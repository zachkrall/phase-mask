!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=146)}([function(t,e,n){"use strict";(function(t,r,i,a){n.d(e,"a",(function(){return _i})),n.d(e,"b",(function(){return Si})),n.d(e,"c",(function(){return wt})),n.d(e,"d",(function(){return ar})),n.d(e,"e",(function(){return or})),n.d(e,"f",(function(){return sr})),n.d(e,"g",(function(){return er})),n.d(e,"h",(function(){return Hs})),n.d(e,"i",(function(){return Dc})),n.d(e,"j",(function(){return Pc})),n.d(e,"k",(function(){return Fc})),n.d(e,"l",(function(){return Bc})),n.d(e,"m",(function(){return ur})),n.d(e,"n",(function(){return cr})),n.d(e,"o",(function(){return lr})),n.d(e,"p",(function(){return Ur})),n.d(e,"q",(function(){return hr})),n.d(e,"r",(function(){return Mc})),n.d(e,"s",(function(){return Cc})),n.d(e,"t",(function(){return Ui})),n.d(e,"u",(function(){return Ks})),n.d(e,"v",(function(){return Dn})),n.d(e,"w",(function(){return wp})),n.d(e,"x",(function(){return Ln})),n.d(e,"y",(function(){return Pn})),n.d(e,"z",(function(){return pr})),n.d(e,"A",(function(){return fr})),n.d(e,"B",(function(){return hn})),n.d(e,"C",(function(){return An})),n.d(e,"D",(function(){return In})),n.d(e,"E",(function(){return nc})),n.d(e,"F",(function(){return rc})),n.d(e,"G",(function(){return hc})),n.d(e,"H",(function(){return ic})),n.d(e,"I",(function(){return dr})),n.d(e,"J",(function(){return mr})),n.d(e,"K",(function(){return Bn})),n.d(e,"L",(function(){return sc})),n.d(e,"M",(function(){return ni})),n.d(e,"N",(function(){return du})),n.d(e,"O",(function(){return qc})),n.d(e,"P",(function(){return Ve})),n.d(e,"Q",(function(){return p})),n.d(e,"R",(function(){return Fu})),n.d(e,"S",(function(){return vr})),n.d(e,"T",(function(){return gr})),n.d(e,"U",(function(){return zn})),n.d(e,"V",(function(){return yr})),n.d(e,"W",(function(){return ol})),n.d(e,"X",(function(){return Sn})),n.d(e,"Y",(function(){return xr})),n.d(e,"Z",(function(){return Wr})),n.d(e,"ab",(function(){return Jl})),n.d(e,"bb",(function(){return Ju})),n.d(e,"cb",(function(){return pl})),n.d(e,"db",(function(){return ii})),n.d(e,"eb",(function(){return zu})),n.d(e,"fb",(function(){return Uu})),n.d(e,"gb",(function(){return sl})),n.d(e,"hb",(function(){return fn})),n.d(e,"ib",(function(){return Vl})),n.d(e,"jb",(function(){return yp})),n.d(e,"kb",(function(){return cl})),n.d(e,"lb",(function(){return Xc})),n.d(e,"mb",(function(){return Vu})),n.d(e,"nb",(function(){return Hu})),n.d(e,"ob",(function(){return Mn})),n.d(e,"pb",(function(){return Zc})),n.d(e,"qb",(function(){return br})),n.d(e,"rb",(function(){return wr})),n.d(e,"sb",(function(){return bi})),n.d(e,"tb",(function(){return uu})),n.d(e,"ub",(function(){return cu})),n.d(e,"vb",(function(){return lu})),n.d(e,"wb",(function(){return fc})),n.d(e,"xb",(function(){return Uc})),n.d(e,"yb",(function(){return Sc})),n.d(e,"zb",(function(){return Tc})),n.d(e,"Ab",(function(){return Ac})),n.d(e,"Bb",(function(){return Vr})),n.d(e,"Cb",(function(){return jc})),n.d(e,"Db",(function(){return Wc})),n.d(e,"Eb",(function(){return Gr})),n.d(e,"Fb",(function(){return Xr})),n.d(e,"Gb",(function(){return Yr})),n.d(e,"Hb",(function(){return gu})),n.d(e,"Ib",(function(){return Sr})),n.d(e,"Jb",(function(){return Xu})),n.d(e,"Kb",(function(){return yu})),n.d(e,"Lb",(function(){return wn})),n.d(e,"Mb",(function(){return Tn})),n.d(e,"Nb",(function(){return xu})),n.d(e,"Ob",(function(){return Jr})),n.d(e,"Pb",(function(){return $c})),n.d(e,"Qb",(function(){return Gc})),n.d(e,"Rb",(function(){return ku})),n.d(e,"Sb",(function(){return En})),n.d(e,"Tb",(function(){return pn})),n.d(e,"Ub",(function(){return Mr})),n.d(e,"Vb",(function(){return Xe})),n.d(e,"Wb",(function(){return x})),n.d(e,"Xb",(function(){return Yc})),n.d(e,"Yb",(function(){return Un})),n.d(e,"Zb",(function(){return vc})),n.d(e,"ac",(function(){return ul})),n.d(e,"bc",(function(){return Er})),n.d(e,"cc",(function(){return Tr})),n.d(e,"dc",(function(){return vn})),n.d(e,"ec",(function(){return al})),n.d(e,"fc",(function(){return ci})),n.d(e,"gc",(function(){return Jc})),n.d(e,"hc",(function(){return qe})),n.d(e,"ic",(function(){return Gn})),n.d(e,"jc",(function(){return Cr})),n.d(e,"kc",(function(){return Ar})),n.d(e,"lc",(function(){return Or})),n.d(e,"mc",(function(){return kr})),n.d(e,"nc",(function(){return Nc})),n.d(e,"oc",(function(){return gi})),n.d(e,"pc",(function(){return xi})),n.d(e,"qc",(function(){return Lr})),n.d(e,"rc",(function(){return jn})),n.d(e,"sc",(function(){return hl})),n.d(e,"tc",(function(){return kn})),n.d(e,"uc",(function(){return Dr})),n.d(e,"vc",(function(){return Lu})),n.d(e,"wc",(function(){return Du})),n.d(e,"xc",(function(){return Wn})),n.d(e,"yc",(function(){return Vn})),n.d(e,"zc",(function(){return rl})),n.d(e,"Ac",(function(){return ti})),n.d(e,"Bc",(function(){return Hc})),n.d(e,"Cc",(function(){return Fr})),n.d(e,"Dc",(function(){return Br})),n.d(e,"Ec",(function(){return dn})),n.d(e,"Fc",(function(){return gn})),n.d(e,"Gc",(function(){return yn})),n.d(e,"Hc",(function(){return He})),n.d(e,"Ic",(function(){return mu})),n.d(e,"Jc",(function(){return il})),n.d(e,"Kc",(function(){return wi})),n.d(e,"Lc",(function(){return Pu})),n.d(e,"Mc",(function(){return Hn})),n.d(e,"Nc",(function(){return ht})),n.d(e,"Oc",(function(){return pu})),n.d(e,"Pc",(function(){return fu})),n.d(e,"Qc",(function(){return _n})),n.d(e,"Rc",(function(){return Cn}));
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function s(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function u(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}u((r=r.apply(t,e||[])).next())}))}function c(t,e){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}var l=function(){function t(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return t.prototype.setPlatform=function(t,e){null!=this.platform&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+e+"."),this.platformName=t,this.platform=e},t.prototype.registerFlag=function(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){var r=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+r+"."),this.set(t,r)}},t.prototype.get=function(t){return t in this.flags||(this.flags[t]=this.evaluateFlag(t)),this.flags[t]},t.prototype.getNumber=function(t){return this.get(t)},t.prototype.getBool=function(t){return this.get(t)},t.prototype.getFlags=function(){return this.flags},Object.defineProperty(t.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),t.prototype.set=function(t,e){if(null==this.flagRegistry[t])throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)},t.prototype.evaluateFlag=function(t){if(null==this.flagRegistry[t])throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},t.prototype.setFlags=function(t){this.flags=Object.assign({},t)},t.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},t.prototype.populateURLFlags=function(){var t=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var e,n,r=(e=this.global.location.search,n={},e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return h(n,e[0],e[1]),e.join("=")})),n);"tfjsflags"in r&&r.tfjsflags.split(",").forEach((function(e){var n=e.split(":"),r=n[0],i=n[1];t.urlFlags[r]=function(t,e){if("true"===(e=e.toLowerCase())||"false"===e)return"true"===e;if(""+ +e===e)return+e;throw new Error("Could not parse value flag value "+e+" for flag "+t+".")}(r,i)}))}},t}();function h(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function p(){return f}var f=null,d=new Map,m=new Map;function v(t,e){var n=w(t,e);return d.get(n)}function g(t){return m.get(t)}function y(t){for(var e=d.entries(),n=[];;){var r=e.next(),i=r.done,a=r.value;if(i)break;var o=a[0],s=a[1];o.split("_")[0]===t&&n.push(s)}return n}function x(t){var e=t.kernelName,n=t.backendName,r=w(e,n);if(d.has(r))throw new Error("The kernel '"+e+"' for backend '"+n+"' is already registered");d.set(r,t)}function b(t){var e=t.kernelName;m.has(e)&&console.warn("Overriding the gradient for '"+e+"'"),m.set(e,t)}function w(t,e){return e+"_"+t}function _(t){for(var e=t.length,n=0,r=0;e>0;)r=Math.random()*e|0,n=t[--e],t[e]=t[r],t[r]=n}function S(t,e,n){return Math.max(t,Math.min(e,n))}function M(t){return t%2==0?t:t+1}function E(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}function T(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function C(t,e,n){void 0===n&&(n=""),T(R(t,e),(function(){return n+" Shapes "+t+" and "+e+" must match"}))}function A(t){T(null!=t,(function(){return"The input to the tensor constructor must be a non-null value."}))}function N(t,e,n){if(void 0===e&&(e=[]),void 0===n&&(n=!1),null==e&&(e=[]),Array.isArray(t)||G(t)&&!n)for(var r=0;r<t.length;++r)N(t[r],e,n);else e.push(t);return e}function I(t){if(0===t.length)return 1;for(var e=t[0],n=1;n<t.length;n++)e*=t[n];return e}function R(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function O(t){return t%1==0}function k(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var e=Math.exp(2*t);return(e-1)/(e+1)}function L(t){var e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function D(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function P(t,e,n){return void 0===e&&(e=function(t){return 0}),new Promise((function(r,i){var a=0,o=function(){if(t())r();else{a++;var s=e(a);null!=n&&a>=n?i():setTimeout(o,s)}};o()}))}function F(t,e){for(var n=1,r=-1,i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(-1===t[i]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+i);r=i}else if(t[i]<0)throw Error("Shapes can not be < 0. Found "+t[i]+" at dim "+i);if(-1===r){if(e>0&&e!==n)throw Error("Size("+e+") must match the product of shape "+t);return t}if(0===n)throw Error("Cannot infer the missing size in ["+t+"] when there are 0 elements");if(e%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+e+" / "+n);var a=t.slice();return a[r]=e/n,a}function B(t,e){var n=e.length;return T((t=null==t?e.map((function(t,e){return e})):[].concat(t)).every((function(t){return t>=-n&&t<n})),(function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+t})),T(t.every((function(t){return O(t)})),(function(){return"All values in axis param must be integers but got axis "+t})),t.map((function(t){return t<0?n+t:t}))}function z(t,e){for(var n=[],r=[],i=null!=e&&Array.isArray(e)&&0===e.length,a=null==e||i?null:B(e,t).sort(),o=0,s=0;s<t.length;++s){if(null!=a){if(a[o]===s&&1!==t[s])throw new Error("Can't squeeze axis "+s+" since its dim '"+t[s]+"' is not 1");(null==a[o]||a[o]>s)&&1===t[s]&&(n.push(t[s]),r.push(s)),a[o]<=s&&o++}1!==t[s]&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}function U(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else{if("bool"!==t)throw new Error("Unknown data type "+t);n=new Uint8Array(e)}return n}function j(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type "+t);n=new Array(e)}return n}function W(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+e+" being uploaded contains "+r+".")}}function V(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function H(t,e){return!("complex64"===e||"float32"===e&&"complex64"!==t||"int32"===e&&"float32"!==t&&"complex64"!==t||"bool"===e&&"bool"===t)}function G(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function q(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype "+t)}function X(t){if(null==t)return 0;var e=0;return t.forEach((function(t){return e+=t.length})),e}function $(t){return"string"==typeof t||t instanceof String}function Y(t){return"boolean"==typeof t}function K(t){return"number"==typeof t}function J(t){return Array.isArray(t)?J(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":K(t)?"float32":$(t)?"string":Y(t)?"bool":"float32"}function Z(t){return!!(t&&t.constructor&&t.call&&t.apply)}function Q(t,e){for(var n=e;n<t;++n)if(t%n==0)return n;return t}function tt(t){var e=t.length;if(e<2)return[];var n=new Array(e-1);n[e-2]=t[e-1];for(var r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function et(t,e,n){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=N(t)),n&&W(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){for(var r=new Uint8Array(t.length),i=0;i<r.length;++i)0!==Math.round(t[i])&&(r[i]=1);return r}throw new Error("Unknown data type "+e)}function nt(t,e){if(0===t.length)return e[0];var n=t.reduce((function(t,e){return t*e}));if(0===n)return[];if(n!==e.length)throw new Error("["+t+"] does not match the input size.");return function t(e,n,r){var i=new Array;if(1===n.length)for(var a=n[0],o=0;o<a;o++)i[o]=r[e+o];else{a=n[0];var s=n.slice(1),u=s.reduce((function(t,e){return t*e}));for(o=0;o<a;o++)i[o]=t(e+o*u,s,r)}return i}(0,t,e)}function rt(t,e){for(var n=it(t,e),r=0;r<n.length;r++)n[r]=1;return n}function it(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type "+e)}function at(){return p().platform.now()}function ot(t){t.forEach((function(e){T(Number.isInteger(e)&&e>=0,(function(){return"Tensor must have a shape comprised of positive integers but got shape ["+t+"]."}))}))}function st(t,e){return void 0===e&&(e="utf-8"),e=e||"utf-8",p().platform.encode(t,e)}function ut(t,e){return void 0===e&&(e="utf-8"),e=e||"utf-8",p().platform.decode(t,e)}function ct(t,e,n){if(0===e)return 0;if(1===e)return t[0];for(var r=t[t.length-1],i=0;i<t.length-1;++i)r+=n[i]*t[i];return r}function lt(t,e,n){if(0===e)return[];if(1===e)return[t];for(var r=new Array(e),i=0;i<r.length-1;++i)r[i]=Math.floor(t/n[i]),t-=r[i]*n[i];return r[r.length-1]=t,r}var ht=Object.freeze({shuffle:_,clamp:S,nearestLargerEven:M,sum:E,randUniform:function(t,e){var n=Math.random();return e*n+(1-n)*t},distSquared:function(t,e){for(var n=0,r=0;r<t.length;r++){var i=Number(t[r])-Number(e[r]);n+=i*i}return n},assert:T,assertShapesMatch:C,assertNonNull:A,flatten:N,sizeFromShape:I,isScalarShape:function(t){return 0===t.length},arraysEqual:R,isInt:O,tanh:k,sizeToSquarishShape:L,createShuffledIndices:function(t){for(var e=new Uint32Array(t),n=0;n<t;++n)e[n]=n;return _(e),e},rightPad:D,repeatedTry:P,inferFromImplicitShape:F,parseAxisParam:B,squeezeShape:z,getTypedArrayFromDType:U,getArrayFromDType:j,checkConversionForErrors:W,isValidDtype:V,hasEncodingLoss:H,isTypedArray:G,bytesPerElement:q,bytesFromStringArray:X,isString:$,isBoolean:Y,isNumber:K,inferDtype:J,isFunction:Z,nearestDivisor:Q,computeStrides:tt,toTypedArray:et,toNestedArray:nt,makeOnesTypedArray:rt,makeZerosTypedArray:it,now:at,assertNonNegativeIntegerDimensions:ot,fetch:function(t,e){return p().platform.fetch(t,e)},encodeString:st,decodeString:ut,locToIndex:ct,indexToLoc:lt}),pt=function(){function t(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new ft)}return t.prototype.profileKernel=function(t,e,n){var r,i=this,a=this.backendTimer.time((function(){r=n()}));return r.forEach((function(n){n.data().then((function(r){!function(t,e,n){if("float32"!==e)return!1;for(var r=0;r<t.length;r++){var i=t[r];if(isNaN(i)||!isFinite(i))return console.warn("Found "+i+" in the result of '"+n+"'"),!0}}(r,n.dtype,t),a.then((function(a){var o="";null!=a.getExtraProfileInfo&&(o=a.getExtraProfileInfo()),i.logger.logKernelProfile(t,n,r,a.kernelMs,e,o)}))}))})),r},t}(),ft=function(){function t(){}return t.prototype.logKernelProfile=function(t,e,n,r,i,a){var o="number"==typeof r?D(r+"ms",9):r.error,s=D(t,25),u=e.rank,c=e.size,l=D(e.shape.toString(),14),h="";for(var p in i){var f=i[p].shape||e.shape,d=f.length;h+=p+": "+d+"D "+(d>0?f:"")+" "}console.log("%c"+s+"\t%c"+o+"\t%c"+u+"D "+l+"\t%c"+c+"\t%c"+h+"\t%c"+a,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},t}();function dt(t,e,n){return D(Array.isArray(t)?parseFloat(t[0].toFixed(7))+" + "+parseFloat(t[1].toFixed(7))+"j":$(t)?"'"+t+"'":"bool"===n?mt(t):parseFloat(t.toFixed(7)).toString(),e)}function mt(t){return 0===t?"false":"true"}function vt(t){for(var e=[],n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var gt=function(){function t(t,e,n){var r=this;if(this.dtype=e,this.shape=t.slice(),this.size=I(t),null!=n){var i=n.length;T(i===this.size,(function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+r.size+"'."}))}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||j(e,this.size),this.strides=tt(t)}return t.prototype.set=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),T(n.length===this.rank,(function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+e.rank+")"}));var i=this.locToIndex(n);this.values[i]=t},t.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];0===t.length&&(t=[0]);for(var n=0,r=0,i=t;r<i.length;r++){var a=i[r];if(a<0||a>=this.shape[n]){var o="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(o)}n++}for(var s=t[t.length-1],u=0;u<t.length-1;++u)s+=this.strides[u]*t[u];return this.values[s]},t.prototype.locToIndex=function(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];for(var e=t[t.length-1],n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e},t.prototype.indexToLoc=function(t){if(0===this.rank)return[];if(1===this.rank)return[t];for(var e=new Array(this.shape.length),n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.toTensor=function(){return yt().makeTensor(this.values,this.shape,this.dtype)},t}(),yt=null,xt=null,bt=null,wt=function(){function t(t,e,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=I(t),this.strides=tt(t),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}return t.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},t.prototype.asScalar=function(){return this.throwIfDisposed(),T(1===this.size,(function(){return"The array must have only 1 element."})),this.reshape([])},t.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},t.prototype.as2D=function(t,e){return this.throwIfDisposed(),this.reshape([t,e])},t.prototype.as3D=function(t,e,n){return this.throwIfDisposed(),this.reshape([t,e,n])},t.prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),this.reshape([t,e,n,r])},t.prototype.as5D=function(t,e,n,r,i){return this.throwIfDisposed(),this.reshape([t,e,n,r,i])},t.prototype.asType=function(t){return this.throwIfDisposed(),xt.cast(this,t)},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.buffer=function(){return u(this,void 0,void 0,(function(){var t;return c(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,xt.buffer(this.shape,this.dtype,t)]}}))}))},t.prototype.bufferSync=function(){return xt.buffer(this.shape,this.dtype,this.dataSync())},t.prototype.array=function(){return u(this,void 0,void 0,(function(){var t;return c(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,nt(this.shape,t)]}}))}))},t.prototype.arraySync=function(){return nt(this.shape,this.dataSync())},t.prototype.data=function(){return u(this,void 0,void 0,(function(){var t,e;return c(this,(function(n){switch(n.label){case 0:return this.throwIfDisposed(),t=yt().read(this.dataId),"string"!==this.dtype?[3,2]:[4,t];case 1:e=n.sent();try{return[2,e.map((function(t){return ut(t)}))]}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,t]}}))}))},t.prototype.dataSync=function(){this.throwIfDisposed();var t=yt().readSync(this.dataId);if("string"===this.dtype)try{return t.map((function(t){return ut(t)}))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},t.prototype.bytes=function(){return u(this,void 0,void 0,(function(){var t;return c(this,(function(e){switch(e.label){case 0:return this.throwIfDisposed(),[4,yt().read(this.dataId)];case 1:return t=e.sent(),"string"===this.dtype?[2,t]:[2,new Uint8Array(t.buffer)]}}))}))},t.prototype.dispose=function(){this.isDisposed||(yt().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),t.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},t.prototype.toFloat=function(){return this.asType("float32")},t.prototype.toInt=function(){return this.asType("int32")},t.prototype.toBool=function(){return this.asType("bool")},t.prototype.print=function(t){return void 0===t&&(t=!1),xt.print(this,t)},t.prototype.reshape=function(t){return this.throwIfDisposed(),xt.reshape(this,t)},t.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},t.prototype.expandDims=function(t){return void 0===t&&(t=0),xt.expandDims(this,t)},t.prototype.cumsum=function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=!1),void 0===n&&(n=!1),xt.cumsum(this,t,e,n)},t.prototype.squeeze=function(t){return this.throwIfDisposed(),xt.squeeze(this,t)},t.prototype.clone=function(){return this.throwIfDisposed(),xt.clone(this)},t.prototype.toString=function(t){return void 0===t&&(t=!1),function(t,e,n,r){var i=tt(e),a=function(t,e,n,r){var i=I(e),a=r[r.length-1],o=new Array(a).fill(0),s=e.length,u="complex64"===n?vt(t):t;if(s>1)for(var c=0;c<i/a;c++)for(var l=c*a,h=0;h<a;h++)o[h]=Math.max(o[h],dt(u[l+h],0,n).length);return o}(t,e,n,i),o=e.length,s=function t(e,n,r,i,a,o){void 0===o&&(o=!0);var s="complex64"===r?2:1,u=n[0],c=n.length;if(0===c)return"complex64"===r?[dt(vt(e)[0],0,r)]:"bool"===r?[mt(e[0])]:[e[0].toString()];if(1===c){if(u>20){var l=3*s,h=Array.from(e.slice(0,l)),p=Array.from(e.slice((u-3)*s,u*s));return"complex64"===r&&(h=vt(h),p=vt(p)),["["+h.map((function(t,e){return dt(t,a[e],r)})).join(", ")+", ..., "+p.map((function(t,e){return dt(t,a[u-3+e],r)})).join(", ")+"]"]}return["["+("complex64"===r?vt(e):Array.from(e)).map((function(t,e){return dt(t,a[e],r)})).join(", ")+"]"]}var f=n.slice(1),d=i.slice(1),m=i[0]*s,v=[];if(u>20){for(var g=0;g<3;g++){var y=(x=g*m)+m;v.push.apply(v,t(e.slice(x,y),f,r,d,a,!1))}for(v.push("..."),g=u-3;g<u;g++)y=(x=g*m)+m,v.push.apply(v,t(e.slice(x,y),f,r,d,a,g===u-1))}else for(g=0;g<u;g++){var x;y=(x=g*m)+m,v.push.apply(v,t(e.slice(x,y),f,r,d,a,g===u-1))}var b=2===c?",":"";for(v[0]="["+v[0]+b,g=1;g<v.length-1;g++)v[g]=" "+v[g]+b;var w=",\n";for(g=2;g<c;g++)w+="\n";return v[v.length-1]=" "+v[v.length-1]+"]"+(o?"":w),v}(t,e,n,i,a),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+o),u.push("  shape: ["+e+"]"),u.push("  values:")),u.push(s.map((function(t){return"    "+t})).join("\n")),u.join("\n")}(this.dataSync(),this.shape,this.dtype,t)},t.prototype.gather=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),xt.gather(this,t,e)},t.prototype.matMul=function(t,e,n){return void 0===e&&(e=!1),void 0===n&&(n=!1),this.throwIfDisposed(),xt.matMul(this,t,e,n)},t.prototype.dot=function(t){return this.throwIfDisposed(),xt.dot(this,t)},t.prototype.norm=function(t,e,n){return void 0===t&&(t="euclidean"),void 0===e&&(e=null),void 0===n&&(n=!1),this.throwIfDisposed(),xt.norm(this,t,e,n)},t.prototype.slice=function(t,e){return this.throwIfDisposed(),xt.slice(this,t,e)},t.prototype.reverse=function(t){return this.throwIfDisposed(),xt.reverse(this,t)},t.prototype.concat=function(e,n){return void 0===n&&(n=0),this.throwIfDisposed(),e instanceof t&&(e=[e]),xt.concat([this].concat(e),n)},t.prototype.split=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),xt.split(this,t,e)},t.prototype.stack=function(t,e){return void 0===e&&(e=0),xt.stack([this,t],e)},t.prototype.unstack=function(t){return void 0===t&&(t=0),xt.unstack(this,t)},t.prototype.batchNormalization=function(t,e,n,r,i){return void 0===n&&(n=.001),bt("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,e,i,r,n)},t.prototype.all=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),xt.all(this,t,e)},t.prototype.any=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),xt.any(this,t,e)},t.prototype.logSumExp=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),xt.logSumExp(this,t,e)},t.prototype.sum=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),xt.sum(this,t,e)},t.prototype.prod=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),xt.prod(this,t,e)},t.prototype.mean=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),xt.mean(this,t,e)},t.prototype.min=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),xt.min(this,t,e)},t.prototype.max=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),xt.max(this,t,e)},t.prototype.argMin=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),xt.argMin(this,t)},t.prototype.argMax=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),xt.argMax(this,t)},t.prototype.cast=function(t){return this.throwIfDisposed(),xt.cast(this,t)},t.prototype.addStrict=function(t){return this.throwIfDisposed(),xt.addStrict(this,t)},t.prototype.atan2=function(t){return this.throwIfDisposed(),xt.atan2(this,t)},t.prototype.sub=function(t){return this.throwIfDisposed(),xt.sub(this,t)},t.prototype.subStrict=function(t){return this.throwIfDisposed(),xt.subStrict(this,t)},t.prototype.pow=function(t){return this.throwIfDisposed(),xt.pow(this,t)},t.prototype.powStrict=function(t){return this.throwIfDisposed(),xt.powStrict(this,t)},t.prototype.mul=function(t){return this.throwIfDisposed(),xt.mul(this,t)},t.prototype.mulStrict=function(t){return this.throwIfDisposed(),xt.mulStrict(this,t)},t.prototype.floorDiv=function(t){return this.throwIfDisposed(),xt.floorDiv(this,t)},t.prototype.divStrict=function(t){return this.throwIfDisposed(),xt.divStrict(this,t)},t.prototype.minimum=function(t){return this.throwIfDisposed(),xt.minimum(this,t)},t.prototype.minimumStrict=function(t){return this.throwIfDisposed(),xt.minimumStrict(this,t)},t.prototype.maximum=function(t){return this.throwIfDisposed(),xt.maximum(this,t)},t.prototype.maximumStrict=function(t){return this.throwIfDisposed(),xt.maximumStrict(this,t)},t.prototype.mod=function(t){return this.throwIfDisposed(),xt.mod(this,t)},t.prototype.modStrict=function(t){return this.throwIfDisposed(),xt.modStrict(this,t)},t.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),xt.squaredDifferenceStrict(this,t)},t.prototype.notEqual=function(t){return this.throwIfDisposed(),xt.notEqual(this,t)},t.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),xt.notEqualStrict(this,t)},t.prototype.less=function(t){return this.throwIfDisposed(),xt.less(this,t)},t.prototype.lessStrict=function(t){return this.throwIfDisposed(),xt.lessStrict(this,t)},t.prototype.equal=function(t){return this.throwIfDisposed(),xt.equal(this,t)},t.prototype.equalStrict=function(t){return this.throwIfDisposed(),xt.equalStrict(this,t)},t.prototype.lessEqual=function(t){return this.throwIfDisposed(),xt.lessEqual(this,t)},t.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),xt.lessEqualStrict(this,t)},t.prototype.greater=function(t){return this.throwIfDisposed(),xt.greater(this,t)},t.prototype.greaterStrict=function(t){return this.throwIfDisposed(),xt.greaterStrict(this,t)},t.prototype.greaterEqual=function(t){return this.throwIfDisposed(),xt.greaterEqual(this,t)},t.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),xt.greaterEqualStrict(this,t)},t.prototype.logicalAnd=function(t){return this.throwIfDisposed(),xt.logicalAnd(this,t)},t.prototype.logicalOr=function(t){return this.throwIfDisposed(),xt.logicalOr(this,t)},t.prototype.logicalNot=function(){return this.throwIfDisposed(),xt.logicalNot(this)},t.prototype.logicalXor=function(t){return this.throwIfDisposed(),xt.logicalXor(this,t)},t.prototype.where=function(t,e){return this.throwIfDisposed(),xt.where(t,this,e)},t.prototype.neg=function(){return this.throwIfDisposed(),xt.neg(this)},t.prototype.ceil=function(){return this.throwIfDisposed(),xt.ceil(this)},t.prototype.floor=function(){return this.throwIfDisposed(),xt.floor(this)},t.prototype.sign=function(){return this.throwIfDisposed(),xt.sign(this)},t.prototype.isNaN=function(){return this.throwIfDisposed(),xt.isNaN(this)},t.prototype.isInf=function(){return this.throwIfDisposed(),xt.isInf(this)},t.prototype.isFinite=function(){return this.throwIfDisposed(),xt.isFinite(this)},t.prototype.exp=function(){return this.throwIfDisposed(),xt.exp(this)},t.prototype.expm1=function(){return this.throwIfDisposed(),xt.expm1(this)},t.prototype.log=function(){return this.throwIfDisposed(),xt.log(this)},t.prototype.log1p=function(){return this.throwIfDisposed(),xt.log1p(this)},t.prototype.sqrt=function(){return this.throwIfDisposed(),xt.sqrt(this)},t.prototype.rsqrt=function(){return this.throwIfDisposed(),xt.rsqrt(this)},t.prototype.square=function(){return this.throwIfDisposed(),xt.square(this)},t.prototype.reciprocal=function(){return this.throwIfDisposed(),xt.reciprocal(this)},t.prototype.abs=function(){return this.throwIfDisposed(),xt.abs(this)},t.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),xt.clipByValue(this,t,e)},t.prototype.relu=function(){return this.throwIfDisposed(),xt.relu(this)},t.prototype.relu6=function(){return this.throwIfDisposed(),xt.relu6(this)},t.prototype.elu=function(){return this.throwIfDisposed(),xt.elu(this)},t.prototype.selu=function(){return this.throwIfDisposed(),xt.selu(this)},t.prototype.leakyRelu=function(t){return void 0===t&&(t=.2),this.throwIfDisposed(),xt.leakyRelu(this,t)},t.prototype.prelu=function(t){return this.throwIfDisposed(),xt.prelu(this,t)},t.prototype.sigmoid=function(){return this.throwIfDisposed(),xt.sigmoid(this)},t.prototype.logSigmoid=function(){return this.throwIfDisposed(),xt.logSigmoid(this)},t.prototype.softplus=function(){return this.throwIfDisposed(),xt.softplus(this)},t.prototype.zerosLike=function(){return this.throwIfDisposed(),xt.zerosLike(this)},t.prototype.onesLike=function(){return this.throwIfDisposed(),xt.onesLike(this)},t.prototype.sin=function(){return this.throwIfDisposed(),xt.sin(this)},t.prototype.cos=function(){return this.throwIfDisposed(),xt.cos(this)},t.prototype.tan=function(){return this.throwIfDisposed(),xt.tan(this)},t.prototype.asin=function(){return this.throwIfDisposed(),xt.asin(this)},t.prototype.acos=function(){return this.throwIfDisposed(),xt.acos(this)},t.prototype.atan=function(){return this.throwIfDisposed(),xt.atan(this)},t.prototype.sinh=function(){return this.throwIfDisposed(),xt.sinh(this)},t.prototype.cosh=function(){return this.throwIfDisposed(),xt.cosh(this)},t.prototype.tanh=function(){return this.throwIfDisposed(),xt.tanh(this)},t.prototype.asinh=function(){return this.throwIfDisposed(),xt.asinh(this)},t.prototype.acosh=function(){return this.throwIfDisposed(),xt.acosh(this)},t.prototype.atanh=function(){return this.throwIfDisposed(),xt.atanh(this)},t.prototype.erf=function(){return this.throwIfDisposed(),xt.erf(this)},t.prototype.round=function(){return this.throwIfDisposed(),xt.round(this)},t.prototype.step=function(t){return void 0===t&&(t=0),this.throwIfDisposed(),xt.step(this,t)},t.prototype.softmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),xt.softmax(this,t)},t.prototype.logSoftmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),xt.logSoftmax(this,t)},t.prototype.resizeBilinear=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),xt.image.resizeBilinear(this,t,e)},t.prototype.resizeNearestNeighbor=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),xt.image.resizeNearestNeighbor(this,t,e)},t.prototype.conv1d=function(t,e,n,r,i,a){return void 0===r&&(r="NWC"),void 0===i&&(i=1),this.throwIfDisposed(),xt.conv1d(this,t,e,n,r,i,a)},t.prototype.conv2d=function(t,e,n,r,i,a){return void 0===r&&(r="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),xt.conv2d(this,t,e,n,r,i,a)},t.prototype.conv2dTranspose=function(t,e,n,r,i){return this.throwIfDisposed(),xt.conv2dTranspose(this,t,e,n,r,i)},t.prototype.depthwiseConv2D=function(t,e,n,r,i,a){return void 0===r&&(r="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),xt.depthwiseConv2d(this,t,e,n,r,i,a)},t.prototype.separableConv2d=function(t,e,n,r,i,a){return void 0===i&&(i=[1,1]),void 0===a&&(a="NHWC"),this.throwIfDisposed(),xt.separableConv2d(this,t,e,n,r,i,a)},t.prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),xt.avgPool(this,t,e,n,r)},t.prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),xt.maxPool(this,t,e,n,r)},t.prototype.localResponseNormalization=function(t,e,n,r){return void 0===t&&(t=5),void 0===e&&(e=1),void 0===n&&(n=1),void 0===r&&(r=.5),xt.localResponseNormalization(this,t,e,n,r)},t.prototype.pool=function(t,e,n,r,i){return this.throwIfDisposed(),xt.pool(this,t,e,n,r,i)},t.prototype.variable=function(t,e,n){return void 0===t&&(t=!0),this.throwIfDisposed(),yt().makeVariable(this,t,e,n)},t.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),xt.unsortedSegmentSum(this,t,e)},t.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),xt.batchToSpaceND(this,t,e)},t.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),xt.spaceToBatchND(this,t,e)},t.prototype.topk=function(t,e){return void 0===t&&(t=1),void 0===e&&(e=!0),this.throwIfDisposed(),xt.topk(this,t,e)},t.prototype.stridedSlice=function(t,e,n,r,i,a,o,s){return void 0===r&&(r=0),void 0===i&&(i=0),void 0===a&&(a=0),void 0===o&&(o=0),void 0===s&&(s=0),this.throwIfDisposed(),xt.stridedSlice(this,t,e,n,r,i,a,o,s)},t.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),xt.depthToSpace(this,t,e)},t.prototype.fft=function(){return this.throwIfDisposed(),xt.spectral.fft(this)},t.prototype.ifft=function(){return this.throwIfDisposed(),xt.spectral.ifft(this)},t.prototype.rfft=function(){return this.throwIfDisposed(),xt.spectral.rfft(this)},t.prototype.irfft=function(){return this.throwIfDisposed(),xt.spectral.irfft(this)},t}();Object.defineProperty(wt,Symbol.hasInstance,{value:function(t){return!!t&&null!=t.dataId&&null!=t.shape&&null!=t.dtype}});var _t,St,Mt,Et,Tt,Ct=function(t){function e(e,n,r,i){var a=t.call(this,e.shape,e.dtype,e.dataId,i)||this;return a.trainable=n,a.name=r,a}return s(e,t),e.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value ("+t.dtype+") and previous value ("+this.dtype+") must match");if(!R(t.shape,this.shape))throw new Error("shape of the new value ("+t.shape+") and previous value ("+this.shape+") must match");yt().disposeTensor(this),this.dataId=t.dataId,yt().incRef(this,null)},e.prototype.dispose=function(){yt().disposeVariable(this),this.isDisposedInternal=!0},e}(wt);Object.defineProperty(Ct,Symbol.hasInstance,{value:function(t){return t instanceof wt&&null!=t.assign&&t.assign instanceof Function}}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(_t||(_t={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(St||(St={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(Mt||(Mt={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(Et||(Et={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(Tt||(Tt={}));var At={float32:Et,int32:St,bool:Mt,complex64:Tt};function Nt(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error("Can not upcast "+t+" with "+e)}return At[t][e]}function It(t){return Nt(t,"int32")}function Rt(t,e){if(t.dtype===e.dtype)return[t,e];var n=Nt(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function Ot(t,e){T(t.dtype===e.dtype,(function(){return"The dtypes of the first("+t.dtype+") and second("+e.dtype+") input must match"}))}function kt(t){var e=[];return function t(e,n,r){if(null!=e)if(e instanceof wt)n.push(e);else if(i=e,Array.isArray(i)||"object"==typeof i){var i,a=e;for(var o in a){var s=a[o];r.has(s)||(r.add(s),t(s,n,r))}}}(t,e,new Set),e}Object.freeze({makeTypesMatch:Rt,assertTypesMatch:Ot,isTensorInList:function(t,e){return e.some((function(e){return e.id===t.id}))},getTensorsInContainer:kt});var Lt,Dt=function(){function t(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return t.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},t}(),Pt=function(){function t(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Dt}return t.prototype.ready=function(){return u(this,void 0,void 0,(function(){var t,e,n;return c(this,(function(r){switch(r.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then((function(){}))];if(null!=this.backendInstance)return[2];t=this.getSortedBackends(),e=0,r.label=1;case 1:return e<t.length?(n=t[e],[4,this.initializeBackend(n).success]):[3,5];case 2:return r.sent()?[4,this.setBackend(n)]:[3,4];case 3:return r.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}}))}))},Object.defineProperty(t.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+e+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance},enumerable:!0,configurable:!0}),t.prototype.backendNames=function(){return Object.keys(this.registryFactory)},t.prototype.findBackend=function(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;if(this.initializeBackend(t).asyncInit)return null}return this.registry[t]},t.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},t.prototype.registerBackend=function(t,e,n){return void 0===n&&(n=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)},t.prototype.setBackend=function(t){return u(this,void 0,void 0,(function(){var e,n,r;return c(this,(function(i){switch(i.label){case 0:if(null==this.registryFactory[t])throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,null!=this.registry[t]?[3,4]:(this.backendInstance=null,e=this.initializeBackend(t),n=e.success,e.asyncInit?[4,n]:[3,2]);case 1:return r=i.sent(),[3,3];case 2:r=n,i.label=3;case 3:if(!r)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new pt(this.backendInstance),[2,!0]}}))}))},t.prototype.setupRegisteredKernels=function(){var t=this;y(this.backendName).forEach((function(e){null!=e.setupFunc&&e.setupFunc(t.backendInstance)}))},t.prototype.disposeRegisteredKernels=function(t){var e=this;y(t).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(e.registry[t])}))},t.prototype.initializeBackend=function(t){var e=this,n=this.registryFactory[t];if(null==n)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var r=n.factory();if(Promise.resolve(r)===r){var i=++this.pendingBackendInitId,a=r.then((function(n){return!(i<e.pendingBackendInitId||(e.registry[t]=n,e.pendingBackendInit=null,0))})).catch((function(n){return!(i<e.pendingBackendInitId||(e.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(n.stack||n.message),1))}));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}return this.registry[t]=r,{success:!0,asyncInit:!1}}catch(e){return console.warn("Initialization of backend "+t+" failed"),console.warn(e.stack||e.message),{success:!1,asyncInit:!1}}},t.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},t.prototype.getSortedBackends=function(){var t=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(e,n){return t.registryFactory[n].priority-t.registryFactory[e].priority}))},t.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var n=t[e],r=this.initializeBackend(n),i=r.success,a=r.asyncInit;if(a||i)return{name:n,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")},t.prototype.moveData=function(t,e){var n=this.state.tensorInfo.get(e),r=n.backend,i=this.readSync(e);r.disposeData(e),n.backend=t,t.move(e,i,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},t.prototype.tidy=function(t,e){var n,r=this,i=null;if(null==e){if("function"!=typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!=typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun((function(){return r.startScope(i)}),(function(){return r.endScope(n)}),(function(){return(n=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))},t.prototype.scopedRun=function(t,e,n){t();try{var r=n();return e(),r}catch(t){throw e(),t}},t.prototype.nextTensorId=function(){return t.nextTensorId++},t.prototype.nextVariableId=function(){return t.nextVariableId++},t.prototype.clone=function(t){var e=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),n={x:t};return this.addTapeNode(this.state.activeScope.name,n,[e],(function(t){return{x:function(){return t.toFloat()}}}),[],{}),e},t.prototype.runKernel=function(t,e,n,r,i){return this.runKernelFunc(null,e,null,t,n,r,i)},t.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},t.prototype.checkKernelForMemLeak=function(t,e,n){var r=this.backend.numDataIds(),i=0;n.forEach((function(t){i+="complex64"===t.dtype?3:1}));var a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-e-i-a;if(o>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+o+" data ids) after running '"+t+"'")},t.prototype.runKernelFunc=function(t,e,n,r,i,a,o){var s,u=this,c=[],l=this.isTapeOn();null==r&&(r=null!=this.state.activeScope?this.state.activeScope.name:"");var h,p=this.state.numBytes,f=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var d,m=v(r,this.backendName);if(null!=m)h=function(){var t=u.backend.numDataIds();d=m.kernelFunc({inputs:e,attrs:i,backend:u.backend});var n=Array.isArray(d)?d:[d];u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,t,n);var s=n.map((function(t){var e=t.dataId,n=t.shape,r=t.dtype;return u.makeTensorFromDataId(e,n,r)}));if(l){var h=u.getTensorsForGradient(r,e,s);if(null==h){null==o&&(o=[]);var p=s.filter((function(t,e){return o[e]}));h=(a||[]).slice().concat(p)}c=u.saveTensorsForBackwardMode(h)}return s};else{var g=function(t){l&&(c=t.map((function(t){return u.keep(u.clone(t))})))};h=function(){var e=u.backend.numDataIds();d=u.tidy((function(){return t(u.backend,g)}));var n=Array.isArray(d)?d:[d];return u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,e,n),n}}return this.scopedRun((function(){return u.state.kernelDepth++}),(function(){return u.state.kernelDepth--}),(function(){s=u.ENV.getBool("DEBUG")?u.profiler.profileKernel(r,e,(function(){return h()})):h()})),l&&this.addTapeNode(r,e,s,n,c,i),this.state.profiling&&this.state.activeProfile.kernels.push({name:r,bytesAdded:this.state.numBytes-p,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-f,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map((function(t){return e[t].shape})),outputShapes:s.map((function(t){return t.shape}))}),Array.isArray(d)?s:s[0]},t.prototype.saveTensorsForBackwardMode=function(t){var e=this;return t.map((function(t){return e.keep(e.clone(t))}))},t.prototype.getTensorsForGradient=function(t,e,n){var r=g(t);if(null!=r){var i=r.inputsToSave||[],a=r.outputsToSave||[],o=void 0;r.saveAllInputs?(T(Array.isArray(e),(function(){return"saveAllInputs is true, expected inputs to be an array."})),o=Object.keys(e).map((function(t){return e[t]}))):o=i.map((function(t){return e[t]}));var s=n.filter((function(t,e){return a[e]}));return o.concat(s)}return null},t.prototype.makeTensor=function(t,e,n,r){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var i=t;"string"===n&&$(t[0])&&(i=t.map((function(t){return st(t)})));var a=r.write(i,e,n),o=new wt(e,n,a,this.nextTensorId());if(this.incRef(o,r),"string"===n){var s=this.state.tensorInfo.get(a),u=X(i);this.state.numBytes+=u-s.bytes,s.bytes=u}return o},t.prototype.makeTensorFromDataId=function(t,e,n,r){var i=new wt(e,n=n||"float32",t,this.nextTensorId());return this.incRef(i,r),i},t.prototype.makeVariable=function(t,e,n,r){void 0===e&&(e=!0),n=n||this.nextVariableId().toString(),null!=r&&r!==t.dtype&&(t=t.asType(r));var i=new Ct(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[i.name])throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},t.prototype.incRef=function(t,e){var n=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(r=t.size*q(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:r,refCount:0}),this.state.numBytes+=r}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof Ct||this.track(t)},t.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,"string"===t.dtype&&this.state.numStringTensors--;var e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?("complex64"!==t.dtype&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},t.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var e=this.state.registeredVariables[t];this.disposeVariable(e)}},t.prototype.disposeVariable=function(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]},t.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},t.prototype.profile=function(t){return u(this,void 0,void 0,(function(){var e,n;return c(this,(function(r){return this.state.profiling=!0,e=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map((function(t){return t.totalBytesSnapshot}))),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]}))}))},t.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},t.prototype.addTapeNode=function(t,e,n,r,i,a){var o=this,s={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:i},u=g(t);null!=u&&(r=u.gradFunc),null!=r&&(s.gradient=function(t){return t=t.map((function(t,e){if(null==t){var r=n[e],i=it(r.size,r.dtype);return o.makeTensor(i,r.shape,r.dtype)}return t})),r(t.length>1?t:t[0],i,a)}),this.state.activeTape.push(s)},t.prototype.keep=function(t){return t.kept=!0,t},t.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},t.prototype.endTape=function(){this.state.gradientDepth--},t.prototype.startScope=function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e},t.prototype.endScope=function(t){for(var e=this,n=kt(t),r=new Set(n.map((function(t){return t.id}))),i=0;i<this.state.activeScope.track.length;i++){var a=this.state.activeScope.track[i];a.kept||r.has(a.id)||a.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(t){t.kept||t.scopeId!==o.id||e.track(t)}))},t.prototype.gradients=function(t,e,n,r){var i=this;if(void 0===r&&(r=!1),T(e.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var a=this.scopedRun((function(){return i.startTape()}),(function(){return i.endTape()}),(function(){return i.tidy("forward",t)}));T(a instanceof wt,(function(){return"The result y returned by f() must be a tensor."}));var o=function(t,e,n){for(var r={},i={},a=0;a<e.length;a++)r[e[a].id]=!0;for(a=0;a<t.length;a++){var o=(d=t[a]).inputs;for(var s in o){for(var u=o[s],c=!1,l=0;l<e.length;l++)if(r[u.id]){d.outputs.forEach((function(t){return r[t.id]=!0})),c=!0,i[d.id]=!0;break}if(c)break}}var h={};h[n.id]=!0;var p={};for(a=t.length-1;a>=0;a--)for(o=(d=t[a]).inputs,l=0;l<d.outputs.length;l++)if(h[d.outputs[l].id]){for(var s in o)h[o[s].id]=!0,p[d.id]=!0;break}var f=[];for(a=0;a<t.length;a++){var d;if(i[(d=t[a]).id]&&p[d.id]){var m={};for(var s in d.inputs){var v=d.inputs[s];r[v.id]&&(m[s]=v)}var g=Object.assign({},d);g.inputs=m,g.outputs=d.outputs,f.push(g)}}return f}(this.state.activeTape,e,a);if(!r&&0===o.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var t,r,s={};s[a.id]=null==n?(r=rt(I(t=a.shape),"float32"),Ft.makeTensor(r,t,"float32")):n,function(t,e,n){for(var r=function(r){var i=e[r],a=[];if(i.outputs.forEach((function(e){var n=t[e.id];null!=n?a.push(n):a.push(null)})),null==i.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+i.kernelName+".");var o=i.gradient(a),s=function(e){if(!(e in o))throw new Error("Cannot backprop through input "+e+". Available gradients found: "+Object.keys(o)+".");var r=n((function(){return o[e]()}));if("float32"!==r.dtype)throw new Error("Error in gradient for op "+i.kernelName+". The gradient of input "+e+" must have 'float32' dtype, but has '"+r.dtype+"'");var a=i.inputs[e];if(!R(r.shape,a.shape))throw new Error("Error in gradient for op "+i.kernelName+". The gradient of input '"+e+"' has shape '"+r.shape+"', which does not match the shape of the input '"+a.shape+"'");if(null==t[a.id])t[a.id]=r;else{var s=t[a.id];t[a.id]=s.add(r),s.dispose()}};for(var u in i.inputs)s(u)},i=e.length-1;i>=0;i--)r(i)}(s,o,(function(t){return i.tidy(t)}));var u=e.map((function(t){return s[t.id]}));return 0===i.state.gradientDepth&&(i.state.activeTape.forEach((function(t){for(var e=0,n=t.saved;e<n.length;e++)n[e].dispose()})),i.state.activeTape=null),{value:a,grads:u}}))},t.prototype.customGrad=function(t){var e=this;return T(Z(t),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];T(r.every((function(t){return t instanceof wt})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var a={};return r.forEach((function(t,e){a[e]=t})),e.runKernelFunc((function(e,i){return T((n=t.apply(void 0,r.concat([i]))).value instanceof wt,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),T(Z(n.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),n.value}),a,(function(t,e){var i=n.gradFunc(t,e),a=Array.isArray(i)?i:[i];T(a.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),T(a.every((function(t){return t instanceof wt})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return a.forEach((function(t,e){o[e]=function(){return t}})),o}))}},t.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},t.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},t.prototype.time=function(t){return u(this,void 0,void 0,(function(){var e,n;return c(this,(function(r){switch(r.label){case 0:return e=at(),[4,this.backend.time(t)];case 1:return(n=r.sent()).wallMs=at()-e,[2,n]}}))}))},t.prototype.track=function(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(t.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),t.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Dt,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},t.nextTensorId=0,t.nextVariableId=0,t}(),Ft=function(){var e=function(){if(null==Lt){var e=void 0;if("undefined"!=typeof window)e=window;else if(void 0!==t)e=t;else if(void 0!==r)e=r;else{if("undefined"==typeof self)throw new Error("Could not find a global object");e=self}Lt=e}return Lt}();if(null==e._tfengine){var n=new l(e);e._tfengine=new Pt(n)}return function(t){f=t}(e._tfengine.ENV),yt=function(){return e._tfengine},e._tfengine}();function Bt(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}var zt=p();zt.registerFlag("DEBUG",(function(){return!1}),(function(t){t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),zt.registerFlag("IS_BROWSER",(function(){return Bt()})),zt.registerFlag("IS_NODE",(function(){return void 0!==r&&void 0!==r.versions&&void 0!==r.versions.node})),zt.registerFlag("IS_CHROME",(function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),zt.registerFlag("PROD",(function(){return!1})),zt.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return zt.getBool("DEBUG")})),zt.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),zt.registerFlag("IS_TEST",(function(){return!1}));var Ut,jt,Wt,Vt={},Ht={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Gt(t,e){Vt[t]=e}function qt(t){t in Vt||(Vt[t]=function(t){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var e=function(t){if("undefined"!=typeof OffscreenCanvas&&2===t)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(t);return e.addEventListener("webglcontextlost",(function(e){e.preventDefault(),delete Vt[t]}),!1),1===t?e.getContext("webgl",Ht)||e.getContext("experimental-webgl",Ht):e.getContext("webgl2",Ht)}(t));var e=Vt[t];return e.isContextLost()?(delete Vt[t],qt(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),Vt[t])}function Xt(t,e){return[e,t]}function $t(t){var e=I(t);return L(Math.ceil(e/4))}function Yt(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function Kt(t,e){var n,r,i,a,o,s,u,c,l,h=t;return 2===p().getNumber("WEBGL_VERSION")?(n=h.R32F,r=h.R16F,i=h.RGBA16F,a=h.RGBA32F,o=h.RED,s=4,u=1,c=h.HALF_FLOAT,l=h.FLOAT):(n=t.RGBA,r=t.RGBA,i=t.RGBA,a=h.RGBA,o=t.RGBA,s=4,u=4,c=null!=e?e.HALF_FLOAT_OES:null,l=t.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:a,textureFormatFloat:o,downloadTextureFormat:t.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:c,textureTypeFloat:l}}function Jt(t,e,n){var r=n();return e&&function(t){var e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+Qt(t,e))}(t),r}!function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"}(Ut||(Ut={})),function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(jt||(jt={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Wt||(Wt={}));function Zt(t){return!!(p().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||5.96e-8<Math.abs(t)&&Math.abs(t)<65504)}function Qt(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function te(t,e,n){return Se(t,e,(function(){return t.getExtension(n)}),'Extension "'+n+'" not supported on this browser.')}function ee(t,e,n){var r=Se(t,e,(function(){return t.createShader(t.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(Jt(t,e,(function(){return t.shaderSource(r,n)})),Jt(t,e,(function(){return t.compileShader(r)})),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function ne(t,e,n){var r=Se(t,e,(function(){return t.createShader(t.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(Jt(t,e,(function(){return t.shaderSource(r,n)})),Jt(t,e,(function(){return t.compileShader(r)})),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw function(t,e){var n=ae.exec(e);if(null==n)return console.log("Couldn't parse line number in error: "+e),void console.log(t);for(var r=+n[1],i=t.split("\n"),a=i.length.toString().length+2,o=i.map((function(t,e){return D((e+1).toString(),a)+t})),s=0,u=0;u<o.length;u++)s=Math.max(o[u].length,s);var c=o.slice(0,r-1),l=o.slice(r-1,r),h=o.slice(r);console.log(c.join("\n")),console.log(e.split("\n")[0]),console.log("%c "+D(l[0],s),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join("\n"))}(n,t.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var re,ie,ae=/ERROR: [0-9]+:([0-9]+):/g;function oe(t,e){return Se(t,e,(function(){return t.createProgram()}),"Unable to create WebGLProgram.")}function se(t,e,n){if(Jt(t,e,(function(){return t.linkProgram(n)})),!1===t.getProgramParameter(n,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function ue(t,e,n){if(Jt(t,e,(function(){return t.validateProgram(n)})),!1===t.getProgramParameter(n,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function ce(t,e,n){var r=Se(t,e,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return Jt(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),Jt(t,e,(function(){return t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)})),r}function le(t,e,n){var r=Se(t,e,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return Jt(t,e,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r)})),Jt(t,e,(function(){return t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW)})),r}function he(t,e){return Se(t,e,(function(){return t.createTexture()}),"Unable to create WebGLTexture.")}function pe(t,e){var n=p().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){var r="["+t+"x"+e+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n)throw r="["+t+"x"+e+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU ["+n+"x"+n+"].")}function fe(t,e){return Se(t,e,(function(){return t.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}function de(t,e,n,r,i,a,o,s){var u=t.getAttribLocation(n,r);return-1!==u&&(Jt(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,i)})),Jt(t,e,(function(){return t.vertexAttribPointer(u,a,t.FLOAT,!1,o,s)})),Jt(t,e,(function(){return t.enableVertexAttribArray(u)})),!0)}function me(t,e,n,r){Me(t,r),Jt(t,e,(function(){return t.activeTexture(t.TEXTURE0+r)})),Jt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)}))}function ve(t,e,n,r){return Se(t,e,(function(){return t.getUniformLocation(n,r)}),'uniform "'+r+'" not present in program.')}function ge(t,e,n){return t.getUniformLocation(e,n)}function ye(t,e,n,r,i,a){Jt(t,e,(function(){return me(t,e,r,a)})),Jt(t,e,(function(){return t.uniform1i(i,a)}))}function xe(t,e,n,r){Jt(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,r)})),Jt(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}))}function be(t,e,n){Jt(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,n)})),Jt(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)}))}function we(t){var e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+_e(t,e))}function _e(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function Se(t,e,n,r){var i=Jt(t,e,(function(){return n()}));if(null==i)throw new Error(r);return i}function Me(t,e){var n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+n+"].")}function Ee(t,e){return void 0===e&&(e=2),I(t.slice(0,t.length-e))}function Te(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function Ce(t){var e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=[Ee(t)].concat(Te(t))),e}function Ae(t,e){var n;void 0===e&&(e=!1);var r=p().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(r*=2,1===(t=t.map((function(e,n){return n>=t.length-2?M(t[n]):t[n]}))).length&&(t=[2,t[0]])),2!==t.length){var i=z(t);t=i.newShape}var a=I(t);if(t.length<=1&&a<=r)return[1,a];if(2===t.length&&t[0]<=r&&t[1]<=r)return t;if(3===t.length&&t[0]*t[1]<=r&&t[2]<=r)return[t[0]*t[1],t[2]];if(3===t.length&&t[0]<=r&&t[1]*t[2]<=r)return[t[0],t[1]*t[2]];if(4===t.length&&t[0]*t[1]*t[2]<=r&&t[3]<=r)return[t[0]*t[1]*t[2],t[3]];if(4===t.length&&t[0]<=r&&t[1]*t[2]*t[3]<=r)return[t[0],t[1]*t[2]*t[3]];if(e){var o=Ee(t),s=2,u=2;return t.length&&(s=(n=Te(t))[0],u=n[1]),L(a=o*(s/2)*(u/2)).map((function(t){return 2*t}))}return L(a)}function Ne(t){return t%2==0}function Ie(t,e){if(R(t=t.slice(-2),e=e.slice(-2)))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){var n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r)return!0;if(Ne(n)&&Ne(r)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&Ne(t[0])&&Ne(e[0])}function Re(t){if(null==re){var e=qt(t);re=e.getParameter(e.MAX_TEXTURE_SIZE)}return re}function Oe(t){if(null==ie){var e=qt(t);ie=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,ie)}function ke(t){if(0===t)return 0;var e=qt(t);return Le(e,"EXT_disjoint_timer_query_webgl2")&&2===t?2:Le(e,"EXT_disjoint_timer_query")?1:0}function Le(t,e){return null!=t.getExtension(e)}function De(t){try{if(null!=qt(t))return!0}catch(t){return!1}return!1}function Pe(t){if(0===t)return!1;var e=qt(t);if(1===t){if(!Le(e,"OES_texture_float"))return!1}else if(!Le(e,"EXT_color_buffer_float"))return!1;return Be(e)}function Fe(t){if(0===t)return!1;var e=qt(t);if(1!==t){if(Le(e,"EXT_color_buffer_float"))return Be(e);if(Le(e,"EXT_color_buffer_half_float")){var n=e.getExtension("EXT_color_buffer_half_float");return function(t,e){var n=Kt(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);var a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(i),a}(e,n)}return!1}return!!Le(e,"OES_texture_float")&&!!Le(e,"WEBGL_color_buffer_float")&&Be(e)}function Be(t){var e=Kt(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);var r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);var i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),i}function ze(t){return 2===t&&null!=qt(t).fenceSync}var Ue=Object.freeze({callAndCheck:Jt,canBeRepresented:Zt,getWebGLErrorMessage:Qt,getExtensionOrThrow:te,createVertexShader:ee,createFragmentShader:ne,createProgram:oe,linkProgram:se,validateProgram:ue,createStaticVertexBuffer:ce,createStaticIndexBuffer:le,getNumChannels:function(){return 2===p().getNumber("WEBGL_VERSION")?1:4},createTexture:he,validateTextureSize:pe,createFramebuffer:fe,bindVertexBufferToProgramAttribute:de,bindTextureUnit:me,unbindTextureUnit:function(t,e,n){Me(t,n),Jt(t,e,(function(){return t.activeTexture(t.TEXTURE0+n)})),Jt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))},getProgramUniformLocationOrThrow:ve,getProgramUniformLocation:ge,bindTextureToProgramUniformSampler:ye,bindCanvasToFramebuffer:function(t,e){Jt(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),Jt(t,e,(function(){return t.viewport(0,0,t.canvas.width,t.canvas.height)})),Jt(t,e,(function(){return t.scissor(0,0,t.canvas.width,t.canvas.height)}))},bindColorTextureToFramebuffer:xe,unbindColorTextureFromFramebuffer:be,validateFramebuffer:we,getFramebufferErrorMessage:_e,getBatchDim:Ee,getRowsCols:Te,getShapeAs3D:Ce,getTextureShapeFromLogicalShape:Ae,isReshapeFree:Ie,getWebGLMaxTextureSize:Re,resetMaxTextureSize:function(){re=null},resetMaxTexturesInShader:function(){ie=null},getMaxTexturesInShader:Oe,getWebGLDisjointQueryTimerVersion:ke,hasExtension:Le,isWebGLVersionEnabled:De,isCapableOfRenderingToFloatTexture:Pe,isDownloadFloatTextureEnabled:Fe,isWebGLFenceEnabled:ze}),je=p();function We(t){p().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Ve(){return Ft}function He(t,e){return Ft.tidy(t,e)}function Ge(t){kt(t).forEach((function(t){return t.dispose()}))}function qe(t){return Ft.setBackend(t)}function Xe(t,e,n){return void 0===n&&(n=1),Ft.registerBackend(t,e,n)}function $e(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];p().getBool("IS_TEST")||console.warn.apply(console,t)}function Ye(t,e){var n=t;if(G(t))return"string"===e?[]:[t.length];if(!Array.isArray(t))return[];for(var r=[];Array.isArray(n)||G(n)&&"string"!==e;)r.push(n.length),n=n[0];return Array.isArray(t)&&p().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function t(e,n,r){if(r=r||[],Array.isArray(e)||G(e)){T(n.length>0,(function(){return"Element arr["+r.join("][")+"] should be a primitive, but is an array of "+e.length+" elements"})),T(e.length===n[0],(function(){return"Element arr["+r.join("][")+"] should have "+n[0]+" elements, but has "+e.length+" elements"}));for(var i=n.slice(1),a=0;a<e.length;++a)t(e[a],i,r.concat(a))}else T(0===n.length,(function(){return"Element arr["+r.join("][")+"] is a primitive, but should be an array/TypedArray of "+n[0]+" elements"}))}(t,r,[]),r}function Ke(t,e,n,r){if(null!=t&&("numeric"!==t&&t!==e||"numeric"===t&&"string"===e))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+t+" tensor, but got "+e+" tensor")}function Je(t,e,n,r){if(void 0===r&&(r="numeric"),t instanceof wt)return Ke(r,t.dtype,e,n),t;var i=J(t);if("string"!==i&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),Ke(r,i,e,n),null==t||!G(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t){var a=null==t?"null":t.constructor.name;throw new Error("Argument '"+e+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+a+"'")}var o=Ye(t,i);G(t)||Array.isArray(t)||(t=[t]);var s="string"!==i?et(t,i,p().getBool("DEBUG")):N(t,[],!0);return Ft.makeTensor(s,o,i)}function Ze(t,e,n,r){if(void 0===r&&(r="numeric"),!Array.isArray(t))throw new Error("Argument "+e+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return t.map((function(t,r){return Je(t,e+"["+r+"]",n)}),r)}function Qe(t,e){for(var n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function tn(t,e,n){for(var r=t.length+e.length,i=[],a=0,o=0,s=0;s<r;s++)-1===n.indexOf(s)?i.push(t[a++]):i.push(e[o++]);return i}function en(t,e){for(var n=[],r=t.length,i=0;i<r;i++)-1===e.indexOf(i)&&n.push(t[i]);return[n,e.map((function(e){return t[e]}))]}function nn(t,e){return tn(t,e.map((function(t){return 1})),e)}function rn(t,e,n){T(Qe(e,n),(function(){return t+" supports only inner-most axes for now. Got axes "+e+" and rank-"+n+" input."}))}function an(t,e){if(Qe(t,e))return null;for(var n=[],r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach((function(t){return n.push(t)})),n}function on(t){return t.map((function(t,e){return[e,t]})).sort((function(t,e){return t[1]-e[1]})).map((function(t){return t[0]}))}function sn(t,e){for(var n=[],r=e-t;r<e;++r)n.push(r);return n}function un(t,e){var n=t[0].length;t.forEach((function(t,e){T(t.length===n,(function(){return"Error in concat"+n+"D: rank of tensors["+e+"] must be the same as the rank of the rest ("+n+")"}))})),T(e>=0&&e<n,(function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."}));var r=t[0];t.forEach((function(t,i){for(var a=0;a<n;a++)T(a===e||t[a]===r[a],(function(){return"Error in concat"+n+"D: Shape of tensors["+i+"] ("+t+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."}))}))}function cn(t,e){for(var n=t[0].slice(),r=1;r<t.length;r++)n[e]+=t[r][e];return n}function ln(t){var e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");var n=e[0],r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var i=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Ft.startScope(n);try{var i=r.apply(void 0,t);return i instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),Ft.endScope(i),i}catch(t){throw Ft.endScope(null),t}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}je.registerFlag("HAS_WEBGL",(function(){return je.getNumber("WEBGL_VERSION")>0})),je.registerFlag("WEBGL_VERSION",(function(){return De(2)?2:De(1)?1:0})),je.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===je.get("WEBGL_VERSION")})),je.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),je.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),je.registerFlag("WEBGL_PACK",(function(){return je.getBool("HAS_WEBGL")})),je.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return je.getBool("WEBGL_PACK")})),je.registerFlag("WEBGL_PACK_CLIP",(function(){return je.getBool("WEBGL_PACK")})),je.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),je.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return je.getBool("WEBGL_PACK")})),je.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return je.getBool("WEBGL_PACK")})),je.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return je.getBool("WEBGL_PACK")})),je.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return je.getBool("WEBGL_PACK")})),je.registerFlag("WEBGL_PACK_REDUCE",(function(){return je.getBool("WEBGL_PACK")})),je.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return je.getBool("WEBGL_PACK")})),je.registerFlag("WEBGL_CONV_IM2COL",(function(){return je.getBool("WEBGL_PACK")})),je.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return Re(je.getNumber("WEBGL_VERSION"))})),je.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return Oe(je.getNumber("WEBGL_VERSION"))})),je.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var t=je.getNumber("WEBGL_VERSION");return 0===t?0:ke(t)})),je.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return je.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(t=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))));var t})),je.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return Pe(je.getNumber("WEBGL_VERSION"))})),je.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!je.getBool("WEBGL_FORCE_F16_TEXTURES")&&je.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),je.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return Fe(je.getNumber("WEBGL_VERSION"))})),je.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return ze(je.getNumber("WEBGL_VERSION"))})),je.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return je.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),bt=We;var hn=ln({complex_:function(t,e){var n=Je(t,"real","complex"),r=Je(e,"imag","complex");return C(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),Ft.runKernelFunc((function(t){return t.complex(n,r)}),{$real:n,$imag:r})}}),pn=ln({real_:function(t){var e=Je(t,"input","real");return Ft.runKernelFunc((function(t){return t.real(e)}),{$input:e})}}),fn=ln({imag_:function(t){var e=Je(t,"input","imag");return Ft.runKernelFunc((function(t){return t.imag(e)}),{$input:e})}});function dn(t,e,n){return mn(t,e,Ye(t,n),n)}function mn(t,e,n,r){if(null==r&&(r=J(t)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!G(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){ot(e);var i=I(e),a=I(n);T(i===a,(function(){return"Based on the provided shape, ["+e+"], the tensor should have "+i+" values but has "+a}));for(var o=0;o<n.length;++o){var s=n[o],u=o!==n.length-1||s!==I(e.slice(o));T(n[o]===e[o]||!u,(function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+e+"). "}))}}return G(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==r?et(t,r,p().getBool("DEBUG")):N(t,[],!0),Ft.makeTensor(t,e,r)}function vn(t,e){if((G(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&G(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return mn(t,[],[],e)}function gn(t,e){A(t);var n=Ye(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return mn(t,null,n,e)}function yn(t,e,n){if(A(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");var r=Ye(t,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return mn(t,e,r,n)}function xn(t,e,n){if(A(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");var r=Ye(t,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return mn(t,e,r,n)}function bn(t,e,n){if(A(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");var r=Ye(t,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return mn(t,e,r,n)}function wn(t,e){if(void 0===e&&(e="float32"),"complex64"===e){var n=wn(t,"float32"),r=_n(t,"float32");return hn(n,r)}var i=rt(I(t),e);return Ft.makeTensor(i,t,e)}function _n(t,e){if(void 0===e&&(e="float32"),"complex64"===e){var n=_n(t,"float32"),r=_n(t,"float32");return hn(n,r)}var i=it(I(t),e);return Ft.makeTensor(i,t,e)}function Sn(t,e,n){return Ft.runKernelFunc((function(r){return r.fill(t,e,n)}),{})}function Mn(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");return Ft.runKernelFunc((function(r){return r.linspace(t,e,n)}),{})}function En(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r="float32"),0===n)throw new Error("Cannot have a step of zero");if(t===e||t<e&&n<0||e<t&&n>1)return _n([0],r);var i=it(Math.abs(Math.ceil((e-t)/n)),r);e<t&&1===n&&(n=-1),i[0]=t;for(var a=1;a<i.length;a++)i[a]=i[a-1]+n;return gn(i,r)}var Tn=ln({onesLike_:function(t){var e=Je(t,"x","onesLike");if("complex64"===e.dtype){var n=Tn(pn(e)),r=Cn(fn(e));return hn(n,r)}return Ft.runKernelFunc((function(t){return t.onesLike(e)}),{x:e},(function(t,e){return{x:function(){return Cn(t)}}}),"OnesLike")}}),Cn=ln({zerosLike_:function(t){var e=Je(t,"x","zerosLike");return Ft.runKernelFunc((function(t){return t.zerosLike(e)}),{x:e},(function(t,e){return{x:function(){return Cn(t)}}}),"ZerosLike")}}),An=ln({concat_:function(t,e){void 0===e&&(e=0),T(t.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=Ze(t,"tensors","concat");"complex64"===n[0].dtype&&n.forEach((function(t){if("complex64"!==t.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype "+t.dtype+". ")})),e=B(e,n[0].shape)[0];var r=cn(n.map((function(t){return t.shape})),e);if(0===I(r))return dn([],r);if(1===(n=n.filter((function(t){return t.size>0}))).length)return n[0];var i=n.map((function(t){return t.shape}));un(i,e);var a=n,o={axis:e};return Ft.runKernelFunc((function(t){return t.concat(n,e)}),a,(function(t){var n=i.map((function(t){return t[e]}));return kn(t,n,e).map((function(t){return function(){return t}}))}),"Concat",o)}}),Nn=ln({concat1d_:function(t){return An(t,0)}}),In=ln({concat2d_:function(t,e){return An(t,e)}}),Rn=ln({concat3d_:function(t,e){return An(t,e)}}),On=ln({concat4d_:function(t,e){return An(t,e)}}),kn=ln({split_:function(t,e,n){void 0===n&&(n=0);var r,i=Je(t,"x","split");return n=B(n,i.shape)[0],"number"==typeof e?(T(i.shape[n]%e==0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(e).fill(i.shape[n]/e)):(T(i.shape[n]===e.reduce((function(t,e){return t+e})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=e),Ft.runKernelFunc((function(t){return t.split(i,r,n)}),{$x:i},(function(t){return{$x:function(){return An(t,n)}}}))}});function Ln(t,e,n){return void 0===e&&(e="float32"),e=e||"float32",ot(t),new gt(t,e,n)}var Dn=ln({batchToSpaceND_:function(t,e,n){var r=Je(t,"x","batchToSpaceND"),i=e.reduce((function(t,e){return t*e}));return T(r.rank>=1+e.length,(function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+e.length})),T(n.length===e.length,(function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+e.length})),T(r.shape[0]%i==0,(function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+e.join(" * ")+" === "+i})),Ft.runKernelFunc((function(t){return t.batchToSpaceND(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.spaceToBatchND(e,n)}}}))}}),Pn=ln({cast_:function(t,e){var n=Je(t,"x","cast");if(!V(e))throw new Error("Failed to cast to unknown dtype "+e);if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var r={dtype:e};return Ft.runKernelFunc((function(t){return t.cast(n,e)}),{x:n},(function(t){return{x:function(){return t.clone()}}}),"Cast",r)}}),Fn=ln({cumsum_:function(t,e,n,r){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var i=Je(t,"x","cumsum"),a=an([e|=0],i.rank),o=i;null!=a&&(o=i.transpose(a));var s=sn(1,i.rank)[0],u=Ft.runKernelFunc((function(t){return t.cumsum(o,s,n,r)}),{permutedX:o},(function(t){return{permutedX:function(){return t.cumsum(e,n,!r)}}}));return null!=a&&(u=u.transpose(a)),u}}),Bn=ln({depthToSpace_:function(t,e,n){void 0===n&&(n="NHWC");var r=Je(t,"x","depthToSpace"),i="NHWC"===n?r.shape[1]:r.shape[2],a="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];return T(i*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+i+" and "+e+"  for depthToSpace with input shape\n      "+r.shape})),T(a*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+a+" and "+e+" for depthToSpace with input shape\n          "+r.shape})),T(o%(e*e)==0,(function(){return"Dimension size must be evenly divisible by "+e*e+" but is "+o+" for depthToSpace with input shape "+r.shape})),Ft.runKernelFunc((function(t){return t.depthToSpace(r,e,n)}),{$x:r})}}),zn=ln({expandDims_:function(t,e){void 0===e&&(e=0);var n=Je(t,"x","expandDims",null);T(e<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n.shape.slice();return e<0&&(T(-(n.rank+1)<=e,(function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"})),e=n.rank+e+1),r.splice(e,0,1),Un(n,r)}}),Un=ln({reshape_:function(t,e){var n=Je(t,"x","reshape",null);e=F(e,n.size),T(n.size===I(e),(function(){return"new shape and old shape must have the same number of elements."}));var r={shape:e};return Ft.runKernelFunc((function(t){return t.reshape(n,e)}),{x:n},(function(t){return{x:function(){return t.reshape(n.shape)}}}),"Reshape",r)}}),jn=ln({spaceToBatchND_:function(t,e,n){var r=Je(t,"x","spaceToBatchND");return T(r.rank>=1+e.length,(function(){return"input rank "+r.rank+" should be > than [blockShape] "+e.length})),T(n.length===e.length,(function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+e.length})),T(r.shape.reduce((function(t,r,i){return i>0&&i<=e.length?t&&(r+n[i-1][0]+n[i-1][1])%e[i-1]==0:t}),!0),(function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+e.toString()})),Ft.runKernelFunc((function(t){return t.spaceToBatchND(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.batchToSpaceND(e,n)}}}))}}),Wn=ln({squeeze_:function(t,e){var n=Je(t,"x","squeeze");return Un(n,z(n.shape,e).newShape)}}),Vn=ln({stack_:function(t,e){void 0===e&&(e=0);var n=Ze(t,"tensors","stack");if(T(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),1===n.length)return n[0].expandDims(e);var r=n[0].rank,i=n[0].shape,a=n[0].dtype;T(e<=r,(function(){return"Axis must be <= rank of the tensor"})),n.forEach((function(t){C(i,t.shape,"All tensors passed to stack must have matching shapes")})),n.forEach((function(t){T(a===t.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=n.map((function(t){return t.expandDims(e)}));return An(o,e)}}),Hn=ln({unstack_:function(t,e){void 0===e&&(e=0),e=e||0;var n=Je(t,"x","unstack");T(e>=-n.shape.length&&e<n.shape.length,(function(){return"Axis = "+e+" is not in [-"+n.shape.length+", "+n.shape.length+")"})),e<0&&(e+=n.shape.length);var r={axis:e};return Ft.runKernelFunc((function(t){return t.unstack(n,e)}),{x:n},(function(t){return{x:function(){return Vn(t,e)}}}),"Unpack",r)}}),Gn=function(t,e){return u(this,void 0,void 0,(function(){var n,r,i,a,o,s,u,l,h,p;return c(this,(function(c){switch(c.label){case 0:return n=Je(t,"x","setdiff1d"),r=Je(e,"y","setdiff1d"),T(n.dtype===r.dtype,(function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."})),T(1===n.rank,(function(){return"x should be 1D tensor, but got x ("+n.shape+")."})),T(1===r.rank,(function(){return"y should be 1D tensor, but got y ("+r.shape+")."})),[4,n.data()];case 1:return i=c.sent(),[4,r.data()];case 2:for(a=c.sent(),o=new Set(a),s=0,h=0;h<i.length;h++)o.has(i[h])||s++;for(u=new gt([s],n.dtype),l=new gt([s],"int32"),h=0,p=0;h<i.length;h++)o.has(i[h])||(u.values[p]=i[h],l.values[p]=h,p++);return[2,[u.toTensor(),l.toTensor()]]}}))}))};function qn(t,e,n,r){void 0===r&&(r=!0);var i=[];if(r)(i=i.concat(e.slice(0))).push(t[0]/n),i=i.concat(t.slice(1));else{i=i.concat(t[0]);for(var a=e.length,o=0;o<a;++o)i=i.concat([t[o+1]/e[o],e[o]]);i=i.concat(t.slice(a+1))}return i}function Xn(t,e,n){void 0===n&&(n=!0);var r=[];if(n){r.push(e);for(var i=e+1;i<t;++i)i<=2*e?(r.push(i),r.push(i-(e+1))):r.push(i)}else{var a=[],o=[];for(i=1;i<t;++i)i>=2*e+1||i%2==1?o.push(i):a.push(i);r.push.apply(r,a),r.push(0),r.push.apply(r,o)}return r}function $n(t,e,n,r){void 0===r&&(r=!0);var i=[];r?i.push(t[0]/n):i.push(t[0]*n);for(var a=1;a<t.length;++a)a<=e.length?r?i.push(e[a-1]*t[a]):i.push(t[a]/e[a-1]):i.push(t[a]);return i}function Yn(t,e){for(var n=[0],r=0;r<e;++r)n.push(t[r][0]);return n}function Kn(t,e,n){for(var r=t.slice(0,1),i=0;i<n;++i)r.push(t[i+1]-e[i][0]-e[i][1]);return r}var Jn="Div",Zn="SquaredDifference",Qn="BroadcastTo",tr="Identity",er=ln({add_:function(t,e){var n,r=Je(t,"a","add"),i=Je(e,"b","add");n=Rt(r,i),r=n[0],i=n[1];var a={a:r,b:i};return Ft.runKernelFunc((function(t,e){var n=t.add(r,i);return e([r,i]),n}),a,null,"Add")}});function nr(t,e){for(var n=t.length,r=[],i=0;i<n;i++){var a=n-1-i,o=t[a]||1;(e[e.length-1-i]||1)>1&&1===o&&r.unshift(a)}return r}function rr(t,e){for(var n=[],r=0;r<e.length;r++){var i=t[t.length-r-1],a=e.length-r-1,o=e[a];(null==i||1===i&&o>1)&&n.unshift(a)}return n}function ir(t,e){for(var n=[],r=Math.max(t.length,e.length),i=0;i<r;i++){var a=t[t.length-i-1];null==a&&(a=1);var o=e[e.length-i-1];if(null==o&&(o=1),1===a)n.unshift(o);else if(1===o)n.unshift(a);else{if(a!==o)throw Error("Operands could not be broadcast together with shapes "+t+" and "+e+".");n.unshift(a)}}return n}var ar=ln({abs_:function(t){var e=Je(t,"x","abs");return"complex64"===e.dtype?Ft.runKernelFunc((function(t){return t.complexAbs(e)}),{$x:e}):Ft.runKernelFunc((function(t,n){var r=t.abs(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.mul(n.toFloat().step(-1))}}}),"Abs")}}),or=ln({acos_:function(t){var e=Je(t,"x","acos");return Ft.runKernelFunc((function(t,n){var r=t.acos(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(vn(1).sub(n.toFloat().square()).sqrt()).neg()}}}))}}),sr=ln({acosh_:function(t){var e=Je(t,"x","acosh");return Ft.runKernelFunc((function(t,n){var r=t.acosh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(n.toFloat().square().sub(1).sqrt())}}}))}}),ur=ln({asin_:function(t){var e=Je(t,"x","asin");return Ft.runKernelFunc((function(t,n){var r=t.asin(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(vn(1).sub(n.toFloat().square()).sqrt())}}}))}}),cr=ln({asinh_:function(t){var e=Je(t,"x","asinh");return Ft.runKernelFunc((function(t,n){var r=t.asinh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(vn(1).add(n.toFloat().square()).sqrt())}}}))}}),lr=ln({atan_:function(t){var e=Je(t,"x","atan");return Ft.runKernelFunc((function(t,n){var r=t.atan(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat().square().add(1))}}}))}}),hr=ln({atanh_:function(t){var e=Je(t,"x","atanh");return Ft.runKernelFunc((function(t,n){var r=t.atanh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(vn(1).sub(n.toFloat().square()))}}}))}}),pr=ln({ceil_:function(t){var e=Je(t,"x","ceil");return Ft.runKernelFunc((function(t){return t.ceil(e)}),{$x:e},(function(t){return{$x:function(){return Cn(t)}}}))}}),fr=ln({clipByValue_:function(t,e,n){var r=Je(t,"x","clipByValue");T(e<=n,(function(){return"Error in clip: min ("+e+") must be less than or equal to max ("+n+")."}));var i=[r],a={min:e,max:n};return Ft.runKernelFunc((function(t,i){var a=t.clip(r,e,n);return i([r]),a}),{x:r},(function(t,r){var i=r[0];return{x:function(){return t.where(i.greaterEqual(e).logicalAnd(i.lessEqual(n)),Cn(t))}}}),"ClipByValue",a,i)}}),dr=ln({cos_:function(t){var e=Je(t,"x","cos"),n=[e];return Ft.runKernelFunc((function(t,n){var r=t.cos(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return n.toFloat().sin().neg().mul(t)}}}),"Cos",{},n)}}),mr=ln({cosh_:function(t){var e=Je(t,"x","cosh");return Ft.runKernelFunc((function(t,n){var r=t.cosh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().sinh().mulStrict(t)}}}))}}),vr=ln({erf_:function(t){var e=Je(t,"x","erf");return T("int32"===e.dtype||"float32"===e.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===e.dtype&&(e=e.toFloat()),Ft.runKernelFunc((function(t,n){var r=t.erf(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),gr=ln({exp_:function(t){var e=Je(t,"x","exp");return Ft.runKernelFunc((function(t,n){var r=t.exp(e);return n([r]),r}),{x:e},(function(t,e){return{x:function(){return t.mulStrict(e[0])}}}),"Exp",{},[],[!0])}}),yr=ln({expm1_:function(t){var e=Je(t,"x","expm1");return Ft.runKernelFunc((function(t,n){var r=t.expm1(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.exp())}}}))}}),xr=ln({floor_:function(t){var e=Je(t,"x","floor");return Ft.runKernelFunc((function(t){return t.floor(e)}),{$x:e},(function(t){return{$x:function(){return Cn(t)}}}))}}),br=ln({log_:function(t){var e=Je(t,"x","log"),n=[e];return Ft.runKernelFunc((function(t,n){var r=t.log(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.div(n.toFloat())}}}),"Log",{},n)}}),wr=ln({log1p_:function(t){var e=Je(t,"x","log1p");return Ft.runKernelFunc((function(t,n){var r=t.log1p(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.add(1))}}}))}}),_r=ln({logSigmoid_:function(t){var e=Je(t,"x","logSigmoid");return Ft.runKernelFunc((function(t,n){var r=t.softplus(e.neg()).neg();return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.neg().sigmoid())}}}))}}),Sr=ln({neg_:function(t){var e=Je(t,"x","neg"),n=[e];return Ft.runKernelFunc((function(t){return t.neg(e)}),{x:e},(function(t){return{x:function(){return t.neg()}}}),"Neg",{},n)}}),Mr=ln({reciprocal_:function(t){var e=Je(t,"x","reciprocal");return Ft.runKernelFunc((function(t,n){var r=t.reciprocal(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.square().neg())}}}))}}),Er=ln({round_:function(t){var e=Je(t,"x","round");return Ft.runKernelFunc((function(t){return t.round(e)}),{$x:e},(function(t){return{$x:function(){return Cn(t)}}}))}}),Tr=ln({rsqrt_:function(t){var e=Je(t,"x","rsqrt"),n=[e];return Ft.runKernelFunc((function(t,n){var r=t.rsqrt(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.div(n.pow(1.5).mul(2)).neg()}}}),"Rsqrt",{},n)}}),Cr=ln({sigmoid_:function(t){var e=Je(t,"x","sigmoid");return Ft.runKernelFunc((function(t,n){var r=t.sigmoid(e);return n([r]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.mul(n.mul(vn(1).sub(n)))}}}),"Sigmoid")}}),Ar=ln({sign_:function(t){var e=Je(t,"x","sign");return Ft.runKernelFunc((function(t){return t.sign(e)}),{$x:e},(function(t){return{$x:function(){return Cn(t)}}}))}}),Nr=ln({isNaN_:function(t){var e=Je(t,"x","isNaN");return Ft.runKernelFunc((function(t){return t.isNaN(e)}),{$x:e},(function(t){return{$x:function(){return Cn(t)}}}))}}),Ir=ln({isInf_:function(t){var e=Je(t,"x","isInf");return Ft.runKernelFunc((function(t){return t.isInf(e)}),{$x:e},(function(t){return{$x:function(){return Cn(t)}}}))}}),Rr=ln({isFinite_:function(t){var e=Je(t,"x","isFinite");return Ft.runKernelFunc((function(t){return t.isFinite(e)}),{$x:e},(function(t){return{$x:function(){return Cn(t)}}}))}}),Or=ln({sin_:function(t){var e=Je(t,"x","sin"),n=[e];return Ft.runKernelFunc((function(t,n){var r=t.sin(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return n.toFloat().cos().mul(t)}}}),"Sin",{},n)}}),kr=ln({sinh_:function(t){var e=Je(t,"x","sinh");return Ft.runKernelFunc((function(t,n){var r=t.sinh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().cosh().mulStrict(t)}}}))}}),Lr=ln({softplus_:function(t){var e=Je(t,"x","softplus");return Ft.runKernelFunc((function(t,n){var r=t.softplus(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.sigmoid())}}}))}}),Dr=ln({sqrt_:function(t){var e=Je(t,"x","sqrt");return Ft.runKernelFunc((function(t,n){var r=t.sqrt(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat().sqrt().mul(2))}}}))}}),Pr=ln({step_:function(t,e){void 0===e&&(e=0);var n=Je(t,"x","step");return Ft.runKernelFunc((function(t){return t.step(n,e)}),{$x:n},(function(t){return{$x:function(){return Cn(t)}}}))}}),Fr=ln({tan_:function(t){var e=Je(t,"x","tan");return Ft.runKernelFunc((function(t,n){var r=t.tan(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.cos().square())}}}))}}),Br=ln({tanh_:function(t){var e=Je(t,"x","tanh");return Ft.runKernelFunc((function(t,n){var r=t.tanh(e);return n([r]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return vn(1).sub(n.square()).mulStrict(t)}}}),"Tanh",{},null,[!0])}}),zr=ln({addStrict_:function(t,e){var n=Je(t,"a","addStrict"),r=Je(e,"b","addStrict");return C(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),Ur=ln({atan2_:function(t,e){var n,r=Je(t,"a","atan2"),i=Je(e,"b","atan2");n=Rt(r,i),r=n[0],i=n[1];var a=ir(r.shape,i.shape);return Ft.runKernelFunc((function(t,e){var n=t.atan2(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=er(n.square(),r.square()),i=t.mul(r.div(e)),o=rr(n.shape,a);return o.length>0&&(i=i.sum(o)),i.reshape(n.shape)},$b:function(){var e=er(n.square(),r.square()),i=Sr(t.mul(n.div(e))),o=rr(r.shape,a);return o.length>0&&(i=i.sum(o)),i.reshape(r.shape)}}}))}}),jr=ln({divStrict_:function(t,e){var n=Je(t,"a","div"),r=Je(e,"b","div");return C(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),Wr=ln({floorDiv_:function(t,e){var n,r=Je(t,"a","floorDiv"),i=Je(e,"b","floorDiv");n=Rt(r,i),r=n[0],i=n[1];var a=ir(r.shape,i.shape);return Ft.runKernelFunc((function(t,e){var n=t.floorDiv(r,i);return e([r,i]),n}),{a:r,b:i},(function(t,e){var n=e[0],r=e[1];return{a:function(){var e=t.div(r.toFloat()),i=rr(n.shape,a);return i.length>0?e.sum(i).reshape(n.shape):e},b:function(){var e=t.mul(n.toFloat()),i=rr(r.shape,a);i.length>0&&(e=e.sum(i).reshape(r.shape));var o=r.square();return e.div(o.toFloat()).neg()}}}),"FloorDiv")}}),Vr=ln({maximum_:function(t,e){var n,r=Je(t,"a","maximum"),i=Je(e,"b","maximum");return n=Rt(r,i),r=n[0],i=n[1],"bool"===r.dtype&&(r=r.toInt(),i=i.toInt()),ir(r.shape,i.shape),Ft.runKernelFunc((function(t,e){var n=t.maximum(r,i);return e([r,i]),n}),{a:r,b:i},(function(t,e){var n=e[0],r=e[1];return{a:function(){return t.mul(n.greaterEqual(r).toFloat())},b:function(){return t.mul(n.less(r).toFloat())}}}),"Maximum")}}),Hr=ln({maximumStrict_:function(t,e){var n=Je(t,"a","maximumStrict"),r=Je(e,"b","maximumStrict");return C(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),Gr=ln({minimum_:function(t,e){var n,r=Je(t,"a","minimum"),i=Je(e,"b","minimum");return n=Rt(r,i),r=n[0],i=n[1],"bool"===r.dtype&&(r=r.toInt(),i=i.toInt()),ir(r.shape,i.shape),Ft.runKernelFunc((function(t,e){var n=t.minimum(r,i);return e([r,i]),n}),{a:r,b:i},(function(t,e){var n=e[0],r=e[1];return{a:function(){return t.mul(n.lessEqual(r).toFloat())},b:function(){return t.mul(n.greater(r).toFloat())}}}),"Minimum")}}),qr=ln({minimumStrict_:function(t,e){var n=Je(t,"a","minimumStrict"),r=Je(e,"b","minimumStrict");return C(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),Xr=ln({mod_:function(t,e){var n,r=Je(t,"a","mod"),i=Je(e,"b","mod");n=Rt(r,i),r=n[0],i=n[1];var a=ir(r.shape,i.shape);return Ft.runKernelFunc((function(t,e){var n=t.mod(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=rr(n.shape,a);return e.length>0?t.sum(e).reshape(n.shape):t},$b:function(){var e=t.mul(n.div(r).floor().neg()),i=rr(r.shape,a);return i.length>0?e.sum(i).reshape(r.shape):e}}}))}}),$r=ln({modStrict_:function(t,e){var n=Je(t,"a","modStrict"),r=Je(e,"b","modStrict");return C(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),Yr=ln({mul_:function(t,e){var n,r=Je(t,"a","mul"),i=Je(e,"b","mul");n=Rt(r,i),r=n[0],i=n[1];var a=ir(r.shape,i.shape);return Ft.runKernelFunc((function(t,e){var n=t.multiply(r,i);return e([r,i]),n}),{a:r,b:i},(function(t,e){var n=e[0],r=e[1];return{a:function(){var e=t.mul(r.toFloat()),i=rr(n.shape,a);return i.length>0?e.sum(i).reshape(n.shape):e},b:function(){var e=t.mul(n.toFloat()),i=rr(r.shape,a);return i.length>0?e.sum(i).reshape(r.shape):e}}}),"Mul")}}),Kr=ln({mulStrict_:function(t,e){var n=Je(t,"a","mul"),r=Je(e,"b","mul");return C(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),Jr=ln({pow_:function(t,e){var n,r=Je(t,"base","pow"),i=Je(e,"exp","pow");n=Rt(r,i),r=n[0],i=n[1];var a=ir(r.shape,i.shape),o=[r,i];return Ft.runKernelFunc((function(t,e){var n=t.pow(r,i);return e([r,i,n]),n}),{a:r,b:i},(function(t,e){var n=e[0],r=e[1],i=e[2];return{a:function(){var e=r.toFloat(),i=t.mul(e.mul(n.pow(e.sub(vn(1))))),o=rr(n.shape,a);return o.length>0&&(i=i.sum(o)),i.reshape(n.shape)},b:function(){var e=n.greater(0),o=n.log().where(e,Cn(n)),s=t.mul(i.mul(o)),u=rr(r.shape,a);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)}}}),"Pow",{},o,[!0])}}),Zr=ln({powStrict_:function(t,e){return C(t.shape,e.shape,"Error in powStrict: "),t.pow(e)}}),Qr=ln({squaredDifferenceStrict_:function(t,e){var n=Je(t,"a","squaredDifferenceStrict"),r=Je(e,"b","squaredDifferenceStrict");return C(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),ti=ln({sub_:function(t,e){var n,r=Je(t,"a","sub"),i=Je(e,"b","sub");n=Rt(r,i),r=n[0],i=n[1];var a=ir(r.shape,i.shape);return Ft.runKernelFunc((function(t){return t.subtract(r,i)}),{a:r,b:i},(function(t){return{a:function(){var e=t,n=rr(r.shape,a);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},b:function(){var e=t,n=rr(i.shape,a);return n.length>0&&(e=e.sum(n)),e.neg().reshape(i.shape)}}}),"Sub")}}),ei=ln({subStrict_:function(t,e){var n=Je(t,"a","subStrict"),r=Je(e,"b","subStrict");return C(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),ni=ln({div_:function(t,e){var n,r=Je(t,"a","div"),i=Je(e,"b","div");if(n=Rt(r,i),r=n[0],i=n[1],"int32"===r.dtype&&"int32"===i.dtype)return Wr(r,i);var a={a:r,b:i};return Ft.runKernelFunc((function(t,e){var n=t.realDivide(r,i);return e([r,i]),n}),a,null,Jn,{})}});function ri(t,e){if(t.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if("int32"!==e.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.shape[e.rank-1]>t.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+e.shape[e.rank-1]+" vs. "+t.rank);if(0===t.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+t.shape+".");for(var n=e.shape,r=n[n.length-1],i=1,a=0;a<n.length-1;++a)i*=n[a];var o=t.shape,s=n.slice();s.pop();var u=1;for(a=r;a<t.rank;++a)u*=o[a],s.push(o[a]);var c=tt(t.shape).map((function(t){return t/u})).concat([1]).slice(0,r);return[s,i,u,c]}var ii=Object.freeze({prepareAndValidate:ri});function ai(t){return t<=30?t:Q(t,Math.floor(Math.sqrt(t)))}function oi(t,e,n){var r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,a="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+e.shape+", shape: "+t+", sliceDim: "+r+", and batchDim: "+i+".";if(n.rank<i)throw new Error(a+" update.rank < "+i+". ");if(t.length<r+(n.rank-i))throw new Error(a+" Output shape length < "+(r+(n.rank-i)));if(n.rank!==i+t.length-r)throw new Error(a+" update.rank != "+(i+t.length-r));for(var o=0;o<i;++o)if(n.shape[o]!==e.shape[o])throw new Error(a+" updates.shape["+o+"] ("+n.shape[o]+") != indices.shape["+o+"] ("+e.shape[o]+").");for(o=0;o<n.rank-i;++o)if(n.shape[o+i]!==t[o+r])throw new Error(a+" updates.shape["+(o+i)+"] ("+n.shape[o+i]+") != shape["+(o+i)+"] ("+t[o+i]+")")}function si(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+t.rank+".");if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(0===t.size)throw new Error("Updates specified for empty output. updates shape: "+t.shape)}oi(n,e,t)}function ui(t,e,n){for(var r=e.shape.length,i=r>1?e.shape[r-1]:1,a=n.length,o=1,s=i;s<a;++s)o*=n[s];var u=i<1?1:i;return{sliceRank:i,numUpdates:I(e.shape)/u,sliceSize:o,strides:tt(n.slice(0,i)).concat([1]),outputSize:I(n)}}var ci=Object.freeze({validateUpdateShape:oi,validateInput:si,calculateShapes:ui});function li(t,e,n){T(t.rank===e.length,(function(){return"Error in slice"+t.rank+"D: Length of begin "+e+" must match the rank of the array ("+t.rank+")."})),T(t.rank===n.length,(function(){return"Error in slice"+t.rank+"D: Length of size "+n+" must match the rank of the array ("+t.rank+")."}));for(var r=function(r){T(e[r]+n[r]<=t.shape[r],(function(){return"Error in slice"+t.rank+"D: begin["+r+"] + size["+r+"] ("+(e[r]+n[r])+") would overflow input.shape["+r+"] ("+t.shape[r]+")"}))},i=0;i<t.rank;++i)r(i)}function hi(t){for(var e=[],n=0;t>0;)1&t&&e.push(n),t/=2,n++;return e}function pi(t,e,n){for(var r=[],i=0;i<t.length;i++)r[i]=Math.ceil((e[i]-t[i])/n[i]);return r}function fi(t,e,n,r,i){var a=e[i],o=n[i]||1;(t&1<<i||null==a)&&(a=o>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[i];return a<0&&(a+=s),S(0,a,s-1)}function di(t,e,n,r,i){var a=e[i],o=n[i]||1;(t&1<<i||null==a)&&(a=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[i];return a<0&&(a+=s),o>0?S(0,a,s):S(-1,a,s-1)}function mi(t,e,n){for(var r=n.length,i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(i=r+1;i<n.length;i++)if(e[i]>0||n[i]!==t[i])return!1;return!0}function vi(t,e){for(var n=t.length>0?t[t.length-1]:1,r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}var gi=Object.freeze({assertParamsValid:li,maskToAxes:hi,computeOutShape:pi,startForAxis:fi,stopForAxis:di,isSliceContinous:mi,computeFlatOffset:vi});function yi(t){return Ft.customGrad(t)}var xi=ln({softmax_:function(t,e){void 0===e&&(e=-1);var n=Je(t,"logits","softmax","float32");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+e);return Ft.runKernelFunc((function(t,r){var i=t.softmax(n,e);return r([i]),i}),{logits:n},(function(t,n){var r=n[0],i=t.mul(r);return{logits:function(){return i.sub(i.sum([e],!0).mul(r))}}}),"Softmax",{dim:e},[],[!0])}}),bi=ln({logSoftmax_:function(t,e){void 0===e&&(e=-1);var n=Je(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+e);return yi((function(t,n){var r=t.max(e,!0),i=t.sub(r),a=i.toFloat().sub(i.exp().sum(e,!0).log());return n([a]),{value:a,gradFunc:function(t,n){var r=n[0].exp();return t.sub(t.sum(e,!0).mul(r))}}}))(n)}}),wi=ln({transpose_:function(t,e){var n=Je(t,"x","transpose");if(null==e&&(e=n.shape.map((function(t,e){return e})).reverse()),T(n.rank===e.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+e+"."})),e.forEach((function(t){T(t>=0&&t<n.rank,(function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+e}))})),n.rank<=1)return n.clone();var r={perm:e};return Ft.runKernelFunc((function(t){return t.transpose(n,e)}),{x:n},null,"Transpose",r)}}),_i=function(){function t(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}return t.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},t.prototype.set=function(t,e){this.dataIdsCount++,this.data.set(t,e)},t.prototype.has=function(t){return this.data.has(t)},t.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},t.prototype.numDataIds=function(){return this.dataIdsCount},t}(),Si=function(){function t(){}return t.prototype.time=function(t){return Mi("time")},t.prototype.read=function(t){return Mi("read")},t.prototype.readSync=function(t){return Mi("readSync")},t.prototype.numDataIds=function(){return Mi("numDataIds")},t.prototype.disposeData=function(t){return Mi("disposeData")},t.prototype.write=function(t,e,n){return Mi("write")},t.prototype.move=function(t,e,n,r){return Mi("move")},t.prototype.memory=function(){return Mi("memory")},t.prototype.floatPrecision=function(){return Mi("floatPrecision")},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.batchMatMul=function(t,e,n,r){return Mi("batchMatMul")},t.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,Mi("fusedBatchMatMul")},t.prototype.slice=function(t,e,n){return Mi("slice")},t.prototype.stridedSlice=function(t,e,n,r){return Mi("stridedSlice")},t.prototype.unstack=function(t,e){return Mi("unstack")},t.prototype.reverse=function(t,e){return Mi("reverse")},t.prototype.concat=function(t,e){return Mi("concat")},t.prototype.neg=function(t){return Mi("neg")},t.prototype.add=function(t,e){return Mi("add")},t.prototype.addN=function(t){return Mi("addN")},t.prototype.subtract=function(t,e){return Mi("subtract")},t.prototype.multiply=function(t,e){return Mi("multiply")},t.prototype.realDivide=function(t,e){return Mi("realDivide")},t.prototype.floorDiv=function(t,e){return Mi("floorDiv")},t.prototype.sum=function(t,e){return Mi("sum")},t.prototype.prod=function(t,e){return Mi("prod")},t.prototype.unsortedSegmentSum=function(t,e,n){return Mi("unsortedSegmentSum")},t.prototype.argMin=function(t,e){return Mi("argMin")},t.prototype.argMax=function(t,e){return Mi("argMax")},t.prototype.equal=function(t,e){return Mi("equal")},t.prototype.notEqual=function(t,e){return Mi("notEqual")},t.prototype.less=function(t,e){return Mi("less")},t.prototype.lessEqual=function(t,e){return Mi("lessEqual")},t.prototype.greater=function(t,e){return Mi("greater")},t.prototype.greaterEqual=function(t,e){return Mi("greaterEqual")},t.prototype.logicalNot=function(t){return Mi("logicalNot")},t.prototype.logicalAnd=function(t,e){return Mi("logicalAnd")},t.prototype.logicalOr=function(t,e){return Mi("logicalOr")},t.prototype.where=function(t){return Mi("where")},t.prototype.select=function(t,e,n){return Mi("select")},t.prototype.topk=function(t,e,n){return Mi("topk")},t.prototype.min=function(t,e){return Mi("min")},t.prototype.minimum=function(t,e){return Mi("minimum")},t.prototype.mod=function(t,e){return Mi("mod")},t.prototype.max=function(t,e){return Mi("max")},t.prototype.maximum=function(t,e){return Mi("maximum")},t.prototype.all=function(t,e){return Mi("all")},t.prototype.any=function(t,e){return Mi("any")},t.prototype.squaredDifference=function(t,e){return Mi("squaredDifference")},t.prototype.ceil=function(t){return Mi("ceil")},t.prototype.floor=function(t){return Mi("floor")},t.prototype.round=function(t){return Mi("round")},t.prototype.sign=function(t){return Mi("sign")},t.prototype.isNaN=function(t){return Mi("isNaN")},t.prototype.isInf=function(t){return Mi("isInf")},t.prototype.isFinite=function(t){return Mi("isFinite")},t.prototype.pow=function(t,e){return Mi("pow")},t.prototype.exp=function(t){return Mi("exp")},t.prototype.expm1=function(t){return Mi("expm1")},t.prototype.softmax=function(t,e){return Mi("softmax")},t.prototype.log=function(t){return Mi("log")},t.prototype.log1p=function(t){return Mi("log1p")},t.prototype.sqrt=function(t){return Mi("sqrt")},t.prototype.rsqrt=function(t){return Mi("rsqrt")},t.prototype.square=function(t){return Mi("square")},t.prototype.reciprocal=function(t){return Mi("reciprocal")},t.prototype.relu=function(t){return Mi("relu")},t.prototype.relu6=function(t){return Mi("relu6")},t.prototype.prelu=function(t,e){return Mi("prelu")},t.prototype.elu=function(t){return Mi("elu")},t.prototype.eluDer=function(t,e){return Mi("eluDer")},t.prototype.selu=function(t){return Mi("selu")},t.prototype.int=function(t){return Mi("int")},t.prototype.clip=function(t,e,n){return Mi("clip")},t.prototype.abs=function(t){return Mi("abs")},t.prototype.complexAbs=function(t){return Mi("complexAbs")},t.prototype.sigmoid=function(t){return Mi("sigmoid")},t.prototype.softplus=function(t){return Mi("softplus")},t.prototype.sin=function(t){return Mi("sin")},t.prototype.cos=function(t){return Mi("cos")},t.prototype.tan=function(t){return Mi("tan")},t.prototype.asin=function(t){return Mi("asin")},t.prototype.acos=function(t){return Mi("acos")},t.prototype.atan=function(t){return Mi("atan")},t.prototype.atan2=function(t,e){return Mi("atan2")},t.prototype.sinh=function(t){return Mi("sinh")},t.prototype.cosh=function(t){return Mi("cosh")},t.prototype.tanh=function(t){return Mi("tanh")},t.prototype.asinh=function(t){return Mi("asinh")},t.prototype.acosh=function(t){return Mi("acosh")},t.prototype.atanh=function(t){return Mi("atanh")},t.prototype.erf=function(t){return Mi("erf")},t.prototype.step=function(t,e){return Mi("step")},t.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,Mi("fusedConv2d")},t.prototype.conv2d=function(t,e,n){return Mi("conv2d")},t.prototype.conv2dDerInput=function(t,e,n){return Mi("conv2dDerInput")},t.prototype.conv2dDerFilter=function(t,e,n){return Mi("conv2dDerFilter")},t.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,Mi("fusedDepthwiseConv2D")},t.prototype.depthwiseConv2D=function(t,e,n){return Mi("depthwiseConv2D")},t.prototype.depthwiseConv2DDerInput=function(t,e,n){return Mi("depthwiseConv2DDerInput")},t.prototype.depthwiseConv2DDerFilter=function(t,e,n){return Mi("depthwiseConv2DDerFilter")},t.prototype.conv3d=function(t,e,n){return Mi("conv3d")},t.prototype.conv3dDerInput=function(t,e,n){return Mi("conv3dDerInput")},t.prototype.conv3dDerFilter=function(t,e,n){return Mi("conv3dDerFilter")},t.prototype.maxPool=function(t,e){return Mi("maxPool")},t.prototype.maxPoolBackprop=function(t,e,n,r){return Mi("maxPoolBackprop")},t.prototype.avgPool=function(t,e){return Mi("avgPool")},t.prototype.avgPoolBackprop=function(t,e,n){return Mi("avgPoolBackprop")},t.prototype.avgPool3d=function(t,e){return Mi("avgPool3d")},t.prototype.avgPool3dBackprop=function(t,e,n){return Mi("avgPool3dBackprop")},t.prototype.maxPool3d=function(t,e){return Mi("maxPool3d")},t.prototype.maxPool3dBackprop=function(t,e,n,r){return Mi("maxPool3dBackprop")},t.prototype.reshape=function(t,e){return Mi("reshape")},t.prototype.cast=function(t,e){return Mi("cast")},t.prototype.tile=function(t,e){return Mi("tile")},t.prototype.pad=function(t,e,n){return Mi("pad")},t.prototype.transpose=function(t,e){return Mi("transpose")},t.prototype.gather=function(t,e,n){return Mi("gather")},t.prototype.gatherND=function(t,e){return Mi("gatherND")},t.prototype.scatterND=function(t,e,n){return Mi("scatterND")},t.prototype.batchToSpaceND=function(t,e,n){return Mi("batchToSpaceND")},t.prototype.spaceToBatchND=function(t,e,n){return Mi("spaceToBatchND")},t.prototype.resizeBilinear=function(t,e,n,r){return Mi("resizeBilinear")},t.prototype.resizeBilinearBackprop=function(t,e,n){return Mi("resizeBilinearBackprop")},t.prototype.resizeNearestNeighbor=function(t,e,n,r){return Mi("resizeNearestNeighbor")},t.prototype.resizeNearestNeighborBackprop=function(t,e,n){return Mi("resizeNearestNeighborBackprop")},t.prototype.batchNormalization=function(t,e,n,r,i,a){return Mi("batchNormalization")},t.prototype.localResponseNormalization4D=function(t,e,n,r,i){return Mi("localResponseNormalization4D")},t.prototype.LRNGrad=function(t,e,n,r,i,a,o){return Mi("LRNGrad")},t.prototype.multinomial=function(t,e,n,r){return Mi("multinomial")},t.prototype.oneHot=function(t,e,n,r){return Mi("oneHot")},t.prototype.cumsum=function(t,e,n,r){return Mi("cumsum")},t.prototype.nonMaxSuppression=function(t,e,n,r,i){return Mi("nonMaxSuppression")},t.prototype.fft=function(t){return Mi("fft")},t.prototype.ifft=function(t){return Mi("ifft")},t.prototype.complex=function(t,e){return Mi("complex")},t.prototype.real=function(t){return Mi("real")},t.prototype.imag=function(t){return Mi("imag")},t.prototype.cropAndResize=function(t,e,n,r,i,a){return Mi("cropAndResize")},t.prototype.depthToSpace=function(t,e,n){return Mi("depthToSpace")},t.prototype.split=function(t,e,n){return Mi("split")},t.prototype.sparseToDense=function(t,e,n,r){return Mi("sparseToDense")},t.prototype.diag=function(t){return Mi("diag")},t.prototype.fill=function(t,e,n){return Mi("fill")},t.prototype.onesLike=function(t){return Mi("onesLike")},t.prototype.zerosLike=function(t){return Mi("zerosLike")},t.prototype.linspace=function(t,e,n){return Mi("linspace")},t.prototype.dispose=function(){return Mi("dispose")},t}();function Mi(t){throw new Error("'"+t+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function Ei(t,e,n,r,i,a,o){void 0===o&&(o="channelsLast");var s,u=Ii(e),c=u[0],l=u[1];if("channelsLast"===o)s=[c,l,t[3],t[3]];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);s=[c,l,t[1],t[1]]}return Ci(t,s,n,r,i,a,!1,o)}function Ti(t,e,n,r,i,a,o){void 0===o&&(o="NDHWC");var s,u,c=Ri(e),l=c[0],h=c[1],p=c[2];if("NDHWC"===o)u="channelsLast",s=[l,h,p,t[4],t[4]];else{if("NCDHW"!==o)throw new Error("Unknown dataFormat "+o);u="channelsFirst",s=[l,h,p,t[1],t[1]]}return Ai(t,s,n,r,i,!1,u,a)}function Ci(t,e,n,r,i,a,o,s){void 0===o&&(o=!1),void 0===s&&(s="channelsLast");var u=[-1,-1,-1,-1],c=u[0],l=u[1],h=u[2],p=u[3];if("channelsLast"===s)c=t[0],l=t[1],h=t[2],p=t[3];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);c=t[0],p=t[1],l=t[2],h=t[3]}var f,d=e[0],m=e[1],v=e[3],g=Ii(n),y=g[0],x=g[1],b=Ii(r),w=b[0],_=b[1],S=Oi(d,w),M=Oi(m,_),E=function(t,e,n,r,i,a,o,s){var u,c,l;if("number"==typeof t){u={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};var h=function(t,e,n,r,i){null==r&&(r=Ni(t,e,n));var a=t[1],o=ki((t[0]-e+2*r)/n+1,i);T(O(o),(function(){return"The output # of rows ("+o+") must be an integer. Change the stride and/or zero pad parameters"}));var s=ki((a-e+2*r)/n+1,i);return T(O(s),(function(){return"The output # of columns ("+s+") must be an integer. Change the stride and/or zero pad parameters"})),[o,s]}([e,n],a,r,t,s);c=h[0],l=h[1]}else if("same"===t){c=Math.ceil(e/r),l=Math.ceil(n/i);var p=Math.max(0,(c-1)*r+a-e),f=Math.max(0,(l-1)*i+o-n),d=Math.floor(p/2),m=p-d,v=Math.floor(f/2);u={top:d,bottom:m,left:v,right:f-v,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-a+1)/r),l=Math.ceil((n-o+1)/i)}return{padInfo:u,outHeight:c,outWidth:l}}(i,l,h,y,x,S,M,a),C=E.padInfo,A=E.outHeight,N=E.outWidth,I=o?v*p:v;return"channelsFirst"===s?f=[c,I,A,N]:"channelsLast"===s&&(f=[c,A,N,I]),{batchSize:c,dataFormat:s,inHeight:l,inWidth:h,inChannels:p,outHeight:A,outWidth:N,outChannels:I,padInfo:C,strideHeight:y,strideWidth:x,filterHeight:d,filterWidth:m,effectiveFilterHeight:S,effectiveFilterWidth:M,dilationHeight:w,dilationWidth:_,inShape:t,outShape:f,filterShape:e}}function Ai(t,e,n,r,i,a,o,s){void 0===a&&(a=!1),void 0===o&&(o="channelsLast");var u=[-1,-1,-1,-1,-1],c=u[0],l=u[1],h=u[2],p=u[3],f=u[4];if("channelsLast"===o)c=t[0],l=t[1],h=t[2],p=t[3],f=t[4];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);c=t[0],f=t[1],l=t[2],h=t[3],p=t[4]}var d,m=e[0],v=e[1],g=e[2],y=e[4],x=Ri(n),b=x[0],w=x[1],_=x[2],S=Ri(r),M=S[0],E=S[1],C=S[2],A=Oi(m,M),N=Oi(v,E),I=Oi(g,C),R=function(t,e,n,r,i,a,o,s,u,c,l){var h,p,f,d;if("number"==typeof t){h={top:t,bottom:t,left:t,right:t,front:t,back:t,type:0===t?"VALID":"NUMBER"};var m=function(t,e,n,r,i,a){null==i&&(i=Ni(t,e,r));var o=t[1],s=t[2],u=ki((t[0]-e+2*i)/r+1,a);T(O(u),(function(){return"The output # of depths ("+u+") must be an integer. Change the stride and/or zero pad parameters"}));var c=ki((o-e+2*i)/r+1,a);T(O(c),(function(){return"The output # of rows ("+c+") must be an integer. Change the stride and/or zero pad parameters"}));var l=ki((s-e+2*i)/r+1,a);return T(O(l),(function(){return"The output # of columns ("+l+") must be an integer. Change the stride and/or zero pad parameters"})),[u,c,l,1]}([e,n,r,1],s,0,i,t,l);p=m[0],f=m[1],d=m[2]}else if("same"===t){var v=((p=Math.ceil(e/i))-1)*i+s-e,g=((f=Math.ceil(n/a))-1)*a+u-n,y=((d=Math.ceil(r/o))-1)*o+c-r,x=Math.floor(v/2),b=v-x,w=Math.floor(g/2),_=g-w,S=Math.floor(y/2);h={top:w,bottom:_,left:S,right:y-S,front:x,back:b,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);h={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},p=Math.ceil((e-s+1)/i),f=Math.ceil((n-u+1)/a),d=Math.ceil((r-c+1)/o)}return{padInfo:h,outDepth:p,outHeight:f,outWidth:d}}(i,l,h,p,b,w,_,A,N,I,s),k=R.padInfo,L=R.outDepth,D=R.outHeight,P=R.outWidth,F=a?y*f:y;return"channelsFirst"===o?d=[c,F,L,D,P]:"channelsLast"===o&&(d=[c,L,D,P,F]),{batchSize:c,dataFormat:o,inDepth:l,inHeight:h,inWidth:p,inChannels:f,outDepth:L,outHeight:D,outWidth:P,outChannels:F,padInfo:k,strideDepth:b,strideHeight:w,strideWidth:_,filterDepth:m,filterHeight:v,filterWidth:g,effectiveFilterDepth:A,effectiveFilterHeight:N,effectiveFilterWidth:I,dilationDepth:M,dilationHeight:E,dilationWidth:C,inShape:t,outShape:d,filterShape:e}}function Ni(t,e,n,r){void 0===r&&(r=1);var i=Oi(e,r);return Math.floor((t[0]*(n-1)-n+i)/2)}function Ii(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function Ri(t){return"number"==typeof t?[t,t,t]:t}function Oi(t,e){return e<=1?t:t+(t-1)*(e-1)}function ki(t,e){if(!e)return t;switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode "+e)}}function Li(t){var e=Ii(t),n=e[0],r=e[1],i=e[2];return 1===n&&1===r&&1===i}function Di(t,e){return Li(t)||Li(e)}function Pi(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error("Unknown dataFormat "+t)}function Fi(t,e,n){if("complex64"===e){if("complex64"===t.dtype)return t.clone();var r=_n(t.shape),i=t.toFloat(),a=n.complex(i,r);return r.dispose(),i.dispose(),a}if(!H(t.dtype,e))return Ft.makeTensorFromDataId(t.dataId,t.shape,e);if("complex64"===t.dtype){var o=n.real(t);return a=o.cast(e),o.dispose(),a}if("int32"===e)return n.int(t);if("bool"===e){var s=vn(0,t.dtype);return a=n.notEqual(t,s),s.dispose(),a}throw new Error("Error in Cast: failed to cast "+t.dtype+" to "+e)}function Bi(t,e){return Ft.makeTensorFromDataId(t.dataId,e,t.dtype)}function zi(t,e,n){var r=(e-t)/(n-1),i=it(n,"float32");i[0]=t;for(var a=1;a<i.length;a++)i[a]=i[a-1]+r;return gn(i,"float32")}var Ui=Object.freeze({castTensor:Fi,reshapeTensor:Bi,linspaceImpl:zi,upcastType:Nt,axesAreInnerMostDims:Qe,combineLocations:tn,computeOutAndReduceShapes:en,expandShapeToKeepDim:nn,assertAxesAreInnerMostDims:rn,getAxesPermutation:an,getUndoAxesPermutation:on,getInnerMostAxes:sn,getBroadcastDims:nr,getReductionAxes:rr,assertAndGetBroadcastShape:ir,assertParamsConsistent:un,computeOutShape:cn,computePool2DInfo:Ei,computePool3DInfo:Ti,computeConv2DInfo:Ci,computeConv3DInfo:Ai,computeDefaultPad:Ni,tupleValuesAreOne:Li,eitherStridesOrDilationsAreOne:Di,convertConv2DDataFormat:Pi,PARALLELIZE_THRESHOLD:30,computeOptimalWindowSize:ai});function ji(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+t.length+", imag: "+e.length+".");for(var n=new Float32Array(2*t.length),r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function Wi(t,e){return{real:t[2*e],imag:t[2*e+1]}}function Vi(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function Hi(t,e,n){var r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}function Gi(t,e,n){var r=function(t,e,n){return function(t,e,n){for(var r=0,i=t.length,a=0,o=!1;r<i;){var s=n(e,t[a=r+(i-r>>>1)]);s>0?r=a+1:(i=a,o=!s)}return o?r:-r-1}(t,e,n||qi)}(t,e,n),i=r<0?-(r+1):r;t.splice(i,0,e)}function qi(t,e){return t>e?1:t<e?-1:0}function Xi(t,e,n,r,i){return Yi(t,e,n,r,i,0).selectedIndices}function $i(t,e,n,r,i,a){var o=Yi(t,e,n,r,i,a,!0);return o.numValidOutputs.dispose(),{selectedIndices:o.selectedIndices,selectedScores:o.selectedScores}}function Yi(t,e,n,r,i,a,o,s){void 0===o&&(o=!1),void 0===s&&(s=!1);for(var u=Array.from(e).map((function(t,e){return{score:t,boxIndex:e,suppressBeginIndex:0}})).filter((function(t){return t.score>i})).sort(Zi),c=a>0?-.5/a:0,l=[],h=[];l.length<n&&u.length>0;){var p=u.pop(),f=p.score,d=p.boxIndex,m=p.suppressBeginIndex;if(f<i)break;for(var v=!1,g=l.length-1;g>=m;--g){var y=Ki(t,d,l[g]);if(y>=r){v=!0;break}if(p.score=p.score*Ji(r,c,y),p.score<=i)break}p.suppressBeginIndex=l.length,v||(p.score===f?(l.push(d),h.push(p.score)):p.score>i&&Gi(u,p,Zi))}var x=l.length;return s&&(l.fill(0,x),h.fill(0,x)),{selectedIndices:gn(l,"int32"),selectedScores:gn(h,"float32"),numValidOutputs:vn(x,"int32")}}function Ki(t,e,n){var r=t.subarray(4*e,4*e+4),i=t.subarray(4*n,4*n+4),a=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(i[0],i[2]),l=Math.min(i[1],i[3]),h=Math.max(i[0],i[2]),p=Math.max(i[1],i[3]),f=(s-a)*(u-o),d=(h-c)*(p-l);if(f<=0||d<=0)return 0;var m=Math.max(a,c),v=Math.max(o,l),g=Math.min(s,h),y=Math.min(u,p),x=Math.max(g-m,0)*Math.max(y-v,0);return x/(f+d-x)}function Ji(t,e,n){var r=Math.exp(e*n*n);return n<=t?r:0}function Zi(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}function Qi(t,e,n){var r=new Array(t.rank).fill(0),i=t.shape.slice();return e.map((function(e){i[n]=e;var a=t.slice(r,i);return r[n]+=e,a}))}function ta(t,e){for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];var i=Ln(n,t.dtype);for(r=0;r<i.values.length;++r){for(var a=i.indexToLoc(r),o=new Array(t.rank),s=0;s<o.length;s++)o[s]=a[s]%t.shape[s];var u=t.locToIndex(o);i.values[r]=t.values[u]}return i.toTensor()}function ea(t,e,n,r,i){for(var a=e[e.length-1],o=[t.length/a,a],s=o[0],u=o[1],c=U(n,s*r),l=U("int32",s*r),h=0;h<s;h++){for(var p=h*u,f=t.subarray(p,p+u),d=[],m=0;m<f.length;m++)d.push({value:f[m],index:m});d.sort((function(t,e){return e.value-t.value}));var v=h*r,g=c.subarray(v,v+r),y=l.subarray(v,v+r);for(m=0;m<r;m++)g[m]=d[m].value,y[m]=d[m].index}var x=e.slice();return x[x.length-1]=r,[dn(c,x,n),dn(l,x,"int32")]}function na(t,e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(r);var i=Ln(t,"int32"),a=Ln([n.length,t.length],"int32");for(r=0;r<n.length;r++){var o=i.indexToLoc(n[r]),s=r*t.length;a.values.set(o,s)}return a.toTensor()}var ra=function(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((function(t,e){return"T"+e}));var n=[];this.variableNames.forEach((function(t){n.push("float v"+t+" = get"+t+"AtOutCoords();")}));var r=this.variableNames.map((function(t){return"v"+t})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        float result = "+r+";\n        setOutput(result);\n      }\n    "},ia=function(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map((function(t,e){return"T"+e}));var n=[];this.variableNames.forEach((function(t){n.push("vec4 v"+t+" = get"+t+"AtOutCoords();")}));var r=this.variableNames.map((function(t){return"v"+t})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        vec4 result = "+r+";\n        setOutput(result);\n      }\n    "},aa=function(t,e,n){this.variableNames=["A"];var r=t.windowSize,i=t.batchSize,a=t.inSize,o=Math.ceil(a/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];var s="max"===e?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+u+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+s+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "};function oa(t,e){return["x","y","z","w","u","v"].slice(0,e).map((function(e){return t+"."+e}))}function sa(t,e){return 1===e?[t]:oa(t,e)}function ua(){var t,e,n,r,i,a,o,s,u,c;return 2===p().getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",r="in",i="texture",a="outputColor",o="out vec4 outputColor;",s="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",u="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",r="varying",i="texture2D",a="gl_FragColor",o="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:i,output:a,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:u,defineRound:c}}function ca(t,e,n){void 0===n&&(n="index");var r=tt(e);return r.map((function(e,i){return"int "+t[i]+" = "+n+" / "+e+"; "+(i===r.length-1?"int "+t[i+1]+" = "+n+" - "+t[i]+" * "+e:"index -= "+t[i]+" * "+e)+";"})).join("")}function la(t){var e=tt(t).map((function(t){return t.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * "+e[0]+" + coords.y * "+e[1]+" + coords.z;\n  }\n"}var ha="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";function pa(t,e,n,r){var i=[];t.forEach((function(t){var e=I(t.shapeInfo.logicalShape);t.shapeInfo.isUniform?i.push("uniform float "+t.name+(e>1?"["+e+"]":"")+";"):(i.push("uniform sampler2D "+t.name+";"),i.push("uniform int offset"+t.name+";"))}));var a,o,s=i.join("\n"),u=t.map((function(t){return function(t,e,n){void 0===n&&(n=!1);var r="";r+=n?function t(e){var n,r,i;switch(e.shapeInfo.logicalShape.length){case 0:return n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=ua(),"\n    vec4 "+r+"() {\n      return "+i.texture2D+"("+n+", halfCR);\n    }\n  ";case 1:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=t.shapeInfo.texShape,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],a=ua();return"\n    vec4 "+n+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+i[0]+", "+i[1]+", index);\n      return "+a.texture2D+"("+e+", uv);\n    }\n  "}(e);case 2:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t.shapeInfo.texShape,a=i[0],o=i[1],s=ua();if(null!=i&&R(e,i))return"\n      vec4 "+r+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+o+".0, "+a+".0);\n\n        return "+s.texture2D+"("+n+", uv);\n      }\n    ";var u=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return"\n    vec4 "+r+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+Math.ceil(e[1]/2)+", "+u[0]+", "+u[1]+", row, col);\n      return "+s.texture2D+"("+n+", uv);\n    }\n  "}(e);case 3:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=e.shapeInfo.texShape,o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(1===n[0]){var s=ba(e,n.slice(1));return"\n        "+t(s)+"\n        vec4 "+i+"(int b, int row, int col) {\n          return "+i+"("+wa(["b","row","col"],[1,2])+");\n        }\n      "}var u=o[0],c=o[1],l=Math.ceil(n[2]/2);return"\n    vec4 "+i+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+u+", "+c+", "+l*Math.ceil(n[1]/2)+", "+l+", b, row, col);\n      return "+ua().texture2D+"("+r+", uv);\n    }\n  "}(e);default:return function(t){for(var e=t.shapeInfo.logicalShape,n=e.length,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=t.shapeInfo.texShape,o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],s=o[0],u=o[1],c=Math.ceil(e[n-1]/2),l=c*Math.ceil(e[n-2]/2),h="int b, int row, int col",p="b * "+l+" + (row / 2) * "+c+" + (col / 2)",f=2;f<n-1;f++)h="int b"+f+", "+h,p="b"+f+" * "+(l*=e[n-f-1])+" + "+p;return"\n    vec4 "+i+"("+h+") {\n      int index = "+p+";\n      int texR = index / "+u+";\n      int texC = index - texR * "+u+";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+u+", "+s+");\n      return "+ua().texture2D+"("+r+", uv);\n    }\n  "}(e)}}(t):function t(e){var n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"float "+n+"() {return "+e+";}";var r=t.shapeInfo.texShape,i=r[0],a=r[1];if(1===i&&1===a)return"\n      float "+n+"() {\n        return sampleTexture("+e+", halfCR);\n      }\n    ";var o=t.shapeInfo.texShape;return"\n    float "+n+"() {\n      vec2 uv = uvFromFlat("+o[0]+", "+o[1]+", "+ga(e)+");\n      return sampleTexture("+e+", uv);\n    }\n  "}(e);case 1:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"\n      float "+n+"(int index) {\n        "+ya(t)+"\n      }\n    ";var r=t.shapeInfo.texShape,i=r[0],a=r[1];if(1===a&&1===i)return"\n      float "+n+"(int index) {\n        return sampleTexture("+e+", halfCR);\n      }\n    ";var o=ga(e);return 1===a?"\n      float "+n+"(int index) {\n        vec2 uv = vec2(0.5, (float(index + "+o+") + 0.5) / "+i+".0);\n        return sampleTexture("+e+", uv);\n      }\n    ":1===i?"\n      float "+n+"(int index) {\n        vec2 uv = vec2((float(index + "+o+") + 0.5) / "+a+".0, 0.5);\n        return sampleTexture("+e+", uv);\n      }\n    ":"\n    float "+n+"(int index) {\n      vec2 uv = uvFromFlat("+i+", "+a+", index + "+o+");\n      return sampleTexture("+e+", uv);\n    }\n  "}(e);case 2:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=e.shapeInfo.texShape;if(null!=a&&R(n,a)){var o=a[0];return"\n    float "+i+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+a[1]+".0, "+o+".0);\n      return sampleTexture("+r+", uv);\n    }\n  "}var s=z(n),u=s.newShape,c=s.keptDims,l=u;if(l.length<n.length){var h=ba(e,l);return"\n      "+t(h)+"\n      float "+i+"(int row, int col) {\n        return "+i+"("+wa(["row","col"],c)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2("+n[1]+", 1)));\n        "+ya(e)+"\n      }\n    ";var p=a[0],f=a[1],d=ga(r);return 1===f?"\n    float "+i+"(int row, int col) {\n      float index = dot(vec3(row, col, "+d+"), vec3("+n[1]+", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+p+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ":1===p?"\n    float "+i+"(int row, int col) {\n      float index = dot(vec3(row, col, "+d+"), vec3("+n[1]+", 1, 1));\n      vec2 uv = vec2((index + 0.5) / "+f+".0, 0.5);\n      return sampleTexture("+r+", uv);\n    }\n  ":"\n  float "+i+"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * "+n[1]+" + col + "+d+";\n    vec2 uv = uvFromFlat("+p+", "+f+", index);\n    return sampleTexture("+r+", uv);\n  }\n"}(e);case 3:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=n[1]*n[2],o=n[2],s=z(n),u=s.newShape,c=s.keptDims,l=u;if(l.length<n.length){var h=ba(e,l);return"\n        "+t(h)+"\n        float "+i+"(int row, int col, int depth) {\n          return "+i+"("+wa(["row","col","depth"],c)+");\n        }\n      "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3("+a+", "+o+", 1)));\n        "+ya(e)+"\n      }\n    ";var p=e.shapeInfo.texShape,f=p[0],d=p[1],m=e.shapeInfo.flatOffset;return d===a&&null==m?"\n        float "+i+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+o+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+d+".0, "+f+".0);\n          return sampleTexture("+r+", uv);\n        }\n      ":d===o&&null==m?"\n    float "+i+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+n[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+d+".0, "+f+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ":"\n      float "+i+"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * "+a+" + col * "+o+" + depth + "+ga(r)+";\n        vec2 uv = uvFromFlat("+f+", "+d+", index);\n        return sampleTexture("+r+", uv);\n      }\n  "}(e);case 4:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=n[3],o=n[2]*a,s=n[1]*o,u=z(n),c=u.newShape,l=u.keptDims;if(c.length<n.length){var h=ba(e,c);return"\n      "+t(h)+"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        return "+i+"("+wa(["row","col","depth","depth2"],l)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4("+s+", "+o+", "+a+", 1)));\n        "+ya(e)+"\n      }\n    ";var p=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,d=f[0],m=f[1];return m===s&&null==p?"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3("+o+", "+a+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+m+".0, "+d+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":m===a&&null==p?"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+n[1]*n[2]+", "+n[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+m+".0, "+d+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+s+" + col * "+o+" +\n          depth * "+a+" + depth2;\n      vec2 uv = uvFromFlat("+d+", "+m+", index + "+ga(r)+");\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);case 5:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=n[4],o=n[3]*a,s=n[2]*o,u=n[1]*s,c=z(n),l=c.newShape,h=c.keptDims;if(l.length<n.length){var p=ba(e,l);return"\n      "+t(p)+"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+i+"("+wa(["row","col","depth","depth2","depth3"],h)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+u+", "+s+", "+o+", "+a+")) +\n          depth3;\n        "+ya(e)+"\n      }\n    ";var f=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,m=d[0],v=d[1];return v===u&&null==f?"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4("+s+", "+o+", "+a+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+v+".0, "+m+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":v===a&&null==f?"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+n[1]*n[2]*n[3]+",\n               "+n[2]*n[3]+", "+n[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+v+".0, "+m+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+u+" + col * "+s+" + depth * "+o+" +\n          depth2 * "+a+" + depth3 + "+ga(r)+";\n      vec2 uv = uvFromFlat("+m+", "+v+", index);\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);case 6:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=z(n),o=a.newShape,s=a.keptDims;if(o.length<n.length){var u=ba(e,o);return"\n      "+t(u)+"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+i+"("+wa(["row","col","depth","depth2","depth3","depth4"],s)+");\n      }\n    "}var c=n[5],l=n[4]*c,h=n[3]*l,p=n[2]*h,f=n[1]*p;if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4("+f+", "+p+", "+h+", "+l+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+c+", 1)));\n        "+ya(e)+"\n      }\n    ";var d=e.shapeInfo.flatOffset,m=e.shapeInfo.texShape,v=m[0],g=m[1];return g===f&&null==d?"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4("+p+", "+h+", "+l+", "+c+")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+g+".0, "+v+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":g===c&&null==d?"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4("+n[1]*n[2]*n[3]*n[4]+",\n               "+n[2]*n[3]*n[4]+",\n               "+n[3]*n[4]+",\n               "+n[4]+")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+g+".0, "+v+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+f+" + col * "+p+" + depth * "+h+" +\n          depth2 * "+l+" + depth3 * "+c+" + depth4 + "+ga(r)+";\n      vec2 uv = uvFromFlat("+v+", "+g+", index);\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);default:throw new Error(n.length+"-D input sampling is not yet supported")}}(t);var i=t.shapeInfo.logicalShape,a=e.logicalShape;return i.length<=a.length&&(r+=n?function(t,e){var n,r=t.name,i=r.charAt(0).toUpperCase()+r.slice(1),a="get"+i+"AtOutCoords",o=t.shapeInfo.logicalShape.length,s=e.logicalShape.length,u=nr(t.shapeInfo.logicalShape,e.logicalShape),c=xa(s),l=s-o,h=["x","y","z","w","u","v"];n=0===o?"":s<2&&u.length>=1?"coords = 0;":u.map((function(t){return"coords."+h[t+l]+" = 0;"})).join("\n");var p;p=s<2&&o>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords."+h[e+l]})).join(", ");var f="return outputValue;",d=1===I(t.shapeInfo.logicalShape),m=1===I(e.logicalShape);if(1!==o||d||m){if(d&&!m)f=1===s?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(u.length){var v=o-2,g=o-1;u.indexOf(v)>-1&&u.indexOf(g)>-1?f="return vec4(outputValue.x);":u.indexOf(v)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":u.indexOf(g)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}}else f="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 "+a+"() {\n      "+c+" coords = getOutputCoords();\n      "+n+"\n      vec4 outputValue = get"+i+"("+p+");\n      "+f+"\n    }\n  "}(t,e):function(t,e){var n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",a=e.texShape,o=t.shapeInfo.texShape,s=t.shapeInfo.logicalShape.length,u=e.logicalShape.length;if(!t.shapeInfo.isUniform&&s===u&&null==t.shapeInfo.flatOffset&&R(o,a))return"\n      float "+i+"() {\n        return sampleTexture("+n+", resultUV);\n      }\n    ";var c=xa(u),l=nr(t.shapeInfo.logicalShape,e.logicalShape),h=u-s,p=["x","y","z","w","u","v"];return"\n    float "+i+"() {\n      "+c+" coords = getOutputCoords();\n      "+(0===s?"":u<2&&l.length>=1?"coords = 0;":l.map((function(t){return"coords."+p[t+h]+" = 0;"})).join("\n"))+"\n      return get"+r+"("+(u<2&&s>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords."+p[e+h]})).join(", "))+");\n    }\n  "}(t,e)),r}(t,e,r)})).join("\n"),c=e.texShape,l=ua(),h=function(t){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return "+t.texture2D+"(textureSampler, uv).r;\n    }\n  "}(l),p=function(t){return t.version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+t.varyingFs+" vec2 resultUV;\n    "+t.defineOutput+"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    "+t.defineSpecialNaN+"\n    "+t.defineSpecialInf+"\n    "+t.defineRound+"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    "+fa+"\n    "+da+"\n    "+ma+"\n  "}(l);return e.isPacked?(a=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return 1===n[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+n[1]+".0);\n      }\n    ":1===n[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+n[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      return 2 * (resTexRC.x * "+n[1]+" + resTexRC.y);\n    }\n  "}(0,e);case 2:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(R(t,e))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+n[0]+", "+n[1]+"));\n      }\n    ";var r=Math.ceil(t[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(t,e);case 3:return n=t,r=e,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],o=(a=Math.ceil(n[2]/2))*Math.ceil(n[1]/2),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+i[0]+", "+i[1]+"));\n      int index = resTexRC.x * "+i[1]+" + resTexRC.y;\n\n      int b = index / "+o+";\n      index -= b * "+o+";\n\n      int r = 2 * (index / "+a+");\n      int c = imod(index, "+a+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";default:return function(t,e){for(var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),i=r*Math.ceil(t[t.length-2]/2),a=i,o="",s="b, r, c",u=2;u<t.length-1;u++)o="\n      int b"+u+" = index / "+(a*=t[t.length-u-1])+";\n      index -= b"+u+" * "+a+";\n    "+o,s="b"+u+", "+s;return"\n    ivec"+t.length+" getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n\n      "+o+"\n\n      int b = index / "+i+";\n      index -= b * "+i+";\n\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec"+t.length+"("+s+");\n    }\n  "}(t,e)}var n,r,i,a,o}(e.logicalShape,c),o=function(t){return"\n    void setOutput(vec4 val) {\n      "+t.output+" = val;\n    }\n  "}(l)):(a=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){return 1===e[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+e[1]+".0);\n      }\n    ":1===e[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+e[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      return resTexRC.x * "+e[1]+" + resTexRC.y;\n    }\n  "}(0,e);case 2:return function(t,e){return R(t,e)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+e[0]+", "+e[1]+"));\n      }\n    ":1===t[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===t[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      int r = index / "+t[1]+";\n      int c = index - r * "+t[1]+";\n      return ivec2(r, c);\n    }\n  "}(t,e);case 3:return n=e,r=ca(["r","c","d"],t),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      "+r+"\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(t,e){var n=ca(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      "+n+"\n      return ivec4(r, c, d, d2);\n    }\n  "}(t,e);case 5:return function(t,e){var n=ca(["r","c","d","d2","d3"],t);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+e[0]+",\n                             "+e[1]+"));\n\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}(t,e);case 6:return function(t,e){var n=ca(["r","c","d","d2","d3","d4"],t);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  "}(t,e);default:throw new Error(t.length+"-D output sampling is not yet supported")}var n,r}(e.logicalShape,c),o=function(t){return"\n    void setOutput(float val) {\n      "+t.output+" = vec4(val, 0, 0, 0);\n    }\n  "}(l)),r&&(p+=va),[p,h,o,s,a,u,n].join("\n")}var fa="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",da="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",ma="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",va="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function ga(t){return"offset"+t}function ya(t){var e=t.name,n=I(t.shapeInfo.logicalShape);return n<2?"return "+e+";":"\n    for (int i = 0; i < "+n+"; i++) {\n      if (i == index) {\n        return "+e+"[i];\n      }\n    }\n  "}function xa(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error("GPU for rank "+t+" is not yet supported")}function ba(t,e){var n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function wa(t,e){return e.map((function(e){return t[e]})).join(", ")}var _a=function(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,T(t.length>2,(function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."}));var i=t[t.length-1],a=Math.ceil(i/e);this.outputShape=t.slice(0,-1),a>1&&this.outputShape.push(a),r||this.variableNames.push("bestIndicesA");var o,s,u=this.outputShape,c=u.length,l=xa(c),h=sa("coords",c);if(1===a){var p=xa(s=c+1);o="\n        "+p+" sourceLocR = "+p+"("+h.join()+", 0);\n        ++"+h[c-1]+";\n        "+p+" sourceLocG = "+p+"("+h.join()+", 0);\n        ++"+h[c-2]+";\n        "+p+" sourceLocA = "+p+"("+h.join()+", 0);\n        --"+h[c-1]+";\n        "+p+" sourceLocB = "+p+"("+h.join()+", 0);\n        --"+h[c-2]+";"}else s=c,o="\n        "+l+" sourceLocR = coords;\n        ++"+h[c-1]+";\n        "+l+" sourceLocG = coords;\n        ++"+h[c-2]+";\n        "+l+" sourceLocA = coords;\n        --"+h[c-1]+";\n        "+l+" sourceLocB = coords;\n        --"+h[c-2]+";";var f=["x","y","z","w","u","v"].slice(0,s),d="."+f[s-1],m=f.map((function(t){return"int "+t})),v=sa("sourceLocR",s-1).concat("inIdx.r"),g=sa("sourceLocG",s-1).concat("inIdx.g"),y=sa("sourceLocB",s-1).concat("inIdx.b"),x=sa("sourceLocA",s-1).concat("inIdx.a"),b="max"===n?"greaterThan":"lessThan",w=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel("+v.join()+"),\n                             getBestIndicesAChannel("+g.join()+"),\n                             getBestIndicesAChannel("+y.join()+"),\n                             getBestIndicesAChannel("+x.join()+")));",_="vec4(\n            getAChannel("+v.join()+"),\n            hasNextCol ? getAChannel("+g.join()+") : 0.,\n            hasNextRow ? getAChannel("+y.join()+") : 0.,\n            hasNextRow && hasNextCol ? getAChannel("+x.join()+") : 0.)",S=r?"":"\n      float getBestIndicesAChannel("+m.join()+") {\n        return getChannel(getBestIndicesA("+f.join()+"),\n                                          vec2("+f.slice(-2).join()+"));\n      }";this.userCode="\n      float getAChannel("+m.join()+") {\n        return getChannel(getA("+f.join()+"),\n                               vec2("+f.slice(-2).join()+"));\n      }\n      "+S+"\n      void main() {\n        "+l+" coords = getOutputCoords();\n        bool hasNextCol = "+h[c-1]+" < "+(u[c-1]-1)+";\n        bool hasNextRow = "+h[c-2]+" < "+(u[c-2]-1)+";\n        "+o+"\n        ivec4 srcIdx = ivec4(sourceLocR"+d+", sourceLocG"+d+",\n          sourceLocB"+d+", sourceLocA"+d+") * "+e+";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = "+_+";\n\n        for (int i = 0; i < "+e+"; i++) {\n          inIdx = srcIdx;\n          "+w+"\n          vec4 candidate = "+_+";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4("+b+"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    "},Sa=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,i=t.strideWidth,a=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,c=s-1-t.padInfo.top,l=u-1-t.padInfo.left,h=1/(e*n);this.userCode="\n      const ivec2 pads = ivec2("+c+", "+l+");\n      const float avgMultiplier = float("+h+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+s+";\n            wR += "+a+") {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+u+";\n            wC+= "+o+") {\n            float dyC = float(dyCCorner + wC) / "+i+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Ma=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,i=t.strideDepth,a=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterDepth,h=t.effectiveFilterHeight,p=t.effectiveFilterWidth,f=l-1-t.padInfo.front,d=h-1-t.padInfo.top,m=p-1-t.padInfo.left,v=1/(e*n*r);this.userCode="\n      const ivec3 pads = ivec3("+f+", "+d+", "+m+");\n      const float avgMultiplier = float("+v+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+l+";\n            wD += "+s+") {\n          float dyD = float(dyDCorner + wD) / "+i+".0;\n\n          if (dyD < 0.0 || dyD >= "+t.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+h+";\n              wR += "+u+") {\n            float dyR = float(dyRCorner + wR) / "+a+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+p+";\n                wC += "+c+") {\n              float dyC = float(dyCCorner + wC) / "+o+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Ea=function(t,e,n,r,i,a){this.outputShape=[],this.variableNames=["x","mean","variance"],ir(t,e),ir(t,n);var o="0.0";null!=r&&(ir(t,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="1.0";null!=i&&(ir(t,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+o+";\n        float scale = "+s+";\n        float inv = scale * inversesqrt(variance + float("+a+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "},Ta=function(t,e,n,r,i,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],ir(t,e),ir(t,n);var o="vec4(0.0)";null!=r&&(ir(t,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="vec4(1.0)";null!=i&&(ir(t,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = "+o+";\n        vec4 scale = "+s+";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+a+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "},Ca=function(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=ir(e,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+t+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "},Aa="return a + b;",Na="return a - b;",Ia="return a * b;",Ra="return (a < 0.) ? b * a : a;",Oa=function(t,e,n){this.variableNames=["A","B"],this.outputShape=ir(e,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+t+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "},ka="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",La=function(t,e,n,r){void 0===r&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=ir(e,n);var i=this.outputShape.length,a="";if(r)if(0===i||1===I(this.outputShape))a="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(a="\n          "+xa(i)+" coords = getOutputCoords();\n        ",1===i)a+="\n            result.y = (coords + 1) >= "+this.outputShape[0]+" ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ";else{var o=sa("coords",i);a+="\n            bool nextRowOutOfBounds =\n              ("+o[i-2]+" + 1) >= "+this.outputShape[i-2]+";\n            bool nextColOutOfBounds =\n              ("+o[i-1]+" + 1) >= "+this.outputShape[i-1]+";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        "+t+"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        "+a+"\n\n        setOutput(result);\n      }\n    "},Da=function(){function t(t){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(r,i){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(i,"maxVal")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}},t}(),Pa=function(){function t(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(r,i){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(i,"maxVal")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}},t}(),Fa=function(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},Ba=function(t){this.outputShape=[],this.outputShape=cn(t,1),this.variableNames=t.map((function(t,e){return"T"+e}));var e=new Array(t.length-1);e[0]=t[0][1];for(var n=1;n<e.length;n++)e[n]=e[n-1]+t[n][1];var r=["if (yC < "+e[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<e.length;n++){var i=e[n-1];r.push("else if (yC < "+e[n]+") setOutput(getT"+n+"(yR, yC-"+i+"));")}var a=e.length,o=e[e.length-1];r.push("else setOutput(getT"+a+"(yR, yC-"+o+"));"),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        "+r.join("\n        ")+"\n      }\n    "},za=function(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=cn(t,e);var n=this.outputShape,r=n.length,i=xa(r),a=sa("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map((function(t,e){return"T"+e}));var s=new Array(t.length-1);s[0]=t[0][e];for(var u=1;u<s.length;u++)s[u]=s[u-1]+t[u][e];var c=o[e],l=o.slice(-2),h=o.join(),p="if ("+c+" < "+s[0]+") {\n        return getChannel(\n            getT0("+h+"), vec2("+l.join()+"));\n        }";for(u=1;u<s.length;u++){var f=s[u-1];p+="\n        if ("+c+" < "+s[u]+"  && "+c+" >= "+s[u-1]+") {\n          return getChannel(\n            getT"+u+"("+Ua(o,c,f)+"),\n            vec2("+Ua(l,c,f)+"));\n        }"}var d=s.length,m=s[s.length-1];p+="\n        return getChannel(\n          getT"+d+"("+Ua(o,c,m)+"),\n          vec2("+Ua(l,c,m)+"));",this.userCode="\n      float getValue("+o.map((function(t){return"int "+t}))+") {\n        "+p+"\n      }\n\n      void main() {\n        "+i+" coords = getOutputCoords();\n        vec4 result = vec4(getValue("+a+"), 0., 0., 0.);\n\n        "+a[r-1]+" = "+a[r-1]+" + 1;\n        if ("+a[r-1]+" < "+n[r-1]+") {\n          result.g = getValue("+a+");\n        }\n\n        "+a[r-2]+" = "+a[r-2]+" + 1;\n        if ("+a[r-2]+" < "+n[r-2]+") {\n          result.a = getValue("+a+");\n        }\n\n        "+a[r-1]+" = "+a[r-1]+" - 1;\n        if ("+a[r-2]+" < "+n[r-2]+" &&\n            "+a[r-1]+" < "+n[r-1]+") {\n          result.b = getValue("+a+");\n        }\n        setOutput(result);\n      }\n    "};function Ua(t,e,n){var r=t.indexOf(e);return t.map((function(t,e){return e===r?t+" - "+n:t})).join()}var ja=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,i=t.padInfo.left,a="channelsLast"===t.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+e+" - "+r+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+i+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              if ("+a+") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Wa=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,i=t.strideWidth,a="channelsLast"===t.dataFormat,o=e-1-t.padInfo.top,s=n-1-t.padInfo.left,u=a?1:2,c=a?2:3,l=a?3:1;this.userCode="\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords["+l+"];\n\n        ivec2 dyCorner = ivec2(coords["+u+"], coords["+c+"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+e+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+i+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n\n              if ("+a+") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Va=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,i=t.padInfo.front,a=t.padInfo.top,o=t.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yF = 0; yF < "+t.outDepth+"; yF++) {\n            int xF = wF + yF * "+e+" - "+i+";\n\n            if (xF < 0 || xF >= "+t.inDepth+") {\n              continue;\n            }\n\n            for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n              int xR = wR + yR * "+n+" - "+a+";\n\n              if (xR < 0 || xR >= "+t.inHeight+") {\n                continue;\n              }\n\n              for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n                int xC = wC + yC * "+r+" - "+o+";\n\n                if (xC < 0 || xC >= "+t.inWidth+") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Ha=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,i=t.strideDepth,a=t.strideHeight,o=t.strideWidth,s=e-1-t.padInfo.front,u=n-1-t.padInfo.top,c=r-1-t.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3("+s+", "+u+", "+c+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+e+"; wF++) {\n          float dyF = float(dyFCorner + wF) / "+i+".0;\n\n          if (dyF < 0.0 || dyF >= "+t.outDepth+".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = "+e+" - 1 - wF;\n\n          for (int wR = 0; wR < "+n+"; wR++) {\n            float dyR = float(dyRCorner + wR) / "+a+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = "+n+" - 1 - wR;\n\n            for (int wC = 0; wC < "+r+"; wC++) {\n              float dyC = float(dyCCorner + wC) / "+o+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = "+r+" - 1 - wC;\n\n              for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Ga=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,i=t.padInfo.left,a=t.outChannels/t.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+a+" + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+e+" - "+r+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+i+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},qa=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,i=t.strideWidth,a=e-1-t.padInfo.top,o=n-1-t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+a+", "+o+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+e+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+i+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+s+"; dm++) {\n              int d2 = d1 * "+s+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Xa=function(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var i=t.padInfo.top,a=t.padInfo.left,o=t.strideHeight,s=t.strideWidth,u=t.dilationHeight,c=t.dilationWidth,l=t.filterHeight,h=t.filterWidth,p=4*Math.floor(t.inChannels/4),f=t.inChannels%4,d="channelsLast"===t.dataFormat,m=d?1:2,v=d?2:3,g=d?3:1,y="",x="";n&&(y=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",x="result = activation(result);");var b=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+y+"\n\n      const ivec2 strides = ivec2("+o+", "+s+");\n      const ivec2 pads = ivec2("+i+", "+a+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords["+g+"];\n\n        ivec2 xRCCorner =\n            ivec2(coords["+m+"], coords["+v+"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+l+"; wR++) {\n          int xR = xRCorner + wR * "+u+";\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+h+"; wC++) {\n            int xC = xCCorner + wC * "+c+";\n\n            if (xC < 0 || xC >= "+t.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+p+"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if ("+d+") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if ("+(1===f)+") {\n\n              if ("+d+") {\n                dotProd +=\n                    getX(batch, xR, xC, "+p+") *\n                    getW(wR, wC, "+p+", d2);\n              } else {\n                dotProd +=\n                    getX(batch, "+p+", xR, xC) *\n                    getW(wR, wC, "+p+", d2);\n              }\n\n            } else if ("+(2===f)+") {\n              vec2 wValues = vec2(\n                getW(wR, wC, "+p+", d2),\n                getW(wR, wC, "+p+" + 1, d2)\n              );\n\n              if ("+d+") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, "+p+"),\n                  getX(batch, xR, xC, "+p+" + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, "+p+", xR, xC),\n                  getX(batch, "+p+" + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if ("+(3===f)+") {\n              vec3 wValues = vec3(\n                getW(wR, wC, "+p+", d2),\n                getW(wR, wC, "+p+" + 1, d2),\n                getW(wR, wC, "+p+" + 2, d2)\n              );\n\n              if ("+d+") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, "+p+"),\n                  getX(batch, xR, xC, "+p+" + 1),\n                  getX(batch, xR, xC, "+p+" + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, "+p+", xR, xC),\n                  getX(batch, "+p+" + 1, xR, xC),\n                  getX(batch, "+p+" + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        "+b+"\n        "+x+"\n        setOutput(result);\n      }\n    "},$a=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,i=t.strideDepth,a=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.filterDepth,h=t.filterHeight,p=t.filterWidth,f=4*Math.floor(t.inChannels/4),d=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3("+i+", "+a+", "+o+");\n      const ivec3 pads = ivec3("+e+", "+n+", "+r+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+l+"; wF++) {\n          int xF = xFCorner + wF * "+s+";\n\n          if (xF < 0 || xF >= "+t.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+h+"; wR++) {\n            int xR = xRCorner + wR * "+u+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+p+"; wC++) {\n              int xC = xCCorner + wC * "+c+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < "+f+"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if ("+(1===d)+") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, "+f+") *\n                  getW(wF, wR, wC, "+f+", d2);\n              } else if ("+(2===d)+") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, "+f+"),\n                  getX(batch, xF, xR, xC, "+f+" + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, "+f+", d2),\n                  getW(wF, wR, wC, "+f+" + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if ("+(3===d)+") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, "+f+"),\n                  getX(batch, xF, xR, xC, "+f+" + 1),\n                  getX(batch, xF, xR, xC, "+f+" + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, "+f+", d2),\n                  getW(wF, wR, wC, "+f+" + 1, d2),\n                  getW(wF, wR, wC, "+f+" + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Ya=function(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var i=t.inHeight,a=t.inWidth,o=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,h=t.dilationWidth,p=t.filterHeight,f=t.filterWidth,d=t.outChannels/t.inChannels,m="",v="";n&&(m=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",v="result = activation(result);");var g=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+m+"\n\n      const ivec2 strides = ivec2("+u+", "+c+");\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+d+";\n        int q = d2 - d1 * "+d+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+p+"; wR++) {\n          int xR = xRCorner + wR * "+l+";\n\n          if (xR < 0 || xR >= "+i+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+f+"; wC++) {\n            int xC = xCCorner + wC * "+h+";\n\n            if (xC < 0 || xC >= "+a+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        "+g+"\n        "+v+"\n        setOutput(result);\n      }\n    "},Ka=function(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;for(var i=t.inHeight,a=t.inWidth,o=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,h=t.dilationWidth,p=t.filterHeight,f=t.filterWidth,d=f,m="int xR; int xC; int xCOffset;",v=0;v<p;v++)for(var g=0;g<f;g++)m+="\n          vec4 xTexelR"+v+"C"+2*g+" = vec4(0.);\n          vec4 wR"+v+"C"+g+" = vec4(0.);\n          vec4 xR"+v+"C"+g+" = vec4(0.);";for(v=0;v<p;v++)for(var y=0;y<d;y++){if(m+="\n          xR = xRCorner + "+v*l+";\n          xC = xCCorner + "+(g=2*y)*h+";\n        ",1===c){if(g<f&&(m+=s%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < "+i+" && xCOffset >= 0 && xCOffset < "+a+") {\n                  xTexelR"+v+"C"+g+" = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+a+") {\n                    xTexelR"+v+"C"+g+".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR"+v+"C"+g+" = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < "+i+" && xCOffset >= 0 && xCOffset < "+a+") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+a+") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR"+v+"C"+g+" = vec4(previous.zw, xTexelR"+v+"C"+g+".xy);\n                } else {\n                  xR"+v+"C"+g+" = vec4(0, 0, xTexelR"+v+"C"+g+".xy);\n                }\n              ":"\n                if(xR >= 0 && xR < "+i+" && xC >= 0 && xC < "+a+") {\n                  xTexelR"+v+"C"+g+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+v+"C"+g+" = vec4(0.);\n                }\n\n                xR"+v+"C"+g+" = xTexelR"+v+"C"+g+";\n              ",g+1<f)){var x=s%2==0?M(h):h;h%2==0&&s%2==1||h%2!=0&&s%2!=1?(m+="\n                  xCOffset = xC + "+s%2+" + "+x+";\n\n                  if(xR >= 0 && xR < "+i+" &&\n                    xCOffset >= 0 && xCOffset < "+a+") {\n                    xTexelR"+v+"C"+(g+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n                ",h>1&&(m+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < "+i+" &&\n                      xCOffset >= 0 && xCOffset < "+a+") {\n                      xTexelR"+v+"C"+g+" = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR"+v+"C"+g+" = vec4(0.);\n                    }\n                  "),m+="\n                  xR"+v+"C"+(g+1)+" = vec4(\n                    xTexelR"+v+"C"+g+".zw, xTexelR"+v+"C"+(g+2)+".xy);\n                "):m+="\n                  xCOffset = xC + "+x+";\n\n                  if(xR >= 0 && xR < "+i+" &&\n                    xCOffset >= 0 && xCOffset < "+a+") {\n                    xTexelR"+v+"C"+(g+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR"+v+"C"+(g+1)+" = xTexelR"+v+"C"+(g+2)+";\n                "}}else g<f&&(m+="\n              if(xR >= 0 && xR < "+i+") {\n            ",s%2==1?(m+="\n                xCOffset = xC + 1 - "+c+";\n                if(xCOffset >= 0 && xCOffset < "+a+") {\n                  xTexelR"+v+"C"+g+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+v+"C"+g+" = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < "+a+") {\n                  xTexelR"+v+"C"+(g+2)+" = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR"+v+"C"+(g+2)+" = vec4(0.);\n                }\n\n                xR"+v+"C"+g+" = vec4(\n                  xTexelR"+v+"C"+g+".zw, xTexelR"+v+"C"+(g+2)+".zw);\n              ",g+1<f&&(m+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + "+c+";\n                  if(xCOffset >= 0 && xCOffset < "+a+") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR"+v+"C"+(g+1)+" = vec4(xTexelR"+v+"C"+(g+2)+".xy, final.xy);\n                ")):(m+="\n                if(xC >= 0 && xC < "+a+") {\n                  xTexelR"+v+"C"+g+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+v+"C"+g+" = vec4(0.);\n                }\n\n                xCOffset = xC + "+c+";\n                if(xCOffset >= 0 && xCOffset < "+a+") {\n                  xTexelR"+v+"C"+(g+2)+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+v+"C"+(g+2)+" = vec4(0.);\n                }\n\n                xR"+v+"C"+g+" = vec4(\n                  xTexelR"+v+"C"+g+".xy, xTexelR"+v+"C"+(g+2)+".xy);\n              ",g+1<f&&(m+="\n                  xR"+v+"C"+(g+1)+" = vec4(\n                    xTexelR"+v+"C"+g+".zw, xTexelR"+v+"C"+(g+2)+".zw);\n                ")),m+="}");g<f&&(m+="\n            vec4 wTexelR"+v+"C"+g+" = getW("+v+", "+g+", d1, q);\n            wR"+v+"C"+g+" = vec4(wTexelR"+v+"C"+g+".xz, wTexelR"+v+"C"+g+".xz);\n          ",g+1<f&&(m+="\n              vec4 wTexelR"+v+"C"+(g+1)+" = getW("+v+", "+(g+1)+", d1, q);\n              wR"+v+"C"+(g+1)+" =\n                vec4(wTexelR"+v+"C"+(g+1)+".xz, wTexelR"+v+"C"+(g+1)+".xz);"))}for(v=0;v<p;v++)for(g=0;g<f;g++)m+="dotProd += xR"+v+"C"+g+" * wR"+v+"C"+g+";";var b="",w="";n&&(b=r?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"vec4 activation(vec4 x) {\n          "+n+"\n        }",w="result = activation(result);");var _=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+b+"\n\n      const ivec2 strides = ivec2("+u+", "+c+");\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        "+m+"\n\n        vec4 result = dotProd;\n        "+_+"\n        "+w+"\n        setOutput(result);\n      }\n    "},Ja=function(t,e,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var a=t[0],o=t[1],s=t[2],u=t[3],c=e[0],l=n[0],h=n[1];this.outputShape=[c,l,h,u];var p="bilinear"===r?1:0,f=[o-1+".0",s-1+".0"],d=f[0],m=f[1],v=l>1?[""+(o-1)/(l-1),"(y2-y1) * height_ratio","y1*"+d+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+d],g=v[0],y=v[1],x=v[2],b=h>1?[""+(s-1)/(h-1),"(x2-x1) * width_ratio","x1*"+m+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+m],w=b[0],_=b[1],S=b[2];this.userCode="\n      const float height_ratio = float("+g+");\n      const float width_ratio = float("+w+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+a+") {\n          return;\n        }\n\n        float height_scale = "+y+";\n        float width_scale = "+_+";\n\n        float in_y = "+x+";\n        if( in_y < 0.0 || in_y > "+d+" ) {\n          setOutput(float("+i+"));\n          return;\n        }\n        float in_x = "+S+";\n        if( in_x < 0.0 || in_x > "+m+" ) {\n          setOutput(float("+i+"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if("+p+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    "},Za=function(t,e,n){this.variableNames=["x"],this.outputShape=t;var r=t.length,i=t[t.length-1],a=n?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(n?"return "+i+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+xa(r)+" coords = getOutputCoords();\n        int end = "+Qa(r,"coords")+";\n        float val = 0.0;\n        for (int i = "+i+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+a+" end) {\n            continue;\n          }\n          if (idx == end && "+e+") {\n            continue;\n          }\n          "+Qa(r,"coords")+" = idx;\n          val += getX("+function(t,e){if(1===t)return""+e;if(2===t)return e+".x, "+e+".y";if(3===t)return e+".x, "+e+".y, "+e+".z";if(4===t)return e+".x, "+e+".y, "+e+".z, "+e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}(r,"coords")+");\n        }\n        setOutput(val);\n      }\n    "};function Qa(t,e){if(1===t)return""+e;if(2===t)return e+".y";if(3===t)return e+".z";if(4===t)return e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}var to=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Ut.DENSE;var e=$t(t),n=ua();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+ca(["r","c","d"],t)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+e[0]+", "+e[1]+"));\n        int index = 4 * (resTexRC.x * "+e[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        "+n.output+" = result;\n      }\n    "},eo=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Ut.DENSE;var e=$t(t),n=ua();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+ca(["r","c","d"],t)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+e[0]+", "+e[1]+"));\n        int index = 4 * (resTexRC.x * "+e[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        "+n.output+" = result;\n      }\n    "},no=function(){function t(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+e+";\n      int offset_h = imod(h, "+e+");\n      int in_w = w / "+e+";\n      int offset_w = imod(w, "+e+");\n      int offset_d = (offset_h * "+e+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}return t.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},t.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},t.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},t.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},t.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},t}(),ro=function(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "},io=function(t){this.variableNames=["A"],this.outTexUsage=jt.DOWNLOAD;var e=ua();this.outputShape=t,this.userCode="\n      "+ha+"\n\n      void main() {\n        float x = getAAtOutCoords();\n        "+e.output+" = encode_float(x);\n      }\n    "},ao=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=jt.DOWNLOAD;var e=ua();this.outputShape=t,this.userCode="\n      "+ha+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        "+e.output+" = encode_float(x);\n      }\n    "},oo=function(t,e,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=ua(),i=e[0],a=e[1];this.outputShape=t;var o="result";n&&(o="floor(result * 255. + 0.5)"),this.userCode="\n      "+la(t)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / "+a+";\n        int c = imod(flatIndex, "+a+");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2("+a+".0, "+i+".0);\n        vec4 values = "+r.texture2D+"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        "+r.output+" = vec4("+o+", 0., 0., 0.);\n      }\n    "},so=function(t,e,n){void 0===n&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=ua(),i=e[0],a=e[1];this.outputShape=t;var o="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var c=0;c<=1;c++){var l=2*u+c;o+="\n          localCoords = coords;\n          if(localCoords[2] + "+c+" < "+t[2]+") {\n            localCoords[2] += "+c+";\n            if(localCoords[1] + "+u+" < "+t[1]+") {\n              localCoords[1] += "+u+";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / "+a+";\n              c = imod(flatIndex, "+a+");\n              uv = (vec2(c, r) + halfCR) / vec2("+a+".0, "+i+".0);\n              values = "+r.texture2D+"(A, uv);\n\n              if(offset == 0) {\n                result["+l+"] = values[0];\n              } else if(offset == 1) {\n                result["+l+"] = values[1];\n              } else if(offset == 2) {\n                result["+l+"] = values[2];\n              } else {\n                result["+l+"] = values[3];\n              }\n            }\n          }\n        "}this.userCode="\n      "+la(t)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        "+o+"\n\n        "+r.output+" = "+s+";\n      }\n    "},uo=function(t,e,n){this.variableNames=["real","imag"];var r=e[1];this.outputShape=e;var i=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,a=n?r+".0":"1.0";this.userCode="\n      const float exponentMultiplier = "+i+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+t+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+r+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+r+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+a+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "},co=function(){function t(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,r){null==e.valueLoc&&(e.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(e.valueLoc,t)}},t}(),lo=function(t,e,n){this.variableNames=["A","indices"];var r=t.slice();r[n]=e,this.outputShape=r,this.rank=r.length;var i=xa(this.rank),a=function(t,e){var n=t.length;if(n>4)throw Error("Gather for rank "+n+" is not yet supported");if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[],a=0;a<t.length;a++)a===e?i.push("int(getIndices("+r[a]+"))"):i.push(""+r[a]);return i.join()}(t,n);this.userCode="\n      void main() {\n        "+i+" resRC = getOutputCoords();\n        setOutput(getA("+a+"));\n      }\n    "},ho=function(t,e,n){this.sliceDim=t,this.strides=e,this.variableNames=["x","indices"],this.outputShape=n;var r=xa(e.length),i=xa(n.length),a=this.sliceDim>1?"strides[j]":"strides";this.userCode="\n        "+r+" strides = "+r+"("+this.strides+");\n         void main() {\n          "+i+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+a+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "};function po(t,e){var n=ua();return ee(t,e,n.version+"\n    precision highp float;\n    "+n.attribute+" vec3 clipSpacePos;\n    "+n.attribute+" vec2 uv;\n    "+n.varyingVs+" vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function fo(t,e){return ce(t,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function mo(t,e){return le(t,e,new Uint16Array([0,1,2,2,1,3]))}function vo(t,e,n,r,i,a,o){pe(n,r);var s=he(t,e),u=t.TEXTURE_2D;return Jt(t,e,(function(){return t.bindTexture(u,s)})),Jt(t,e,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)})),Jt(t,e,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)})),Jt(t,e,(function(){return t.texParameteri(u,t.TEXTURE_MIN_FILTER,t.NEAREST)})),Jt(t,e,(function(){return t.texParameteri(u,t.TEXTURE_MAG_FILTER,t.NEAREST)})),Jt(t,e,(function(){return t.texImage2D(u,0,i,n,r,0,a,o,null)})),Jt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)})),s}function go(t,e,n,r,i){var a=Xt(n,r);return vo(t,e,a[0],a[1],i.internalFormatFloat,i.textureFormatFloat,t.FLOAT)}function yo(t,e,n,r,i){var a=Xt(n,r);return vo(t,e,a[0],a[1],i.internalFormatHalfFloat,i.textureFormatFloat,i.textureTypeHalfFloat)}function xo(t,e,n,r,i){var a=Xt(n,r);return vo(t,e,a[0],a[1],t.RGBA,t.RGBA,t.UNSIGNED_BYTE)}function bo(t,e,n,r,i){var a=Yt(n,r);return vo(t,e,a[0],a[1],i.internalFormatPackedFloat,t.RGBA,t.FLOAT)}function wo(t,e,n,r,i){var a=Yt(n,r);return vo(t,e,a[0],a[1],i.internalFormatPackedHalfFloat,t.RGBA,i.textureTypeHalfFloat)}function _o(t,e,n,r){return Jt(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),de(t,e,n,"clipSpacePos",r,3,20,0)&&de(t,e,n,"uv",r,2,20,12)}function So(t,e,n,r,i,a,o){var s,u,c;Jt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)})),a instanceof Uint8Array?(s=new Uint8Array(r*i*4),u=t.UNSIGNED_BYTE,c=t.RGBA):(s=new Float32Array(r*i*4),u=t.FLOAT,c=o.internalFormatPackedFloat),s.set(a),Jt(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,c,r,i,0,t.RGBA,u,s)})),Jt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function Mo(t,e,n,r){Jt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)})),r.data instanceof Uint8Array?Jt(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r.width,r.height,0,t.RGBA,t.UNSIGNED_BYTE,r.data)})):Jt(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)})),Jt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function Eo(t,e,n,r,i){var a=t.createBuffer();Jt(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,a)}));var o=16*n*r;return Jt(t,e,(function(){return t.bufferData(t.PIXEL_PACK_BUFFER,o,t.STREAM_READ)})),Jt(t,e,(function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,0)})),Jt(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,null)})),a}function To(t,e,n){var r=t,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function Co(t,e,n,r,i){var a=Xt(n,r),o=a[0],s=a[1],u=new Uint8Array(n*r*4);return Jt(t,e,(function(){return t.readPixels(0,0,o,s,i.downloadTextureFormat,t.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}function Ao(t,e,n,r,i,a,o,s){var u=t,c=new Float32Array(function(t,e){var n=Yt(t,e);return n[0]*n[1]*4}(a,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}function No(t,e,n,r){var i=new Float32Array(n*r*4);return Jt(t,e,(function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,i)})),i}var Io=Object.freeze({createVertexShader:po,createVertexBuffer:fo,createIndexBuffer:mo,createFloat32MatrixTexture:go,createFloat16MatrixTexture:yo,createUnsignedBytesMatrixTexture:xo,createPackedMatrixTexture:bo,createFloat16PackedMatrixTexture:wo,bindVertexProgramAttributeStreams:_o,uploadDenseMatrixToTexture:So,uploadPixelDataToTexture:Mo,createBufferFromOutputTexture:Eo,downloadFloat32MatrixFromBuffer:To,downloadByteEncodedFloatMatrixFromOutputTexture:Co,downloadPackedMatrixFromBuffer:Ao,downloadMatrixFromPackedOutputTexture:No}),Ro=function(){function t(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var e=p().getNumber("WEBGL_VERSION");null!=t?(this.gl=t,Gt(e,t)):this.gl=qt(e);var n="WEBGL_color_buffer_float";if(1===p().getNumber("WEBGL_VERSION")){if(this.textureFloatExtension=te(this.gl,this.debug,"OES_texture_float"),Le(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=te(this.gl,this.debug,"OES_texture_half_float");else if(p().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),Le(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=te(this.gl,this.debug,"EXT_color_buffer_half_float");else if(p().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",Le(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!Le(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=fo(this.gl,this.debug),this.indexBuffer=mo(this.gl,this.debug),this.framebuffer=fe(this.gl,this.debug),this.textureConfig=Kt(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(t.prototype,"debug",{get:function(){return p().getBool("DEBUG")},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var t=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;Jt(e,this.debug,(function(){return e.finish()})),Jt(e,this.debug,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)})),Jt(e,this.debug,(function(){return e.deleteFramebuffer(t.framebuffer)})),Jt(e,this.debug,(function(){return e.bindBuffer(e.ARRAY_BUFFER,null)})),Jt(e,this.debug,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)})),Jt(e,this.debug,(function(){return e.deleteBuffer(t.indexBuffer)})),this.disposed=!0}},t.prototype.createFloat32MatrixTexture=function(t,e){return this.throwIfDisposed(),go(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createFloat16MatrixTexture=function(t,e){return this.throwIfDisposed(),yo(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createUnsignedBytesMatrixTexture=function(t,e){return this.throwIfDisposed(),xo(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.uploadPixelDataToTexture=function(t,e){this.throwIfDisposed(),Mo(this.gl,this.debug,t,e)},t.prototype.uploadDenseMatrixToTexture=function(t,e,n,r){this.throwIfDisposed(),So(this.gl,this.debug,t,e,n,r,this.textureConfig)},t.prototype.createFloat16PackedMatrixTexture=function(t,e){return this.throwIfDisposed(),wo(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createPackedMatrixTexture=function(t,e){return this.throwIfDisposed(),bo(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.deleteMatrixTexture=function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(be(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Jt(this.gl,this.debug,(function(){return e.gl.deleteTexture(t)}))},t.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return Co(r.gl,r.debug,e,n,r.textureConfig)}))},t.prototype.downloadPackedMatrixFromBuffer=function(t,e,n,r,i,a){return Ao(this.gl,t,0,0,0,i,a,this.textureConfig)},t.prototype.downloadFloat32MatrixFromBuffer=function(t,e){return To(this.gl,t,e)},t.prototype.createBufferFromTexture=function(t,e,n){this.bindTextureToFrameBuffer(t);var r=Eo(this.gl,this.debug,e,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r},t.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},t.prototype.createFence=function(t){var e,n,r=this;if(p().getBool("WEBGL_FENCE_API_ENABLED")){var i=t,a=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=function(){var t=i.clientWaitSync(a,0,0);return t===i.ALREADY_SIGNALED||t===i.CONDITION_SATISFIED},e=a}else p().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(e,p().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:e,isFencePassed:n}},t.prototype.downloadMatrixFromPackedTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return No(r.gl,r.debug,e,n)}))},t.prototype.createProgram=function(t){this.throwIfDisposed();var e=this.gl,n=ne(e,this.debug,t),r=po(e,this.debug),i=oe(e,this.debug);return Jt(e,this.debug,(function(){return e.attachShader(i,r)})),Jt(e,this.debug,(function(){return e.attachShader(i,n)})),se(e,this.debug,i),this.debug&&ue(e,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=_o(e,this.debug,this.program,this.vertexBuffer)),i},t.prototype.deleteProgram=function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&Jt(this.gl,this.debug,(function(){return e.gl.deleteProgram(t)}))},t.prototype.setProgram=function(t){var e=this;this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&ue(this.gl,this.debug,this.program),Jt(this.gl,this.debug,(function(){return e.gl.useProgram(t)}))},t.prototype.getUniformLocation=function(t,e,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?ve(this.gl,this.debug,t,e):ge(this.gl,t,e)},t.prototype.getAttributeLocation=function(t,e){var n=this;return this.throwIfDisposed(),Jt(this.gl,this.debug,(function(){return n.gl.getAttribLocation(t,e)}))},t.prototype.getUniformLocationNoThrow=function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)},t.prototype.setInputMatrixTexture=function(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),ye(this.gl,this.debug,this.program,t,e,n)},t.prototype.setOutputMatrixTexture=function(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)},t.prototype.setOutputPackedMatrixTexture=function(t,e,n){this.throwIfDisposed();var r=Yt(e,n),i=r[0],a=r[1];this.setOutputMatrixTextureDriver(t,i,a)},t.prototype.setOutputMatrixWriteRegion=function(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)},t.prototype.setOutputPackedMatrixWriteRegion=function(t,e,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},t.prototype.debugValidate=function(){null!=this.program&&ue(this.gl,this.debug,this.program),we(this.gl)},t.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),Jt(t,this.debug,(function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)}))},t.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),Jt(this.gl,this.debug,(function(){return t.gl.finish()}))},t.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=te(this.gl,this.debug,2===p().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},t.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},t.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},t.prototype.beginQuery=function(){if(2===p().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),i=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,i),i},t.prototype.endQuery=function(){if(2!==p().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var e=this.gl,n=this.getQueryTimerExtensionWebGL2();e.endQuery(n.TIME_ELAPSED_EXT)}},t.prototype.waitForQueryAndGetTime=function(t){return u(this,void 0,void 0,(function(){var e=this;return c(this,(function(n){switch(n.label){case 0:return[4,P((function(){return e.disposed||e.isQueryAvailable(t,p().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}))];case 1:return n.sent(),[2,this.getQueryTime(t,p().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}}))}))},t.prototype.getQueryTime=function(t,e){if(0===e)return null;if(2===e){var n=this.gl;return n.getQueryParameter(t,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6},t.prototype.isQueryAvailable=function(t,e){if(0===e)return!0;if(2===e){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=n.getQueryParameter(t,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,r.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint},t.prototype.pollFence=function(t){var e=this;return new Promise((function(n){e.addItemToPoll((function(){return t.isFencePassed()}),(function(){return n()}))}))},t.prototype.pollItems=function(){for(var t=function(t){for(var e=0;e<t.length&&t[e]();++e);return e-1}(this.itemsToPoll.map((function(t){return t.isDoneFn}))),e=0;e<=t;++e)(0,this.itemsToPoll[e].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},t.prototype.addItemToPoll=function(t,e){var n=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||P((function(){return n.pollItems(),0===n.itemsToPoll.length}))},t.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),xe(this.gl,this.debug,t,this.framebuffer),this.debug&&we(this.gl)},t.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(xe(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&we(this.gl)):be(this.gl,this.debug,this.framebuffer)},t.prototype.downloadMatrixDriver=function(t,e){this.bindTextureToFrameBuffer(t);var n=e();return this.unbindTextureToFrameBuffer(),n},t.prototype.setOutputMatrixTextureDriver=function(t,e,n){this.throwIfDisposed();var r=this.gl;xe(r,this.debug,t,this.framebuffer),this.debug&&we(r),this.outputTexture=t,Jt(r,this.debug,(function(){return r.viewport(0,0,e,n)})),Jt(r,this.debug,(function(){return r.scissor(0,0,e,n)}))},t.prototype.setOutputMatrixWriteRegionDriver=function(t,e,n,r){var i=this;this.throwIfDisposed(),Jt(this.gl,this.debug,(function(){return i.gl.scissor(t,e,n,r)}))},t.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},t.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},t}();function Oo(t,e){if(t.length!==e.length)throw Error("Binary was compiled with "+t.length+" inputs, but was executed with "+e.length+" inputs");t.forEach((function(t,n){var r=t.logicalShape,i=e[n],a=i.shape;if(!R(r,a))throw Error("Binary was compiled with different shapes than the current args. Shapes "+r+" and "+a+" must match");if(!t.isUniform||!i.isUniform){var o=t.texShape,s=i.isUniform?null:i.texData.texShape;if(!R(o,s))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+o+" and "+s+" must match")}}))}var ko=function(t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var r=n.filterWidth,i=n.inChannels,a=n.strideWidth,o=n.strideHeight,s=n.padInfo,u=n.outWidth,c=n.dilationWidth,l=n.dilationHeight,h=n.dataFormat,p=s.left,f=s.top,d=i*r,m=ua(),v="channelsLast"===h,g=v?0:1,y=v?1:2,x="",b=0;b<=1;b++)for(var w=0;w<=1;w++)x+="\n          blockIndex = rc.y + "+w+";\n          pos = rc.x + "+b+";\n\n          if(blockIndex < "+t[1]+" && pos < "+t[0]+") {\n            offsetY = int(blockIndex / ("+u+")) * "+o+" - "+f+";\n            d0 = offsetY + "+l+" * (pos / "+d+");\n\n            if(d0 < "+e[g]+" && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), "+u+".) * "+a+". - "+p+".);\n              d1 = offsetX + "+c+" * (int(mod(float(pos), "+d+".) / "+i+".));\n\n              if(d1 < "+e[y]+" && d1 >= 0) {\n\n                ch = int(mod(float(pos), "+i+".));\n\n                if ("+v+") {\n                  innerDims = vec2(d1, ch);\n                  result["+(2*b+w)+"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result["+(2*b+w)+"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ";this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        "+x+"\n\n        "+m.output+" = result;\n      }\n    "},Lo=function(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[];var a,o=e,s=t[3]-1;this.outputShape=t;var u="float("+n+") + float("+r+") * sum";a=.5===i?"inversesqrt("+u+")":1===i?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+o+"; j <= "+o+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+s+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+a+";\n        setOutput(val);\n      }\n    "},Do=function(t,e,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+e+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+e+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+r+") * norm + float("+n+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+r+")\n                * float("+i+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+i+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "},Po=function(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var a,o=e,s=t[3]-1;this.outputShape=t;var u="float("+n+") + float("+r+") * sum";a=.5===i?"inversesqrt("+u+")":1===i?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < "+this.outputShape[3]+";\n        bool hasNextRow = c < "+this.outputShape[2]+";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - "+o+";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - "+o+"; j <= "+o+"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2("+s+"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * "+a+";\n        setOutput(result);\n      }\n    "},Fo=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.strideHeight,n=t.strideWidth,r=t.dilationHeight,i=t.effectiveFilterHeight,a=t.effectiveFilterWidth,o=i-1-t.padInfo.top,s=a-1-t.padInfo.left,u=i*a-1;this.userCode="\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+i+";\n          wR += "+r+") {\n          float dyR = float(dyRCorner + wR) / "+e+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+a+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+n+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+u+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+a+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Bo=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,i=t.dilationDepth,a=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterDepth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=s-1-t.padInfo.front,h=u-1-t.padInfo.top,p=c-1-t.padInfo.left,f=s*u*c-1;this.userCode="\n      const ivec3 pads = ivec3("+l+", "+h+", "+p+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+s+";\n           wD += "+i+") {\n          float dyD = float(dyDCorner + wD) / "+e+".0;\n\n          if (dyD < 0.0 || dyD >= "+t.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+a+") {\n            float dyR = float(dyRCorner + wR) / "+n+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+o+") {\n              float dyC = float(dyCCorner + wC) / "+r+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = "+f+" -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * "+u+" * "+c+" +\n                  wR * "+c+" + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},zo=function(t,e,n,r,i,a,o){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===a&&(a=null),void 0===o&&(o=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;var s=n?t[1]:t[2],u=Math.ceil(s/2),c=n?"i * 2, rc.y":"rc.y, i * 2",l=r?"rc.z, i * 2":"i * 2, rc.z",h=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],p=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],f="",d="";a&&(f=o?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+a+"\n        }":"vec4 activation(vec4 x) {\n          "+a+"\n        }",d="result = activation(result);");var m=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+f+"\n\n      const float sharedDimension = "+u+".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+u+"; i++) {\n          vec4 a = getMatrixA(rc.x, "+c+");\n          vec4 b = getMatrixB(rc.x, "+l+");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += ("+h[0]+" * "+p[0]+");\n          result += ("+h[1]+" * "+p[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        "+m+"\n\n        "+d+"\n\n        setOutput(result);\n      }\n    "},Uo=function(){function t(t,e,n){this.variableNames=["probs"],this.outputShape=[t,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(e-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(e-1)+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,r){null==e.seedLoc&&(e.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(e.seedLoc,t)}},t}(),jo=function(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+n+"),\n                      float(index == coords.y)));\n      }\n    "},Wo=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;var e=t.length;if(0===e)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=sa("rc",e),r=xa(e),i=function(t,e,n){if(1===t)return"rc > "+e[0];for(var r="",i=t-2;i<t;i++)r+=n[i]+" >= "+e[i],i<t-1&&(r+="||");return r}(e,t,n),a=function(t,e,n,r){if(1===t)return"";var i=r.slice(-2);return"\n    int r = "+i[0]+";\n    int c = "+i[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+e+";\n    bool rEdge = rp1 >= "+n+";\n  "}(e,t[t.length-1],t[t.length-2],n),o=function(t,e){var n=t.length,r=function(t,e){for(var n=[],r=0;r<=1;r++)for(var i=0;i<=1;i++){for(var a=(0===r?"r":"rp1")+", "+(0===i?"c":"cp1"),o=2;o<t;o++)a=e[e.length-1-o]+","+a;n.push(a)}return n}(n,e);return 1===n?"getA(rc),\n            rc + 1 >= "+t[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+r[0]+"),\n          cEdge ? 0. : getA("+r[1]+"),\n          rEdge ? 0. : getA("+r[2]+"),\n          rEdge || cEdge ? 0. : getA("+r[3]+")"}(t,n);this.userCode="\n        void main() {\n          "+r+" rc = getOutputCoords();\n\n          if("+i+") {\n            setOutput(vec4(0));\n          } else {\n            "+a+"\n\n            setOutput(vec4("+o+"));\n          }\n        }\n      "}},Vo=function(t,e,n){this.variableNames=["x"],this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));var r=t.length,i=xa(r),a=e.map((function(t){return t[0]})).join(","),o=e.map((function(e,n){return e[0]+t[n]})).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      "+i+" start = "+i+"("+a+");\n      "+i+" end = "+i+"("+o+");\n\n      void main() {\n        "+i+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+n+"));\n        } else {\n          "+i+" coords = outC - start;\n          setOutput(getX("+s+"));\n        }\n      }\n    ":"\n        int start = "+a+";\n        int end = "+o+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+n+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "},Ho=function(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));for(var r=t.length,i=xa(r),a=e.map((function(t){return t[0]})).join(","),o=e.map((function(e,n){return e[0]+t[n]})).join(","),s=sa("rc",r),u=sa("source",r),c=s[r-1]+" < "+this.outputShape[r-1],l=1===r?"source":"vec2("+u.slice(-2).join()+")",h=[i+" rc = outputLoc;",s[r-1]+" += 1;\n       if("+c+") {\n      ",1===r?"":"}\n       rc = outputLoc;\n       "+s[r-2]+" += 1;\n       if("+s[r-2]+" < "+this.outputShape[r-2]+") {",1===r?"":"  "+s[r-1]+" += 1;\n         if("+c+") {"],p=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",f="",d=0,m=1===r?2:4;d<m;d++)f+="\n        "+h[d]+"\n        if ("+p+") {\n          result["+d+"] = float("+n+");\n        } else {\n          "+i+" source = rc - start;\n          result["+d+"] = getChannel(getX("+u.join()+"), "+l+");\n        }\n      ";f+=1===r?"} ":"}}",this.userCode="\n      const "+i+" start = "+i+"("+a+");\n      const "+i+" end = "+i+"("+o+");\n\n      void main() {\n        "+i+" outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        "+f+"\n        setOutput(result);\n      }\n    "},Go=function(t,e,n,r,i){if(void 0===r&&(r=!1),void 0===i&&(i=!1),this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");var a=t.filterWidth,o=t.strideHeight,s=t.strideWidth,u=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterHeight,h=t.effectiveFilterWidth,p=t.padInfo.top,f=t.padInfo.left;this.outputShape=t.outShape;var d="avg"===e,m="((batch  * "+t.inHeight+" + xR) * "+t.inWidth+" + xC) * "+t.inChannels+" + d",v="(xR * "+t.inWidth+" + xC) * "+t.inChannels+" + d",g="0.0";if(d||(g="-1.0 / 1e-20"),n)this.userCode="\n        const ivec2 strides = ivec2("+o+", "+s+");\n        const ivec2 pads = ivec2("+p+", "+f+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+l+";\n              wR += "+u+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+h+";\n                wC += "+c+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = "+(r?i?m:v:"wR * "+h+" + wC")+";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var y=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(y="avgValue / count");var x=4*Math.floor(a/4),b=a%4,w="\n      if ("+d+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+o+", "+s+");\n      const ivec2 pads = ivec2("+p+", "+f+");\n      const float initializationValue = "+g+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+t.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+g+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+l+";\n            wR += "+u+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+x+"; wC += 4) {\n            int xC = xCCorner + wC * "+c+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+c+", d),\n              getValue(batch, xR, xC + 2 * "+c+", d),\n              getValue(batch, xR, xC + 3 * "+c+", d)\n            );\n\n            "+w+"\n          }\n\n          int xC = xCCorner + "+x+";\n          if ("+(1===b)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+w+"\n          } else if ("+(2===b)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+c+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+w+"\n          } else if ("+(3===b)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+c+", d),\n              getValue(batch, xR, xC + 2 * "+c+", d),\n              initializationValue\n            );\n\n            "+w+"\n          }\n        }\n        setOutput("+y+");\n      }\n    "}},qo=function(t,e,n,r,i){if(void 0===r&&(r=!1),void 0===i&&(i=!1),this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");var a=t.filterWidth,o=t.strideDepth,s=t.strideHeight,u=t.strideWidth,c=t.dilationDepth,l=t.dilationHeight,h=t.dilationWidth,p=t.effectiveFilterDepth,f=t.effectiveFilterHeight,d=t.effectiveFilterWidth,m=t.padInfo.front,v=t.padInfo.top,g=t.padInfo.left;this.outputShape=t.outShape;var y="avg"===e,x="0.0";if(y||(x="-1.0 / 1e-20"),n)this.userCode="\n        const ivec3 strides =\n            ivec3("+o+", "+s+", "+u+");\n        const ivec3 pads = ivec3("+m+", "+v+", "+g+");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < "+p+";\n              wD += "+c+") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= "+t.inDepth+") {\n              continue;\n            }\n\n            for (int wR = 0; wR < "+f+";\n                wR += "+l+") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= "+t.inHeight+") {\n                continue;\n              }\n\n              for (int wC = 0; wC < "+d+";\n                  wC += "+h+") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= "+t.inWidth+") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = "+(r?i?"(((batch * "+t.inDepth+" + xD) * "+t.inHeight+" + xR) * "+t.inWidth+" + xC) * "+t.inChannels+" + ch":"((xD * "+t.inHeight+" + xR) * "+t.inWidth+" + xC) * "+t.inChannels+" + ch":"wD * "+f+" * "+d+" +\n                      wR * "+d+" + wC")+";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var b=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(b="avgValue / count");var w=4*Math.floor(a/4),_=a%4,S="\n      if ("+y+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec3 strides =\n        ivec3("+o+", "+s+", "+u+");\n      const ivec3 pads = ivec3("+m+", "+v+", "+g+");\n      const float initializationValue = "+x+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= "+t.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+x+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < "+p+";\n            wD += "+c+") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= "+t.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+f+";\n            wR += "+l+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+w+"; wC += 4) {\n              int xC = xCCorner + wC * "+h+";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+h+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+h+", ch),\n                getValue(batch, xD, xR, xC + 3 * "+h+", ch)\n              );\n\n              "+S+"\n            }\n\n            int xC = xCCorner + "+w+";\n            if ("+(1===_)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              "+S+"\n            } else if ("+(2===_)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+h+", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              "+S+"\n            } else if ("+(3===_)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+h+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+h+", ch),\n                initializationValue\n              );\n\n              "+S+"\n            }\n          }\n          setOutput("+b+");\n        }\n      }\n    "}},Xo=function(t,e){this.variableNames=["x"];var n=t.windowSize,r=t.batchSize,i=t.inSize,a=Math.ceil(i/n);this.outputShape=[r,a];var o="0.0",s="";"prod"===e?o="1.0":"min"===e?(o="1.0 / 1e-20",s="min"):"max"===e&&(o="-1.0 / 1e-20",s="max");var u=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===e?u="sumValue":"prod"===e?u="prodValue":"all"===e?u="allValue":"any"===e&&(u="anyValue");var c=4*Math.floor(n/4),l=n%4,h="\n      if ("+("sum"===e)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===e)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+s+"(values, minMaxValue);\n      }\n    ",p="vec4";"all"===e?(o="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",p="bvec4"):"any"===e&&(o="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",p="bvec4");var f="";i%n>0&&(f="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+o+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+f+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        vec4 minMaxValue = vec4("+o+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+c+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+p+" values = "+p+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+h+"\n        }\n\n        int inIdx = inOffset + "+c+";\n        if ("+(1===l)+") {\n          "+p+" values = "+p+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+h+"\n        } else if ("+(2===l)+") {\n          "+p+" values = "+p+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+h+"\n        } else if ("+(3===l)+") {\n          "+p+" values = "+p+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+h+"\n        }\n        setOutput("+u+");\n      }\n    "},$o=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var n="",r=0;r<4;r++){var i="thisRC = rc;";r%2==1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),n+="\n        "+i+"\n        "+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+r+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(r>0?"}":"")+"\n      "}this.userCode="\n      \n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+ca(["r","c","d"],e)+"\n      return ivec3(r, c, d);\n    }\n  \n      "+la(t)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+t[1]+";\n        int cols = "+t[2]+";\n\n        "+n+"\n\n        setOutput(result);\n      }\n    "},Yo=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],a=r[2],o=t.shape,s=o[1],u=o[2],c=[n&&s>1?i-1:i,n&&u>1?a-1:a],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],h=c[0]/l[0],p=c[1]/l[1],f=1/h,d=1/p,m=2*Math.ceil(f)+2,v=2*Math.ceil(d)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+h+");\n        const float widthScale = float("+p+");\n\n        const float invHeightScale = float("+f+");\n        const float invWidthScale = float("+d+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+v+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(i-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(a-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},Ko=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var i=t[0],a=t[1],o=t[2],s=t[3];this.outputShape=[i,e,n,s];var u=[r&&e>1?a-1:a,r&&n>1?o-1:o],c=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+a+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "},Jo=function(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var i=t[0],a=t[1],o=t[2],s=t[3];this.outputShape=[i,e,n,s];var u=[r&&e>1?a-1:a,r&&n>1?o-1:o],c=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+",\n          "+u[1]/c[1]+");\n      const vec3 inputShapeRC = vec3("+a+".0, "+o+".0,\n                                     "+o+".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < "+(s-1)+";\n        bool hasNextRow = coords.z < "+(n-1)+";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    "},Zo=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],a=r[2],o=t.shape,s=o[1],u=o[2],c=[n&&s>1?i-1:i,n&&u>1?a-1:a],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],h=c[0]/l[0],p=c[1]/l[1],f=1/h,d=1/p,m=2*Math.ceil(f)+2,v=2*Math.ceil(d)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+h+");\n        const float widthScale = float("+p+");\n\n        const float invHeightScale = float("+f+");\n        const float invWidthScale = float("+d+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+v+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+c[0]+") *\n                (float(dyR) / float("+l[0]+"));\n\n            float sourceFracCol =\n                float("+c[1]+") *\n                  (float(dyC) / float("+l[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+i+") - 1),\n                "+n+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+a+") - 1),\n                "+n+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},Qo=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var i=t[0],a=t[1],o=t[2],s=t[3];this.outputShape=[i,e,n,s];var u=[r&&e>1?a-1:a,r&&n>1?o-1:o],c=[r&&e>1?e-1:e,r&&n>1?n-1:n],l=r?"0.5":"0.0";this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+a+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+l+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "},ts=function(t,e){this.variableNames=["x"];var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=t,1!==n){var r=t.map((function(n,r){return function(n){return-1!==e.indexOf(n)&&1!==t[n]?t[n]+" - coords["+n+"] - 1":"coords["+n+"]"}(r)})).join(","),i=xa(n);this.userCode="\n      void main() {\n        "+i+" coords = getOutputCoords();\n        setOutput(getX("+r+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+t[0]+" - coord - 1));\n        }\n      "},es=function(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=t;var r=sa("rc",n),i=r[n-1]+" + 1 < "+this.outputShape[n-1],a=r[n-2]+" + 1 < "+this.outputShape[n-2],o=xa(n);function s(n){var r=t.map((function(r,i){return function(n,r){return-1!==e.indexOf(n)&&1!==t[n]?t[n]+" - "+r[n]+" - 1":""+r[n]}(i,n)}));return"getChannel(getX("+r.join(",")+"), vec2("+r.slice(-2).join(",")+"))"}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX("+t[0]+" - rc - 1),\n            "+t[0]+" - rc - 1);\n          if("+i+"){\n              result.g = getChannel(getX("+t[0]+" - (rc  + 1) - 1),\n                "+t[0]+" - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      ":"\n        void main() {\n          "+o+" rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = "+function(t){return s(t)}(r.slice())+";\n          if("+i+"){\n            result.g = "+function(t){return t[n-1]="("+t[n-1]+" + 1)",s(t)}(r.slice())+";\n          }\n          if("+a+") {\n            result.b = "+function(t){return t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice())+";\n            if("+i+") {\n              result.a = "+function(t){return t[n-1]="("+t[n-1]+" + 1)",t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice())+";\n            }\n          }\n          setOutput(result);\n        }\n    "},ns=function(t,e,n,r,i,a,o){void 0===o&&(o=!0),this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;var s=xa(i.length),u=xa(a.length),c="";1===n?c="i":2===n&&(c="i, j");var l="getIndices("+c+")",h="";1===r?h="i":2===r&&(h="i, coords[1]");var p="getUpdates("+h+")",f=e>1?"strides[j]":"strides";this.userCode="\n        "+s+" strides = "+s+"("+i+");\n\n        void main() {\n          "+u+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+t+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+e+"; j++) {\n              int index = round("+l+");\n              flattenedIndex += index * "+f+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += "+p+";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "},rs=function(t,e){this.variableNames=["x","segmentIds"];var n=t.windowSize,r=t.batchSize,i=t.inSize,a=t.numSegments,o=a*Math.ceil(i/n);this.outputShape=[r,o];var s=4*Math.floor(n/4),u=n%4,c="\n        sumValue += dot(values, segFilter);\n    ",l="";i%n>0&&(l="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return initializationValue;\n        }\n      ");var h="";i%n>0&&(h="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+l+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+h+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+a+")) * float("+n+"));\n        int currentSeg = int(mod(float(outIdx), float("+a+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+s+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+c+"\n        }\n\n        int inIdx = inOffset + "+s+";\n        if ("+(1===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+c+"\n        } else if ("+(2===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+c+"\n        } else if ("+(3===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+c+"\n        }\n        setOutput(sumValue);\n      }\n    "},is=function(t,e,n){var r,i;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error("Where for rank "+n+" is not yet supported");if(1===n)i="resRC",r="resRC";else{for(var a=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],s=[],u=0;u<e.length;u++)s.push(""+a[u]),u<t&&o.push(""+a[u]);r=o.join(),i=s.join()}var c=xa(n);this.userCode="\n      void main() {\n        "+c+" resRC = getOutputCoords();\n        float cVal = getC("+r+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+i+"));\n        } else {\n          setOutput(getB("+i+"));\n        }\n      }\n    "},as=function(){function t(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var e,n=xa(this.rank),r="uniform int start["+this.rank+"];",i=function(t){if(1===t)return"sourceLoc";if(t<=6)return os.slice(0,t).map((function(t){return"sourceLoc."+t})).join(",");throw Error("Slicing for rank "+t+" is not yet supported")}(this.rank);e="\n        "+n+" sourceLoc;\n        "+n+" coords = getOutputCoords();\n        "+t.map((function(t,e){return"sourceLoc."+os[e]+" = start["+e+"] + coords."+os[e]+";"})).join("\n")+"\n      ",this.userCode="\n      "+r+"\n      void main() {\n        "+e+"\n        setOutput(getSource("+i+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,"start"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}},t}(),os=["x","y","z","w","u","v"],ss=function(){function t(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var e=xa(this.rank),n=sa("coords",this.rank),r=sa("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2("+r.slice(-2).join()+")",a="getChannel(getSource("+r.join()+"), "+i+")",o="\n      result.x = "+a+";\n      if (++"+n[this.rank-1]+" < "+t[this.rank-1]+") {\n        ++"+r[this.rank-1]+";\n        result.y = "+a+";\n        --"+r[this.rank-1]+";\n      }\n    ",s=1===this.rank?"":"\n      --"+n[this.rank-1]+";\n      if (++"+n[this.rank-2]+" < "+t[this.rank-2]+") {\n        ++"+r[this.rank-2]+";\n        result.z = "+a+";\n        if (++"+n[this.rank-1]+" < "+t[this.rank-1]+") {\n          ++"+r[this.rank-1]+";\n          result.w = "+a+";\n        }\n      }\n    ",u=this.rank<=4?"sourceLoc = coords +\n            "+e+"("+t.map((function(t,e){return"start["+e+"]"})).join()+");":t.map((function(t,e){return r[e]+" = "+n[e]+" + start["+e+"];"})).join("\n");this.userCode="\n      uniform int start["+this.rank+"];\n      void main() {\n        "+e+" coords = getOutputCoords();\n        "+e+" sourceLoc;\n        "+u+"\n        vec4 result = vec4(0.);\n        "+o+"\n        "+s+"\n        setOutput(result);\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,"start"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}},t}(),us=function(t,e,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,i=xa(n.length),a=xa(n.length),o="";if(1===r)o="coords * strides + begin";else{var s=0;o=n.map((function(t,e){return s++,1===n.length?"coords * strides["+e+"] + begin["+e+"]":"coords["+(s-1)+"] * strides["+e+"] + begin["+e+"]"})).join(",")}this.userCode="\n      "+i+" begin = "+i+"("+t+");\n      "+i+" strides = "+i+"("+e+");\n\n      void main() {\n        "+a+" coords = getOutputCoords();\n        setOutput(getX("+o+"));\n      }\n    "},cs=function(){function t(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return t.prototype.acquireTexture=function(t,e,n){var r,i=ls(e,n),a=hs(t,i,n);if(a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]),this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var o=this.freeTextures[a].shift();return this.usedTextures[a].push(o),o}return this.numUsedTextures++,this.log(),i===Wt.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===Wt.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===Wt.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===Wt.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===Wt.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[a].push(r),r},t.prototype.releaseTexture=function(t,e,n,r){if(null!=this.freeTextures){var i=hs(e,ls(n,r),r);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var a=this.usedTextures[i],o=a.indexOf(t);if(o<0)throw new Error("Cannot release a texture that was never provided by this texture manager");a.splice(o,1),this.log()}},t.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},t.prototype.getNumUsedTextures=function(){return this.numUsedTextures},t.prototype.getNumFreeTextures=function(){return this.numFreeTextures},t.prototype.dispose=function(){var t=this;if(null!=this.freeTextures){for(var e in this.freeTextures)this.freeTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));for(var e in this.usedTextures)this.usedTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},t}();function ls(t,e){if(t===jt.UPLOAD)return Wt.PACKED_2X2_FLOAT32;if(t===jt.RENDER||null==t)return function(t){return p().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Wt.PACKED_2X2_FLOAT32:Wt.UNPACKED_FLOAT32:t?Wt.PACKED_2X2_FLOAT16:Wt.UNPACKED_FLOAT16}(e);if(t===jt.DOWNLOAD||t===jt.PIXELS)return Wt.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+t)}function hs(t,e,n){return t[0]+"_"+t[1]+"_"+e+"_"+n}var ps=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[r]*e[r];this.outputShape=n,this.rank=n.length;var i=xa(this.rank),a=function(t){var e=t.length;if(e>5)throw Error("Tile for rank "+e+" is not yet supported");if(1===e)return"imod(resRC, "+t[0]+")";for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],i=0;i<t.length;i++)r.push("imod("+n[i]+", "+t[i]+")");return r.join()}(t);this.userCode="\n      void main() {\n        "+i+" resRC = getOutputCoords();\n        setOutput(getA("+a+"));\n      }\n    "},fs=1.7580993408473768,ds=1.0507009873554805,ms=function(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      float unaryOperation(float x) {\n        "+e+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},vs="if (isnan(x)) return x;",gs="return abs(x);",ys=vs+"\n  return (x < 0.0) ? 0.0 : x;\n",xs=vs+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",bs="return (x >= 0.0) ? x : (exp(x) - 1.0);",ws="return -x;",_s="return ceil(x);",Ss="return floor(x);",Ms="return exp(x);",Es="return exp(x) - 1.0;",Ts="return x;",Cs="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",As="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Ns="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",Is=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        "+e+"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},Rs=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;var e=t.length,n=sa("rc",e),r=xa(e),i=function(t,e){if(1===t)return"rc";for(var n="",r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}(e,n),a=n.slice(-2),o=e<=1?"rc":"vec2("+a.join(",")+")";this.userCode="\n      void main() {\n        "+r+" rc = getOutputCoords();\n        vec4 packedInput = getA("+i+");\n\n        setOutput(getChannel(packedInput, "+o+"));\n      }\n    "},Os={};function ks(t,e){if(void 0===e&&(e=!1),"linear"===t)return"return x;";if("relu"===t)return e?Cs:ys;if("elu"===t)return e?Ns:bs;if("relu6"===t)return e?As:xs;if("prelu"===t)return e?ka:Ra;throw new Error("Activation "+t+" has not been implemented for the WebGL backend.")}var Ls=function(t){function e(e){var n,r=t.call(this)||this;if(r.pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.warnedAboutMemory=!1,r.pendingDeletes=0,r.disposed=!1,!p().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==e){var i=qt(p().getNumber("WEBGL_VERSION"));r.binaryCache=((n=p().getNumber("WEBGL_VERSION"))in Os||(Os[n]={}),Os[n]),r.gpgpu=new Ro(i),r.canvas=i.canvas,r.gpgpuCreatedLocally=!0}else r.gpgpu=e,r.binaryCache={},r.gpgpuCreatedLocally=!1,r.canvas=e.gl.canvas;return r.textureManager=new cs(r.gpgpu),r.numMBBeforeWarning=null==p().global.screen?1024:p().global.screen.height*p().global.screen.width*window.devicePixelRatio*600/1024/1024,r.texData=new _i(r,Ft),r}return s(e,t),e.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},e.prototype.write=function(t,e,n){if(p().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===n&&null!=t)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={};return this.texData.set(r,{shape:e,dtype:n,values:t,usage:jt.UPLOAD}),r},e.prototype.move=function(t,e,n,r){if(p().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:n,dtype:r,values:e,usage:jt.UPLOAD})},e.prototype.readSync=function(t){var e=this.texData.get(t),n=e.values,r=e.dtype,i=e.complexTensors,a=e.slice,o=e.shape,s=e.isPacked;if(null!=a){var u;u=s?new Is(o,Ts):new ms(o,Ts);var c=this.runWebGLProgram(u,[{dataId:t,shape:o,dtype:r}],r),l=this.readSync(c.dataId);return this.disposeData(c.dataId),l}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===r)return n;var h,p,f=null!=this.activeTimers;return f&&(h=at()),p="complex64"===r?ji(i.real.dataSync(),i.imag.dataSync()):this.getValuesFromTexture(t),f&&(this.downloadWaitMs+=at()-h),this.convertAndCacheOnCPU(t,p)},e.prototype.read=function(t){return u(this,void 0,void 0,(function(){var e,n,r,i,a,o,s,u,l,h,f,d,m,v,g,y,x,b,w,_,S,M;return c(this,(function(c){switch(c.label){case 0:if(this.pendingRead.has(t))return e=this.pendingRead.get(t),[2,new Promise((function(t){return e.push(t)}))];if(n=this.texData.get(t),r=n.values,i=n.shape,a=n.slice,o=n.dtype,s=n.complexTensors,u=n.isPacked,null!=a)return void 0,l=u?new Is(i,Ts):new ms(i,Ts),h=this.runWebGLProgram(l,[{dataId:t,shape:i,dtype:o}],o),f=this.read(h.dataId),this.disposeData(h.dataId),[2,f];if(null!=r)return[2,this.convertAndCacheOnCPU(t)];if(!p().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===p().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return d=null,"complex64"!==o&&p().get("WEBGL_BUFFER_SUPPORTED")&&(m=this.decode(t),v=this.texData.get(m.dataId),d=(M=this.gpgpu).createBufferFromTexture.apply(M,[v.texture].concat($t(i)))),this.pendingRead.set(t,[]),"complex64"===o?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:c.sent(),c.label=2;case 2:return"complex64"!==o?[3,4]:[4,Promise.all([s.real.data(),s.imag.data()])];case 3:return y=c.sent(),x=y[0],b=y[1],g=ji(x,b),[3,5];case 4:null==d?g=this.getValuesFromTexture(t):(w=I(i),g=this.gpgpu.downloadFloat32MatrixFromBuffer(d,w)),c.label=5;case 5:return null!=m&&this.disposeData(m.dataId),_=this.convertAndCacheOnCPU(t,g),S=this.pendingRead.get(t),this.pendingRead.delete(t),S.forEach((function(t){return t(_)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),[2,_]}}))}))},e.prototype.checkNumericalProblems=function(t){if(null!=t)for(var e=0;e<t.length;e++){var n=t[e];if(!Zt(n)){if(p().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value "+n+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value "+n+" cannot be represented on this device.")}}},e.prototype.getValuesFromTexture=function(t){var e,n=this.texData.get(t),r=n.shape,i=n.dtype,a=n.isPacked,o=I(r);if(p().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var s=this.decode(t),u=this.texData.get(s.dataId),c=(e=this.gpgpu).downloadMatrixFromPackedTexture.apply(e,[u.texture].concat($t(r))).subarray(0,o);return this.disposeData(s.dataId),c}var l=p().getBool("WEBGL_PACK")&&!0===a,h=l?Ce(r):r,f=l?new ao(h):new io(h),d=this.runWebGLProgram(f,[{shape:h,dtype:i,dataId:t}],"float32"),m=this.texData.get(d.dataId),v=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(m.texture,m.texShape[0],m.texShape[1]).subarray(0,o);return this.disposeData(d.dataId),v},e.prototype.time=function(t){return u(this,void 0,void 0,(function(){var e,n,r,i,a,o,s;return c(this,(function(u){switch(u.label){case 0:return e=this.activeTimers,n=[],r=!1,null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,t(),i=N(this.activeTimers.map((function(t){return t.query}))).filter((function(t){return null!=t})),a=N(this.activeTimers.map((function(t){return t.name}))).filter((function(t){return null!=t})),this.activeTimers=e,r&&(this.programTimersStack=null),o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},p().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(i)]:[3,2];case 1:return s=u.sent(),o.kernelMs=E(s),o.getExtraProfileInfo=function(){return s.map((function(t,e){return{name:a[e],ms:t}})).map((function(t){return t.name+": "+t.ms})).join(", ")},[3,3];case 2:o.kernelMs={error:"WebGL query timers are not supported in this environment."},u.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,o]}}))}))},e.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},e.prototype.startTimer=function(){return p().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:at(),endMs:null}},e.prototype.endTimer=function(t){return p().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=at(),t)},e.prototype.getQueryTime=function(t){return u(this,void 0,void 0,(function(){var e;return c(this,(function(n){return p().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(t)]:[2,(e=t).endMs-e.startMs]}))}))},e.prototype.disposeData=function(t){if(!this.pendingDisposal.has(t)){if(this.pendingRead.has(t))return this.pendingDisposal.add(t),void this.pendingDeletes++;if(this.texData.has(t)){this.releaseGPUData(t);var e=this.texData.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.texData.delete(t)}}},e.prototype.releaseGPUData=function(t){var e=this.texData.get(t),n=e.texture,r=e.dtype,i=e.texShape,a=e.usage,o=e.isPacked,s=e.slice,u=s&&s.origDataId||t,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(i,r),this.textureManager.releaseTexture(n,i,a,o)));var l=this.texData.get(t);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null},e.prototype.getTexture=function(t){return this.uploadToGPU(t),this.texData.get(t).texture},e.prototype.getDataInfo=function(t){return this.texData.get(t)},e.prototype.getCPUBackend=function(){return p().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=Ft.findBackend("cpu")),this.cpuBackend):null},e.prototype.shouldExecuteOnCPU=function(t,e){var n=this;return void 0===e&&(e=128),null!=this.getCPUBackend()&&t.every((function(t){return null==n.texData.get(t.dataId).texture&&I(t.shape)<e}))},e.prototype.getGPGPUContext=function(){return this.gpgpu},e.prototype.complex=function(t,e){var n=this.makeOutput(t.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:Ft.keep(t.clone()),imag:Ft.keep(e.clone())},n},e.prototype.real=function(t){return this.texData.get(t.dataId).complexTensors.real.clone()},e.prototype.imag=function(t){return this.texData.get(t.dataId).complexTensors.imag.clone()},e.prototype.slice=function(t,e,n){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.slice(t,e,n);if(0===I(n))return dn([],n,t.dtype);var r=this.texData.get(t.dataId).isPacked,i=mi(t.shape,e,n);if(r||!i){var a=p().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ss(n):new as(n),o=a.getCustomSetupFunc(e);return this.compileAndRun(a,[t],null,o)}return this.uploadToGPU(t.dataId),this.shallowSlice(t,e,n)},e.prototype.shallowSlice=function(t,e,n){var r=this.texData.get(t.dataId),i=this.makeOutput(n,t.dtype),a=this.texData.get(i.dataId);Object.assign(a,r),a.shape=n,a.dtype=t.dtype;var o=vi(e,t.strides);r.slice&&(o+=r.slice.flatOffset),a.slice={flatOffset:o,origDataId:r.slice&&r.slice.origDataId||t.dataId};var s=this.dataRefCount.get(a.slice.origDataId)||1;return this.dataRefCount.set(a.slice.origDataId,s+1),i},e.prototype.stridedSlice=function(t,e,n,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.stridedSlice(t,e,n,r);var i=pi(e,n,r);if(i.some((function(t){return 0===t})))return dn([],i);var a=new us(e,r,i);return this.compileAndRun(a,[t])},e.prototype.reverse=function(t,e){var n=p().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new es(t.shape,e):new ts(t.shape,e);return this.compileAndRun(n,[t])},e.prototype.concat=function(t,e){if("complex64"===t[0].dtype){var n=t.map((function(t){return pn(t)})),r=t.map((function(t){return fn(t)}));return hn(this.concat(n,e),this.concat(r,e))}if(this.shouldExecuteOnCPU(t))return this.cpuBackend.concat(t,e);if(1===t.length)return t[0];if(t.length>p().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var i=Math.floor(t.length/2),a=this.concat(t.slice(0,i),e),o=this.concat(t.slice(i),e);return this.concat([a,o],e)}if(p().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].rank>1){var s=new za(t.map((function(t){return t.shape})),e);return this.compileAndRun(s,t)}var u=cn(t.map((function(t){return t.shape})),e),c=t.map((function(t){return t.as2D(-1,I(t.shape.slice(e)))})),l=new Ba(c.map((function(t){return t.shape})));return this.compileAndRun(l,c).reshape(u)},e.prototype.neg=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.neg(t);if(p().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,ws,t.dtype);var e=new ms(t.shape,ws);return this.compileAndRun(e,[t])},e.prototype.batchMatMul=function(t,e,n,r){var i=n?t.shape[2]:t.shape[1],a=r?e.shape[1]:e.shape[2],o=n?t.shape[1]:t.shape[2],s=t.shape[0];if((1===i||1===a)&&o>1e3){n&&(t=wi(t,[0,2,1])),r&&(e=wi(e,[0,2,1]));var u=1===a?t:t.as3D(s,o,1),c=1===a?2:1,l=1===a?e.as3D(s,1,o):e;return this.multiply(u,l).sum(c,!0)}var h=Nt(t.dtype,e.dtype),p=new zo(t.shape,[s,i,a],n,r);return this.compileAndRun(p,[t,e],h)},e.prototype.fusedBatchMatMul=function(t){var e=t.a,n=t.b,r=t.transposeA,i=t.transposeB,a=t.bias,o=t.activation,s=t.preluActivationWeights,u=r?e.shape[2]:e.shape[1],c=i?n.shape[1]:n.shape[2],l=e.shape[0],h=Nt(e.dtype,n.dtype),p=null!=a,f=null!=s,d=o?ks(o,!0):null,m=new zo(e.shape,[l,u,c],r,i,p,d,f),v=[e,n];return a&&v.push(a),s&&v.push(s),this.compileAndRun(m,v,h)},e.prototype.multiply=function(t,e){if("complex64"===t.dtype){var n=this.texData.get(t.dataId),r=this.texData.get(e.dataId),i=new Ca("return areal * breal - aimag * bimag;",t.shape,e.shape),a=new Ca("return areal * bimag + aimag * breal;",t.shape,e.shape),o=[this.makeComplexComponentTensorInfo(t,n.complexTensors.real),this.makeComplexComponentTensorInfo(t,n.complexTensors.imag),this.makeComplexComponentTensorInfo(e,r.complexTensors.real),this.makeComplexComponentTensorInfo(e,r.complexTensors.imag)],s=this.compileAndRun(i,o),u=this.compileAndRun(a,o),c=this.complex(s,u);return s.dispose(),u.dispose(),c}if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.multiply(t,e);if(p().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,Ia,t.dtype);var l=new Oa(Ia,t.shape,e.shape);return this.compileAndRun(l,[t,e],t.dtype)},e.prototype.batchNormalization=function(t,e,n,r,i,a){var o=[t,e,n],s=null;null!=a&&(s=a.shape,o.push(a));var u=null;if(null!=i&&(u=i.shape,o.push(i)),p().getBool("WEBGL_PACK_NORMALIZATION")){var c=new Ta(t.shape,e.shape,n.shape,s,u,r);return this.compileAndRun(c,o)}var l=new Ea(t.shape,e.shape,n.shape,s,u,r);return this.compileAndRun(l,o)},e.prototype.localResponseNormalization4D=function(t,e,n,r,i){var a=p().getBool("WEBGL_PACK_NORMALIZATION")?new Po(t.shape,e,n,r,i):new Lo(t.shape,e,n,r,i);return this.compileAndRun(a,[t])},e.prototype.LRNGrad=function(t,e,n,r,i,a,o){var s=new Do(e.shape,r,i,a,o);return this.compileAndRun(s,[e,n,t])},e.prototype.tile=function(t,e){if("string"===t.dtype){var n=this.readSync(t.dataId).map((function(t){return ut(t)}));return ta(Ln(t.shape,t.dtype,n),e)}var r=new ps(t.shape,e);return this.compileAndRun(r,[t])},e.prototype.pad=function(t,e,n){var r=p().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ho(t.shape,e,n):new Vo(t.shape,e,n);return this.compileAndRun(r,[t])},e.prototype.gather=function(t,e,n){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.gather(t,e,n);var r=new lo(t.shape,e.size,n);return this.compileAndRun(r,[t,e])},e.prototype.batchToSpaceND=function(t,e,n){T(t.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var r=e.reduce((function(t,e){return t*e})),i=qn(t.shape,e,r),a=Xn(i.length,e.length),o=$n(t.shape,e,r),s=Yn(n,e.length),u=Kn(o,n,e.length);return wi(t.reshape(i),a).reshape(o).slice(s,u)},e.prototype.spaceToBatchND=function(t,e,n){T(t.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var r=e.reduce((function(t,e){return t*e})),i=[[0,0]];i.push.apply(i,n);for(var a=1+e.length;a<t.shape.length;++a)i.push([0,0]);var o=t.pad(i),s=qn(o.shape,e,r,!1),u=Xn(s.length,e.length,!1),c=$n(o.shape,e,r,!1);return wi(o.reshape(s),u).reshape(c)},e.prototype.reduce=function(t,e,n){var r=t.shape[0],i=t.shape[1],a=ai(i),o=new Xo({windowSize:a,inSize:i,batchSize:r},e),s=this.compileAndRun(o,[t],n);return 1===s.shape[1]?s:this.reduce(s,e,n)},e.prototype.argReduce=function(t,e,n){void 0===n&&(n=null);var r=t.shape[0],i=t.shape[1];null!=n&&(r=n.shape[0],i=n.shape[1]);var a=ai(i),o=new aa({windowSize:a,inSize:i,batchSize:r},e,null==n),s=[t];null!=n&&s.push(n);var u=this.compileAndRun(o,s,"int32");return 1===u.shape[1]?u:this.argReduce(t,e,u)},e.prototype.argReducePacked=function(t,e,n){void 0===n&&(n=null);var r=null!=n?n.shape:t.shape,i=ai(r[r.length-1]),a=new _a(r,i,e,null==n),o=null==n?[t]:[t,n],s=this.compileAndRun(a,o,"int32");return s.rank===t.rank?this.argReducePacked(t,e,s):s},e.prototype.sum=function(t,e){rn("sum",e,t.rank);var n=en(t.shape,e),r=n[0],i=I(n[1]),a=t.as2D(-1,i),o=It(t.dtype);return this.reduce(a,"sum",o).reshape(r)},e.prototype.prod=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.prod(t,e);var n=en(t.shape,e),r=n[0],i=I(n[1]),a=t.as2D(-1,i),o=It(t.dtype);return this.reduce(a,"prod",o).reshape(r)},e.prototype.unsortedSegmentSum=function(t,e,n){var r=0,i=an([r],t.rank),a=t;null!=i&&(a=wi(t,i),r=sn(1,t.rank)[0]);var o=function(t,e,n){for(var r=[],i=t.length,a=0;a<i;a++)a!==e?r.push(t[a]):r.push(n);return r}(a.shape,r,n),s=I([a.shape[r]]),u=a.as2D(-1,s),c=It(t.dtype),l=this.segOpCompute(u,"unsortedSegmentSum",e,c,n).reshape(o);return null!=i&&(l=wi(l,on(i))),l},e.prototype.segOpCompute=function(t,e,n,r,i){var a=t.shape[0],o=t.shape[1],s=function(t,e){var n,r=!1;for(t<=30?(n=t,r=!0):n=Q(t,Math.floor(Math.sqrt(t)));!r;)n>e||n===t?r=!0:n=Q(t,n+1);return n}(o,i),u=new rs({windowSize:s,inSize:o,batchSize:a,numSegments:i},e),c=this.compileAndRun(u,[t,n],r);return c.shape[1]===i?c:(n=En(0,i).tile([o/s]),this.segOpCompute(c,e,n,r,i))},e.prototype.argMinMaxReduce=function(t,e,n){var r=[e];if(rn("arg"+n.charAt(0).toUpperCase()+n.slice(1),r,t.rank),!p().getBool("WEBGL_PACK_REDUCE")||t.rank<=2){var i=en(t.shape,r),a=i[0],o=I(i[1]),s=t.as2D(-1,o);return this.argReduce(s,n).reshape(a)}return this.argReducePacked(t,n)},e.prototype.argMin=function(t,e){return this.argMinMaxReduce(t,e,"min")},e.prototype.argMax=function(t,e){return this.argMinMaxReduce(t,e,"max")},e.prototype.cumsum=function(t,e,n,r){if(e!==t.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(t.rank-1)+" but got axis="+e);var i=new Za(t.shape,n,r);return this.compileAndRun(i,[t])},e.prototype.equal=function(t,e){if(p().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(equal(a, b));\n","bool");var n=new Oa("return float(a == b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.notEqual=function(t,e){if(p().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(notEqual(a, b));\n","bool");var n=new Oa("return float(a != b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.less=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.less(t,e);if(p().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThan(a, b));\n","bool");var n=new Oa("return float(a < b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.lessEqual=function(t,e){if(p().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThanEqual(a, b));\n","bool");var n=new Oa("return float(a <= b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.greater=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.greater(t,e);if(p().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThan(a, b));\n","bool");var n=new Oa("return float(a > b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.greaterEqual=function(t,e){if(p().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var n=new Oa("return float(a >= b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.logicalNot=function(t){var e=new ms(t.shape,"return float(!(x >= 1.0));");return this.compileAndRun(e,[t])},e.prototype.logicalAnd=function(t,e){if(p().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var n=new Oa("return float(a >= 1.0 && b >= 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.logicalOr=function(t,e){if(p().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var n=new Oa("return float(a >= 1.0 || b >= 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.select=function(t,e,n){var r=new is(t.rank,e.shape,e.rank);return this.compileAndRun(r,[t,e,n],Nt(e.dtype,n.dtype))},e.prototype.where=function(t){$e("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var e=t.dataSync();return na(t.shape,e)},e.prototype.topk=function(t,e,n){return ea(t.dataSync(),t.shape,t.dtype,e)},e.prototype.min=function(t,e){rn("min",e,t.rank);var n=en(t.shape,e),r=n[0],i=I(n[1]),a=t.as2D(-1,i);return this.reduce(a,"min",a.dtype).reshape(r)},e.prototype.minimum=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.minimum(t,e);var n=p().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new La("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new Oa("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.mod=function(t,e){var n=p().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new La("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new Oa("if (b == 0.0) return NAN;\n  return mod(a, b);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.max=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.max(t,e);rn("max",e,t.rank);var n=en(t.shape,e),r=n[0],i=I(n[1]),a=t.as2D(-1,i);return this.reduce(a,"max",a.dtype).reshape(r)},e.prototype.maximum=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.maximum(t,e);var n=p().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new La("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new Oa("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.all=function(t,e){rn("all",e,t.rank);var n=en(t.shape,e),r=n[0],i=I(n[1]),a=t.as2D(-1,i);return this.reduce(a,"all",a.dtype).reshape(r)},e.prototype.any=function(t,e){rn("any",e,t.rank);var n=en(t.shape,e),r=n[0],i=I(n[1]),a=t.as2D(-1,i);return this.reduce(a,"any",a.dtype).reshape(r)},e.prototype.floorDiv=function(t,e){if(p().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var n=new Oa("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",t.shape,e.shape);return this.compileAndRun(n,[t,e],"int32")},e.prototype.add=function(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,Aa);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.add(t,e);var n=Nt(t.dtype,e.dtype);if(p().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,Aa,n);var r=new Oa(Aa,t.shape,e.shape);return this.compileAndRun(r,[t,e],n)},e.prototype.packedUnaryOp=function(t,e,n){var r=new Is(t.shape,e);return this.compileAndRun(r,[t],n)},e.prototype.packedBinaryOp=function(t,e,n,r,i){void 0===i&&(i=!1);var a=new La(n,t.shape,e.shape,i);return this.compileAndRun(a,[t,e],r)},e.prototype.complexSeparableBinaryOp=function(t,e,n){var r=this,i=this.texData.get(t.dataId),a=this.texData.get(e.dataId),o=[[i.complexTensors.real,a.complexTensors.real],[i.complexTensors.imag,a.complexTensors.imag]].map((function(i){var a=i[0],o=i[1],s=r.makeComplexComponentTensorInfo(t,a),u=r.makeComplexComponentTensorInfo(e,o),c=new Oa(n,t.shape,e.shape);return r.compileAndRun(c,[s,u],Nt(a.dtype,o.dtype))})),s=o[0],u=o[1],c=this.complex(s,u);return s.dispose(),u.dispose(),c},e.prototype.makeComplexComponentTensorInfo=function(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}},e.prototype.addN=function(t){if(1===t.length)return t[0];if(t.length>p().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var e=Math.floor(t.length/2),n=this.addN(t.slice(0,e)),r=this.addN(t.slice(e));return this.addN([n,r])}var i=t.map((function(t){return t.dtype})).reduce((function(t,e){return Nt(t,e)})),a=t.map((function(t){return t.shape})),o=p().getBool("WEBGL_PACK")?new ia(t[0].shape,a):new ra(t[0].shape,a);return this.compileAndRun(o,t,i)},e.prototype.subtract=function(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,Na);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.subtract(t,e);var n=Nt(t.dtype,e.dtype);if(p().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,Na,t.dtype);var r=new Oa(Na,t.shape,e.shape);return this.compileAndRun(r,[t,e],n)},e.prototype.pow=function(t,e){var n=p().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new La("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new Oa("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",t.shape,e.shape),r=Nt(t.dtype,e.dtype);return this.compileAndRun(n,[t,e],r)},e.prototype.ceil=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.ceil(t);if(p().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,_s,t.dtype);var e=new ms(t.shape,_s);return this.compileAndRun(e,[t])},e.prototype.floor=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.floor(t);if(p().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Ss,t.dtype);var e=new ms(t.shape,Ss);return this.compileAndRun(e,[t])},e.prototype.sign=function(t){var e=new ms(t.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(e,[t])},e.prototype.isNaN=function(t){var e=new ms(t.shape,"return float(isnan(x));");return this.compileAndRun(e,[t],"bool")},e.prototype.isInf=function(t){var e=new ms(t.shape,"return float(isinf(x));");return this.compileAndRun(e,[t],"bool")},e.prototype.isFinite=function(t){var e=new ms(t.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(e,[t],"bool")},e.prototype.round=function(t){var e=new ms(t.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(e,[t])},e.prototype.exp=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.exp(t);if(p().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Ms,t.dtype);var e=new ms(t.shape,Ms);return this.compileAndRun(e,[t])},e.prototype.expm1=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.expm1(t);if(p().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Es,t.dtype);var e=new ms(t.shape,Es);return this.compileAndRun(e,[t])},e.prototype.softmax=function(t,e){var n=B([e],t.shape),r=this.max(t,n),i=nn(r.shape,n),a=this.subtract(t,r.reshape(i)),o=this.exp(a),s=this.sum(o,n).reshape(i);return ni(o,s)},e.prototype.log=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.log(t);if(p().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",t.dtype);var e=new ms(t.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(e,[t])},e.prototype.log1p=function(t){var e=new ms(t.shape,"return log(1.0 + x);");return this.compileAndRun(e,[t])},e.prototype.sqrt=function(t){var e=new ms(t.shape,"return sqrt(x);");return this.compileAndRun(e,[t])},e.prototype.rsqrt=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.rsqrt(t);var e=new ms(t.shape,"return inversesqrt(x);");return this.compileAndRun(e,[t])},e.prototype.reciprocal=function(t){var e=new ms(t.shape,"return 1.0 / x;");return this.compileAndRun(e,[t])},e.prototype.relu=function(t){var e;return e=p().getBool("WEBGL_PACK")?new Is(t.shape,Cs):new ms(t.shape,ys),this.compileAndRun(e,[t])},e.prototype.relu6=function(t){var e;return e=p().getBool("WEBGL_PACK")?new Is(t.shape,As):new ms(t.shape,xs),this.compileAndRun(e,[t])},e.prototype.prelu=function(t,e){var n=p().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new La(ka,t.shape,e.shape):new Oa(Ra,t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.elu=function(t){if(p().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Ns,t.dtype);var e=new ms(t.shape,bs);return this.compileAndRun(e,[t])},e.prototype.eluDer=function(t,e){var n=p().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new La("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",t.shape,e.shape):new Oa("return (b >= 1.0) ? a : a * (b + 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.selu=function(t){var e=new ms(t.shape,"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = 1.7580993408473768;\n  float scale = 1.0507009873554805;\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n");return this.compileAndRun(e,[t])},e.prototype.int=function(t){var e=new ms(t.shape,"return float(int(x));");return this.compileAndRun(e,[t],"int32")},e.prototype.clip=function(t,e,n){var r,i=(r=p().getBool("WEBGL_PACK_CLIP")?new Pa(t.shape):new Da(t.shape)).getCustomSetupFunc(e,n);return this.compileAndRun(r,[t],null,i)},e.prototype.abs=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.abs(t);if(p().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,gs,t.dtype);var e=new ms(t.shape,gs);return this.compileAndRun(e,[t])},e.prototype.complexAbs=function(t){var e=this.texData.get(t.dataId),n=new Fa(t.shape),r=[this.makeComplexComponentTensorInfo(t,e.complexTensors.real),this.makeComplexComponentTensorInfo(t,e.complexTensors.imag)];return this.compileAndRun(n,r)},e.prototype.sigmoid=function(t){var e=new ms(t.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(e,[t])},e.prototype.softplus=function(t){var e=new ms(t.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(e,[t])},e.prototype.sin=function(t){var e=new ms(t.shape,"if (isnan(x)) return x;\n  return sin(x);\n");return this.compileAndRun(e,[t])},e.prototype.cos=function(t){var e=new ms(t.shape,"if (isnan(x)) return x;\n  return cos(x);\n");return this.compileAndRun(e,[t])},e.prototype.tan=function(t){var e=new ms(t.shape,"return tan(x);");return this.compileAndRun(e,[t])},e.prototype.asin=function(t){var e=new ms(t.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n");return this.compileAndRun(e,[t])},e.prototype.acos=function(t){var e=new ms(t.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n");return this.compileAndRun(e,[t])},e.prototype.atan=function(t){var e=new ms(t.shape,"if (isnan(x)) return x;\n  return atan(x);\n");return this.compileAndRun(e,[t])},e.prototype.atan2=function(t,e){var n=p().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new La("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new Oa("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.sinh=function(t){var e=new ms(t.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])},e.prototype.cosh=function(t){var e=new ms(t.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])},e.prototype.tanh=function(t){var e=new ms(t.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(e,[t])},e.prototype.asinh=function(t){var e=new ms(t.shape,"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));");return this.compileAndRun(e,[t])},e.prototype.acosh=function(t){var e=new ms(t.shape,"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));");return this.compileAndRun(e,[t])},e.prototype.atanh=function(t){var e=new ms(t.shape,"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;");return this.compileAndRun(e,[t])},e.prototype.erf=function(t){var e=new ms(t.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n');return this.compileAndRun(e,[t])},e.prototype.step=function(t,e){var n=new ms(t.shape,function(t){return void 0===t&&(t=0),vs+"\n    return x > 0.0 ? 1.0 : float("+t+");\n  "}(e));return this.compileAndRun(n,[t])},e.prototype.conv2dByMatMul=function(t,e,n,r,i,a){var o=t.shape,s=this.texData.get(t.dataId),u=n.inChannels,c=o[0]*o[1]*o[2],l=n.outChannels,h="channelsLast"===n.dataFormat,f=(1===c||1===l)&&u>1e3,d=o[2]%2!=0&&!!s.isPacked;if(f||!p().getBool("WEBGL_LAZILY_UNPACK")||!p().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!d){var m=h?o[0]*o[1]*o[2]:o[0]*o[2]*o[3],v=this.reshape(t,[1,m,n.inChannels]),g=this.reshape(e,[1,n.inChannels,n.outChannels]);return this.reshape(this.fusedBatchMatMul({a:v,b:g,transposeA:!1,transposeB:!1,bias:r,activation:i,preluActivationWeights:a}),n.outShape)}var y=h?o[0]*o[1]*(o[2]+1):o[0]*o[2]*(o[3]+1),x={dataId:t.dataId,shape:[1,y,n.inChannels],dtype:t.dtype},b=s.shape;s.shape=s.shape.slice(),s.shape[s.shape.length-2]++,T(Ie(s.shape,x.shape),(function(){return"packed reshape "+s.shape+" to "+x.shape+" isn't free"}));var w=this.reshape(e,[1,n.inChannels,n.outChannels]),_=this.fusedBatchMatMul({a:x,b:w,transposeA:!1,transposeB:!1,bias:r,activation:i,preluActivationWeights:a}),S=this.texData.get(_.dataId);return T(S.isPacked,(function(){return"batchMatMul result is expected to be packed"})),s.shape=b,S.shape=n.outShape,Ft.makeTensorFromDataId(_.dataId,n.outShape,_.dtype)},e.prototype.conv2dWithIm2Row=function(t,e,n,r,i,a){var o=n.filterWidth,s=n.filterHeight,u=n.inChannels,c=n.outWidth,l=n.outHeight,h="channelsLast"===n.dataFormat,p=o*s*u,f=l*c,d=[p,f],m=t.squeeze([0]),v=e.reshape([1,p,-1]),g=new ko(d,m.shape,n),y=this.compileAndRun(g,[m]).reshape([1,d[0],d[1]]),x=null!=r,b=null!=a,w=i?ks(i,!0):null,_=new zo(y.shape,[1,f,n.outChannels],!0,!1,x,w,b),S=[y,v];r&&S.push(r),b&&S.push(a);var M=this.compileAndRun(_,S);return h?M.reshape([1,l,c,n.outChannels]):M.reshape([1,n.outChannels,l,c])},e.prototype.fusedConv2d=function(t){var e=t.input,n=t.filter,r=t.convInfo,i=t.bias,a=t.activation,o=t.preluActivationWeights;if(1===r.filterHeight&&1===r.filterWidth&&1===r.dilationHeight&&1===r.dilationWidth&&1===r.strideHeight&&1===r.strideWidth&&("SAME"===r.padInfo.type||"VALID"===r.padInfo.type))return this.conv2dByMatMul(e,n,r,i,a,o);if(p().getBool("WEBGL_CONV_IM2COL")&&1===e.shape[0])return this.conv2dWithIm2Row(e,n,r,i,a,o);var s=null!=i,u=null!=o,c=a?ks(a,!1):null,l=new Xa(r,s,c,u),h=[e,n];return i&&h.push(i),o&&h.push(o),this.compileAndRun(l,h)},e.prototype.conv2d=function(t,e,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(t,e,n);if(p().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,e,n);var r=new Xa(n);return this.compileAndRun(r,[t,e])},e.prototype.conv2dDerInput=function(t,e,n){var r=new Wa(n);return this.compileAndRun(r,[t,e])},e.prototype.conv2dDerFilter=function(t,e,n){var r=new ja(n);return this.compileAndRun(r,[t,e])},e.prototype.fusedDepthwiseConv2D=function(t){var e,n=t.input,r=t.filter,i=t.convInfo,a=t.bias,o=t.activation,s=t.preluActivationWeights,u=p().getBool("WEBGL_PACK_DEPTHWISECONV")&&i.strideWidth<=2&&i.outChannels/i.inChannels==1,c=o?ks(o,u):null,l=[n,r],h=null!=a,f=null!=s;return h&&l.push(a),f&&l.push(s),u?(e=new Ka(i,h,c,f),this.compileAndRun(e,l)):(e=new Ya(i,h,c,f),this.compileAndRun(e,l))},e.prototype.depthwiseConv2D=function(t,e,n){var r;return p().getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(r=new Ka(n),this.compileAndRun(r,[t,e])):(r=new Ya(n),this.compileAndRun(r,[t,e]))},e.prototype.depthwiseConv2DDerInput=function(t,e,n){var r=new qa(n);return this.compileAndRun(r,[t,e])},e.prototype.depthwiseConv2DDerFilter=function(t,e,n){var r=new Ga(n);return this.compileAndRun(r,[t,e])},e.prototype.conv3d=function(t,e,n){var r=new $a(n);return this.compileAndRun(r,[t,e])},e.prototype.conv3dDerInput=function(t,e,n){var r=new Ha(n);return this.compileAndRun(r,[t,e])},e.prototype.conv3dDerFilter=function(t,e,n){var r=new Va(n);return this.compileAndRun(r,[t,e])},e.prototype.maxPool=function(t,e){var n=new Go(e,"max",!1);return this.compileAndRun(n,[t])},e.prototype.avgPool=function(t,e){var n=new Go(e,"avg",!1);return this.compileAndRun(n,[t],"float32")},e.prototype.maxPoolBackprop=function(t,e,n,r){var i=new Go(r,"max",!0),a=this.compileAndRun(i,[e]),o=new Fo(r),s=this.compileAndRun(o,[t,a],e.dtype);return a.dispose(),s},e.prototype.avgPoolBackprop=function(t,e,n){var r=new Sa(n);return this.compileAndRun(r,[t],e.dtype)},e.prototype.cast=function(t,e){return Fi(t,e,this)},e.prototype.unstack=function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),i=0,a=0;a<t.rank;a++)a!==e&&(r[i++]=t.shape[a]);var o=new Array(t.rank).fill(0),s=t.shape.slice();s[e]=1;var u=new Array(n);for(a=0;a<u.length;a++)o[e]=a,u[a]=this.slice(t,o,s).reshape(r);return u},e.prototype.avgPool3d=function(t,e){var n=new qo(e,"avg",!1);return this.compileAndRun(n,[t],"float32")},e.prototype.avgPool3dBackprop=function(t,e,n){var r=new Ma(n);return this.compileAndRun(r,[t],e.dtype)},e.prototype.maxPool3d=function(t,e){var n=new qo(e,"max",!1);return this.compileAndRun(n,[t],"float32")},e.prototype.maxPool3dBackprop=function(t,e,n,r){var i=new qo(r,"max",!0),a=this.compileAndRun(i,[e]),o=new Bo(r),s=this.compileAndRun(o,[t,a],e.dtype);return a.dispose(),s},e.prototype.reshape=function(t,e){var n=this.texData.get(t.dataId);if(n.isPacked&&!Ie(t.shape,e)&&(null===n.texture||!Ie(n.shape,e))){var r=this.packedReshape(t,e);return Ft.makeTensorFromDataId(r.dataId,r.shape,r.dtype)}return Bi(t,e)},e.prototype.resizeBilinear=function(t,e,n,r){var i=p().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Jo(t.shape,e,n,r):new Ko(t.shape,e,n,r);return this.compileAndRun(i,[t],"float32")},e.prototype.resizeBilinearBackprop=function(t,e,n){var r=new Yo(t,e,n);return this.compileAndRun(r,[t])},e.prototype.resizeNearestNeighbor=function(t,e,n,r){var i=new Qo(t.shape,e,n,r);return this.compileAndRun(i,[t])},e.prototype.resizeNearestNeighborBackprop=function(t,e,n){var r=new Zo(t,e,n);return this.compileAndRun(r,[t])},e.prototype.multinomial=function(t,e,n,r){var i=e?t:xi(t),a=i.shape[0],o=i.shape[1],s=new Uo(a,o,n),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[i],"int32",u)},e.prototype.oneHot=function(t,e,n,r){var i=new jo(t.size,e,n,r);return this.compileAndRun(i,[t])},e.prototype.diag=function(t){var e=new ro(t.size);return this.compileAndRun(e,[t])},e.prototype.nonMaxSuppression=function(t,e,n,r,i){return $e("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),Xi(t.dataSync(),e.dataSync(),n,r,i)},e.prototype.cropAndResize=function(t,e,n,r,i,a){var o=new Ja(t.shape,e.shape,r,i,a);return this.compileAndRun(o,[t,e,n],"float32")},e.prototype.depthToSpace=function(t,e,n){T(e>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+e}));var r=t.shape[0],i="NHWC"===n?t.shape[1]:t.shape[2],a="NHWC"===n?t.shape[2]:t.shape[3],o="NHWC"===n?t.shape[3]:t.shape[1],s=i*e,u=a*e,c=o/(e*e),l=new no("NHWC"===n?[r,s,u,c]:[r,c,s,u],e,n);return this.compileAndRun(l,[t])},e.prototype.split=function(t,e,n){return Qi(t,e,n)},e.prototype.scatterND=function(t,e,n){var r=ui(0,t,n),i=r.sliceRank,a=r.numUpdates,o=r.sliceSize,s=r.strides,u=r.outputSize,c=[u/o,o],l=t.reshape([a,i]),h=e.reshape([a,o]);if(0===u)return Bi(dn([]),n);var p=vn(0),f=new ns(a,i,l.rank,h.rank,s,c);return this.compileAndRun(f,[h,l,p]).reshape(n)},e.prototype.sparseToDense=function(t,e,n,r){var i=ui(0,t,n),a=i.sliceRank,o=i.numUpdates,s=i.strides,u=i.outputSize,c=new ns(o,a,t.rank,e.rank,s,[u,1],!1);return this.compileAndRun(c,[e,t,r]).reshape(n)},e.prototype.fft=function(t){return this.fftImpl(t,!1)},e.prototype.ifft=function(t){return this.fftImpl(t,!0)},e.prototype.fftImpl=function(t,e){var n=this.texData.get(t.dataId),r=new uo("return real * expR - imag * expI;",t.shape,e),i=new uo("return real * expI + imag * expR;",t.shape,e),a=[this.makeComplexComponentTensorInfo(t,n.complexTensors.real),this.makeComplexComponentTensorInfo(t,n.complexTensors.imag)],o=this.compileAndRun(r,a),s=this.compileAndRun(i,a),u=this.complex(o,s).as2D(t.shape[0],t.shape[1]);return o.dispose(),s.dispose(),u},e.prototype.gatherND=function(t,e){var n=e.shape,r=n[n.length-1],i=ri(t,e),a=i[0],o=i[1],s=i[2],u=i[3],c=e.reshape([o,r]),l=t.reshape([t.size/s,s]),h=new ho(r,u,[o,s]);return this.compileAndRun(h,[l,c]).reshape(a)},e.prototype.fill=function(t,e,n){if("string"===(n=n||J(e))){var r=j(n,I(t));return r.fill(e),Ft.makeTensor(r,t,n,this)}var i=new co(t,e),a=i.getCustomSetupFunc(e);return this.compileAndRun(i,[],n,a)},e.prototype.onesLike=function(t){if("string"===t.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(t.shape,1,t.dtype)},e.prototype.zerosLike=function(t){return this.fill(t.shape,"string"===t.dtype?"":0,t.dtype)},e.prototype.linspace=function(t,e,n){return zi(t,e,n)},e.prototype.makeTensorInfo=function(t,e){var n=this.write(null,t,e);return this.texData.get(n).usage=null,{dataId:n,shape:t,dtype:e}},e.prototype.makeOutput=function(t,e){var n=this.makeTensorInfo(t,e).dataId;return Ft.makeTensorFromDataId(n,t,e,this)},e.prototype.unpackTensor=function(t){var e=new Rs(t.shape);return this.runWebGLProgram(e,[t],t.dtype)},e.prototype.packTensor=function(t){var e=new Wo(t.shape);return this.runWebGLProgram(e,[t],t.dtype,null,!0)},e.prototype.packedReshape=function(t,e){var n=[Ee(t.shape)].concat(Te(t.shape)),r={dtype:t.dtype,shape:n,dataId:t.dataId},i=[Ee(e)].concat(Te(e)),a=new $o(i,n),o=this.runWebGLProgram(a,[r],t.dtype,null,!0);return{dataId:o.dataId,shape:e,dtype:o.dtype}},e.prototype.decode=function(t){var e,n=this.texData.get(t),r=n.isPacked,i=n.shape,a=n.dtype,o=Ce(i);return e=r?new eo(o):new to(o),{dtype:a,shape:i,dataId:this.runWebGLProgram(e,[{shape:o,dtype:a,dataId:t}],a,null,!0).dataId}},e.prototype.runWebGLProgram=function(t,e,n,r,i){var a=this;void 0===i&&(i=!1);var o=this.makeTensorInfo(t.outputShape,n),s=this.texData.get(o.dataId);if(t.packedOutput&&(s.isPacked=!0),t.outPackingScheme===Ut.DENSE){var u=$t(t.outputShape);s.texShape=u.map((function(t){return 2*t}))}if(null!=t.outTexUsage&&(s.usage=t.outTexUsage),0===I(o.shape))return s.values=U(o.dtype,0),o;var c=[],l=e.map((function(e){if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=a.texData.get(e.dataId);if(null==n.texture){if(!t.packedInputs&&I(e.shape)<=p().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.packedInputs&&(n.isPacked=!0,n.shape=e.shape)}else if(!!n.isPacked!=!!t.packedInputs)e=n.isPacked?a.unpackTensor(e):a.packTensor(e),c.push(e),n=a.texData.get(e.dataId);else if(n.isPacked&&!Ie(n.shape,e.shape)){var r=e,i=e.shape;e.shape=n.shape,e=a.packedReshape(e,i),c.push(e),n=a.texData.get(e.dataId),r.shape=i}return a.uploadToGPU(e.dataId),{shape:e.shape,texData:n,isUniform:!1}}));this.uploadToGPU(o.dataId);var h,f={shape:o.shape,texData:s,isUniform:!1},d=function(t,e,n){var r="";e.concat(n).forEach((function(t){var e=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0,n=t.isUniform?"uniform":t.texData.texShape;r+=t.shape+"_"+n+"_"+e}));var i=t.userCode;return t.constructor.name+"_"+r+"_"+i}(t,l,f),m=this.getAndSaveBinary(d,(function(){return function(t,e,n,r){var i=e.userCode,a=n.map((function(t,n){var r={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(r.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:r}})),o=a.map((function(t){return t.shapeInfo})),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},u=pa(a,s,i,e.packedInputs),c=t.createProgram(u),l=null,h=t.getUniformLocation(c,"NAN",!1);1===p().getNumber("WEBGL_VERSION")&&(l=t.getUniformLocation(c,"INFINITY",!1));for(var f={},d=0;d<e.variableNames.length;d++){var m=e.variableNames[d];f[m]=t.getUniformLocation(c,m,!1),f["offset"+m]=t.getUniformLocation(c,"offset"+m,!1)}return{program:e,source:u,webGLProgram:c,uniformLocations:f,inShapeInfos:o,outShapeInfo:s,infLoc:l,nanLoc:h}}(a.gpgpu,t,l,f)})),v=null!=this.activeTimers;if(v&&(h=this.startTimer()),function(t,e,n,r,i){Oo(e.inShapeInfos,n),Oo([e.outShapeInfo],[r]);var a=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(a,o[0],o[1]):t.setOutputMatrixTexture(a,o[0],o[1]),t.setProgram(e.webGLProgram),1===p().getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach((function(n,r){var i=e.program.variableNames[r],a=e.uniformLocations[i],o=e.uniformLocations["offset"+i];if(null!=a)if(n.isUniform)if(I(n.shape)<2)t.gl.uniform1f(a,n.uniformValues[0]);else{var s=n.uniformValues;s instanceof Float32Array||(s=new Float32Array(s)),t.gl.uniform1fv(a,s)}else null!=n.texData.slice&&null!=o&&t.gl.uniform1i(o,n.texData.slice.flatOffset),t.setInputMatrixTexture(n.texData.texture,a,r)})),null!=i&&i(t,e.webGLProgram),t.executeProgram()}(this.gpgpu,m,l,f,r),c.forEach((function(t){return a.disposeData(t.dataId)})),v&&(h=this.endTimer(h),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(h)})),!p().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===i){var g=this.unpackTensor(o);return this.disposeData(o.dataId),g}return o},e.prototype.compileAndRun=function(t,e,n,r,i){void 0===i&&(i=!1),n=n||e[0].dtype;var a=this.runWebGLProgram(t,e,n,r,i);return Ft.makeTensorFromDataId(a.dataId,a.shape,a.dtype)},e.prototype.getAndSaveBinary=function(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]},e.prototype.getTextureManager=function(){return this.textureManager},e.prototype.dispose=function(){var t=this;this.disposed||(p().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach((function(e){t.gpgpu.deleteProgram(t.binaryCache[e].webGLProgram),delete t.binaryCache[e]})),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},e.prototype.floatPrecision=function(){var t=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=He((function(){if(!p().get("WEBGL_RENDER_FLOAT32_ENABLED")){var e=p().getBool("DEBUG");p().set("DEBUG",!1);var n=t.abs(vn(1e-8)).dataSync()[0];if(p().set("DEBUG",e),n>0)return 32}return 16}))),this.floatPrecisionValue},e.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},e.prototype.uploadToGPU=function(t){var e,n=this.texData.get(t),r=n.shape,i=n.dtype,a=n.values,o=n.texture,s=n.usage,u=n.isPacked;if(null==o){var c,l=null!=this.activeTimers;l&&(c=at());var h=n.texShape;if(null==h&&(h=Ae(r,u),n.texShape=h),null!=a){var p=Ce(r),f=void 0,d=h[1],m=h[0],v=a instanceof Uint8Array;u?(d=(e=Yt(h[0],h[1]))[0],m=e[1],f=new so(p,[m,d],v)):f=new oo(p,[m,d],v);var g=this.makeTensorInfo([m,d],i);this.texData.get(g.dataId).usage=v?jt.PIXELS:jt.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(g.dataId),d,m,a);var y=this.runWebGLProgram(f,[g],i,null,!0),x=this.texData.get(y.dataId);n.texture=x.texture,n.texShape=x.texShape,n.isPacked=x.isPacked,n.usage=x.usage,this.disposeData(g.dataId),this.texData.delete(y.dataId),n.values=null,l&&(this.uploadWaitMs+=at()-c)}else{var b=this.acquireTexture(h,s,i,u);n.texture=b}}},e.prototype.convertAndCacheOnCPU=function(t,e){var n=this.texData.get(t),r=n.dtype;return this.releaseGPUData(t),null!=e&&(n.values=function(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){for(var n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length),r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}throw new Error("Unknown dtype "+e)}(e,r)),n.values},e.prototype.acquireTexture=function(t,e,n,r){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+i+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(t,e,r)},e.prototype.computeBytes=function(t,e){return t[0]*t[1]*q(e)},e}(Si);function Ds(t,e){return t(e={exports:{}},e.exports),e.exports}Bt()&&Ft.registerBackend("webgl",(function(){return new Ls}),2),"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t||"undefined"!=typeof self&&self;var Ps=Ds((function(t){!function(t,e,n){function r(t){var e,n=this,r=(e=4022871197,function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}function i(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function a(t,e){var n=new r(t),a=e&&e.state,o=n.next;return o.int32=function(){return 4294967296*n.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,a&&("object"==typeof a&&i(a,n),o.state=function(){return i(n,{})}),o}e&&e.exports?e.exports=a:this.alea=a}(0,t)})),Fs=Ds((function(t){!function(t,e,n){function r(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function a(t,e){var n=new r(t),a=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,a&&("object"==typeof a&&i(a,n),o.state=function(){return i(n,{})}),o}e&&e.exports?e.exports=a:this.xor128=a}(0,t)})),Bs=Ds((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function a(t,e){var n=new r(t),a=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,a&&("object"==typeof a&&i(a,n),o.state=function(){return i(n,{})}),o}e&&e.exports?e.exports=a:this.xorwow=a}(0,t)})),zs=Ds((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function i(t,e){return e.x=t.x.slice(),e.i=t.i,e}function a(t,e){null==t&&(t=+new Date);var n=new r(t),a=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,a&&(a.x&&i(a,n),o.state=function(){return i(n,{})}),o}e&&e.exports?e.exports=a:this.xorshift7=a}(0,t)})),Us=Ds((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,a=e.i;return e.w=r=r+1640531527|0,n=i[a+34&127],t=i[a=a+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=i[a]=n^t,e.i=a,n+(r^r>>>16)|0},function(t,e){var n,r,i,a,o,s=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),i=0,a=-32;a<u;++a)e&&(r^=e.charCodeAt((a+32)%e.length)),0===a&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(o=o+1640531527|0,i=0==(n=s[127&a]^=r+o)?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,a=512;a>0;--a)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[i]=r^n;t.w=o,t.X=s,t.i=i}(e,t)}function i(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function a(t,e){null==t&&(t=+new Date);var n=new r(t),a=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,a&&(a.X&&i(a,n),o.state=function(){return i(n,{})}),o}e&&e.exports?e.exports=a:this.xor4096=a}(0,t)})),js=Ds((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function i(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function a(t,e){var n=new r(t),a=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,a&&("object"==typeof a&&i(a,n),o.state=function(){return i(n,{})}),o}e&&e.exports?e.exports=a:this.tychei=a}(0,t)})),Ws=Ds((function(t){!function(e,r){var i,a=this,o=256,s="random",u=r.pow(o,6),c=r.pow(2,52),l=2*c,h=255;function p(t,n,h){var p=[],g=m(function t(e,n){var r,i=[],a=typeof e;if(n&&"object"==a)for(r in e)try{i.push(t(e[r],n-1))}catch(t){}return i.length?i:"string"==a?e:e+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[t,v(e)]:null==t?function(){try{var t;return i&&(t=i.randomBytes)?t=t(o):(t=new Uint8Array(o),(a.crypto||a.msCrypto).getRandomValues(t)),v(t)}catch(t){var n=a.navigator,r=n&&n.plugins;return[+new Date,a,r,a.screen,v(e)]}}():t,3),p),y=new f(p),x=function(){for(var t=y.g(6),e=u,n=0;t<c;)t=(t+n)*o,e*=o,n=y.g(1);for(;t>=l;)t/=2,e/=2,n>>>=1;return(t+n)/e};return x.int32=function(){return 0|y.g(4)},x.quick=function(){return y.g(4)/4294967296},x.double=x,m(v(y.S),e),(n.pass||h||function(t,e,n,i){return i&&(i.S&&d(i,y),t.state=function(){return d(y,{})}),n?(r[s]=t,e):t})(x,g,"global"in n?n.global:this==r,n.state)}function f(t){var e,n=t.length,r=this,i=0,a=r.i=r.j=0,s=r.S=[];for(n||(t=[n++]);i<o;)s[i]=i++;for(i=0;i<o;i++)s[i]=s[a=h&a+t[i%n]+(e=s[i])],s[a]=e;(r.g=function(t){for(var e,n=0,i=r.i,a=r.j,s=r.S;t--;)e=s[i=h&i+1],n=n*o+s[h&(s[i]=s[a=h&a+e])+(s[a]=e)];return r.i=i,r.j=a,n})(o)}function d(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function m(t,e){for(var n,r=t+"",i=0;i<r.length;)e[h&i]=h&(n^=19*e[h&i])+r.charCodeAt(i++);return v(e)}function v(t){return String.fromCharCode.apply(0,t)}if(r.seedrandom=p,m(r.random(),e),t.exports){t.exports=p;try{i=n(349)}catch(t){}}}([],Math)}));Ws.alea=Ps,Ws.xor128=Fs,Ws.xorwow=Bs,Ws.xorshift7=zs,Ws.xor4096=Us,Ws.tychei=js;var Vs=Ws.alea,Hs=ln({addN_:function(t){T(Array.isArray(t),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),T(t.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+t.length}));var e=t.map((function(t,e){return Je(t,"tensors"+e,"addN")})),n=e[0];e.forEach((function(t){if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),e.forEach((function(t){if(!R(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var r=e;return Ft.runKernelFunc((function(t,n){return t.addN(e)}),r,null,"AddN")}});function Gs(){We("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}function qs(t){return 0===t.rank||1===t.rank?t.as4D(1,1,1,t.size):2===t.rank?t.as4D(1,1,t.shape[0],t.shape[1]):3===t.rank?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}function Xs(t,e,n,r,i,a){null==a&&(a=.001);var o,s,u=Je(t,"x","batchNorm"),c=Je(e,"mean","batchNorm"),l=Je(n,"variance","batchNorm");null!=i&&(o=Je(i,"scale","batchNorm")),null!=r&&(s=Je(r,"offset","batchNorm")),T(c.rank===l.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),T(null==s||c.rank===s.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),T(null==o||c.rank===o.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var h={x:u,scale:o,offset:s,mean:c,variance:l},p={varianceEpsilon:a};return Ft.runKernelFunc((function(t,e){var n=qs(u),r=t.batchNormalization(n,$s(c),$s(l),a,$s(o),$s(s));return e([u,c,l,o]),r}),h,null,"FusedBatchNorm",p).reshape(u.shape)}function $s(t){return null==t?null:0===t.rank?t.as1D():1===t.rank?t:2===t.rank?t.as4D(1,1,t.shape[0],t.shape[1]):3===t.rank?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}var Ys=ln({batchNormalization_:function(t,e,n,r,i,a){return void 0===r&&(r=.001),Gs(),Xs(t,e,n,a,i,r)}}),Ks=ln({batchNorm_:Xs});function Js(t,e,n,r,i,a){var o,s,u=Je(t,"x","batchNorm"),c=Je(e,"mean","batchNorm"),l=Je(n,"variance","batchNorm");return null!=i&&(o=Je(i,"scale","batchNorm")),null!=r&&(s=Je(r,"offset","batchNorm")),T(2===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),T(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+c.rank+"."})),T(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+l.rank+"."})),null!=o&&T(2===o.rank||1===o.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+o.rank+"."})),null!=s&&T(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."})),Ks(u,c,l,s,o,a)}var Zs=ln({batchNormalization2d_:function(t,e,n,r,i,a){return void 0===r&&(r=.001),Gs(),Js(t,e,n,a,i,r)}}),Qs=ln({batchNorm2d_:Js});function tu(t,e,n,r,i,a){var o,s,u=Je(t,"x","batchNorm"),c=Je(e,"mean","batchNorm"),l=Je(n,"variance","batchNorm");return null!=i&&(o=Je(i,"scale","batchNorm")),null!=r&&(s=Je(r,"offset","batchNorm")),T(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),T(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+c.rank+"."})),T(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+l.rank+"."})),null!=o&&T(3===o.rank||1===o.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+o.rank+"."})),null!=s&&T(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."})),Ks(u,c,l,s,o,a)}var eu=ln({batchNormalization3d_:function(t,e,n,r,i,a){return void 0===r&&(r=.001),Gs(),tu(t,e,n,a,i,r)}}),nu=ln({batchNorm3d_:tu});function ru(t,e,n,r,i,a){var o,s,u=Je(t,"x","batchNorm"),c=Je(e,"mean","batchNorm"),l=Je(n,"variance","batchNorm");return null!=i&&(o=Je(i,"scale","batchNorm")),null!=r&&(s=Je(r,"offset","batchNorm")),T(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."})),T(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+c.rank+"."})),T(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+l.rank+"."})),null!=o&&T(4===o.rank||1===o.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+o.rank+"."})),null!=s&&T(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."})),Ks(u,c,l,s,o,a)}var iu=ln({batchNormalization4d_:function(t,e,n,r,i,a){return void 0===r&&(r=.001),Gs(),ru(t,e,n,a,i,r)}}),au=ln({batchNorm4d_:ru}),ou=ln({broadcastTo_:function(t,e){var n=Je(t,"broadcastTo","x"),r=n.shape;if(e.some((function(t){return!(t>0)||t%1!=0})))throw new Error("broadcastTo(): Invalid broadcast shape ["+e+"].");if(e.length<n.rank)throw new Error("broadcastTo(): shape.length="+e.length+" < input.rank="+n.rank+".");if(e.length>n.rank){for(var i=n.shape.slice();i.length<e.length;)i.unshift(1);n=n.reshape(i)}for(var a=n.shape,o=Array.from(e),s=e.length-1;s>=0;s--)if(a[s]===e[s])o[s]=1;else if(1!==n.shape[s])throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+e+"].");var u=o.map((function(t,e){return t>1?e:-1})).filter((function(t){return t>=0}));if(0===u.length)return n.clone();var c={x:n},l={shape:e,inputShape:a};return Ft.runKernelFunc((function(t){return t.tile(n,o)}),c,(function(t){return{x:function(){return t.sum(u,!0)}}}),Qn,l)}}),su=ln({clone_:function(t){var e=Je(t,"x","clone",null);return Ft.runKernelFunc((function(){return Ft.makeTensorFromDataId(e.dataId,e.shape,e.dtype)}),{x:e},null,tr)}}),uu=ln({logicalAnd_:function(t,e){var n=Je(t,"a","logicalAnd","bool"),r=Je(e,"b","logicalAnd","bool");return ir(n.shape,r.shape),Ft.runKernelFunc((function(t){return t.logicalAnd(n,r)}),{a:n,b:r},null,"LogicalAnd")}}),cu=ln({logicalNot_:function(t){var e=Je(t,"x","logicalNot","bool");return Ft.runKernelFunc((function(t){return t.logicalNot(e)}),{$x:e})}}),lu=ln({logicalOr_:function(t,e){var n=Je(t,"a","logicalOr","bool"),r=Je(e,"b","logicalOr","bool");return ir(n.shape,r.shape),Ft.runKernelFunc((function(t){return t.logicalOr(n,r)}),{$a:n,$b:r})}}),hu=ln({logicalXor_:function(t,e){var n=Je(t,"a","logicalXor","bool"),r=Je(e,"b","logicalXor","bool");return ir(n.shape,r.shape),lu(t,e).logicalAnd(uu(t,e).logicalNot())}}),pu=ln({where_:function(t,e,n){var r=Je(e,"a","where"),i=Je(n,"b","where"),a=Je(t,"condition","where","bool");return C(r.shape,i.shape,"Error in where: "),1===a.rank?T(a.shape[0]===r.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})):C(a.shape,i.shape,"Error in where: "),Ft.runKernelFunc((function(t,e){var n=t.select(a,r,i);return e([a]),n}),{$condition:a,$a:r,$b:i},(function(t,e){var n=e[0];return{$condition:function(){return Cn(n).toFloat()},$a:function(){return t.mul(n.cast(t.dtype))},$b:function(){return t.mul(n.logicalNot().cast(t.dtype))}}}))}}),fu=function(t){return u(this,void 0,void 0,(function(){var e,n,r;return c(this,(function(i){switch(i.label){case 0:return[4,(e=Je(t,"condition","whereAsync","bool")).data()];case 1:return n=i.sent(),r=na(e.shape,n),t!==e&&e.dispose(),[2,r]}}))}))},du=ln({divNoNan_:function(t,e){var n,r=Je(t,"a","div"),i=Je(e,"b","div");r=(n=Rt(r,i))[0],i=n[1];var a=ni(r,i),o=Cn(a),s=i.equal(o);return pu(s,o,a)}}),mu=ln({tile_:function(t,e){var n=Je(t,"x","tile",null);T(n.rank===e.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+e+"."}));var r=[n],i={x:n},a={reps:e};return Ft.runKernelFunc((function(t,r){var i=t.tile(n,e);return r([n]),i}),i,null,"Tile",a,r)}}),vu=ln({eye_:function(t,e,n,r){void 0===r&&(r="float32"),null==e&&(e=t);for(var i=Ln([t,e],r),a=t<=e?t:e,o=0;o<a;++o)i.set(1,o,o);var s=i.toTensor().as2D(t,e);if(null==n)return s;if(1===n.length)return mu(zn(s,0),[n[0],1,1]);if(2===n.length)return mu(zn(zn(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return mu(zn(zn(zn(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),gu=ln({multinomial_:function(t,e,n,r){void 0===r&&(r=!1);var i=Je(t,"logits","multinomial"),a=i.size,o=i.rank;if(a<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+a+".");if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+o);n=n||Math.random();var s=1===o?i.as2D(1,-1):i,u=Ft.runKernelFunc((function(t){return t.multinomial(s,r,e,n)}),{logits2D:s});return 1===o?u.as1D():u}}),yu=ln({oneHot_:function(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r=0),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);var i=Je(t,"indices","oneHot","int32"),a=i.shape.concat([e]),o={indices:i=i.flatten()},s={depth:e,onValue:n,offValue:r};return Ft.runKernelFunc((function(t,a){return a([i]),t.oneHot(i,e,n,r)}),o,null,"OneHot",s).reshape(a)}}),xu=ln({pad_:function(t,e,n){void 0===n&&(n=0);var r=Je(t,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i={paddings:e,constantValue:n},a={x:r};return Ft.runKernelFunc((function(t,i){return i([r]),t.pad(r,e,n)}),a,null,"PadV2",i)}}),bu=ln({pad1d_:function(t,e,n){return void 0===n&&(n=0),T(2===e.length,(function(){return"Invalid number of paddings. Must be length of 2."})),xu(t,[e],n)}}),wu=ln({pad2d_:function(t,e,n){return void 0===n&&(n=0),T(2===e.length&&2===e[0].length&&2===e[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),xu(t,e,n)}}),_u=ln({pad3d_:function(t,e,n){return void 0===n&&(n=0),T(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),xu(t,e,n)}}),Su=ln({pad4d_:function(t,e,n){return void 0===n&&(n=0),T(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),xu(t,e,n)}}),Mu=ln({rand_:function(t,e,n){var r=I(t),i=null;if(null==n||"float32"===n)i=new Float32Array(r);else if("int32"===n)i=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);i=new Uint8Array(r)}for(var a=0;a<r;a++)i[a]=e();return Ft.makeTensor(i,t,n)}});function Eu(){return 32===Ft.backend.floatPrecision()?.001:.1}function Tu(t,e,n){var r=!0;if((G(t)||G(e))&&(r=!1),G(t)&&G(e)&&(r=!0),r){var i=t.constructor.name,a=e.constructor.name;if(i!==a)throw new Error("Arrays are of different type. Actual: "+i+". Expected: "+a)}if(Array.isArray(t)&&Array.isArray(e)){var o=Ye(t),s=Ye(e);if(!R(o,s))throw new Error("Arrays have different shapes. Actual: ["+o+"]. Expected: ["+s+"]")}var u=G(t)?t:N(t),c=G(e)?e:N(e);if(u.length!==c.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+c.length+".\nActual:   "+u+".\nExpected: "+c+".");for(var l=0;l<c.length;++l){var h=u[l],p=c[l];if(!n(h,p))throw new Error("Arrays differ: actual["+l+"] = "+h+", expected["+l+"] = "+p+".\nActual:   "+u+".\nExpected: "+c+".")}}function Cu(t,e,n){return!isFinite(t)&&!isFinite(e)||!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}Object.freeze({TEST_EPSILON_FLOAT16:.1,expectArraysClose:function(t,e,n){return null==n&&(n=Eu()),Tu(t,e,(function(t,e){return Cu(t,e,n)}))},testEpsilon:Eu,expectPromiseToFail:function(t,e){t().then((function(){return e.fail()}),(function(){return e()}))},expectArraysEqual:function(t,e){var n="string"==typeof e||"number"==typeof e||"boolean"==typeof e?[e]:e;return $(t)||$(t[0])||$(e)||$(e[0])?Tu(t,n,(function(t,e){return t==e})):Tu(t,e,(function(t,e){return Cu(t,e,0)}))},expectNumbersClose:function(t,e,n){if(null==n&&(n=Eu()),!Cu(t,e,n))throw new Error("Numbers differ: actual === "+t+", expected === "+e)},expectValuesInRange:function(t,e,n){for(var r=0;r<t.length;r++)if(t[r]<e||t[r]>n)throw new Error("Value out of range:"+t[r]+" low: "+e+", high: "+n)},expectArrayBuffersEqual:function(t,e){expect(new Float32Array(t)).toEqual(new Float32Array(e))}});var Au=function(){function t(t,e,n,r,i){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var a=i||Math.random();this.random=Vs(a.toString())}return t.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,n,r=!1;!r;){var i=void 0,a=void 0,o=void 0;do{o=(i=2*this.random()-1)*i+(a=2*this.random()-1)*a}while(o>=1||0===o);var s=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*i*s,n=this.mean+this.stdDev*a*s,this.truncated&&!this.isValidTruncated(e)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(e)},t.prototype.convertValue=function(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)},t.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},t}(),Nu=function(){function t(t,e,n,r){this.alpha=t,this.beta=1/e,this.dtype=n;var i=r||Math.random();this.randu=Vs(i.toString()),this.randn=new Au(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return t.prototype.nextValue=function(){for(var t,e,n,r,i,a;;){do{r=this.randn.nextValue(),a=1+this.c*r}while(a<=0);if(a*=a*a,e=1-.331*(t=r*r)*t,n=.5*t+this.d*(1-a+Math.log(a)),(i=this.randu())<e||Math.log(i)<n)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)},t.prototype.convertValue=function(t){return"float32"===this.dtype?t:Math.round(t)},t}(),Iu=function(){function t(t,e,n,r){var i=this;if(void 0===t&&(t=0),void 0===e&&(e=1),this.canReturnFloat=function(){return null==i.dtype||"float32"===i.dtype},this.min=t,this.range=e-t,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+e+" <= 1 and dtype is not float");this.random=Vs(r)}return t.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},t.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},t}(),Ru=ln({randomGamma_:function(t,e,n,r,i){if(void 0===n&&(n=1),void 0===r&&(r="float32"),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type "+r);for(var a=new Nu(e,n,r,i),o=Ln(t,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),Ou=ln({randomNormal_:function(t,e,n,r,i){if(void 0===e&&(e=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var a=new Au(e,n,r,!1,i),o=Ln(t,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),ku=ln({randomUniform_:function(t,e,n,r,i){void 0===e&&(e=0),void 0===n&&(n=1),void 0===r&&(r="float32");for(var a=Ln(t,r),o=new Iu(e,n,null,i),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),Lu=ln({square_:function(t){var e=Je(t,"x","square"),n=[e];return Ft.runKernelFunc((function(t,n){return n([e]),t.square(e)}),{x:e},null,"Square",{},n,[])}}),Du=ln({squaredDifference_:function(t,e){var n,r=Je(t,"a","squaredDifference"),i=Je(e,"b","squaredDifference");n=Rt(r,i),r=n[0],i=n[1],ir(r.shape,i.shape);var a={a:r,b:i},o=[r,i];return Ft.runKernelFunc((function(t,e){var n=t.squaredDifference(r,i);return e([r,i]),n}),a,(function(t,e){var n=e[0],r=e[1],i=vn(2);return{a:function(){return t.mul(n.sub(r).mul(i))},b:function(){return t.mul(r.sub(n).mul(i))}}}),Zn,{},o,[])}}),Pu=ln({truncatedNormal_:function(t,e,n,r,i){if(void 0===e&&(e=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");for(var a=new Au(e,n,r,!0,i),o=Ln(t,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),Fu=ln({equal_:function(t,e){var n,r=Je(t,"a","equal"),i=Je(e,"b","equal");return n=Rt(r,i),r=n[0],i=n[1],ir(r.shape,i.shape),Ft.runKernelFunc((function(t){return t.equal(r,i)}),{$a:r,$b:i})}}),Bu=ln({equalStrict_:function(t,e){var n=Je(t,"a","equalStrict"),r=Je(e,"b","equalStrict");return C(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),zu=ln({greater_:function(t,e){var n,r=Je(t,"a","greater"),i=Je(e,"b","greater");return n=Rt(r,i),r=n[0],i=n[1],ir(r.shape,i.shape),Ft.runKernelFunc((function(t){return t.greater(r,i)}),{a:r,b:i},null,"Greater")}}),Uu=ln({greaterEqual_:function(t,e){var n,r=Je(t,"a","greaterEqual"),i=Je(e,"b","greaterEqual");return n=Rt(r,i),r=n[0],i=n[1],ir(r.shape,i.shape),Ft.runKernelFunc((function(t,e){var n=t.greaterEqual(r,i);return e([r,i]),n}),{a:r,b:i},(function(t,e){var n=e[0],r=e[1];return{a:function(){return Cn(n)},b:function(){return Cn(r)}}}),"GreaterEqual")}}),ju=ln({greaterEqualStrict_:function(t,e){var n=Je(t,"a","greaterEqualStrict"),r=Je(e,"b","greaterEqualStrict");return C(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),Wu=ln({greaterStrict_:function(t,e){var n=Je(t,"a","greaterStrict"),r=Je(e,"b","greaterStrict");return C(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),Vu=ln({less_:function(t,e){var n,r=Je(t,"a","less"),i=Je(e,"b","less");return n=Rt(r,i),r=n[0],i=n[1],ir(r.shape,i.shape),Ft.runKernelFunc((function(t){return t.less(r,i)}),{a:r,b:i},null,"Less")}}),Hu=ln({lessEqual_:function(t,e){var n,r=Je(t,"a","lessEqual"),i=Je(e,"b","lessEqual");return n=Rt(r,i),r=n[0],i=n[1],ir(r.shape,i.shape),Ft.runKernelFunc((function(t,e){var n=t.lessEqual(r,i);return e([r,i]),n}),{a:r,b:i},null,"LessEqual")}}),Gu=ln({lessEqualStrict_:function(t,e){var n=Je(t,"a","lessEqualStrict"),r=Je(e,"b","lessEqualStrict");return C(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),qu=ln({lessStrict_:function(t,e){var n=Je(t,"a","lessStrict"),r=Je(e,"b","lessStrict");return C(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),Xu=ln({notEqual_:function(t,e){var n,r=Je(t,"a","notEqual"),i=Je(e,"b","notEqual");return n=Rt(r,i),r=n[0],i=n[1],ir(r.shape,i.shape),Ft.runKernelFunc((function(t){return t.notEqual(r,i)}),{a:r,b:i},null,"NotEqual")}}),$u=ln({notEqualStrict_:function(t,e){var n=Je(t,"a","notEqualStrict"),r=Je(e,"b","notEqualStrict");return C(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function Yu(t,e){for(var n=[],r=t;r<e;++r)n.push(r);return n}function Ku(t){for(var e=[],n=0;n<t.length;++n)for(var r=0;r<t[n].length;++r)e.push(t[n][r]);return e}var Ju=ln({gather_:function(t,e,n){void 0===n&&(n=0);var r=Je(t,"x","gather"),i=Je(e,"indices","gather","int32");n=B(n,r.shape)[0];var a=function(t,e,n){for(var r=t.shape[n],i=[],a=1,o=1,s=0;s<n;s++)i.push(t.shape[s]),a*=t.shape[s];for(s=0;s<e.rank;s++)i.push(e.shape[s]);for(s=n+1;s<t.rank;s++)i.push(t.shape[s]),o*=t.shape[s];return{batchSize:a,sliceSize:o,dimSize:r,outputShape:i}}(r,i,n);return Ft.runKernelFunc((function(t,e){var a=t.gather(r,i.flatten(),n);return e([i]),a}),{x:r,indices:i},(function(t,e){var i=e[0];return{x:function(){var e=r.shape,a=i.size,o=e.slice(0,n),s=o.length,u=e.slice(n,e.length).slice(1),c=u.length,l=Yu(0,s),h=Yu(s+1,s+1+c),p=Ku([o,[a],u]),f=t.reshape(p),d=i.reshape([a]),m=Ku([[s],l,h]),v=f.transpose(m),g=Zu(v,d,r.shape[n]),y=on(m);return g.transpose(y)},indices:function(){return i}}}),"Gather",{axis:n}).reshape(a.outputShape)}}),Zu=ln({unsortedSegmentSum_:function(t,e,n){var r=Je(t,"x","unsortedSegmentSum"),i=Je(e,"segmentIds","unsortedSegmentSum","int32");return T(O(n),(function(){return"numSegments must be of dtype int"})),Ft.runKernelFunc((function(t,e){var a=t.unsortedSegmentSum(r,i,n);return e([i]),a}),{$x:r},(function(t,e){var n=e[0];return{$x:function(){return function(t,e){for(var n=Vr(e,Cn(e)),r=Ju(t,n),i=Uu(e,vn(0,"int32")),a=r.rank-i.rank,o=0;o<a;++o)i=zn(i,o+1);i=uu(i,wn(r.shape,"bool"));var s=Cn(r);return pu(i,r,s)}(t,n)}}}))}});function Qu(t,e,n,r,i,a,o){void 0===a&&(a="NHWC"),T(t.length===e.rank,(function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"}));var s=t,u=e,c=!1;3===e.rank&&(c=!0,u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),s=[1,t[0],t[1],t[2]]),T(4===s.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."})),T(4===u.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank})),T(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank}));var l="NHWC"===a?s[3]:s[1],h="NHWC"===a?u.shape[3]:u.shape[1];T(l===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input ("+l+") must match input depth for filter "+n.shape[2]+"."})),T(h===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output ("+h+") must match output depth for filter "+n.shape[3]+"."})),null!=o&&T(O(i),(function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var p=Pi(a),f=Ci(s,n.shape,r,1,i,o,!1,p),d=Ft.runKernelFunc((function(t,e){var r=t.conv2dDerInput(u,n,f);return e([n,u]),r}),{dy4D:u,filter:n},(function(t,e){var n=e[0],s=e[1];return{dy4D:function(){return rc(t,n,r,i,a,1,o)},filter:function(){return ac(t,s,n.shape,r,i,a,o)}}}));return c?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}function tc(t){var e=function(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}(t),n=e[0],r=e[1],i=e[2];return 1===n&&1===r&&1===i}function ec(t,e,n,r,i){T(t.length===e.rank,(function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"}));var a=t,o=e,s=!1;4===e.rank&&(s=!0,o=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]),a=[1,t[0],t[1],t[2],t[3]]);var u=a[4],c=o.shape[4];T(5===a.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+a.length+"."})),T(5===o.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+o.rank})),T(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank})),T(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."})),T(c===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output ("+c+") must match output depth for filter "+n.shape[4]+"."}));var l=Ai(a,n.shape,r,1,i),h=Ft.runKernelFunc((function(t){return t.conv3dDerInput(o,n,l)}),{dy5D:o});return s?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}var nc=ln({conv1d_:function(t,e,n,r,i,a,o){void 0===i&&(i="NWC"),void 0===a&&(a=1);var s=Je(t,"x","conv1d"),u=Je(e,"filter","conv1d"),c=s,l=!1;2===s.rank&&(l=!0,c=s.as3D(1,s.shape[0],s.shape[1])),T(3===c.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank "+c.rank+"."})),T(3===u.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."})),null!=o&&T(O(r),(function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."})),T(c.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input ("+c.shape[2]+") must match input depth for filter "+u.shape[1]+"."})),T(Di(n,a),(function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+a+"'"})),T("NWC"===i,(function(){return"Error in conv1d: got dataFormat of "+i+" but only NWC is currently supported."}));var h=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),p=c.as4D(c.shape[0],1,c.shape[1],c.shape[2]),f=rc(p,h,[1,n],r,"NHWC",[1,a],o);return l?f.as2D(f.shape[2],f.shape[3]):f.as3D(f.shape[0],f.shape[2],f.shape[3])}}),rc=ln({conv2d_:function(t,e,n,r,i,a,o){void 0===i&&(i="NHWC"),void 0===a&&(a=[1,1]);var s=Je(t,"x","conv2d"),u=Je(e,"filter","conv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),T(4===c.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank "+c.rank+"."})),T(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."})),null!=o&&T(O(r),(function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}));var h="NHWC"===i?c.shape[3]:c.shape[1];T(h===u.shape[2],(function(){return"Error in conv2d: depth of input ("+h+") must match input depth for filter "+u.shape[2]+"."})),T(Di(n,a),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}));var p=Pi(i),f=Ci(c.shape,u.shape,n,a,r,o,!1,p),d=[u,c],m=Ft.runKernelFunc((function(t,e){var n=t.conv2d(c,u,f);return e([u,c]),n}),{x:c,filter:u},(function(t,e){var o=e,s=o[0],u=o[1];return T(Li(a),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+a+"'"})),{x:function(){return oc(u.shape,t,s,n,r,i)},filter:function(){return ac(u,t,s.shape,n,r,i)}}}),"Conv2D",f,d);return l?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),ic=ln({conv3d_:function(t,e,n,r,i,a){void 0===i&&(i="NDHWC"),void 0===a&&(a=[1,1,1]);var o=Je(t,"x","conv3d"),s=Je(e,"filter","conv3d"),u=o,c=!1;4===o.rank&&(c=!0,u=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3])),T(5===u.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."})),T(5===s.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."})),T(u.shape[4]===s.shape[3],(function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."})),T(function(t,e){return tc(t)||tc(e)}(n,a),(function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"})),T("NDHWC"===i,(function(){return"Error in conv3d: got dataFormat of "+i+" but only NDHWC is currently supported."}));var l=Ai(u.shape,s.shape,n,a,r),h=Ft.runKernelFunc((function(t,e){var n=t.conv3d(u,s,l);return e([u,s]),n}),{x:u,$filter:s},(function(t,e){T(tc(a),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+a+"'"}));var i=e[0],o=e[1];return{x:function(){return ec(i.shape,t,o,n,r)},$filter:function(){return function(t,e,n,r,i){var a=t;4===t.rank&&(a=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]));var o=e;4===o.rank&&(o=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3])),T(5===a.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+a.shape+"."})),T(5===o.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+o.shape+"."})),T(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."})),T(a.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input "+a.shape[4]+") must match input depth in filter ("+n[3]+"."})),T(o.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy ("+o.shape[4]+") must match output depth for filter ("+n[4]+")."}));var s=Ai(a.shape,n,r,1,i);return Ft.runKernelFunc((function(t){return t.conv3dDerFilter(a,o,s)}),{x5D:a,dy5D:o})}(i,t,o.shape,n,r)}}}));return c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),ac=ln({conv2dDerFilter_:function(t,e,n,r,i,a,o){void 0===a&&(a="NHWC");var s=t;3===t.rank&&(s=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var u=e;3===u.rank&&(u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),T(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."})),T(4===u.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."})),T(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."}));var c="NHWC"===a?s.shape[3]:s.shape[1],l="NHWC"===a?u.shape[3]:u.shape[1];T(c===n[2],(function(){return"Error in conv2dDerFilter: depth of input "+c+") must match input depth in filter ("+n[2]+"."})),T(l===n[3],(function(){return"Error in conv2dDerFilter: depth of dy ("+l+") must match output depth for filter ("+n[3]+")."})),null!=o&&T(O(i),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var h=Pi(a),p=Ci(s.shape,n,r,1,i,o,!1,h);return Ft.runKernelFunc((function(t){return t.conv2dDerFilter(s,u,p)}),{x4D:s,dy4D:u})}}),oc=ln({conv2dDerInput_:Qu}),sc=ln({depthwiseConv2d_:function(t,e,n,r,i,a,o){void 0===i&&(i="NHWC"),void 0===a&&(a=[1,1]);var s=Je(t,"x","depthwiseConv2d"),u=Je(e,"filter","depthwiseConv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),T(4===c.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+c.rank+"."})),T(4===u.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."})),T(c.shape[3]===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels ("+c.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."})),null==a&&(a=[1,1]),T(Di(n,a),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"})),null!=o&&T(O(r),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}));var h=Ci(c.shape,u.shape,n,a,r,o,!0),p=[c,u],f=Ft.runKernelFunc((function(t,e){var n=t.depthwiseConv2D(c,u,h);return e([c,u]),n}),{x:c,filter:u},(function(t,e){T(Li(a),(function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+a+"'"}));var n=e[0],r=e[1];return{x:function(){return uc(n.shape,t,r,h)},filter:function(){return cc(n,t,r.shape,h)}}}),"DepthwiseConv2dNative",h,p);return l?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}}),uc=ln({depthwiseConv2dDerInput_:function(t,e,n,r){var i=e,a=!1;3===e.rank&&(a=!0,i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var o=Ft.runKernelFunc((function(t){return t.depthwiseConv2DDerInput(i,n,r)}),{dy4D:i});return a?o.as3D(o.shape[1],o.shape[2],o.shape[3]):o}}),cc=ln({depthwiseConv2dDerFilter_:function(t,e,n,r){var i=t;3===t.rank&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var a=e;return 3===a.rank&&(a=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),Ft.runKernelFunc((function(t){return t.depthwiseConv2DDerFilter(i,a,r)}),{x4D:i,dy4D:a})}}),lc=ln({separableConv2d_:function(t,e,n,r,i,a,o){void 0===a&&(a=[1,1]),void 0===o&&(o="NHWC");var s=Je(t,"x","separableConv2d"),u=Je(e,"depthwiseFilter","separableConv2d"),c=Je(n,"pointwiseFilter","separableConv2d"),l=s,h=!1;if(3===s.rank&&(h=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");T(4===l.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got rank "+l.rank+"."})),T(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."})),T(4===c.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."})),T(1===c.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+c.shape[0]+"."})),T(1===c.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+c.shape[1]+"."}));var p=u.shape[2],f=u.shape[3];T(c.shape[2]===p*f,(function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+p*f+", but got "+c.shape[2]+"."}));var d=sc(l,u,r,i,o,a),m=rc(d,c,1,"valid",o);return h?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),hc=ln({conv2dTranspose_:function(t,e,n,r,i,a){return Qu(n,Je(t,"x","conv2dTranspose"),Je(e,"filter","conv2dTranspose"),r,i,"NHWC",a)}}),pc=ln({conv3dTranspose_:function(t,e,n,r,i){return ec(n,Je(t,"x","conv3dTranspose"),Je(e,"filter","conv3dTranspose"),r,i)}}),fc=ln({matMul_:function(t,e,n,r){var i;void 0===n&&(n=!1),void 0===r&&(r=!1);var a=Je(t,"a","matMul"),o=Je(e,"b","matMul");i=Rt(a,o),a=i[0],o=i[1];var s=n?a.shape[a.rank-2]:a.shape[a.rank-1],u=r?o.shape[o.rank-1]:o.shape[o.rank-2],c=n?a.shape[a.rank-1]:a.shape[a.rank-2],l=r?o.shape[o.rank-2]:o.shape[o.rank-1],h=a.shape.slice(0,-2),p=o.shape.slice(0,-2),f=I(h),d=I(p);T(a.rank>=2&&o.rank>=2&&a.rank===o.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+a.rank+" and "+o.rank+"."})),T(R(h,p),(function(){return"Error in matMul: outer dimensions ("+h+") and ("+p+") of Tensors with shapes "+a.shape+" and "+o.shape+" must match."})),T(s===u,(function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+a.shape+" and "+o.shape+" and transposeA="+n+" and transposeB="+r+" must match."}));var m=a.shape.slice(0,-2).concat([c,l]),v=n?a.as3D(f,s,c):a.as3D(f,c,s),g=r?o.as3D(d,l,u):o.as3D(d,u,l),y={transposeA:n,transposeB:r};return Ft.runKernelFunc((function(t,e){var i=t.batchMatMul(v,g,n,r);return e([v,g]),i}),{a:v,b:g},(function(t,e){var i=e,a=i[0],o=i[1];return n||r?!n&&r?{a:function(){return t.matMul(o,!1,!1)},b:function(){return t.matMul(a,!0,!1)}}:n&&!r?{a:function(){return o.matMul(t,!1,!0)},b:function(){return a.matMul(t,!1,!1)}}:{a:function(){return o.matMul(t,!0,!0)},b:function(){return t.matMul(a,!0,!0)}}:{a:function(){return t.matMul(o,!1,!0)},b:function(){return a.matMul(t,!0,!1)}}}),"BatchMatMul",y).reshape(m)}}),dc=ln({dot_:function(t,e){var n=Je(t,"t1","dot"),r=Je(e,"t2","dot");T(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."}));var i=1===n.rank?n.size:n.shape[1],a=1===r.rank?r.size:r.shape[0];return T(i===a,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+i+" and "+a+"."})),1===n.rank&&1===r.rank?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():1===n.rank&&2===r.rank?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():2===n.rank&&1===r.rank?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),mc=ln({outerProduct_:function(t,e){var n=Je(t,"v1","outerProduct"),r=Je(e,"v2","outerProduct");return T(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."})),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),vc=ln({reverse_:function(t,e){var n=Je(t,"x","reverse");if(0===n.rank)return n.clone();var r=B(e,n.shape);return Ft.runKernelFunc((function(t){return t.reverse(n,r)}),{$x:n},(function(t){return{$x:function(){return t.reverse(r)}}})).reshapeAs(n)}}),gc=ln({reverse1d_:function(t){var e=Je(t,"x","reverse");return T(1===e.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank "+e.rank+"."})),vc(e,0)}}),yc=ln({reverse2d_:function(t,e){var n=Je(t,"x","reverse");return T(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."})),vc(n,e)}}),xc=ln({reverse3d_:function(t,e){var n=Je(t,"x","reverse");return T(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."})),vc(n,e)}}),bc=ln({reverse4d_:function(t,e){var n=Je(t,"x","reverse");return T(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."})),vc(n,e)}});function wc(t,e,n,r,i,a){var o=Je(t,"x","maxPool"),s=o,u=!1;3===o.rank&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),null==r&&(r=[1,1]),T(4===s.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."})),T(Di(n,r),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"})),null!=a&&T(O(i),(function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."}));var c=Ei(s.shape,e,n,r,i,a);if(1===c.filterWidth&&1===c.filterHeight&&R(c.inShape,c.outShape))return o.clone();var l=[s],h=Ft.runKernelFunc((function(t,e){var n=t.maxPool(s,c);return e([s,n]),n}),{x:s},(function(t,a){var o=a[0],s=a[1];return{x:function(){return function(t,e,n,r,i,a,o,s){var u=Je(t,"dy","maxPoolBackprop"),c=Je(e,"input","maxPoolBackprop"),l=Je(n,"output","maxPoolBackprop");T(c.rank===u.rank,(function(){return"Rank of input ("+c.rank+") does not match rank of dy ("+u.rank+")"})),null==a&&(a=[1,1]),T(Di(i,a),(function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+a+"'"})),T(4===u.rank,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+u.rank+"."})),T(4===c.rank,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+c.rank+"."}));var h=Ei(c.shape,r,i,a,o,s);return Ft.runKernelFunc((function(t){return t.maxPoolBackprop(u,c,l,h)}),{$dy:u,$input:c})}(t,o,s,e,n,r,i)}}}),"MaxPool",c,l);return u?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}function _c(t,e,n,r,i,a){var o=Je(t,"x","avgPool","float32");null==r&&(r=[1,1]),T(Di(n,r),(function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}));var s=o,u=!1;3===o.rank&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),T(4===s.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."})),null!=a&&T(O(i),(function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."}));var c=Ei(s.shape,e,n,r,i,a);if(1===c.filterWidth&&1===c.filterHeight&&R(c.inShape,c.outShape))return o.clone();var l=Ft.runKernelFunc((function(t){return t.avgPool(s,c)}),{x:s},(function(t){return{x:function(){return function(t,e,n,r,i,a){var o=Je(t,"dy","avgPoolBackprop"),s=Je(e,"input","avgPoolBackprop");T(s.rank===o.rank,(function(){return"Rank of input ("+s.rank+") does not match rank of dy ("+o.rank+")"})),null==i&&(i=[1,1]),T(Di(r,i),(function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+i+"'"}));var u=s,c=o,l=!1;3===s.rank&&(l=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2]),c=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),T(4===c.rank,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+c.rank+"."})),T(4===u.rank,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+u.rank+"."}));var h=Ei(u.shape,n,r,i,a),p=Ft.runKernelFunc((function(t){return t.avgPoolBackprop(c,u,h)}),{dy4D:c,input4D:u});return l?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}(t,s,e,n,r,i)}}}),"AvgPool",c);return l=l.cast(o.dtype),u?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}var Sc=ln({maxPool_:function(t,e,n,r,i){return wc(t,e,n,1,r,i)}}),Mc=ln({avgPool_:function(t,e,n,r,i){return _c(t,e,n,1,r,i)}}),Ec=ln({pool_:function(t,e,n,r,i,a){null==i&&(i=[1,1]),null==a&&(a=1),0===r&&(r="valid");var o=Je(t,"x","maxPool"),s=o,u=!1;3===o.rank&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),T(Di(a,i),(function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+i+"'"}));var c,l=Ei(s.shape,e,a,i,r),h=[l.dilationHeight,l.dilationWidth];c="same"===r?function(t,e){var n=t.map((function(t,n){return t+(t-1)*(e[n]-1)})).map((function(t){return t-1})),r=n.map((function(t){return Math.floor(t/2)})),i=n.map((function(t,e){return t-r[e]}));return n.map((function(t,e){return[r[e],i[e]]}))}([l.filterHeight,l.filterWidth],h):[[0,0],[0,0]];var p=1===h[0]&&1===h[1],f=function(t,e,n){var r=n.map((function(t){return t[0]})),i=n.map((function(t){return t[1]})),a=t.concat(r,i),o=e.map((function(t,e){return(t-a[e]%t)%t})),s=i.map((function(t,e){return t+o[e]}));return[e.map((function(t,e){return[r[e],s[e]]})),e.map((function(t,e){return[0,o[e]]}))]}([l.inHeight,l.inWidth],h,c),d=f[0],m=f[1],v=p?r:"valid",g=p?s:jn(s,h,d),y=("avg"===n?function(){return _c(g,e,a,1,v)}:function(){return wc(g,e,a,1,v)})(),x=p?y:Dn(y,h,m);return u?x.as3D(x.shape[1],x.shape[2],x.shape[3]):x}}),Tc=ln({maxPool3d_:function(t,e,n,r,i,a,o){void 0===a&&(a="NDHWC");var s=Je(t,"x","maxPool3d"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==o&&(o=[1,1,1]),T(5===u.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."})),T("NDHWC"===a,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+a})),T(Di(n,o),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),null!=i&&T(O(r),(function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."}));var l=Ti(u.shape,e,n,o,r,i,a),h=Ft.runKernelFunc((function(t,e){var n=t.maxPool3d(u,l);return e([u,n]),n}),{x:u},(function(t,a){var s=a[0],u=a[1];return{x:function(){return function(t,e,n,r,i,a,o,s){var u=Je(t,"dy","maxPool3dBackprop"),c=Je(e,"input","maxPool3dBackprop"),l=Je(n,"output","maxPool3dBackprop"),h=u,p=c,f=l,d=!1;4===c.rank&&(d=!0,h=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]),p=c.as5D(1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]),f=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),T(5===h.rank,(function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+h.rank+"."})),T(5===p.rank,(function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+p.rank+"."})),T(5===f.rank,(function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+f.rank+"."})),null==a&&(a=[1,1,1]),T(Di(i,a),(function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+a+"'"})),null!=s&&T(O(o),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+o+"."}));var m=Ti(p.shape,r,i,a,o,s),v=Ft.runKernelFunc((function(t){return t.maxPool3dBackprop(h,p,f,m)}),{dy5D:h,input5D:p});return d?v.as4D(v.shape[1],v.shape[2],v.shape[3],v.shape[4]):v}(t,s,u,e,n,o,r,i)}}}));return c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),Cc=ln({avgPool3d_:function(t,e,n,r,i,a,o){void 0===a&&(a="NDHWC");var s=Je(t,"x","avgPool3d","float32"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==o&&(o=[1,1,1]),T(5===u.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."})),T("NDHWC"===a,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+a})),T(Di(n,o),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),null!=i&&T(O(r),(function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."}));var l=Ti(u.shape,e,n,o,r,i,a),h=Ft.runKernelFunc((function(t){return t.avgPool3d(u,l)}),{x:u},(function(t){return{x:function(){return function(t,e,n,r,i,a,o){var s=Je(t,"dy","avgPool3dBackprop"),u=Je(e,"input","avgPool3dBackprop"),c=s,l=u,h=!1;4===u.rank&&(h=!0,c=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]),l=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3])),T(5===c.rank,(function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+c.rank+"."})),T(5===l.rank,(function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+l.rank+"."})),null==i&&(i=[1,1,1]),T(Di(r,i),(function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+i+"'"})),null!=o&&T(O(a),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+a+"."}));var p=Ti(l.shape,n,r,i,a,o),f=Ft.runKernelFunc((function(t){return t.avgPool3dBackprop(c,l,p)}),{dy5D:c,input5D:l});return h?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}(t,u,e,n,o,r,i)}}}));return h=h.cast(u.dtype),c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),Ac=ln({maxPoolWithArgmax_:function(t,e,n,r,i){void 0===i&&(i=!1);var a=Je(t,"x","maxPoolWithArgmax"),o={filterSize:e,strides:n,pad:r,includeBatchInIndex:i},s=Ft.runKernel("MaxPoolWithArgmax",{x:a},o);return{result:s[0],indexes:s[1]}}}),Nc=ln({slice_:function(t,e,n){var r,i,a=Je(t,"x","slice");if(0===a.rank)throw new Error("Slicing scalar is not possible");(r="number"==typeof e?[e].concat(new Array(a.rank-1).fill(0)):e.length<a.rank?e.concat(new Array(a.rank-e.length).fill(0)):e.slice()).forEach((function(t){T(-1!==t,(function(){return"slice() does not support negative begin indexing."}))})),i=(i=null==n?new Array(a.rank).fill(-1):"number"==typeof n?[n].concat(new Array(a.rank-1).fill(-1)):n.length<a.rank?n.concat(new Array(a.rank-n.length).fill(-1)):n).map((function(t,e){return t>=0?t:(T(-1===t,(function(){return"Negative size values should be exactly -1 but got "+t+" for the slice() size at index "+e+"."})),a.shape[e]-r[e])})),li(a,r,i);var o=a.shape,s={begin:r,size:i};return Ft.runKernelFunc((function(t){return t.slice(a,r,i)}),{x:a},(function(t){for(var e=[],n=0;n<t.rank;n++)e.push([r[n],o[n]-r[n]-i[n]]);return{x:function(){return xu(t,e)}}}),"Slice",s)}}),Ic=ln({slice1d_:function(t,e,n){var r=Je(t,"x","slice1d");return T(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"})),Nc(r,[e],[n])}}),Rc=ln({slice2d_:function(t,e,n){var r=Je(t,"x","slice2d");return T(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"})),Nc(r,e,n)}}),Oc=ln({slice3d_:function(t,e,n){var r=Je(t,"x","slice3d");return T(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"})),Nc(r,e,n)}}),kc=ln({slice4d_:function(t,e,n){var r=Je(t,"x","slice4d");return T(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"})),Nc(r,e,n)}});function Lc(t,e,n,r,i){return e.rank<n.rank&&(e=e.reshape(nn(e.shape,r))),t.rank<n.rank&&(t=t.reshape(nn(t.shape,r))),{x:function(){var r=t.mul(n.equal(e).cast(t.dtype));return null==i?r:r.transpose(i)}}}var Dc=ln({all_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Je(t,"x","all","bool"),i=B(e,r.shape),a=i,o=an(a,r.rank);null!=o&&(r=r.transpose(o),a=sn(a.length,r.rank));var s=Ft.runKernelFunc((function(t){return t.all(r,a)}),{$x:r});if(n){var u=nn(s.shape,i);return s.reshape(u)}return s}}),Pc=ln({any_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Je(t,"x","any","bool"),i=B(e,r.shape),a=i,o=an(a,r.rank);null!=o&&(r=r.transpose(o),a=sn(a.length,r.rank));var s=Ft.runKernelFunc((function(t){return t.any(r,a)}),{$x:r});if(n){var u=nn(s.shape,i);return s.reshape(u)}return s}}),Fc=ln({argMax_:function(t,e){void 0===e&&(e=0);var n=Je(t,"x","argMax");null==e&&(e=0);var r=B(e,n.shape),i=an(r,n.rank);null!=i&&(n=n.transpose(i),r=sn(r.length,n.rank));var a={axis:r[0]},o=[n];return Ft.runKernelFunc((function(t,e){var i=t.argMax(n,r[0]);return e([n]),i}),{x:n},(function(t,e){var n=e[0];return{x:function(){return Cn(n)}}}),"ArgMax",a,o)}}),Bc=ln({argMin_:function(t,e){void 0===e&&(e=0);var n=Je(t,"x","argMin");null==e&&(e=0);var r=B(e,n.shape),i=an(r,n.rank);return null!=i&&(n=n.transpose(i),r=sn(r.length,n.rank)),Ft.runKernelFunc((function(t,e){var i=t.argMin(n,r[0]);return e([n]),i}),{$x:n},(function(t,e){var n=e[0];return{$x:function(){return Cn(n)}}}))}}),zc=ln({logSumExp_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Je(t,"x","logSumExp"),i=B(e,r.shape),a=r.max(i,!0),o=r.sub(a).exp().sum(i).log(),s=a.reshape(o.shape).add(o);if(n){var u=nn(s.shape,i);return s.reshape(u)}return s}}),Uc=ln({max_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Je(t,"x","max"),i=r,a=B(e,r.shape),o=a,s=an(o,r.rank);null!=s&&(r=r.transpose(s),o=sn(o.length,r.rank));var u=[r],c=Ft.runKernelFunc((function(t,e){var n=t.max(r,o);return e([i,n]),n}),{x:r},(function(t,e){return Lc(t,e[1],e[0],a,s)}),"Max",{axes:o},u,[!0]);if(n){var l=nn(c.shape,a);c=c.reshape(l)}return c}}),jc=ln({mean_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Je(t,"x","mean"),i=B(e,r.shape),a=I(en(r.shape,i)[1]);return yi((function(t){var r=vn(a);return{value:(r.dtype===t.dtype?t:t.cast(r.dtype)).div(r).sum(e,n),gradFunc:function(e){var n=t.shape.slice();return i.forEach((function(t){n[t]=1})),e.reshape(n).mul(wn(t.shape,"float32")).div(a)}}}))(r)}}),Wc=ln({min_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Je(t,"x","min"),i=r,a=B(e,r.shape),o=a,s=an(o,r.rank);null!=s&&(r=r.transpose(s),o=sn(o.length,r.rank));var u=[r],c=Ft.runKernelFunc((function(t,e){var n=t.min(r,o);return e([i,n]),n}),{x:r},(function(t,e){return Lc(t,e[1],e[0],a,s)}),"Min",{axes:o},u,[!0]);if(n){var l=nn(c.shape,a);c=c.reshape(l)}return c}}),Vc=ln({moments_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=B(e,(t=Je(t,"x","moments")).shape),i=t.mean(r,n),a=i.shape;n||(a=nn(i.shape,r));var o=t.toFloat().sub(i.reshape(a)).square();return{mean:i,variance:o.mean(r,n)}}}),Hc=ln({sum_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Je(t,"x","sum");"bool"===r.dtype&&(r=r.toInt());var i=B(e,r.shape);return yi((function(t){var e=an(i,t.rank),r=i,a=t;null!=e&&(a=t.transpose(e),r=sn(r.length,t.rank));var o=function(e){var n=t.shape.slice();return i.forEach((function(t){n[t]=1})),e.reshape(n).mul(wn(t.shape,"float32"))},s={axes:r},u=Ft.runKernelFunc((function(t){return t.sum(a,r)}),{x:a},(function(t){return{x:function(){return o(t)}}}),"Sum",s);if(n){var c=nn(u.shape,i);u=u.reshape(c)}return{value:u,gradFunc:o}}))(r)}}),Gc=ln({prod_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Je(t,"x","prod");"bool"===r.dtype&&(r=r.toInt());var i=B(e,r.shape),a=an(i,r.rank),o=i,s=r;null!=a&&(s=r.transpose(a),o=sn(o.length,r.rank));var u=Ft.runKernelFunc((function(t){return t.prod(s,o)}),{permutedX:s});if(n){var c=nn(u.shape,i);u=u.reshape(c)}return u}}),qc=ln({elu_:function(t){var e=Je(t,"x","elu");return Ft.runKernelFunc((function(t,n){var r=t.elu(e);return n([r]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return Ft.runKernelFunc((function(e){return e.eluDer(t,n)}),{dy:t,y:n})}}}))}}),Xc=ln({leakyRelu_:function(t,e){void 0===e&&(e=.2);var n=Je(t,"x","leakyRelu");return Vr(vn(e).mul(n),n)}}),$c=ln({prelu_:function(t,e){var n=Je(t,"x","prelu"),r=Je(e,"alpha","prelu");return Ft.runKernelFunc((function(t,e){var i=t.prelu(n,r);return e([n,r]),i}),{x:n,alpha:r},(function(t,e){var n=e[0],r=e[1],i=n.greater(0);return{x:function(){return pu(i,t,t.mul(r))},alpha:function(){var e=pu(i,Cn(t),t.mul(n)),a=rr(r.shape,t.shape);return a.length>0&&(e=e.sum(a)),e.reshape(r.shape)}}}),"Prelu")}}),Yc=ln({relu_:function(t){var e=Je(t,"x","relu");return"bool"===e.dtype?e.toInt():Ft.runKernelFunc((function(t,n){var r=t.relu(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.mulStrict(n.step().toFloat())}}}),"Relu")}}),Kc=ln({relu6_:function(t){var e=Je(t,"x","relu6");return"bool"===e.dtype?e.toInt():Ft.runKernelFunc((function(t,n){var r=t.relu6(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0],r=n.lessEqual(6).mul(n.step());return{x:function(){return t.mulStrict(r.toFloat())}}}),"Relu6")}}),Jc=ln({selu_:function(t){var e=Je(t,"x","selu");return Ft.runKernelFunc((function(t,n){var r=t.selu(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){var e=n.greater(vn(0)),r=vn(fs),i=vn(ds),a=t.mul(i),o=t.mul(r).mul(n.toFloat().exp());return pu(e,a,o)}}}))}}),Zc=ln({localResponseNormalization_:function(t,e,n,r,i){void 0===e&&(e=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=.5);var a=Je(t,"x","localResponseNormalization");T(4===a.rank||3===a.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+a.rank+"."})),T(O(e),(function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+e+"."}));var o=a,s=!1;3===a.rank&&(s=!0,o=a.as4D(1,a.shape[0],a.shape[1],a.shape[2]));var u=Ft.runKernelFunc((function(t,a){var s=t.localResponseNormalization4D(o,e,n,r,i);return a([o,s]),s}),{x4D:o},(function(t,a){var o=a[0],s=a[1];return{x4D:function(){return Ft.runKernelFunc((function(a){return a.LRNGrad(t,o,s,e,n,r,i)}),{})}}}));return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Qc=ln({norm_:function(t,e,n,r){void 0===e&&(e="euclidean"),void 0===n&&(n=null),void 0===r&&(r=!1);var i=function t(e,n,r){if(void 0===r&&(r=null),0===e.rank)return e.abs();if(1!==e.rank&&null===r)return t(e.reshape([-1]),n,r);if(1===e.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return e.abs().sum(r);if(n===1/0)return e.abs().max(r);if(n===-1/0)return e.abs().min(r);if("euclidean"===n||2===n)return e.abs().pow(vn(2,"int32")).sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}if(Array.isArray(r)&&2===r.length){if(1===n)return e.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return e.abs().sum(r[1]).max(r[0]);if(n===-1/0)return e.abs().sum(r[1]).min(r[0]);if("fro"===n||"euclidean"===n)return e.square().sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}throw new Error("Error in norm: invalid axis: "+r)}(t=Je(t,"x","norm"),e,n),a=i.shape;if(r){var o=B(n,t.shape);a=nn(i.shape,o)}return i.reshape(a)}}),tl=ln({basicLSTMCell_:function(t,e,n,r,i,a){var o=Je(t,"forgetBias","basicLSTMCell"),s=Je(e,"lstmKernel","basicLSTMCell"),u=Je(n,"lstmBias","basicLSTMCell"),c=Je(r,"data","basicLSTMCell"),l=Je(i,"c","basicLSTMCell"),h=Je(a,"h","basicLSTMCell"),p=c.concat(h,1).matMul(s).add(u),f=p.shape[0],d=p.shape[1]/4,m=[f,d],v=p.slice([0,0],m),g=p.slice([0,d],m),y=p.slice([0,2*d],m),x=p.slice([0,3*d],m),b=v.sigmoid().mulStrict(g.tanh()).addStrict(l.mulStrict(o.add(y).sigmoid())),w=b.tanh().mulStrict(x.sigmoid());return[b,w]}}),el=ln({multiRNNCell_:function(t,e,n,r){for(var i=Je(e,"data","multiRNNCell"),a=Ze(n,"c","multiRNNCell"),o=Ze(r,"h","multiRNNCell"),s=i,u=[],c=0;c<t.length;c++){var l=t[c](s,a[c],o[c]);u.push(l[0]),u.push(l[1]),s=l[1]}var h=[],p=[];for(c=0;c<u.length;c+=2)h.push(u[c]),p.push(u[c+1]);return[h,p]}}),nl=ln({movingAverage_:function(t,e,n,r,i){void 0===i&&(i=!0);var a=Je(t,"v","movingAverage"),o=Je(e,"x","movingAverage"),s=Je(n,"decay","movingAverage");Ot(a,o),T(R(a.shape,o.shape),(function(){return"Shape mismatch in v and x"}));var u=vn(1),c=u.sub(s),l=o.sub(a).mul(c);if(i){T(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var h=Je(r,"step","movingAverage");l=l.div(u.sub(Jr(s,h)))}return a.add(l)}}),rl=ln({stridedSlice_:function(t,e,n,r,i,a,o,s,u){if(void 0===i&&(i=0),void 0===a&&(a=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===u&&(u=0),null==r&&(r=new Array(e.length)),0!==o)throw new Error("ellipsis mask is not yet supported");var c=Je(t,"x","stridedSlice"),l=hi(s),h=c.shape.slice();l.forEach((function(t){e[t]=0,n[t]=1,h.splice(t,0,1)})),c=c.reshape(h);for(var p=0;p<c.rank;p++)e[p]=fi(i,e,r,c.shape,p),n[p]=di(a,n,r,c.shape,p),r[p]=r[p]||1;var f=hi(u);f.forEach((function(t){n[t]=e[t]+1,r[t]=1}));var d=pi(e,n,r),m=d.filter((function(t,e){return-1===f.indexOf(e)}));return r.every((function(t){return 1===t}))?Nc(c,e,d).reshape(m):Ft.runKernelFunc((function(t){return t.stridedSlice(c,e,n,r)}),{$x:c}).reshape(m)}}),il=ln({topk_:function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=!0);var r=Je(t,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(e>i)throw new Error("'k' passed to topk() must be <= the last dimension ("+i+") but got "+e);var a=Ft.runKernelFunc((function(t){return t.topk(r,e,n)}),{$x:r});return{values:a[0],indices:a[1]}}}),al=ln({scatterND_:function(t,e,n){var r=Je(t,"indices","scatterND","int32"),i=Je(e,"updates","scatterND");return si(i,r,n),Ft.runKernelFunc((function(t){return t.scatterND(r,i,n)}),{indices:r,updates:i},null,"ScatterNd",{shape:n})}}),ol=ln({fft_:function(t){T("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+t.dtype+"."}));var e=t.shape[t.shape.length-1],n=t.size/e,r=t.as2D(n,e);return Ft.runKernelFunc((function(t){return t.fft(r)}),{input:t}).reshape(t.shape)}}),sl=ln({ifft_:function(t){T("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+t.dtype+"."}));var e=t.shape[t.shape.length-1],n=t.size/e,r=t.as2D(n,e);return Ft.runKernelFunc((function(t){return t.ifft(r)}),{input:t}).reshape(t.shape)}}),ul=ln({rfft_:function(t,e){T("float32"===t.dtype,(function(){return"The dtype for rfft() must be real value but got "+t.dtype}));var n,r=t.shape[t.shape.length-1],i=t.size/r;if(null!=e&&e<r){var a=t.shape.map((function(t){return 0})),o=t.shape.map((function(t){return t}));o[t.shape.length-1]=e,n=t.slice(a,o),r=e}else if(null!=e&&e>r){var s=t.shape.map((function(t){return t}));s[t.shape.length-1]=e-r,n=t.concat(_n(s),t.shape.length-1),r=e}else n=t;var u=n.zerosLike(),c=hn(n,u).as2D(i,r),l=ol(c),h=Math.floor(r/2)+1,p=pn(l),f=fn(l),d=p.split([h,r-h],p.shape.length-1),m=f.split([h,r-h],f.shape.length-1),v=n.shape.slice();return v[n.shape.length-1]=h,hn(d[0],m[0]).reshape(v)}}),cl=ln({irfft_:function(t){var e=t.shape[t.shape.length-1],n=t.size/e;if(e<=2){var r=t.as2D(n,e),i=sl(r);return pn(i)}var a=[n,2*(e-1)],o=pn(t).as2D(n,e),s=fn(t).as2D(n,e),u=o.slice([0,1],[n,e-2]).reverse(1),c=s.slice([0,1],[n,e-2]).reverse(1).mul(vn(-1)),l=o.concat(u,1),h=s.concat(c,1);return r=hn(l,h).as2D(a[0],a[1]),i=sl(r),pn(i)}}),ll=Object.freeze({fft:ol,ifft:sl,rfft:ul,irfft:cl}),hl=ln({sparseToDense_:function(t,e,n,r){void 0===r&&(r=0);var i=Je(t,"sparseIndices","sparseToDense","int32"),a=Je(e,"sparseValues","sparseToDense"),o=Je(r,"defaultValue","sparseToDense",a.dtype);return function(t,e,n,r){if("int32"!==t.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+t.shape+".");var i=t.rank>0?t.shape[0]:1,a=t.rank>1?t.shape[1]:1;if(n.length!==a)throw new Error("outputShape has incorrect number of elements:, "+n.length+", should be: "+a+".");var o=e.size;if(0!==e.rank&&(1!==e.rank||o!==i))throw new Error("sparseValues has incorrect shape "+e.shape+", should be [] or ["+i+"]");if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,a,n,o),Ft.runKernelFunc((function(t){return t.sparseToDense(i,a,n,o)}),{$sparseIndices:i,$sparseValues:a,$defaultValue:o})}}),pl=ln({gatherND_:function(t,e){var n=Je(e,"indices","gatherND","int32"),r=Je(t,"x","gatherND");return Ft.runKernelFunc((function(t){return t.gatherND(r,n)}),{x:r,indices:n},null,"GatherNd")}}),fl=ln({diag_:function(t){var e=Je(t,"x","diag").flatten(),n=t.shape.concat(t.shape);return Ft.runKernelFunc((function(t){return t.diag(e)}),{$x:e}).reshape(n)}}),dl=ln({dropout_:function(t,e,n,r){var i=Je(t,"x","dropout");if(T("float32"===i.dtype,(function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+i.dtype+" tensor instead."})),T(e>=0&&e<1,(function(){return"rate must be a float in the range [0, 1), but got "+e+"."})),0===e)return t instanceof wt?i.clone():i;var a=function(t,e){if(null==e)return t.shape.slice();if(R(t.shape,e))return e;if(t.shape.length===e.length){for(var n=[],r=0;r<t.shape.length;r++)null==e[r]&&null!=t.shape[r]?n.push(t.shape[r]):n.push(e[r]);return n}return e}(i,n),o=1-e,s=ku(a,0,1,"float32",r).add(o).floor().div(o);return i.mul(s)}});function ml(t,e,n){for(var r=1-t%2,i=new Float32Array(t),a=0;a<t;++a){var o=2*Math.PI*a/(t+r-1);i[a]=e-n*Math.cos(o)}return gn(i,"float32")}var vl,gl=ln({hannWindow_:function(t){return ml(t,.5,.5)}}),yl=ln({hammingWindow_:function(t){return ml(t,.54,.46)}}),xl=ln({frame_:function(t,e,n,r,i){void 0===r&&(r=!1),void 0===i&&(i=0);for(var a=0,o=[];a+e<=t.size;)o.push(Nc(t,a,e)),a+=n;if(r)for(;a<t.size;){var s=a+e-t.size,u=An([Nc(t,a,e-s),Sn([s],i)]);o.push(u),a+=n}return 0===o.length?yn([],[0,e]):An(o).as2D(o.length,e)}}),bl=ln({stft_:function(t,e,n,r,i){var a;void 0===i&&(i=gl),null==r&&(a=e,r=Math.floor(Math.pow(2,Math.ceil(Math.log(a)/Math.log(2)))));for(var o=xl(t,e,n),s=Yr(o,i(e)),u=[],c=0;c<o.shape[0];c++)u.push(ul(s.slice([c,0],[1,e]),r));return An(u)}}),wl=Object.freeze({hannWindow:gl,hammingWindow:yl,frame:xl,stft:bl});!function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(vl||(vl={}));var _l=ln({absoluteDifference_:function(t,e,n,r){void 0===r&&(r=vl.SUM_BY_NONZERO_WEIGHTS);var i=Je(t,"labels","absoluteDifference"),a=Je(e,"predictions","absoluteDifference"),o=null;null!=n&&(o=Je(n,"weights","absoluteDifference")),C(i.shape,a.shape,"Error in absoluteDifference: ");var s=i.sub(a).abs();return Sl(s,o,r)}}),Sl=ln({computeWeightedLoss_:function(t,e,n){void 0===n&&(n=vl.SUM_BY_NONZERO_WEIGHTS);var r=Je(t,"losses","computeWeightedLoss"),i=null;null!=e&&(i=Je(e,"weights","computeWeightedLoss"));var a=null==i?r:r.mul(i);if(n===vl.NONE)return a;if(n===vl.SUM)return a.sum();if(n===vl.MEAN){if(null==i)return a.mean();var o=r.size/i.size,s=a.sum().div(i.sum());return o>1?s.div(vn(o)):s}if(n===vl.SUM_BY_NONZERO_WEIGHTS){if(null==i)return a.sum().div(vn(r.size));var u=i.mul(wn(r.shape)).notEqual(vn(0)).sum().toFloat();return a.sum().div(u)}throw Error("Unknown reduction: "+n)}}),Ml=ln({cosineDistance_:function(t,e,n,r,i){void 0===i&&(i=vl.SUM_BY_NONZERO_WEIGHTS);var a=Je(t,"labels","cosineDistance"),o=Je(e,"predictions","cosineDistance"),s=null;null!=r&&(s=Je(r,"weights","cosineDistance")),C(a.shape,o.shape,"Error in cosineDistance: ");var u=vn(1).sub(a.mul(o).sum(n,!0));return Sl(u,s,i)}}),El=ln({hingeLoss_:function(t,e,n,r){void 0===r&&(r=vl.SUM_BY_NONZERO_WEIGHTS);var i=Je(t,"labels","hingeLoss"),a=Je(e,"predictions","hingeLoss"),o=null;null!=n&&(o=Je(n,"weights","hingeLoss")),C(i.shape,a.shape,"Error in hingeLoss: ");var s=vn(1);i=vn(2).mul(i).sub(s);var u=s.sub(i.mul(a)).relu();return Sl(u,o,r)}}),Tl=ln({huberLoss_:function(t,e,n,r,i){void 0===r&&(r=1),void 0===i&&(i=vl.SUM_BY_NONZERO_WEIGHTS);var a=Je(t,"labels","huberLoss"),o=Je(e,"predictions","huberLoss"),s=null;null!=n&&(s=Je(n,"weights","huberLoss")),C(a.shape,o.shape,"Error in huberLoss: ");var u=vn(r),c=o.sub(a).abs(),l=Gr(c,u),h=c.sub(l),p=vn(.5).mul(l.square()).add(u.mul(h));return Sl(p,s,i)}}),Cl=ln({logLoss_:function(t,e,n,r,i){void 0===r&&(r=1e-7),void 0===i&&(i=vl.SUM_BY_NONZERO_WEIGHTS);var a=Je(t,"labels","logLoss"),o=Je(e,"predictions","logLoss"),s=null;null!=n&&(s=Je(n,"weights","logLoss")),C(a.shape,o.shape,"Error in logLoss: ");var u=vn(1),c=vn(r),l=a.mul(o.add(c).log()).neg().sub(u.sub(a).mul(u.sub(o).add(c).log()));return Sl(l,s,i)}}),Al=ln({meanSquaredError_:function(t,e,n,r){void 0===r&&(r=vl.SUM_BY_NONZERO_WEIGHTS);var i=Je(t,"labels","meanSquaredError"),a=Je(e,"predictions","meanSquaredError"),o=null;null!=n&&(o=Je(n,"weights","meanSquaredError")),C(i.shape,a.shape,"Error in meanSquaredError: ");var s=i.squaredDifference(a);return Sl(s,o,r)}}),Nl=ln({sigmoidCrossEntropy_:function(t,e,n,r,i){void 0===r&&(r=0),void 0===i&&(i=vl.SUM_BY_NONZERO_WEIGHTS);var a=Je(t,"multiClassLabels","sigmoidCrossEntropy"),o=Je(e,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=Je(n,"weights","sigmoidCrossEntropy")),C(a.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=vn(r),c=vn(1),l=vn(.5);a=a.mul(c.sub(u)).add(l.mul(u))}var h=function(t,e){var n=Je(t,"labels","sigmoidCrossEntropyWithLogits"),r=Je(e,"logits","sigmoidCrossEntropyWithLogits");C(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var i=r.relu(),a=r.mul(n),o=r.abs().neg().exp().log1p();return i.sub(a).add(o)}(a,o);return Sl(h,s,i)}}),Il=ln({softmaxCrossEntropy_:function(t,e,n,r,i){void 0===r&&(r=0),void 0===i&&(i=vl.SUM_BY_NONZERO_WEIGHTS);var a=Je(t,"onehotLabels","softmaxCrossEntropy"),o=Je(e,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=Je(n,"weights","softmaxCrossEntropy")),C(a.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var u=vn(r),c=vn(1),l=vn(a.shape[1]);a=a.mul(c.sub(u)).add(u.div(l))}var h=function(t,e,n){if(void 0===n&&(n=-1),-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+e.rank+" and dim was "+n);return yi((function(t,e,r){var i=e.logSumExp([n],!0),a=e.toFloat().sub(i);return r([t,a]),{value:a.mul(t).neg().sum([n]),gradFunc:function(t,e){var r=e[0],i=e[1],a=nn(t.shape,[n]);return[t.reshape(a).mul(r.toFloat().sub(i.exp())),t.reshape(a).mul(i.exp().sub(r.toFloat()))]}}}))(t,e)}(a,o);return Sl(h,s,i)}}),Rl=Object.freeze({get Reduction(){return vl},absoluteDifference:_l,computeWeightedLoss:Sl,cosineDistance:Ml,hingeLoss:El,huberLoss:Tl,logLoss:Cl,meanSquaredError:Al,sigmoidCrossEntropy:Nl,softmaxCrossEntropy:Il});function Ol(t,e){return void 0===e&&(e=!1),Ft.tidy((function(){if(2!==t.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+t.shape.length+"D Tensor.");for(var n=t.shape[0],r=t.shape[1],i=vu(n),a=t.clone(),o=yn([[1]],[1,1]),s=o.clone(),u=n>=r?r:n,c=function(t){var e,u=a,c=s,l=i;e=Ft.tidy((function(){var e=a.slice([t,t],[n-t,1]),u=e.norm(),c=a.slice([t,t],[1,1]),l=yn([[-1]]).where(c.greater(0),yn([[1]])),h=c.sub(l.mul(u)),p=e.div(h);s=1===p.shape[0]?o.clone():o.concat(p.slice([1,0],[p.shape[0]-1,p.shape[1]]),0);var f=l.matMul(h).div(u).neg(),d=a.slice([t,0],[n-t,r]),m=f.mul(s),v=s.transpose();if(0===t)a=d.sub(m.matMul(v.matMul(d)));else{var g=d.sub(m.matMul(v.matMul(d)));a=a.slice([0,0],[t,r]).concat(g,0)}var y=m.transpose(),x=i.slice([0,t],[n,i.shape[1]-t]);if(0===t)i=x.sub(x.matMul(s).matMul(y));else{var b=x.sub(x.matMul(s).matMul(y));i=i.slice([0,0],[n,t]).concat(b,1)}return[s,a,i]})),s=e[0],a=e[1],i=e[2],Ge([u,c,l])},l=0;l<u;++l)c(l);return!e&&n>r&&(i=i.slice([0,0],[n,r]),a=a.slice([0,0],[r,r])),[i,a]}))}var kl=ln({bandPart_:function(t,e,n){if(e%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+e+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=Je(t,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var i=r.shape,a=r.shape.slice(-2),o=a[0],s=a[1];if(!(e<=o))throw new Error("bandPart(): numLower ("+e+") must not be greater than the number of rows ("+o+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");e<0&&(e=o),n<0&&(n=s);var u=En(0,o,1,"int32").reshape([-1,1]),c=En(0,s,1,"int32"),l=ti(u,c),h=uu(l.lessEqual(vn(+e,"int32")),l.greaterEqual(vn(-n,"int32"))),p=_n([o,s],r.dtype);return Vn(Hn(r.reshape([-1,o,s])).map((function(t){return pu(h,t,p)}))).reshape(i)}}),Ll=ln({gramSchmidt_:function(t){var e;if(Array.isArray(t)){e=!1,T(null!=t&&t.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=t[0].shape[0],r=function(e){T(t[e].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+t[e].shape[0]+" vs. "+n+")"}))},i=1;i<t.length;++i)r(i)}else e=!0,t=kn(t,t.shape[0],0).map((function(t){return Wn(t,[0])}));T(t.length<=t[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors ("+t.length+") exceeds number of dimensions ("+t[0].shape[0]+")."}));var a=[],o=t,s=function(t){a.push(Ft.tidy((function(){var e=o[t];if(t>0)for(var n=0;n<t;++n){var r=Hc(a[n].mulStrict(e)).mul(a[n]);e=e.sub(r)}return e.div(Qc(e,"euclidean"))})))};for(i=0;i<t.length;++i)s(i);return e?Vn(a,0):a}}),Dl=ln({qr_:function(t,e){if(void 0===e&&(e=!1),t.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+t.rank);if(2===t.rank)return Ol(t,e);var n=t.shape.slice(0,t.shape.length-2).reduce((function(t,e){return t*e})),r=Hn(t.reshape([n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),i=[],a=[];return r.forEach((function(t){var n=Ol(t,e),r=n[0],o=n[1];i.push(r),a.push(o)})),[Vn(i,0).reshape(t.shape),Vn(a,0).reshape(t.shape)]}}),Pl=Object.freeze({bandPart:kl,gramSchmidt:Ll,qr:Dl});function Fl(t,e,n,r,i,a){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY),null==a&&(a=0);var o=t.shape[0];return n=Math.min(n,o),T(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"})),T(2===t.rank,(function(){return"boxes must be a 2D tensor, but was of rank '"+t.rank+"'"})),T(4===t.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was "+t.shape[1]})),T(1===e.rank,(function(){return"scores must be a 1D tensor"})),T(e.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected "+o+", but was "+e.shape[0]})),T(0<=a&&a<=1,(function(){return"softNmsSigma must be in [0, 1], but was '"+a+"'"})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:a}}var Bl=ln({resizeBilinear_:function(t,e,n){void 0===n&&(n=!1);var r=Je(t,"images","resizeBilinear");T(3===r.rank||4===r.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."})),T(2===e.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."}));var i=r,a=!1;3===r.rank&&(a=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=e[0],s=e[1],u=Ft.runKernelFunc((function(t,e){return e([i]),t.resizeBilinear(i,o,s,n)}),{x:i},(function(t,e){return{x:function(){return Ft.runKernelFunc((function(r){return r.resizeBilinearBackprop(t,e[0],n)}),{})}}}),"ResizeBilinear",{alignCorners:n,newHeight:o,newWidth:s});return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),zl=ln({resizeNearestNeighbor_:function(t,e,n){void 0===n&&(n=!1);var r=Je(t,"images","resizeNearestNeighbor");T(3===r.rank||4===r.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."})),T(2===e.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."})),T("float32"===r.dtype||"int32"===r.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"}));var i=r,a=!1;3===r.rank&&(a=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=e[0],s=e[1],u=Ft.runKernelFunc((function(t,e){return e([i]),t.resizeNearestNeighbor(i,o,s,n)}),{batchImages:i},(function(t,e){return{batchImages:function(){return Ft.runKernelFunc((function(r){return r.resizeNearestNeighborBackprop(t,e[0],n)}),{})}}}));return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Ul=ln({nonMaxSuppression_:function(t,e,n,r,i){void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY);var a=Je(t,"boxes","nonMaxSuppression"),o=Je(e,"scores","nonMaxSuppression"),s=Fl(a,o,n,r,i);n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:i};return Ft.runKernelFunc((function(t){return t.nonMaxSuppression(a,o,n,r,i)}),{boxes:a,scores:o},null,"NonMaxSuppressionV3",u)}}),jl=ln({nonMaxSuppressionWithScore_:function(t,e,n,r,i,a){void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),void 0===a&&(a=0);var o=Je(t,"boxes","nonMaxSuppression"),s=Je(e,"scores","nonMaxSuppression"),u=Fl(o,s,n,r,i,a),c={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:i=u.scoreThreshold,softNmsSigma:a=u.softNmsSigma},l=Ft.runKernel("NonMaxSuppressionV5",{boxes:o,scores:s},c);return{selectedIndices:l[0],selectedScores:l[1]}}}),Wl=ln({cropAndResize_:function(t,e,n,r,i,a){var o=Je(t,"image","cropAndResize"),s=Je(e,"boxes","cropAndResize","float32"),u=Je(n,"boxInd","cropAndResize","int32");i=i||"bilinear",a=a||0;var c=s.shape[0];return T(4===o.rank,(function(){return"Error in cropAndResize: image must be rank 4,but got rank "+o.rank+"."})),T(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size ["+c+",4] but had shape "+s.shape+"."})),T(1===u.rank&&u.shape[0]===c,(function(){return"Error in cropAndResize: boxInd must be have size ["+c+"] but had shape "+s.shape+"."})),T(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."})),T(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was "+r})),T("bilinear"===i||"nearest"===i,(function(){return"method must be bilinear or nearest, but was "+i})),Ft.runKernelFunc((function(t,e){return t.cropAndResize(o,s,u,r,i,a)}),{images:o,boxes:s,boxInd:u},null,"CropAndResize",{method:i,extrapolationValue:a,cropSize:r})}}),Vl=Object.freeze({resizeBilinear:Bl,resizeNearestNeighbor:zl,nonMaxSuppression:Ul,nonMaxSuppressionAsync:function(t,e,n,r,i){return void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),u(this,void 0,void 0,(function(){var a,o,s,u,l,h,p;return c(this,(function(c){switch(c.label){case 0:return a=Je(t,"boxes","nonMaxSuppressionAsync"),o=Je(e,"scores","nonMaxSuppressionAsync"),s=Fl(a,o,n,r,i),n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold,[4,Promise.all([a.data(),o.data()])];case 1:return u=c.sent(),l=u[0],h=u[1],p=Xi(l,h,n,r,i),a!==t&&a.dispose(),o!==e&&o.dispose(),[2,p]}}))}))},nonMaxSuppressionWithScore:jl,nonMaxSuppressionWithScoreAsync:function(t,e,n,r,i,a){return void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),void 0===a&&(a=0),u(this,void 0,void 0,(function(){var o,s,u,l,h,p,f;return c(this,(function(c){switch(c.label){case 0:return o=Je(t,"boxes","nonMaxSuppressionAsync"),s=Je(e,"scores","nonMaxSuppressionAsync"),u=Fl(o,s,n,r,i,a),n=u.maxOutputSize,r=u.iouThreshold,i=u.scoreThreshold,a=u.softNmsSigma,[4,Promise.all([o.data(),s.data()])];case 1:return l=c.sent(),h=l[0],p=l[1],f=$i(h,p,n,r,i,a),o!==t&&o.dispose(),s!==e&&s.dispose(),[2,f]}}))}))},cropAndResize:Wl}),Hl=function(t,e){return!(t>0)||"linear"===e},Gl=function(t,e,n){if(null==n||"linear"===n)return t;if("relu"===n)return t.mul(e.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},ql=function(t,e){var n=e,r=rr(t.shape,e.shape);return r.length>0&&(n=n.sum(r)),n.reshape(t.shape)},Xl=function(t,e,n){if("linear"===e)return t;if("relu"===e)return Yc(t);if("elu"===e)return qc(t);if("relu6"===e)return Kc(t);if("prelu"===e)return $c(t,n);throw new Error("Unknown fused activation "+e+".")},$l=ln({fusedMatMul_:function(t){var e,n=t.a,r=t.b,i=t.transposeA,a=void 0!==i&&i,o=t.transposeB,s=void 0!==o&&o,u=t.bias,c=t.activation,l=void 0===c?"linear":c,h=t.preluActivationWeights;if(!1===Hl(Ft.state.gradientDepth,l)){var p=fc(n,r,a,s);return null!=u&&(p=er(p,u)),Xl(p,l,h)}var f=Je(n,"a","fused matMul"),d=Je(r,"b","fused matMul");e=Rt(f,d),f=e[0],d=e[1];var m=a?f.shape[f.rank-2]:f.shape[f.rank-1],v=s?d.shape[d.rank-1]:d.shape[d.rank-2],g=a?f.shape[f.rank-1]:f.shape[f.rank-2],y=s?d.shape[d.rank-2]:d.shape[d.rank-1],x=f.shape.slice(0,-2),b=d.shape.slice(0,-2),w=I(x),_=I(b);T(f.rank>=2&&d.rank>=2&&f.rank===d.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+f.rank+" and "+d.rank+"."})),T(R(x,b),(function(){return"Error in fused matMul: outer dimensions ("+x+") and ("+b+") of Tensors with shapes "+f.shape+" and "+d.shape+" must match."})),T(m===v,(function(){return"Error in fused matMul: inner shapes ("+m+") and ("+v+") of Tensors with shapes "+f.shape+" and "+d.shape+" and transposeA="+a+" and transposeB="+s+" must match."}));var S,M,E=f.shape.slice(0,-2).concat([g,y]),C=a?f.as3D(w,m,g):f.as3D(w,g,m),A=s?d.as3D(_,y,v):d.as3D(_,v,y);null!=u&&ir(E,(S=Rt(S=Je(u,"bias","fused matMul"),f)[0]).shape),null!=h&&(M=Je(h,"prelu weights","fused matMul"));var N={a:C,b:A};null!=u&&(N.bias=S),null!=h&&(N.preluActivationWeights=M);var O=[C,A];return Ft.runKernelFunc((function(t,e){var n=t.fusedBatchMatMul({a:C,b:A,transposeA:a,transposeB:s,bias:S,activation:l,preluActivationWeights:M});return e([C,A,n]),n}),N,(function(t,e){var n=e[0],r=e[1],i=e[2],o=Gl(t,i,l),c={};return null!=u&&(c={bias:function(){return ql(S,o)}}),a||s?!a&&s?Object.assign({a:function(){return o.matMul(r,!1,!1)},b:function(){return o.matMul(n,!0,!1)}},c):a&&!s?Object.assign({a:function(){return r.matMul(o,!1,!0)},b:function(){return n.matMul(o,!1,!1)}},c):Object.assign({a:function(){return r.matMul(o,!0,!0)},b:function(){return o.matMul(n,!0,!0)}},c):Object.assign({a:function(){return o.matMul(r,!1,!0)},b:function(){return n.matMul(o,!0,!1)}},c)}),"_FusedMatMul",{transposeA:a,transposeB:s,activation:l},O,[!0]).reshape(E)}}),Yl=ln({fusedConv2d_:function(t){var e=t.x,n=t.filter,r=t.strides,i=t.pad,a=t.dataFormat,o=void 0===a?"NHWC":a,s=t.dilations,u=void 0===s?[1,1]:s,c=t.dimRoundingMode,l=t.bias,h=t.activation,p=void 0===h?"linear":h,f=t.preluActivationWeights;if(p=p||"linear",!1===Hl(Ft.state.gradientDepth,p)){var d=rc(e,n,r,i,o,u,c);return null!=l&&(d=er(d,l)),Xl(d,p,f)}var m=Je(e,"x","conv2d"),v=Je(n,"filter","conv2d"),g=m,y=!1;3===m.rank&&(y=!0,g=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),T(4===g.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+g.rank+"."})),T(4===v.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+v.rank+"."})),null!=c&&T(O(i),(function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+i+"."})),T(g.shape[3]===v.shape[2],(function(){return"Error in conv2d: depth of input ("+g.shape[3]+") must match input depth for filter "+v.shape[2]+"."})),T(Di(r,u),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"})),T("NHWC"===o,(function(){return"Error in conv2d: got dataFormat of "+o+" but only NHWC is currently supported."}));var x,b,w=Ci(g.shape,v.shape,r,u,i,c);null!=l&&(x=Rt(x=Je(l,"bias","fused conv2d"),m)[0],ir(w.outShape,x.shape)),null!=f&&(b=Je(f,"prelu weights","fused conv2d"));var _={x:g,filter:v};null!=l&&(_.bias=x),null!=f&&(_.preluActivationWeights=b);var S=[v,g],M=Ft.runKernelFunc((function(t,e){var n=t.fusedConv2d({input:g,filter:v,convInfo:w,bias:x,activation:p,preluActivationWeights:b});return e([v,g,n]),n}),_,(function(t,e){var n=e,a=n[0],o=n[1],s=n[2],c=Gl(t,s,p);T(Li(u),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"}));var h={};return null!=l&&(h={bias:function(){return ql(x,c)}}),Object.assign({x:function(){return oc(o.shape,c,a,r,i)},filter:function(){return ac(o,c,a.shape,r,i)}},h)}),"FusedConv2D",{convInfo:w,activation:p},S,[!0]);return y?M.as3D(M.shape[1],M.shape[2],M.shape[3]):M}}),Kl=ln({fusedDepthwiseConv2d_:function(t){var e=t.x,n=t.filter,r=t.strides,i=t.pad,a=t.dataFormat,o=void 0===a?"NHWC":a,s=t.dilations,u=void 0===s?[1,1]:s,c=t.dimRoundingMode,l=t.bias,h=t.activation,p=void 0===h?"linear":h,f=t.preluActivationWeights;if(!1===Hl(Ft.state.gradientDepth,p)){var d=sc(e,n,r,i,o,u,c);return null!=l&&(d=er(d,l)),Xl(d,p,f)}var m=Je(e,"x","depthwiseConv2d"),v=Je(n,"filter","depthwiseConv2d"),g=m,y=!1;3===m.rank&&(y=!0,g=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),T(4===g.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+g.rank+"."})),T(4===v.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+v.rank+"."})),T(g.shape[3]===v.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels ("+g.shape[3]+") must match the inChannels dimension in filter "+v.shape[2]+"."})),null==u&&(u=[1,1]),T(Di(r,u),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"})),null!=c&&T(O(i),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+c+" but got pad "+i+"."}));var x,b,w=Ci(g.shape,v.shape,r,u,i,c,!0);null!=l&&(x=Rt(x=Je(l,"bias","fused conv2d"),m)[0],ir(w.outShape,x.shape)),null!=f&&(b=Je(f,"prelu weights","fused depthwiseConv2d"));var _={x:g,filter:v};null!=l&&(_.bias=x),null!=f&&(_.preluActivationWeights=b);var S=[v,g],M=Ft.runKernelFunc((function(t,e){var n=t.fusedDepthwiseConv2D({input:g,filter:v,convInfo:w,bias:x,activation:p,preluActivationWeights:b});return e([v,g,n]),n}),_,(function(t,e){T(Li(u),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"}));var n=e[0],r=e[1],i=e[2],a=Gl(t,i,p),o={};return null!=l&&(o={bias:function(){return ql(x,a)}}),Object.assign({x:function(){return uc(r.shape,a,n,w)},filter:function(){return cc(r,a,n.shape,w)}},o)}),"FusedDepthwiseConv2D",{convInfo:w,activation:p},S,[!0]);return y?M.as3D(M.shape[1],M.shape[2],M.shape[3]):M}}),Jl=Object.freeze({matMul:$l,conv2d:Yl,depthwiseConv2d:Kl}),Zl=Object.freeze({image:Vl,linalg:Pl,losses:Rl,spectral:ll,fused:Jl,signal:wl,add:er,addN:Hs,batchNorm:Ks,batchNormalization:Ys,batchNorm2d:Qs,batchNormalization2d:Zs,batchNorm3d:nu,batchNormalization3d:eu,batchNorm4d:au,batchNormalization4d:iu,broadcastTo:ou,clone:su,div:ni,divNoNan:du,eye:vu,multinomial:gu,oneHot:yu,pad:xu,pad1d:bu,pad2d:wu,pad3d:_u,pad4d:Su,rand:Mu,randomGamma:Ru,randomNormal:Ou,randomUniform:ku,square:Lu,squaredDifference:Du,tile:mu,truncatedNormal:Pu,conv1d:nc,conv2d:rc,conv3d:ic,depthwiseConv2d:sc,separableConv2d:lc,conv2dTranspose:hc,conv3dTranspose:pc,op:ln,booleanMaskAsync:function(t,e,n){return u(this,void 0,void 0,(function(){var r,i,a,o,s,u,l,h,p,f,d,m,v;return c(this,(function(c){switch(c.label){case 0:for(r=Je(t,"tensor","boolMask"),i=Je(e,"mask","boolMask","bool"),a=null==n?0:n,o=i.rank,s=r.shape,T(o>0,(function(){return"mask cannot be scalar"})),C(s.slice(a,a+o),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,l=a;l<a+o;l++)u*=s[l];return h=s.slice(0,a).concat([u],s.slice(a+o)),p=r.reshape(h),f=i.reshape([-1]),[4,fu(f)];case 1:return d=c.sent(),m=d.squeeze([1]),v=Ju(p,m,a),t!==r&&r.dispose(),e!==i&&i.dispose(),m.dispose(),p.dispose(),f.dispose(),d.dispose(),[2,v]}}))}))},complex:hn,real:pn,imag:fn,concat:An,concat1d:Nn,concat2d:In,concat3d:Rn,concat4d:On,split:kn,matMul:fc,dot:dc,outerProduct:mc,reverse:vc,reverse1d:gc,reverse2d:yc,reverse3d:xc,reverse4d:bc,maxPool:Sc,avgPool:Mc,pool:Ec,maxPool3d:Tc,avgPool3d:Cc,maxPoolWithArgmax:Ac,slice:Nc,slice1d:Ic,slice2d:Rc,slice3d:Oc,slice4d:kc,abs:ar,acos:or,acosh:sr,asin:ur,asinh:cr,atan:lr,atanh:hr,ceil:pr,clipByValue:fr,cos:dr,cosh:mr,erf:vr,exp:gr,expm1:yr,floor:xr,log:br,log1p:wr,logSigmoid:_r,neg:Sr,reciprocal:Mr,round:Er,rsqrt:Tr,sigmoid:Cr,sign:Ar,isNaN:Nr,isInf:Ir,isFinite:Rr,sin:Or,sinh:kr,softplus:Lr,sqrt:Dr,step:Pr,tan:Fr,tanh:Br,all:Dc,any:Pc,argMax:Fc,argMin:Bc,logSumExp:zc,max:Uc,mean:jc,min:Wc,moments:Vc,sum:Hc,prod:Gc,equal:Fu,equalStrict:Bu,greater:zu,greaterEqual:Uu,greaterEqualStrict:ju,greaterStrict:Wu,less:Vu,lessEqual:Hu,lessEqualStrict:Gu,lessStrict:qu,notEqual:Xu,notEqualStrict:$u,addStrict:zr,atan2:Ur,divStrict:jr,floorDiv:Wr,maximum:Vr,maximumStrict:Hr,minimum:Gr,minimumStrict:qr,mod:Xr,modStrict:$r,mul:Yr,mulStrict:Kr,pow:Jr,powStrict:Zr,squaredDifferenceStrict:Qr,sub:ti,subStrict:ei,elu:qc,leakyRelu:Xc,prelu:$c,relu:Yc,relu6:Kc,selu:Jc,logicalAnd:uu,logicalNot:cu,logicalOr:lu,logicalXor:hu,where:pu,whereAsync:fu,buffer:Ln,print:function(t,e){void 0===e&&(e=!1),console.log(t.toString(e))},batchToSpaceND:Dn,cast:Pn,cumsum:Fn,depthToSpace:Bn,expandDims:zn,reshape:Un,spaceToBatchND:jn,squeeze:Wn,stack:Vn,unstack:Hn,setdiff1dAsync:Gn,fill:Sn,linspace:Mn,ones:wn,range:En,scalar:vn,tensor:dn,tensor1d:gn,tensor2d:yn,tensor3d:xn,tensor4d:bn,tensor5d:function(t,e,n){if(A(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");var r=Ye(t,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return mn(t,e,r,n)},tensor6d:function(t,e,n){if(A(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");var r=Ye(t,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return mn(t,e=e||r,r,n)},variable:function(t,e,n,r){return void 0===e&&(e=!0),Ft.makeVariable(t,e,n,r)},zeros:_n,onesLike:Tn,zerosLike:Cn,transpose:wi,softmax:xi,logSoftmax:bi,localResponseNormalization:Zc,norm:Qc,gather:Ju,unsortedSegmentSum:Zu,basicLSTMCell:tl,multiRNNCell:el,movingAverage:nl,stridedSlice:rl,topk:il,scatterND:al,fft:ol,ifft:sl,rfft:ul,irfft:cl,sparseToDense:hl,gatherND:pl,diag:fl,dropout:dl,hannWindow:gl,hammingWindow:yl,frame:xl,stft:bl,inTopKAsync:function(t,e,n){return void 0===n&&(n=1),u(this,void 0,void 0,(function(){var r,i,a,o,s,u,l,h,p,f,d,m,v,g;return c(this,(function(c){switch(c.label){case 0:return r=Je(t,"predictions","inTopK"),i=Je(e,"targets","inTopK"),T(r.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank})),T(r.rank-1===i.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+i.rank})),C(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),a=r.shape[r.shape.length-1],T(n>0&&n<=a,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+a+"), but got "+n})),[4,r.data()];case 1:return o=c.sent(),[4,i.data()];case 2:for(s=c.sent(),u=[o.length/a,a],h=u[1],p=U("bool",l=u[0]),f=0;f<l;f++){for(d=f*h,m=o.subarray(d,d+h),v=[],g=0;g<m.length;g++)v.push({value:m[g],index:g});for(v.sort((function(t,e){return e.value-t.value})),p[f]=0,g=0;g<n;g++)if(v[g].index===s[f]){p[f]=1;break}}return t!==r&&r.dispose(),e!==i&&i.dispose(),[2,dn(p,i.shape,"bool")]}}))}))}});function Ql(t,e){Array.isArray(t)||(t=[t]),t.forEach((function(t){null!=t&&T("complex64"!==t.dtype,(function(){return e+" does not support complex64 tensors."}))}))}function th(t,e,n,r,i,a){for(var o=i.strideHeight,s=i.strideWidth,u=i.dilationHeight,c=i.dilationWidth,l=i.effectiveFilterHeight,h=i.effectiveFilterWidth,p=i.padInfo.top,f=i.padInfo.left,d="max"===a?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=Ln(i.outShape,n),v=m.values,g=i.outShape[1]*i.outShape[2]*i.outShape[3],y=i.outShape[2]*i.outShape[3],x=i.outShape[3],b=0;b<i.batchSize;++b)for(var w=b*g,_=b*r[0],S=0;S<i.inChannels;++S)for(var M=0;M<i.outHeight;++M)for(var E=M*o-p,T=Math.max(0,E),C=Math.min(i.inHeight,l+E),A=w+M*y,N=0;N<i.outWidth;++N){for(var I=N*s-f,R=Math.max(0,I),O=Math.min(i.inWidth,h+I),k=d,L=0,D=0,P=T;P<C;P+=u){for(var F=_+P*r[1],B=R;B<O;B+=c){var z=t[F+B*r[2]+S];"max"===a&&z>k?k=z:"avg"===a&&(L+=z,D++)}if(isNaN(k))break}v[A+N*x+S]="avg"===a?L/D:k}return m}function eh(t,e,n,r,i,a){void 0===i&&(i=!1),void 0===a&&(a=!1);for(var o=Ln(r.outShape,"int32"),s=r.strideHeight,u=r.strideWidth,c=r.dilationHeight,l=r.dilationWidth,h=r.effectiveFilterHeight,p=r.effectiveFilterWidth,f=r.padInfo.top,d=r.padInfo.left,m=Ln(e,n,t),v=0;v<r.batchSize;++v)for(var g=0;g<r.inChannels;++g)for(var y=0;y<r.outHeight;++y){for(var x=y*s-f,b=x;b<0;)b+=c;for(var w=Math.min(r.inHeight,h+x),_=0;_<r.outWidth;++_){for(var S=_*u-d,M=S;M<0;)M+=l;for(var E=Math.min(r.inWidth,p+S),T=Number.NEGATIVE_INFINITY,C=-1,A=b;A<w;A+=c)for(var N=A-x,I=M;I<E;I+=l){var R=I-S,O=m.get(v,A,I,g);O>T&&(T=O,C=i?a?((v*r.inHeight+A)*r.inWidth+I)*r.inChannels+g:(A*r.inWidth+I)*r.inChannels+g:N*p+R)}o.set(C,v,y,_,g)}}return o}function nh(t,e,n,r){if("linear"===n)return t.linear(e);if("relu"===n)return t.relu(e);if("elu"===n)return t.elu(e);if("relu6"===n)return t.relu6(e);if("prelu"===n)return t.prelu(e,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var rh=function(t){function e(){var e=t.call(this)||this;return e.blockSize=48,e.firstUse=!0,e.data=new _i(e,Ft),e}return s(e,t),e.prototype.write=function(t,e,n){this.firstUse&&(this.firstUse=!1,p().get("IS_NODE")&&$e("\n============================\nHi there 👋. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));var r={};return this.data.set(r,{values:t,dtype:n}),r},e.prototype.move=function(t,e,n,r){this.data.set(t,{values:e,dtype:r})},e.prototype.numDataIds=function(){return this.data.numDataIds()},e.prototype.read=function(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){return[2,this.readSync(t)]}))}))},e.prototype.readSync=function(t){var e=this.data.get(t),n=e.dtype,r=e.complexTensors;return"complex64"===n?ji(this.readSync(r.real.dataId),this.readSync(r.imag.dataId)):this.data.get(t).values},e.prototype.bufferSync=function(t){var e=this.readSync(t.dataId),n=e;if("string"===t.dtype)try{n=e.map((function(t){return ut(t)}))}catch(t){throw new Error("Failed to decode encoded string bytes into utf-8")}return Ln(t.shape,t.dtype,n)},e.prototype.makeOutput=function(t,e,n){var r=this.write(t,e,n);return Ft.makeTensorFromDataId(r,e,n,this)},e.prototype.disposeData=function(t){if(this.data.has(t)){var e=this.data.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.data.delete(t)}},e.prototype.time=function(t){return u(this,void 0,void 0,(function(){var e;return c(this,(function(n){return e=at(),t(),[2,{kernelMs:at()-e}]}))}))},e.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},e.prototype.complex=function(t,e){var n=this.makeOutput(null,t.shape,"complex64");return this.data.get(n.dataId).complexTensors={real:Ft.keep(t.clone()),imag:Ft.keep(e.clone())},n},e.prototype.real=function(t){return this.data.get(t.dataId).complexTensors.real.clone()},e.prototype.imag=function(t){return this.data.get(t.dataId).complexTensors.imag.clone()},e.prototype.slice=function(t,e,n){if(Ql(t,"slice"),mi(t.shape,e,n)){var r=vi(e,t.strides),i=I(n);return dn(this.readSync(t.dataId).subarray(r,r+i),n,t.dtype)}for(var a=Ln(n,t.dtype),o=this.bufferSync(t),s=0;s<a.size;++s){var u=a.indexToLoc(s).map((function(t,n){return t+e[n]}));a.values[s]=o.get.apply(o,u)}return a.toTensor()},e.prototype.stridedSlice=function(t,e,n,r){Ql(t,"stridedSlice");var i=pi(e,n,r);if(i.some((function(t){return 0===t})))return dn([],i);for(var a=Ln(i,t.dtype),o=this.bufferSync(t),s=0;s<a.size;s++){for(var u=a.indexToLoc(s),c=new Array(u.length),l=0;l<c.length;l++)c[l]=u[l]*r[l]+e[l];a.set.apply(a,[o.get.apply(o,c)].concat(u))}return a.toTensor()},e.prototype.diag=function(t){for(var e=this.readSync(t.dataId),n=Ln([t.size,t.size],t.dtype),r=n.values,i=0;i<e.length;i++)r[i*t.size+i]=e[i];return n.toTensor()},e.prototype.unstack=function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),i=0,a=0;a<t.rank;a++)a!==e&&(r[i++]=t.shape[a]);var o=new Array(t.rank).fill(0),s=t.shape.slice();s[e]=1;var u=new Array(n);for(a=0;a<u.length;a++)o[e]=a,u[a]=this.slice(t,o,s).reshape(r);return u},e.prototype.reverse=function(t,e){Ql(t,"reverse");for(var n=Ln(t.shape,t.dtype),r=this.bufferSync(t),i=function(i){var a=n.indexToLoc(i),o=a.slice();e.forEach((function(e){return o[e]=t.shape[e]-1-o[e]})),n.set.apply(n,[r.get.apply(r,o)].concat(a))},a=0;a<n.size;a++)i(a);return n.toTensor()},e.prototype.concat=function(t,e){var n=this;if("complex64"===t[0].dtype){var r=t.map((function(t){return pn(t)})),i=t.map((function(t){return fn(t)}));return hn(this.concat(r,e),this.concat(i,e))}var a=t.map((function(t){var n=I(t.shape.slice(e));return t.as2D(-1,n)})),o=cn(a.map((function(t){return t.shape})),1),s=Ln(o,t[0].dtype).values;if(1===a[0].shape[0]){var u=0;a.forEach((function(t){s.set(n.readSync(t.dataId),u),u+=t.size}))}else{var c=0;a.forEach((function(t){for(var e=n.readSync(t.dataId),r=0,i=0;i<t.shape[0];++i)for(var a=i*o[1]+c,u=0;u<t.shape[1];++u)s[a+u]=e[r++];c+=t.shape[1]}))}var l=cn(t.map((function(t){return t.shape})),e);return dn(s,l,t[0].dtype)},e.prototype.neg=function(t){return Ql(t,"neg"),this.multiply(vn(-1),t)},e.prototype.add=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t+n,imag:e+r}})):this.broadcastedBinaryOp(t,e,Nt(t.dtype,e.dtype),(function(t,e){return t+e}))},e.prototype.addN=function(t){var e=this;Ql(t,"addN");for(var n=t.map((function(t){return e.readSync(t.dataId)})),r=Ln(t[0].shape,t[0].dtype),i=r.values,a=0;a<t.length;a++)for(var o=n[a],s=0;s<i.length;s++)i[s]+=o[s];return r.toTensor()},e.prototype.softmax=function(t,e){var n=B([e],t.shape),r=this.max(t,n),i=nn(r.shape,n),a=this.subtract(t,r.reshape(i)),o=this.exp(a),s=this.sum(o,n).reshape(i);return ni(o,s)},e.prototype.subtract=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t-n,imag:e-r}})):this.broadcastedBinaryOp(t,e,Nt(t.dtype,e.dtype),(function(t,e){return t-e}))},e.prototype.pow=function(t,e){return Ql([t,e],"pow"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.pow(t,e)}))},e.prototype.batchMatMul=function(t,e,n,r){Ql([t,e],"matMul");for(var i=n?t.shape[1]:t.shape[2],a=n?t.shape[2]:t.shape[1],o=r?e.shape[1]:e.shape[2],s=t.shape[0],u=this.readSync(t.dataId),c=this.readSync(e.dataId),l=n?[t.strides[0],1,t.strides[1]]:[t.strides[0],t.strides[1],1],h=l[0],p=l[1],f=l[2],d=r?[1,e.strides[1],e.strides[0]]:[e.strides[1],1,e.strides[0]],m=d[0],v=d[1],g=d[2],y=a*o,x=Ln([s,a,o],t.dtype),b=x.values,w=this.blockSize,_=0;_<s;_++)for(var S=0;S<a;S+=w)for(var M=0;M<o;M+=w)for(var E=0;E<i;E+=w)for(var T=Math.min(S+w,a),C=Math.min(M+w,o),A=Math.min(E+w,i),N=S;N<T;N++)for(var I=M;I<C;I++){for(var R=0,O=E;O<A;O++)R+=u[_*h+N*p+O*f]*c[O*m+I*v+_*g];b[_*y+(N*o+I)]+=R}return x.toTensor()},e.prototype.fusedBatchMatMul=function(t){var e=t.a,n=t.b,r=t.transposeA,i=t.transposeB,a=t.bias,o=t.activation,s=t.preluActivationWeights,u=this.batchMatMul(e,n,r,i);return a&&(u=this.add(u,a)),o&&(u=nh(this,u,o,s)),u},e.prototype.multiply=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t*n-e*r,imag:t*r+e*n}})):this.broadcastedBinaryOp(t,e,Nt(t.dtype,e.dtype),(function(t,e){return t*e}))},e.prototype.floorDiv=function(t,e){return Ql([t,e],"floorDiv"),this.broadcastedBinaryOp(t,e,"int32",(function(t,e){return Math.floor(t/e)}))},e.prototype.sum=function(t,e){Ql(t,"sum"),rn("sum",e,t.rank);for(var n=en(t.shape,e),r=n[0],i=n[1],a=_n(r,Nt(t.dtype,"int32")),o=I(i),s=this.readSync(a.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*o,h=0,p=0;p<o;++p)h+=u[l+p];s[c]=h}return a},e.prototype.prod=function(t,e){Ql(t,"sum");for(var n=en(t.shape,e),r=n[0],i=n[1],a=_n(r,Nt(t.dtype,"int32")),o=I(i),s=this.readSync(a.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*o,h=1,p=0;p<o;++p)h*=u[l+p];s[c]=h}return a},e.prototype.unsortedSegmentSum=function(t,e,n){Ql(t,"unsortedSegmentSum");for(var r=[],i=t.rank-e.rank,a=0;a<i;++a)e=e.expandDims(a+1);for(a=0;a<n;++a){var o=vn(a,"int32"),s=Fu(o,e).asType("float32").mul(t).sum(0);r.push(s)}return Vn(r)},e.prototype.argMin=function(t,e){Ql(t,"argMin");var n=[e];rn("argMin",n,t.rank);for(var r=en(t.shape,n),i=r[0],a=r[1],o=_n(i,"int32"),s=I(a),u=this.readSync(o.dataId),c=this.readSync(t.dataId),l=0;l<u.length;++l){for(var h=l*s,p=c[h],f=0,d=0;d<s;++d){var m=c[h+d];m<p&&(p=m,f=d)}u[l]=f}return o},e.prototype.argMax=function(t,e){Ql(t,"argMax");var n=[e];rn("argMax",n,t.rank);for(var r=en(t.shape,n),i=r[0],a=r[1],o=_n(i,"int32"),s=I(a),u=this.readSync(o.dataId),c=this.readSync(t.dataId),l=0;l<u.length;++l){for(var h=l*s,p=c[h],f=0,d=0;d<s;++d){var m=c[h+d];m>p&&(p=m,f=d)}u[l]=f}return o},e.prototype.cumsum=function(t,e,n,r){if(Ql(t,"cumsum"),e!==t.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(t.rank-1)+" but got axis="+e);for(var i=Nt(t.dtype,"int32"),a=_n(t.shape,i),o=this.readSync(a.dataId),s=this.readSync(t.dataId),u=t.shape[t.rank-1],c=r?function(t,e){return t+u-e-1}:function(t,e){return t+e},l=0;l<s.length;l+=u)for(var h=0;h<u;h++){var p=c(l,h);if(0===h)o[p]=n?0:s[p];else{var f=c(l,h-1);o[p]=n?s[f]+o[f]:s[p]+o[f]}}return a},e.prototype.equal=function(t,e){return Ql([t,e],"equal"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t===e?1:0}))},e.prototype.notEqual=function(t,e){return Ql([t,e],"notEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t!==e?1:0}))},e.prototype.less=function(t,e){return Ql([t,e],"less"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t<e?1:0}))},e.prototype.lessEqual=function(t,e){return Ql([t,e],"lessEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t<=e?1:0}))},e.prototype.greater=function(t,e){return Ql([t,e],"greater"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t>e?1:0}))},e.prototype.greaterEqual=function(t,e){return Ql([t,e],"greaterEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t>=e?1:0}))},e.prototype.logicalNot=function(t){Ql(t,"logicalNot");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)n[r]=e[r]?0:1;return this.makeOutput(n,t.shape,"bool")},e.prototype.logicalAnd=function(t,e){return Ql([t,e],"logicalAnd"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t&&e}))},e.prototype.logicalOr=function(t,e){return Ql([t,e],"logicalOr"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t||e}))},e.prototype.select=function(t,e,n){Ql([t,e,n],"select");for(var r=this.readSync(t.dataId),i=this.readSync(e.dataId),a=this.readSync(n.dataId),o=_n(e.shape,Nt(e.dtype,n.dtype)),s=this.readSync(o.dataId),u=0,c=0===t.rank||t.rank>1||1===e.rank?1:I(e.shape.slice(1)),l=0;l<r.length;l++)for(var h=0;h<c;h++)1===r[l]?s[u++]=i[l]:s[u++]=a[l];return o},e.prototype.where=function(t){Ql([t],"where");var e=this.readSync(t.dataId);return na(t.shape,e)},e.prototype.topk=function(t,e,n){return Ql(t,"topk"),ea(this.readSync(t.dataId),t.shape,t.dtype,e)},e.prototype.min=function(t,e){Ql(t,"min"),rn("min",e,t.rank);for(var n=en(t.shape,e),r=n[0],i=n[1],a=_n(r,t.dtype),o=I(i),s=this.readSync(a.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*o,h=u[l],p=0;p<o;++p){var f=u[l+p];f<h&&(h=f)}s[c]=h}return a},e.prototype.minimum=function(t,e){return Ql([t,e],"minimum"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.min(t,e)}))},e.prototype.mod=function(t,e){return Ql([t,e],"mod"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}))},e.prototype.max=function(t,e){Ql(t,"max"),rn("max",e,t.rank);for(var n=en(t.shape,e),r=n[0],i=n[1],a=_n(r,t.dtype),o=I(i),s=this.readSync(a.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*o,h=u[l],p=0;p<o;++p){var f=u[l+p];f>h&&(h=f)}s[c]=h}return a},e.prototype.maximum=function(t,e){return Ql([t,e],"maximum"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.max(t,e)}))},e.prototype.all=function(t,e){Ql(t,"all"),rn("all",e,t.rank);for(var n=en(t.shape,e),r=n[0],i=n[1],a=_n(r,t.dtype),o=I(i),s=this.readSync(a.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*o,h=u[l],p=0;p<o;++p){var f=u[l+p];h=h&&f}s[c]=h}return a},e.prototype.any=function(t,e){Ql(t,"any"),rn("any",e,t.rank);for(var n=en(t.shape,e),r=n[0],i=n[1],a=_n(r,t.dtype),o=I(i),s=this.readSync(a.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*o,h=u[l],p=0;p<o;++p){var f=u[l+p];h=h||f}s[c]=h}return a},e.prototype.squaredDifference=function(t,e){return Ql([t,e],"squaredDifference"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t-e;return n*n}))},e.prototype.ceil=function(t){Ql(t,"ceil");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.ceil(e[r]);return this.makeOutput(n,t.shape,"float32")},e.prototype.floor=function(t){Ql(t,"floor");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.floor(e[r]);return this.makeOutput(n,t.shape,"float32")},e.prototype.sign=function(t){Ql(t,"x");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)e[r]<0?n[r]=-1:e[r]>0?n[r]=1:n[r]=0;return this.makeOutput(n,t.shape,"float32")},e.prototype.isNaN=function(t){Ql(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isNaN(e[r])&&(n[r]=1);return this.makeOutput(n,t.shape,"bool")},e.prototype.isInf=function(t){Ql(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Math.abs(e[r])===1/0&&(n[r]=1);return this.makeOutput(n,t.shape,"bool")},e.prototype.isFinite=function(t){Ql(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isFinite(e[r])&&(n[r]=1);return this.makeOutput(n,t.shape,"bool")},e.prototype.round=function(t){Ql(t,"round");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var i=Math.floor(e[r]);e[r]-i<.5?n[r]=Math.floor(e[r]):e[r]-i>.5?n[r]=Math.ceil(e[r]):n[r]=i%2==0?i:i+1}return this.makeOutput(n,t.shape,"float32")},e.prototype.exp=function(t){Ql(t,"exp");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.exp(e[r]);return this.makeOutput(n,t.shape,"float32")},e.prototype.expm1=function(t){Ql(t,"expm1");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.expm1(e[r]);return this.makeOutput(n,t.shape,"float32")},e.prototype.log=function(t){Ql(t,"log");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var i=e[r];n[r]=Math.log(i)}return this.makeOutput(n,t.shape,"float32")},e.prototype.log1p=function(t){Ql(t,"log1p");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var i=e[r];n[r]=Math.log1p(i)}return this.makeOutput(n,t.shape,"float32")},e.prototype.sqrt=function(t){Ql(t,"sqrt");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var i=e[r];n[r]=Math.sqrt(i)}return this.makeOutput(n,t.shape,"float32")},e.prototype.rsqrt=function(t){Ql(t,"rsqrt");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var i=e[r];n[r]=1/Math.sqrt(i)}return this.makeOutput(n,t.shape,"float32")},e.prototype.reciprocal=function(t){Ql(t,"reciprocal");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=1/e[r];return this.makeOutput(n,t.shape,"float32")},e.prototype.linear=function(t){return t},e.prototype.relu=function(t){Ql(t,"relu");for(var e=_n(t.shape,t.dtype),n=this.readSync(e.dataId),r=this.readSync(t.dataId),i=0;i<r.length;++i)n[i]=Math.max(0,r[i]);return e},e.prototype.relu6=function(t){Ql(t,"relu");for(var e=_n(t.shape,t.dtype),n=this.readSync(e.dataId),r=this.readSync(t.dataId),i=0;i<r.length;++i)n[i]=Math.min(Math.max(0,r[i]),6);return e},e.prototype.prelu=function(t,e){return Ql([t,e],"prelu"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return t<0?e*t:t}))},e.prototype.elu=function(t){Ql(t,"elu");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=n[r];e[r]=i>=0?i:Math.exp(i)-1}return this.makeOutput(e,t.shape,"float32")},e.prototype.eluDer=function(t,e){Ql([t,e],"eluDer");for(var n=new Float32Array(e.size),r=this.readSync(e.dataId),i=this.readSync(t.dataId),a=0;a<r.length;++a){var o=r[a];n[a]=o>=1?i[a]:i[a]*(o+1)}return this.makeOutput(n,e.shape,"float32")},e.prototype.selu=function(t){Ql(t,"selu");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=n[r];e[r]=i>=0?1.0507009873554805*i:1.7580993408473768*(Math.exp(i)-1)}return this.makeOutput(e,t.shape,"float32")},e.prototype.clip=function(t,e,n){Ql(t,"clip");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),a=0;a<i.length;++a){var o=i[a];r[a]=o>n?n:o<e?e:o}return this.makeOutput(r,t.shape,"float32")},e.prototype.abs=function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.abs(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.complexAbs=function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<t.size;++r){var i=n[2*r],a=n[2*r+1];e[r]=Math.hypot(i,a)}return this.makeOutput(e,t.shape,"float32")},e.prototype.int=function(t){Ql(t,"int");for(var e=new Int32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=n[r];return this.makeOutput(e,t.shape,"int32")},e.prototype.sigmoid=function(t){Ql(t,"sigmoid");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=1/(1+Math.exp(-n[r]));return this.makeOutput(e,t.shape,"float32")},e.prototype.softplus=function(t){Ql(t,"softplus");for(var e=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(t.size),r=this.readSync(t.dataId),i=0;i<r.length;++i){var a,o=r[i]>-e,s=r[i]<e,u=Math.exp(r[i]);a=s?u:o?r[i]:Math.log(1+u),n[i]=a}return this.makeOutput(n,t.shape,"float32")},e.prototype.sin=function(t){Ql(t,"sin");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sin(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.cos=function(t){Ql(t,"cos");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cos(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.tan=function(t){Ql(t,"tan");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.tan(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.asin=function(t){Ql(t,"asin");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asin(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.acos=function(t){Ql(t,"acos");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acos(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.atan=function(t){Ql(t,"atan");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atan(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.atan2=function(t,e){return Ql([t,e],"atan2"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.atan2(t,e)}))},e.prototype.sinh=function(t){Ql(t,"sinh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sinh(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.cosh=function(t){Ql(t,"cosh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cosh(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.tanh=function(t){Ql(t,"tanh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=k(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.asinh=function(t){Ql(t,"asinh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asinh(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.acosh=function(t){Ql(t,"acosh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acosh(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.atanh=function(t){Ql(t,"atanh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atanh(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.erf=function(t){Ql(t,"erf");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=Math.sign(n[r]),a=Math.abs(n[r]),o=1/(1+.3275911*a);e[r]=i*(1-((((1.061405429*o-1.453152027)*o+1.421413741)*o-.284496736)*o+.254829592)*o*Math.exp(-a*a))}return this.makeOutput(e,t.shape,"float32")},e.prototype.step=function(t,e){void 0===e&&(e=0),Ql(t,"step");for(var n=new Float32Array(t.size),r=this.readSync(t.dataId),i=0;i<r.length;++i){var a=r[i];isNaN(a)?n[i]=NaN:n[i]=a>0?1:e}return this.makeOutput(n,t.shape,"float32")},e.prototype.fusedConv2d=function(t){var e=t.input,n=t.filter,r=t.convInfo,i=t.bias,a=t.activation,o=t.preluActivationWeights,s=this.conv2d(e,n,r);return i&&(s=this.add(s,i)),a&&(s=nh(this,s,a,o)),s},e.prototype.conv2d=function(t,e,n){Ql([t,e],"conv2d");for(var r=n.filterHeight,i=n.filterWidth,a=n.dilationHeight,o=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c="channelsLast"===n.dataFormat,l=Ln(n.outShape,t.dtype),h=t.strides[0],p=c?t.strides[1]:t.strides[2],f=c?t.strides[2]:1,d=c?1:t.strides[1],m=l.strides[0],v=c?l.strides[1]:l.strides[2],g=c?l.strides[2]:1,y=c?1:l.strides[1],x=this.readSync(t.dataId),b=this.readSync(e.dataId),w=l.values,_=0;_<n.batchSize;++_)for(var S=_*h,M=_*m,E=0;E<n.outHeight;++E)for(var T=M+E*v,C=E*n.strideHeight-u,A=0;A<r;A++){var N=C+A*a;if(!(N<0||N>=n.inHeight))for(var I=A*e.strides[0],R=S+N*p,O=0;O<n.outWidth;++O)for(var k=T+O*g,L=O*n.strideWidth-s,D=0;D<i;D++){var P=L+D*o;if(!(P<0||P>=n.inWidth))for(var F=R+P*f,B=I+D*e.strides[1],z=0;z<n.inChannels;++z){for(var U=x[F+z*d],j=0;j<n.outChannels;++j)w[k+j*y]+=U*b[B+j];B+=n.outChannels}}}return l.toTensor()},e.prototype.conv3d=function(t,e,n){for(var r=n.filterDepth,i=n.filterHeight,a=n.filterWidth,o=n.dilationDepth,s=n.dilationHeight,u=n.dilationWidth,c=n.padInfo.front,l=n.padInfo.left,h=n.padInfo.top,p=Ln(n.outShape,t.dtype),f=this.readSync(t.dataId),d=this.readSync(e.dataId),m=p.values,v=0;v<n.batchSize;++v)for(var g=v*t.strides[0],y=v*p.strides[0],x=0;x<n.outDepth;++x)for(var b=y+x*p.strides[1],w=x*n.strideDepth-c,_=0;_<r;_++){var S=w+_*o;if(!(S<0||S>=n.inDepth))for(var M=_*e.strides[0],E=g+S*t.strides[1],T=0;T<n.outHeight;++T)for(var C=b+T*p.strides[2],A=T*n.strideHeight-h,N=0;N<i;N++){var I=A+N*s;if(!(I<0||I>=n.inHeight))for(var R=M+N*e.strides[1],O=E+I*t.strides[2],k=0;k<n.outWidth;++k)for(var L=C+k*n.outChannels,D=k*n.strideWidth-l,P=0;P<a;P++){var F=D+P*u;if(!(F<0||F>=n.inWidth))for(var B=R+P*e.strides[2],z=O+F*n.inChannels,U=B,j=0;j<n.inChannels;++j){for(var W=f[z+j],V=0;V<n.outChannels;++V)m[L+V]+=W*d[U+V];U+=n.outChannels}}}}return p.toTensor()},e.prototype.conv2dDerInput=function(t,e,n){Ql([t,e],"conv2dDerInput");for(var r=Ln(n.inShape,"float32"),i=r.values,a=this.readSync(t.dataId),o=this.readSync(e.dataId),s=e.strides,u=s[0],c=s[1],l=s[2],h=n.batchSize,p=n.filterHeight,f=n.filterWidth,d=n.inChannels,m=n.inHeight,v=n.inWidth,g=n.outChannels,y=n.outHeight,x=n.outWidth,b=n.strideHeight,w=n.strideWidth,_=n.dataFormat,S=p-1-n.padInfo.top,M=f-1-n.padInfo.left,E="channelsLast"===_,T=r.strides[0],C=E?r.strides[1]:r.strides[2],A=E?r.strides[2]:1,N=E?1:r.strides[1],I=t.strides[0],R=E?t.strides[1]:t.strides[2],O=E?t.strides[2]:1,k=E?1:t.strides[1],L=0;L<h;++L)for(var D=0;D<d;++D)for(var P=0;P<m;++P)for(var F=P-S,B=Math.max(0,Math.ceil(F/b)),z=Math.min(y,(p+F)/b),U=0;U<v;++U){for(var j=U-M,W=Math.max(0,Math.ceil(j/w)),V=Math.min(x,(f+j)/w),H=0,G=B;G<z;++G)for(var q=G*b-F,X=W;X<V;++X)for(var $=I*L+R*G+O*X,Y=u*(p-1-q)+c*(f-1-(X*w-j))+l*D,K=0;K<g;++K)H+=a[$+k*K]*o[Y+K];i[T*L+C*P+A*U+N*D]=H}return r.toTensor()},e.prototype.conv3dDerInput=function(t,e,n){for(var r=Ln(n.inShape,"float32"),i=r.values,a=r.strides,o=a[0],s=a[1],u=a[2],c=a[3],l=this.readSync(t.dataId),h=t.strides,p=h[0],f=h[1],d=h[2],m=h[3],v=this.readSync(e.dataId),g=e.strides,y=g[0],x=g[1],b=g[2],w=g[3],_=n.batchSize,S=n.filterDepth,M=n.filterHeight,E=n.filterWidth,T=n.inChannels,C=n.inDepth,A=n.inHeight,N=n.inWidth,I=n.outChannels,R=n.outDepth,O=n.outHeight,k=n.outWidth,L=n.strideDepth,D=n.strideHeight,P=n.strideWidth,F=S-1-n.padInfo.front,B=M-1-n.padInfo.top,z=E-1-n.padInfo.left,U=0;U<_;++U)for(var j=0;j<T;++j)for(var W=0;W<C;++W)for(var V=W-F,H=Math.max(0,Math.ceil(V/L)),G=Math.min(R,(S+V)/L),q=0;q<A;++q)for(var X=q-B,$=Math.max(0,Math.ceil(X/D)),Y=Math.min(O,(M+X)/D),K=0;K<N;++K){for(var J=K-z,Z=Math.max(0,Math.ceil(J/P)),Q=Math.min(k,(E+J)/P),tt=0,et=H;et<G;++et)for(var nt=et*L-V,rt=$;rt<Y;++rt)for(var it=rt*D-X,at=Z;at<Q;++at)for(var ot=p*U+f*et+d*rt+m*at,st=y*(S-1-nt)+x*(M-1-it)+b*(E-1-(at*P-J))+w*j,ut=0;ut<I;++ut)tt+=l[ot+ut]*v[st+ut];i[o*U+s*W+u*q+c*K+j]=tt}return r.toTensor()},e.prototype.conv2dDerFilter=function(t,e,n){Ql([t,e],"conv2dDerFilter");for(var r=n.strideHeight,i=n.strideWidth,a=n.filterHeight,o=n.filterWidth,s="channelsLast"===n.dataFormat,u=Ln(n.filterShape,"float32"),c=n.padInfo.left,l=n.padInfo.top,h=this.bufferSync(t),p=this.bufferSync(e),f=0;f<a;++f)for(var d=Math.max(0,Math.ceil((l-f)/r)),m=Math.min(n.outHeight,(n.inHeight+l-f)/r),v=0;v<o;++v)for(var g=Math.max(0,Math.ceil((c-v)/i)),y=Math.min(n.outWidth,(n.inWidth+c-v)/i),x=0;x<n.inChannels;++x)for(var b=0;b<n.outChannels;++b){for(var w=0,_=0;_<n.batchSize;++_)for(var S=d;S<m;++S)for(var M=f+S*r-l,E=g;E<y;++E){var T=v+E*i-c;w+=s?h.get(_,M,T,x)*p.get(_,S,E,b):h.get(_,x,M,T)*p.get(_,b,S,E)}u.set(w,f,v,x,b)}return u.toTensor()},e.prototype.conv3dDerFilter=function(t,e,n){for(var r=n.strideDepth,i=n.strideHeight,a=n.strideWidth,o=n.filterDepth,s=n.filterHeight,u=n.filterWidth,c=Ln(n.filterShape,"float32"),l=c.values,h=c.strides,p=h[0],f=h[1],d=h[2],m=h[3],v=this.readSync(e.dataId),g=e.strides,y=g[0],x=g[1],b=g[2],w=g[3],_=this.readSync(t.dataId),S=t.strides,M=S[0],E=S[1],T=S[2],C=S[3],A=n.padInfo.front,N=n.padInfo.left,I=n.padInfo.top,R=0;R<o;++R)for(var O=Math.max(0,Math.ceil((A-R)/r)),k=Math.min(n.outDepth,(n.inDepth+A-R)/r),L=R*p,D=0;D<s;++D)for(var P=Math.max(0,Math.ceil((I-D)/i)),F=Math.min(n.outHeight,(n.inHeight+I-D)/i),B=D*f+L,z=0;z<u;++z)for(var U=Math.max(0,Math.ceil((N-z)/a)),j=Math.min(n.outWidth,(n.inWidth+N-z)/a),W=z*d+B,V=0;V<n.inChannels;++V)for(var H=V*m+W,G=0;G<n.outChannels;++G){for(var q=0,X=0;X<n.batchSize;++X)for(var $=X*M,Y=X*y,K=O;K<k;++K)for(var J=(R+K*r-A)*E+$,Z=K*x+Y,Q=P;Q<F;++Q)for(var tt=(D+Q*i-I)*T+J,et=Q*b+Z,nt=U;nt<j;++nt){var rt=nt*w+et;q+=_[(z+nt*a-N)*C+tt+V]*v[rt+G]}l[H+G]=q}return c.toTensor()},e.prototype.fusedDepthwiseConv2D=function(t){var e=t.input,n=t.filter,r=t.convInfo,i=t.bias,a=t.activation,o=t.preluActivationWeights,s=this.depthwiseConv2D(e,n,r);return i&&(s=this.add(s,i)),a&&(s=nh(this,s,a,o)),s},e.prototype.depthwiseConv2D=function(t,e,n){Ql([t,e],"depthwiseConv2D");for(var r=n.filterHeight,i=n.filterWidth,a=n.dilationHeight,o=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c=n.outChannels/n.inChannels,l=Ln(n.outShape,t.dtype),h=this.readSync(t.dataId),p=this.readSync(e.dataId),f=l.values,d=0;d<n.batchSize;++d)for(var m=d*t.strides[0],v=d*l.strides[0],g=0;g<n.outHeight;++g)for(var y=v+g*l.strides[1],x=g*n.strideHeight-s,b=0;b<r;++b){var w=x+b*a;if(!(w<0||w>=n.inHeight))for(var _=b*e.strides[0],S=m+w*t.strides[1],M=0;M<n.outWidth;++M)for(var E=y+M*l.strides[2],T=M*n.strideWidth-u,C=0;C<i;++C){var A=T+C*o;if(!(A<0||A>=n.inWidth))for(var N=_+C*e.strides[1],I=S+A*n.inChannels,R=E,O=N,k=0;k<n.inChannels;++k){for(var L=h[I+k],D=0;D<c;++D)f[R+D]+=L*p[O+D];R+=c,O+=c}}}return l.toTensor()},e.prototype.depthwiseConv2DDerInput=function(t,e,n){Ql([t,e],"depthwiseConv2DDerInput");for(var r=Ln(n.inShape,"float32"),i=r.values,a=r.strides,o=a[0],s=a[1],u=a[2],c=this.readSync(t.dataId),l=t.strides,h=l[0],p=l[1],f=l[2],d=this.readSync(e.dataId),m=e.strides,v=m[0],g=m[1],y=m[2],x=n.batchSize,b=n.filterHeight,w=n.filterWidth,_=n.inChannels,S=n.inHeight,M=n.inWidth,E=n.outChannels,T=n.outHeight,C=n.outWidth,A=n.strideHeight,N=n.strideWidth,I=b-1-n.padInfo.top,R=w-1-n.padInfo.left,O=E/_,k=0;k<x;++k)for(var L=0;L<_;++L)for(var D=0;D<S;++D)for(var P=D-I,F=Math.max(0,Math.ceil(P/A)),B=Math.min(T,(b+P)/A),z=0;z<M;++z){for(var U=z-R,j=Math.max(0,Math.ceil(U/N)),W=Math.min(C,(w+U)/N),V=0,H=F;H<B;++H)for(var G=H*A-P,q=j;q<W;++q)for(var X=h*k+p*H+f*q,$=v*(b-1-G)+g*(w-1-(q*N-U))+y*L,Y=0;Y<O;++Y)V+=c[X+(L*O+Y)]*d[$+Y];i[o*k+s*D+u*z+L]=V}return r.toTensor()},e.prototype.depthwiseConv2DDerFilter=function(t,e,n){Ql([t,e],"depthwiseConv2DDerFilter");for(var r=n.strideHeight,i=n.strideWidth,a=n.filterHeight,o=n.filterWidth,s=Ln(n.filterShape,"float32"),u=n.padInfo.left,c=n.padInfo.top,l=n.outChannels/n.inChannels,h=this.bufferSync(t),p=this.bufferSync(e),f=0;f<a;++f)for(var d=Math.max(0,Math.ceil((c-f)/r)),m=Math.min(n.outHeight,(n.inHeight+c-f)/r),v=0;v<o;++v)for(var g=Math.max(0,Math.ceil((u-v)/i)),y=Math.min(n.outWidth,(n.inWidth+u-v)/i),x=0;x<n.outChannels;++x){for(var b=Math.trunc(x/l),w=x%l,_=0,S=0;S<n.batchSize;++S)for(var M=d;M<m;++M)for(var E=f+M*r-c,T=g;T<y;++T){var C=v+T*i-u;_+=h.get(S,E,C,b)*p.get(S,M,T,x)}s.set(_,f,v,b,w)}return s.toTensor()},e.prototype.tile=function(t,e){return Ql(t,"tile"),ta(this.bufferSync(t),e)},e.prototype.pad=function(t,e,n){Ql(t,"pad");var r=e.map((function(e,n){return e[0]+t.shape[n]+e[1]})),i=e.map((function(t){return t[0]})),a=this.bufferSync(t),o=Ln(r,t.dtype);0!==n&&o.values.fill(n);for(var s=0;s<t.size;s++){var u=a.indexToLoc(s),c=u.map((function(t,e){return t+i[e]}));o.set.apply(o,[a.get.apply(a,u)].concat(c))}return o.toTensor()},e.prototype.gather=function(t,e,n){Ql([t,e],"gather");var r=t.shape.slice(),i=this.readSync(e.dataId);r[n]=i.length;for(var a=Ln(r,t.dtype),o=this.bufferSync(t),s=0;s<a.size;++s){var u=a.indexToLoc(s),c=u.slice();c[n]=i[u[n]];var l=o.locToIndex(c);a.values[s]=o.values[l]}return a.toTensor()},e.prototype.batchToSpaceND=function(t,e,n){Ql([t],"batchToSpaceND");var r=e.reduce((function(t,e){return t*e})),i=qn(t.shape,e,r),a=Xn(i.length,e.length),o=$n(t.shape,e,r),s=Yn(n,e.length),u=Kn(o,n,e.length);return wi(t.reshape(i),a).reshape(o).slice(s,u)},e.prototype.spaceToBatchND=function(t,e,n){Ql([t],"spaceToBatchND");var r=e.reduce((function(t,e){return t*e})),i=[[0,0]];i.push.apply(i,n);for(var a=1+e.length;a<t.shape.length;++a)i.push([0,0]);var o=t.pad(i),s=qn(o.shape,e,r,!1),u=Xn(s.length,e.length,!1),c=$n(o.shape,e,r,!1);return wi(o.reshape(s),u).reshape(c)},e.prototype.maxPool=function(t,e){return Ql(t,"maxPool"),th(this.readSync(t.dataId),t.shape,t.dtype,t.strides,e,"max").toTensor()},e.prototype.maxPoolBackprop=function(t,e,n,r){Ql([e,n],"maxPoolBackprop");for(var i=this.readSync(e.dataId),a=Ln(r.outShape,e.dtype,eh(i,e.shape,e.dtype,r).values),o=r.strideHeight,s=r.strideWidth,u=r.dilationHeight,c=r.dilationWidth,l=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=h-1-r.padInfo.left,f=l-1-r.padInfo.top,d=Ln(e.shape,"float32"),m=this.bufferSync(t),v=0;v<r.batchSize;++v)for(var g=0;g<r.inChannels;++g)for(var y=0;y<r.inHeight;++y)for(var x=0;x<r.inWidth;++x){for(var b=y-f,w=x-p,_=0,S=0;S<l;S+=u){var M=(b+S)/o;if(!(M<0||M>=r.outHeight||Math.floor(M)!==M))for(var E=0;E<h;E+=c){var T=(w+E)/s;if(!(T<0||T>=r.outWidth||Math.floor(T)!==T)){var C=l*h-1-a.get(v,M,T,g)===S*h+E?1:0;0!==C&&(_+=m.get(v,M,T,g)*C)}}}d.set(_,v,y,x,g)}return d.toTensor()},e.prototype.avgPoolBackprop=function(t,e,n){Ql([t,e],"avgPoolBackprop");for(var r=n.strideHeight,i=n.strideWidth,a=n.filterHeight,o=n.filterWidth,s=n.dilationHeight,u=n.dilationWidth,c=n.effectiveFilterHeight,l=n.effectiveFilterWidth,h=l-1-n.padInfo.left,p=c-1-n.padInfo.top,f=Ln(e.shape,"float32"),d=1/(a*o),m=this.bufferSync(t),v=0;v<n.batchSize;++v)for(var g=0;g<n.inChannels;++g)for(var y=0;y<n.inHeight;++y)for(var x=0;x<n.inWidth;++x){for(var b=y-p,w=x-h,_=0,S=0;S<c;S+=s){var M=(b+S)/r;if(!(M<0||M>=n.outHeight||Math.floor(M)!==M))for(var E=0;E<l;E+=u){var T=(w+E)/i;T<0||T>=n.outWidth||Math.floor(T)!==T||(_+=m.get(v,M,T,g))}}f.set(_*d,v,y,x,g)}return f.toTensor()},e.prototype.pool3d=function(t,e,n){Ql(t,"pool3d");for(var r=e.strideDepth,i=e.strideHeight,a=e.strideWidth,o=e.dilationDepth,s=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterDepth,l=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=e.padInfo.front,f=e.padInfo.top,d=e.padInfo.left,m="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=this.readSync(t.dataId),g=Ln(e.outShape,t.dtype),y=g.values,x=e.outShape[1]*e.outShape[2]*e.outShape[3]*e.outShape[4],b=e.outShape[2]*e.outShape[3]*e.outShape[4],w=e.outShape[3]*e.outShape[4],_=e.outShape[4],S=0;S<e.batchSize;++S)for(var M=S*x,E=S*t.strides[0],T=0;T<e.inChannels;++T)for(var C=0;C<e.outDepth;++C){for(var A=C*r-p,N=A;N<0;)N+=o;for(var I=Math.min(e.inDepth,c+A),R=M+C*b,O=0;O<e.outHeight;++O){for(var k=O*i-f,L=k;L<0;)L+=s;for(var D=Math.min(e.inHeight,l+k),P=R+O*w,F=0;F<e.outWidth;++F){for(var B=F*a-d,z=B;z<0;)z+=u;for(var U=Math.min(e.inWidth,h+B),j=P+F*_,W=m,V=0,H=0,G=N;G<I;G+=o){for(var q=E+G*t.strides[1],X=L;X<D;X+=s){for(var $=q+X*t.strides[2],Y=z;Y<U;Y+=u){var K=v[$+Y*t.strides[3]+T];if("max"===n&&K>W?W=K:"avg"===n&&(V+=K,H++),isNaN(W))break}if(isNaN(W))break}if(isNaN(W))break}y[j+T]="avg"===n?V/H:W}}}return g.toTensor()},e.prototype.avgPool3d=function(t,e){return Ql(t,"avgPool3d"),this.pool3d(t,e,"avg").toFloat()},e.prototype.avgPool3dBackprop=function(t,e,n){Ql([t,e],"avgPool3dBackprop");for(var r=n.strideDepth,i=n.strideHeight,a=n.strideWidth,o=n.filterDepth,s=n.filterHeight,u=n.filterWidth,c=n.dilationDepth,l=n.dilationHeight,h=n.dilationWidth,p=n.effectiveFilterDepth,f=n.effectiveFilterHeight,d=n.effectiveFilterWidth,m=p-1-n.padInfo.front,v=d-1-n.padInfo.left,g=f-1-n.padInfo.top,y=Ln(e.shape,"float32"),x=1/(o*s*u),b=this.bufferSync(t),w=0;w<n.batchSize;++w)for(var _=0;_<n.inChannels;++_)for(var S=0;S<n.inDepth;++S)for(var M=0;M<n.inHeight;++M)for(var E=0;E<n.inWidth;++E){for(var T=S-m,C=M-g,A=E-v,N=0,I=0;I<p;I+=c){var R=(T+I)/r;if(!(R<0||R>=n.outDepth||Math.floor(R)!==R))for(var O=0;O<f;O+=l){var k=(C+O)/i;if(!(k<0||k>=n.outHeight||Math.floor(k)!==k))for(var L=0;L<d;L+=h){var D=(A+L)/a;D<0||D>=n.outWidth||Math.floor(D)!==D||(N+=b.get(w,R,k,D,_))}}}y.set(N*x,w,S,M,E,_)}return y.toTensor()},e.prototype.maxPool3d=function(t,e){return Ql(t,"maxPool3d"),this.pool3d(t,e,"max").toFloat()},e.prototype.maxPool3dPositions=function(t,e){for(var n=Ln(e.outShape,"int32"),r=e.strideDepth,i=e.strideHeight,a=e.strideWidth,o=e.dilationDepth,s=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterDepth,l=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=e.padInfo.front,f=e.padInfo.top,d=e.padInfo.left,m=this.bufferSync(t),v=0;v<e.batchSize;++v)for(var g=0;g<e.inChannels;++g)for(var y=0;y<e.outDepth;++y){for(var x=y*r-p,b=x;b<0;)b+=o;for(var w=Math.min(e.inDepth,c+x),_=0;_<e.outHeight;++_){for(var S=_*i-f,M=S;M<0;)M+=s;for(var E=Math.min(e.inHeight,l+S),T=0;T<e.outWidth;++T){for(var C=T*a-d,A=C;A<0;)A+=u;for(var N=Math.min(e.inWidth,h+C),I=Number.NEGATIVE_INFINITY,R=-1,O=b;O<w;O+=o)for(var k=O-x,L=M;L<E;L+=s)for(var D=L-S,P=A;P<N;P+=u){var F=P-C,B=m.get(v,O,L,P,g);B>=I&&(I=B,R=k*l*h+D*l+F)}n.set(R,v,y,_,T,g)}}}return n.toTensor()},e.prototype.maxPool3dBackprop=function(t,e,n,r){Ql([e,n],"maxPool3dBackprop");for(var i=this.maxPool3dPositions(e,r),a=r.strideDepth,o=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,l=r.dilationWidth,h=r.effectiveFilterDepth,p=r.effectiveFilterHeight,f=r.effectiveFilterWidth,d=h-1-r.padInfo.front,m=f-1-r.padInfo.left,v=p-1-r.padInfo.top,g=Ln(e.shape,"float32"),y=this.bufferSync(i),x=this.bufferSync(t),b=0;b<r.batchSize;++b)for(var w=0;w<r.inChannels;++w)for(var _=0;_<r.inDepth;++_)for(var S=0;S<r.inHeight;++S)for(var M=0;M<r.inWidth;++M){for(var E=_-d,T=S-v,C=M-m,A=0,N=0;N<h;N+=u){var I=(E+N)/a;if(!(I<0||I>=r.outDepth||Math.floor(I)!==I))for(var R=0;R<p;R+=c){var O=(T+R)/o;if(!(O<0||O>=r.outHeight||Math.floor(O)!==O))for(var k=0;k<f;k+=l){var L=(C+k)/s;if(!(L<0||L>=r.outWidth||Math.floor(L)!==L)){var D=h*p*f-1-y.get(b,I,O,L,w)===N*p*f+R*f+k?1:0;0!==D&&(A+=x.get(b,I,O,L,w)*D)}}}}g.set(A,b,_,S,M,w)}return g.toTensor()},e.prototype.cast=function(t,e){return Fi(t,e,this)},e.prototype.reshape=function(t,e){return Bi(t,e)},e.prototype.avgPool=function(t,e){return Ql(t,"avgPool"),Ql(t,"maxPool"),th(this.readSync(t.dataId),t.shape,t.dtype,t.strides,e,"avg").toTensor().toFloat()},e.prototype.resizeBilinear=function(t,e,n,r){Ql(t,"resizeBilinear");for(var i=t.shape,a=i[0],o=i[1],s=i[2],u=i[3],c=this.readSync(t.dataId),l=new Float32Array(I([a,e,n,u])),h=[r&&e>1?o-1:o,r&&n>1?s-1:s],p=[r&&e>1?e-1:e,r&&n>1?n-1:n],f=0,d=h[0]/p[0],m=h[1]/p[1],v=0;v<a;v++)for(var g=0;g<e;g++)for(var y=d*g,x=Math.floor(y),b=y-x,w=Math.min(o-1,Math.ceil(y)),_=v*t.strides[0]+x*t.strides[1],S=v*t.strides[0]+w*t.strides[1],M=0;M<n;M++)for(var E=m*M,T=Math.floor(E),C=E-T,A=Math.min(s-1,Math.ceil(E)),N=_+T*t.strides[2],R=S+T*t.strides[2],O=_+A*t.strides[2],k=S+A*t.strides[2],L=0;L<u;L++){var D=c[N+L],P=c[R+L],F=D+(c[O+L]-D)*C,B=F+(P+(c[k+L]-P)*C-F)*b;l[f++]=B}return dn(l,[a,e,n,u])},e.prototype.resizeBilinearBackprop=function(t,e,n){Ql([t,e],"resizeBilinearBackprop");for(var r=e.shape,i=r[0],a=r[1],o=r[2],s=r[3],u=t.shape,c=u[1],l=u[2],h=new Float32Array(i*a*o*s),p=[n&&c>1?a-1:a,n&&l>1?o-1:o],f=[n&&c>1?c-1:c,n&&l>1?l-1:l],d=p[0]/f[0],m=p[1]/f[1],v=this.readSync(t.dataId),g=0,y=0;y<i;y++)for(var x=y*e.strides[0],b=0;b<c;b++)for(var w=b*d,_=Math.floor(w),S=Math.min(Math.ceil(w),a-1),M=x+_*e.strides[1],E=x+S*e.strides[1],T=w-_,C=1-T,A=0;A<l;A++)for(var N=A*m,I=Math.floor(N),R=Math.min(Math.ceil(N),o-1),O=N-I,k=1-O,L=M+I*e.strides[2],D=M+R*e.strides[2],P=E+I*e.strides[2],F=E+R*e.strides[2],B=C*k,z=C*O,U=T*k,j=T*O,W=0;W<s;W++){var V=v[g++];h[L+W]+=V*B,h[D+W]+=V*z,h[P+W]+=V*U,h[F+W]+=V*j}return bn(h,[i,o,a,s],e.dtype)},e.prototype.resizeNearestNeighbor=function(t,e,n,r){Ql(t,"resizeNearestNeighbor");for(var i=t.shape,a=i[0],o=i[1],s=i[2],u=i[3],c=this.readSync(t.dataId),l=new Float32Array(a*e*n*u),h=[r&&e>1?o-1:o,r&&n>1?s-1:s],p=[r&&e>1?e-1:e,r&&n>1?n-1:n],f=h[0]/p[0],d=h[1]/p[1],m=0,v=0;v<a;v++)for(var g=v*t.strides[0],y=0;y<e;y++)for(var x=f*y,b=g+Math.min(o-1,r?Math.round(x):Math.floor(x))*t.strides[1],w=0;w<n;w++)for(var _=d*w,S=b+Math.min(s-1,r?Math.round(_):Math.floor(_))*t.strides[2],M=0;M<u;M++){var E=c[S+M];l[m++]=E}return dn(l,[a,e,n,u],t.dtype)},e.prototype.resizeNearestNeighborBackprop=function(t,e,n){Ql([t,e],"resizeNearestNeighborBackprop");for(var r=e.shape,i=r[0],a=r[1],o=r[2],s=r[3],u=t.shape,c=u[1],l=u[2],h=new Float32Array(i*a*o*s),p=this.readSync(t.dataId),f=[n&&c>1?a-1:a,n&&l>1?o-1:o],d=[n&&c>1?c-1:c,n&&l>1?l-1:l],m=f[0]/d[0],v=f[1]/d[1],g=1/m,y=1/v,x=2*Math.ceil(g)+2,b=2*Math.ceil(y)+2,w=0;w<i;w++)for(var _=w*e.strides[0],S=0;S<a;S++)for(var M=_+S*e.strides[1],E=Math.floor(S*g),T=Math.floor(E-x/2),C=0;C<o;C++)for(var A=M+C*e.strides[2],N=Math.floor(C*y),I=Math.floor(N-b/2),R=0;R<s;R++){for(var O=0,k=0;k<x;k++){var L=k+T;if(!(L<0||L>=c)){var D=_+L*t.strides[1],P=L*m;if(S===Math.min(a-1,n?Math.round(P):Math.floor(P)))for(var F=0;F<b;F++){var B=F+I;if(!(B<0||B>=l)){var z=D+B*t.strides[2],U=B*v;C===Math.min(o-1,n?Math.round(U):Math.floor(U))&&(O+=p[z+R])}}}}h[A+R]=O}return bn(h,e.shape,e.dtype)},e.prototype.batchNormalization=function(t,e,n,r,i,a){Ql([t,e,n,i,a],"batchNorm");for(var o=this.readSync(t.dataId),s=this.readSync(e.dataId),u=this.readSync(n.dataId),c=i?this.readSync(i.dataId):new Float32Array([1]),l=a?this.readSync(a.dataId):new Float32Array([0]),h=new Float32Array(o.length),p=l.length,f=c.length,d=u.length,m=s.length,v=0,g=0,y=0,x=0,b=0;b<o.length;++b)h[b]=l[v++]+(o[b]-s[g++])*c[y++]/Math.sqrt(u[x++]+r),v>=p&&(v=0),g>=m&&(g=0),y>=f&&(y=0),x>=d&&(x=0);return bn(h,t.shape)},e.prototype.localResponseNormalization4D=function(t,e,n,r,i){Ql(t,"localResponseNormalization4D");var a=t.shape[3],o=a-1,s=this.readSync(t.dataId),u=t.size,c=new Float32Array(u);function l(t){for(var n=t%a,r=t-n+Math.max(0,n-e),i=t-n+Math.min(n+e,o),u=0;r<=i;r++){var c=s[r];u+=c*c}return u}for(var h=0;h<u;h++){var p=l(h),f=s[h]*Math.pow(n+r*p,-i);c[h]=f}return bn(c,t.shape)},e.prototype.LRNGrad=function(t,e,n,r,i,a,o){Ql(t,"LRNGrad");for(var s=t.shape[3],u=this.readSync(t.dataId),c=this.readSync(e.dataId),l=this.readSync(n.dataId),h=new Float32Array(t.size),p=t.size,f=0;f<p;f++){for(var d=f%s,m=f-d+Math.max(0,d-r),v=f-d+Math.min(s,d+r+1),g=0,y=m;y<v;y++)g+=Math.pow(c[y],2);for(g=a*g+i,y=m;y<v;y++){var x=-2*a*o*c[y]*l[f]/g;f===y&&(x+=Math.pow(g,-o)),x*=u[f],h[y]+=x}}return bn(h,t.shape)},e.prototype.multinomial=function(t,e,n,r){Ql(t,"multinomial");for(var i=e?t:xi(t),a=i.shape[0],o=i.shape[1],s=_n([a,n],"int32"),u=this.readSync(s.dataId),c=this.readSync(i.dataId),l=0;l<a;++l){var h=l*o,p=new Float32Array(o-1);p[0]=c[h];for(var f=1;f<p.length;++f)p[f]=p[f-1]+c[h+f];for(var d=Vs(r.toString()),m=l*n,v=0;v<n;++v){var g=d();u[m+v]=p.length;for(var y=0;y<p.length;y++)if(g<p[y]){u[m+v]=y;break}}}return s},e.prototype.oneHot=function(t,e,n,r){Ql(t,"oneHot");var i=new Float32Array(t.size*e);i.fill(r);for(var a=this.readSync(t.dataId),o=0;o<t.size;++o)a[o]>=0&&a[o]<e&&(i[o*e+a[o]]=n);return yn(i,[t.size,e],"int32")},e.prototype.nonMaxSuppression=function(t,e,n,r,i){return Ql(t,"nonMaxSuppression"),Xi(this.readSync(t.dataId),this.readSync(e.dataId),n,r,i)},e.prototype.fft=function(t){return this.fftBatch(t,!1)},e.prototype.ifft=function(t){return this.fftBatch(t,!0)},e.prototype.fftBatch=function(t,e){for(var n=t.shape[0],r=t.shape[1],i=Ln(t.shape,"float32"),a=Ln(t.shape,"float32"),o=pn(t).as2D(n,r),s=fn(t).as2D(n,r),u=0;u<n;u++)for(var c=o.slice([u,0],[1,r]),l=s.slice([u,0],[1,r]),h=hn(c,l),p=this.readSync(this.fftImpl(h,e).dataId),f=0;f<r;f++){var d=Wi(p,f);i.values[u*r+f]=d.real,a.values[u*r+f]=d.imag}return hn(i.toTensor(),a.toTensor()).as2D(n,r)},e.prototype.fftImpl=function(t,e){var n=t.as1D(),r=n.size;if(this.isExponentOf2(r)){var i=this.fftRadix2(n,r,e).as2D(t.shape[0],t.shape[1]);return e&&(i=hn(pn(i).div(vn(r)),fn(i).div(vn(r)))),i}var a=this.readSync(t.dataId),o=function(t){for(var e=new Float32Array(t.length/2),n=new Float32Array(t.length/2),r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}(this.fourierTransformByMatmul(a,r,e));return hn(o.real,o.imag).as2D(t.shape[0],t.shape[1])},e.prototype.isExponentOf2=function(t){return 0==(t&t-1)},e.prototype.fftRadix2=function(t,e,n){if(1===e)return t;var r=this.readSync(t.dataId),i=e/2,a=function(t){for(var e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e),i=0;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}(r),o=hn(a.real,a.imag).as1D(),s=function(t){for(var e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e),i=2;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}(r),u=hn(s.real,s.imag).as1D();o=this.fftRadix2(o,i,n),u=this.fftRadix2(u,i,n);var c=function(t,e){for(var n=new Float32Array(t/2),r=new Float32Array(t/2),i=0;i<Math.ceil(t/2);i++){var a=(e?2:-2)*Math.PI*(i/t);n[i]=Math.cos(a),r[i]=Math.sin(a)}return{real:n,imag:r}}(e,n),l=hn(c.real,c.imag).mul(u),h=o.add(l),p=o.sub(l),f=pn(h).concat(pn(p)),d=fn(h).concat(fn(p));return hn(f,d).as1D()},e.prototype.fourierTransformByMatmul=function(t,e,n){for(var r=new Float32Array(2*e),i=0;i<e;i++){for(var a=0,o=0,s=0;s<e;s++){var u=Hi(i*s,e,n),c=Wi(t,s);a+=c.real*u.real-c.imag*u.imag,o+=c.real*u.imag+c.imag*u.real}n&&(a/=e,o/=e),Vi(r,a,o,i)}return r},e.prototype.depthToSpace=function(t,e,n){T("NHWC"===n,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+n})),T(e>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+e}));for(var r=t.shape[0],i=t.shape[1],a=t.shape[2],o=t.shape[3],s=i*e,u=a*e,c=o/(e*e),l=this.readSync(t.dataId),h=new Float32Array(r*s*u*c),p=0,f=0;f<r;++f)for(var d=0;d<s;++d)for(var m=Math.floor(d/e),v=d%e,g=0;g<u;++g)for(var y=Math.floor(g/e),x=(v*e+g%e)*c,b=0;b<c;++b){var w=b+x+o*(y+a*(m+i*f));h[p++]=l[w]}return bn(h,[r,s,u,c])},e.prototype.broadcastedBinaryOp=function(t,e,n,r){var i=ir(t.shape,e.shape),a=Ln(i,n),o=this.readSync(t.dataId),s=this.readSync(e.dataId),u=nr(t.shape,i),c=nr(e.shape,i),l=a.values;if(u.length+c.length===0)for(var h=0;h<l.length;++h)l[h]=r(o[h%o.length],s[h%s.length]);else{var p=this.bufferSync(t),f=this.bufferSync(e),d=function(n){var i=a.indexToLoc(n),h=i.slice(-t.rank);u.forEach((function(t){return h[t]=0}));var d=p.locToIndex(h),m=i.slice(-e.rank);c.forEach((function(t){return m[t]=0}));var v=f.locToIndex(m);l[n]=r(o[d],s[v])};for(h=0;h<l.length;++h)d(h)}return a.toTensor()},e.prototype.broadcastedBinaryComplexOp=function(t,e,n){var r=ir(t.shape,e.shape),i=Ln(r,"float32"),a=Ln(r,"float32"),o=this.readSync(t.dataId),s=this.readSync(e.dataId),u=nr(t.shape,r),c=nr(e.shape,r),l=i.values,h=a.values;if(u.length+c.length===0)for(var p=0;p<l.length;p++){var f=p%o.length,d=p%s.length,m=n(o[2*f],o[2*f+1],s[2*d],s[2*d+1]);l[p]=m.real,h[p]=m.imag}else{var v=this.bufferSync(this.data.get(t.dataId).complexTensors.real),g=this.bufferSync(this.data.get(e.dataId).complexTensors.real),y=function(r){var a=i.indexToLoc(r),p=a.slice(-t.rank);u.forEach((function(t){return p[t]=0}));var f=v.locToIndex(p),d=a.slice(-e.rank);c.forEach((function(t){return d[t]=0}));var m=g.locToIndex(d),y=n(o[2*f],o[2*f+1],s[2*m],s[2*m+1]);l[r]=y.real,h[r]=y.imag};for(p=0;p<l.length;p++)y(p)}return this.complex(i.toTensor(),a.toTensor())},e.prototype.split=function(t,e,n){return Qi(t,e,n)},e.prototype.dispose=function(){},e.prototype.floatPrecision=function(){return 32},e.prototype.epsilon=function(){return 1e-7},e.prototype.cropAndResize=function(t,e,n,r,i,a){for(var o=t.shape,s=o[0],u=o[1],c=o[2],l=o[3],h=e.shape[0],p=r[0],f=r[1],d=Ln([h,p,f,l],"float32"),m=this.readSync(e.dataId),v=this.readSync(n.dataId),g=this.readSync(t.dataId),y=t.strides,x=d.strides,b=0;b<h;b++){var w=4*b,_=m[w],S=m[w+1],M=m[w+2],E=m[w+3],T=v[b];if(!(T>=s))for(var C=p>1?(M-_)*(u-1)/(p-1):0,A=f>1?(E-S)*(c-1)/(f-1):0,N=0;N<p;N++){var I=p>1?_*(u-1)+N*C:.5*(_+M)*(u-1);if(I<0||I>u-1)for(var R=0;R<f;R++)for(var O=0;O<l;O++){var k=O+R*x[2]+N*x[1]+b*x[0];d.values[k]=a}else if("bilinear"===i){var L=Math.floor(I),D=Math.ceil(I),P=I-L;for(R=0;R<f;R++)if((G=f>1?S*(c-1)+R*A:.5*(S+E)*(c-1))<0||G>c-1)for(O=0;O<l;O++)k=O+R*x[2]+N*x[1]+b*x[0],d.values[k]=a;else{var F=Math.floor(G),B=Math.ceil(G),z=G-F;for(O=0;O<l;O++){var U=g[k=O+F*y[2]+L*y[1]+T*y[0]],j=g[k=O+B*y[2]+L*y[1]+T*y[0]],W=g[k=O+F*y[2]+D*y[1]+T*y[0]],V=U+(j-U)*z,H=W+(g[k=O+B*y[2]+D*y[1]+T*y[0]]-W)*z;k=O+R*x[2]+N*x[1]+b*x[0],d.values[k]=V+(H-V)*P}}}else for(R=0;R<f;++R){var G;if((G=f>1?S*(c-1)+R*A:.5*(S+E)*(c-1))<0||G>c-1)for(O=0;O<l;O++)k=O+R*x[2]+N*x[1]+b*x[0],d.values[k]=a;else{var q=Math.round(G),X=Math.round(I);for(O=0;O<l;O++){var $=O+q*y[2]+X*y[1]+T*y[0],Y=O+R*x[2]+N*x[1]+b*x[0];d.values[Y]=g[$]}}}}}return d.toTensor()},e.prototype.sparseToDense=function(t,e,n,r){var i=ui(0,t,n),a=i.sliceRank,o=i.numUpdates,s=i.sliceSize,u=i.strides,c=i.outputSize;return this.scatter(t,e,n,c,s,o,a,u,r,!1)},e.prototype.gatherND=function(t,e){var n=e.shape,r=n[n.length-1],i=ri(t,e),a=i[0],o=i[1],s=i[2],u=i[3];if(0===o)return dn([],a,t.dtype);for(var c=new gt([o,s],t.dtype),l=this.readSync(e.dataId),h=this.readSync(t.dataId),p=0;p<o;p++){for(var f=[],d=0,m=0;m<r;m++){var v=l[p*r+m];d+=v*u[m],f.push(v)}if(d<0||d>=t.size/s)throw new Error("Invalid indices: "+f+" does not index into "+t.shape);for(var g=0;g<s;g++)c.values[p*s+g]=h[d*s+g]}return c.toTensor().reshape(a)},e.prototype.scatterND=function(t,e,n){var r=ui(0,t,n),i=r.sliceRank,a=r.numUpdates,o=r.sliceSize,s=r.strides,u=r.outputSize,c=vn(0);return this.scatter(t,e,n,u,o,a,i,s,c,!0)},e.prototype.fill=function(t,e,n){var r=j(n=n||J(e),I(t));return r.fill(e),Ft.makeTensor(r,t,n,this)},e.prototype.onesLike=function(t){if("string"===t.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(t.shape,1,t.dtype)},e.prototype.zerosLike=function(t){var e=j(t.dtype,I(t.shape));return this.makeOutput(e,t.shape,t.dtype)},e.prototype.linspace=function(t,e,n){return zi(t,e,n)},e.prototype.scatter=function(t,e,n,r,i,a,o,s,u,c){var l=[r/i,i],h=this.readSync(t.dataId),p=this.readSync(e.dataId);if(0===r)return dn([],n,e.dtype);var f=new gt(l,e.dtype);f.values.fill(this.readSync(u.dataId)[0]);for(var d=0;d<a;d++){for(var m=[],v=0,g=0;g<o;g++){var y=h[d*o+g];m.push(y),v+=y*s[g]}if(v<0||v>=r/i)throw new Error("Invalid indices: "+m+" does not index into "+n);for(var x=0;x<i;x++)c?f.values[v*i+x]+=p[d*i+x]:f.values[v*i+x]=0===e.rank?p[0]:p[d*i+x]}return f.toTensor().reshape(n)},e}(Si);function ih(t,e){return{kernelName:t,backendName:"cpu",kernelFunc:function(n){var r=n.inputs,i=n.backend,a=r,o=a.a,s=a.b,u=i;Ql([o,s],t);var c=u.data.get(o.dataId).values,l=u.data.get(s.dataId).values,h=e(o.shape,s.shape,c,l,o.dtype),p=h[0],f=h[1];return{dataId:u.write(p,f,o.dtype),shape:f,dtype:o.dtype}}}}function ah(t){return function(e,n,r,i,a){var o=ir(e,n),s=o.length,u=tt(o),c=U(a,I(o)),l=e.length,h=n.length,p=tt(e),f=tt(n),d=nr(e,o),m=nr(n,o);if(d.length+m.length===0)for(var v=0;v<c.length;++v)c[v]=t(r[v%r.length],i[v%i.length]);else{var g=function(e){var n=lt(e,s,u),a=n.slice(-l);d.forEach((function(t){return a[t]=0}));var o=ct(a,l,p),v=n.slice(-h);m.forEach((function(t){return v[t]=0}));var g=ct(v,h,f);c[e]=t(r[o],i[g])};for(v=0;v<c.length;++v)g(v)}return[c,o]}}Ft.registerBackend("cpu",(function(){return new rh}),1);var oh=ah((function(t,e){return t/e})),sh=ih(Jn,oh),uh={kernelName:"MaxPoolWithArgmax",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.attrs,r=t.backend,i=e.x,a=n,o=a.filterSize,s=a.strides,u=a.pad,c=a.includeBatchInIndex,l=r;Ql(i,"MaxPoolWithArgmax");var h=l.data.get(i.dataId).values,p=Ei(i.shape,o,s,[1,1],u),f=function(t,e,n,r,i){var a=th(t,0,n,tt(e),i,"max"),o=eh(t,e,n,i,!0,r);return[a.values,o.values]}(h,i.shape,i.dtype,c,p),d=f[0],m=f[1],v=l.write(d,p.outShape,i.dtype),g=l.write(m,p.outShape,i.dtype);return[{dataId:v,shape:p.outShape,dtype:i.dtype},{dataId:g,shape:p.outShape,dtype:"int32"}]}},ch={kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e,a=i.boxes,o=i.scores,s=r,u=s.maxOutputSize,c=s.iouThreshold,l=s.scoreThreshold,h=s.softNmsSigma,p=n;Ql(a,"NonMaxSuppressionWithScore");var f=$i(p.data.get(a.dataId).values,p.data.get(o.dataId).values,u,c,l,h);return[f.selectedIndices,f.selectedScores]}},lh={kernelName:"Square",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,i=n;Ql(r,"square");for(var a=i.data.get(r.dataId).values,o=new Float32Array(a.length),s=0;s<a.length;++s){var u=a[s];o[s]=u*u}return{dataId:i.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},hh=ah((function(t,e){var n=t-e;return n*n}));function ph(t,e,n,r,i){for(var a=I(e),o=e.length,s=tt(e),u=tt(i),c=U(n,I(i)),l=0;l<a;++l){for(var h=lt(l,o,s),p=new Array(h.length),f=0;f<p.length;f++)p[f]=h[r[f]];c[ct(p,o,u)]=t[l]}return c}for(var fh=0,dh=[ch,lh,ih(Zn,hh),sh,{kernelName:"Transpose",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.attrs,r=t.backend,i=e.x,a=n.perm,o=r;Ql(i,"transpose");for(var s=i.shape.length,u=new Array(s),c=0;c<u.length;c++)u[c]=i.shape[a[c]];var l=ph(o.data.get(i.dataId).values,i.shape,i.dtype,a,u);return{dataId:o.write(l,u,i.dtype),shape:u,dtype:i.dtype}}},uh];fh<dh.length;fh++)x(dh[fh]);for(var mh,vh=function(t){this.variableNames=["A"];var e=ua(),n=t[0],r=t[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n\n        vec4 values = "+e.texture2D+"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "},gh=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var e=ua(),n=t[0],r=t[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2("+r+".0, "+n+".0);\n            vec4 values = "+e.texture2D+"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        "+e.output+" = result;\n      }\n    "},yh=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];this.outputShape=n,this.rank=n.length;var i=xa(this.rank),a=function(t){var e=t.length;if(e>6)throw Error("Transpose for rank "+e+" is not yet supported");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e),i=0;i<t.length;i++)r[t[i]]=n[i];return r.join()}(e);this.userCode="\n    void main() {\n      "+i+" resRC = getOutputCoords();\n      setOutput(getA("+a+"));\n    }\n    "},xh=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var i=xa(this.rank),a=oa("rc",this.rank),o=new Array(this.rank);for(r=0;r<e.length;r++)o[e[r]]=a[r];var s="vec2("+o.slice(-2).join()+")",u="++"+a[this.rank-1]+" < "+n[this.rank-1],c="getChannel(getA("+o.join()+"), "+s+")";this.userCode="\n    void main() {\n      "+i+" rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = "+c+";\n      if("+u+") {\n        result[1] = "+c+";\n      }\n      --"+a[this.rank-1]+";\n      if(++"+a[this.rank-2]+" < "+n[this.rank-2]+") {\n        result[2] = "+c+";\n        if("+u+") {\n          result[3] = "+c+";\n        }\n      }\n      setOutput(result);\n    }\n    "},bh=0,wh=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.pixels,a=r.numChannels,o="undefined"!=typeof HTMLVideoElement&&i instanceof HTMLVideoElement,s="undefined"!=typeof HTMLImageElement&&i instanceof HTMLImageElement,u=o?[i.videoWidth,i.videoHeight]:[i.width,i.height],c=u[0],l=u[1],h=[l,c],f=[l,c,a];(s||o)&&(null==mh&&(mh=document.createElement("canvas").getContext("2d")),mh.canvas.width=c,mh.canvas.height=l,mh.drawImage(i,0,0,c,l),i=mh.canvas);var d=n.makeTensorInfo(h,"int32");n.texData.get(d.dataId).usage=jt.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),i);var m=p().getBool("WEBGL_PACK")?new gh(f):new vh(f),v=n.runWebGLProgram(m,[d],"int32");return n.disposeData(d.dataId),v}},{kernelName:Jn,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e;return function(t,e,n){var r=new Oa("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",t.shape,e.shape);return p().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&(r=new La("\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",t.shape,e.shape,!0)),n.runWebGLProgram(r,[t,e],"float32")}(r.a,r.b,n)}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs;$e("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var i=e,a=i.boxes,o=i.scores,s=r,u=s.maxOutputSize,c=s.iouThreshold,l=s.scoreThreshold,h=s.softNmsSigma,p=n,f=$i(p.readSync(a.dataId),p.readSync(o.dataId),u,c,l,h);return[f.selectedIndices,f.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,i=n,a=new ms(r.shape,"return x * x;");return i.runWebGLProgram(a,[r],r.dtype)}},{kernelName:Zn,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e,i=r.a,a=r.b,o=n,s=p().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new La("return (a - b) * (a - b);",i.shape,a.shape):new Oa("return (a - b) * (a - b);",i.shape,a.shape);return o.compileAndRun(s,[i,a])}},{kernelName:"Transpose",backendName:"webgl",kernelFunc:function(t){for(var e,n=t.inputs,r=t.attrs,i=t.backend,a=n.x,o=r.perm,s=i,u=a.shape.length,c=new Array(u),l=0;l<c.length;l++)c[l]=a.shape[o[l]];if(s.shouldExecuteOnCPU([a])){var h=ph(s.texData.get(a.dataId).values,a.shape,a.dtype,o,c);e=s.makeTensorInfo(c,a.dtype),s.texData.get(e.dataId).values=h}else e=function(t,e,n){var r=p().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new xh(t.shape,e):new yh(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}(a,o,s);return e}},{kernelName:"MaxPoolWithArgmax",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.attrs,r=t.backend,i=e.x,a=n,o=a.filterSize,s=a.strides,u=a.pad,c=a.includeBatchInIndex,l=r;T(4===i.shape.length,(function(){return"Error in maxPool: input must be rank 4 but got rank "+i.shape.length+"."}));var h=[1,1];T(Di(s,h),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+s+" and dilations '"+h+"'"}));var p=Ei(i.shape,o,s,h,u),f=function(t,e,n,r){var i=new Go(n,"max",!1),a=r.runWebGLProgram(i,[t],"float32");return i=new Go(n,"max",!0,!0,e),[a,r.runWebGLProgram(i,[t],"float32")]}(i,c,p,l);return[f[0],f[1]]}}];bh<wh.length;bh++)x(wh[bh]);for(var _h=0,Sh=[{kernelName:"Add",inputsToSave:["a","b"],gradFunc:function(t,e){var n=e[0],r=e[1],i=ir(n.shape,r.shape);return{a:function(){var e=t,r=rr(n.shape,i);return r.length>0&&(e=e.sum(r)),e.reshape(n.shape)},b:function(){var e=t,n=rr(r.shape,i);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)}}}},{kernelName:"AddN",saveAllInputs:!0,gradFunc:function(t,e){var n={};return e.forEach((function(e,r){n[r]=function(){return t.clone()}})),n}},{kernelName:Qn,gradFunc:function(t,e,n){for(var r=n,i=r.inputShape,a=r.shape,o=Array.from(a),s=i.length-1;s>=0;s--)if(i[s]===a[s])o[s]=1;else if(1!==i[s])throw new Error("broadcastTo(): ["+i+"] cannot be broadcast to ["+a+"].");var u=[];for(s=0;s<o.length;s++)o[s]>1&&u.push(s);return{x:function(){return t.sum(u,!0)}}}},{kernelName:Jn,inputsToSave:["a","b"],gradFunc:function(t,e){var n=e[0],r=e[1],i=ir(n.shape,r.shape);return{a:function(){var e=ni(t,r.toFloat()),a=rr(n.shape,i);return a.length>0?Hc(e,a).reshape(n.shape):e},b:function(){var e=t.mul(n.toFloat()),a=rr(r.shape,i);a.length>0&&(e=Hc(e,a).reshape(r.shape));var o=Lu(r);return Sr(ni(e,o.toFloat()))}}}},{kernelName:"FusedBatchNorm",inputsToSave:["x","mean","variance","scale"],gradFunc:function(t,e,n){var r=n.varianceEpsilon,i=e[0],a=e[1],o=e[2],s=e[3],u=qs(i),c=null==s?vn(1):s,l=rr(a.shape,u.shape),h=[];if(1===a.rank){for(var p=0;p<u.shape.length-1;++p)h.push(u.shape[p]);h.push(1)}var f=ti(i,a),d=Yr(t,c),m=Tr(er(o,vn(r))),v=Yr(Yr(Yr(m,m),m),vn(-.5));return{x:function(){return 1===a.rank?Un(Yr(Yr(t,mu(m.as4D(1,1,1,a.shape[0]),h)),c),i.shape):Un(Yr(Yr(t,m),c),i.shape)},mean:function(){var t=Yr(Yr(m,vn(-1)),d);return 1===a.rank&&(t=Hc(t,l)),Un(t,a.shape)},variance:function(){var t=Yr(Yr(v,f),d);return 1===a.rank&&(t=Hc(t,l)),Un(t,a.shape)},scale:function(){var e=Yr(f,m),n=Yr(t,e);return 1===a.rank&&(n=Hc(n,l)),Un(n,a.shape)},offset:function(){var e=t;return 1===a.rank&&(e=Hc(e,l)),Un(e,a.shape)}}}},{kernelName:tr,gradFunc:function(t){return{x:function(){return t.toFloat()}}}},{kernelName:"OneHot",inputsToSave:["indices"],gradFunc:function(t,e){var n=e[0];return{indices:function(){return _n(n.shape,"float32")}}}},{kernelName:"PadV2",inputsToSave:["x"],gradFunc:function(t,e,n){var r=e[0],i=n.paddings.map((function(t){return t[0]}));return{x:function(){return t.slice(i,r.shape)}}}},{kernelName:"Square",inputsToSave:["x"],gradFunc:function(t,e){var n=e[0];return{x:function(){return t.mul(n.toFloat().mul(2))}}}},{kernelName:Zn,inputsToSave:["a","b"],gradFunc:function(t,e){var n=e[0],r=e[1],i=vn(2);return{a:function(){return Yr(t,Yr(i,ti(n,r)))},b:function(){return Yr(t,Yr(i,ti(r,n)))}}}},{kernelName:"Tile",inputsToSave:["x"],gradFunc:function(t,e,n){var r=e[0],i=n.reps;return{x:function(){var e=Cn(r);if(1===r.rank)for(var n=0;n<i[0];++n)e=e.add(t.slice([n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(n=0;n<i[0];++n)for(var a=0;a<i[1];++a)e=e.add(t.slice([n*r.shape[0],a*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(n=0;n<i[0];++n)for(a=0;a<i[1];++a)for(var o=0;o<i[2];++o)e=e.add(t.slice([n*r.shape[0],a*r.shape[1],o*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(n=0;n<i[0];++n)for(a=0;a<i[1];++a)for(o=0;o<i[2];++o)for(var s=0;s<i[3];++s)e=e.add(t.slice([n*r.shape[0],a*r.shape[1],o*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return e}}}},{kernelName:"Transpose",gradFunc:function(t,e,n){var r=on(n.perm);return{x:function(){return wi(t,r)}}}}];_h<Sh.length;_h++)b(Sh[_h]);var Mh=function(){function t(){}return t.prototype.fetch=function(t,e){return fetch(t,e)},t.prototype.now=function(){return performance.now()},t.prototype.encode=function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Browser's encoder only supports utf-8, but got "+e);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},t.prototype.decode=function(t,e){return new TextDecoder(e).decode(t)},t}();p().get("IS_BROWSER")&&p().setPlatform("browser",new Mh);var Eh,Th=function(){function t(){this.util=n(351),this.textEncoder=new this.util.TextEncoder}return t.prototype.fetch=function(t,e){return null!=p().global.fetch?p().global.fetch(t,e):(null==Eh&&(Eh=n(350)),Eh(t,e))},t.prototype.now=function(){var t=r.hrtime();return 1e3*t[0]+t[1]/1e6},t.prototype.encode=function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Node built-in encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)},t.prototype.decode=function(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)},t}();p().get("IS_NODE")&&p().setPlatform("node",new Th);var Ch={float32:4,int32:4,uint16:2,uint8:1,bool:1};function Ah(t,e){for(var n={},r=0,i=function(e){var i=e.name,a=e.dtype,o=e.shape,s=I(o),u=void 0;if("quantization"in e){var c=e.quantization;if("uint8"!==c.dtype&&"uint16"!==c.dtype)throw new Error("Weight "+e.name+" has unknown quantization dtype "+c.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var l=Ch[c.dtype],h=t.slice(r,r+s*l),p="uint8"===c.dtype?new Uint8Array(h):new Uint16Array(h);if("float32"===a)u=Float32Array.from(p,(function(t){return t*c.scale+c.min}));else{if("int32"!==a)throw new Error("Unsupported dtype in weight '"+i+"': "+a);u=Int32Array.from(p,(function(t){return Math.round(t*c.scale+c.min)}))}r+=s*l}else if("string"===a){var f=I(e.shape);u=[];for(var d=0;d<f;d++){var m=new Uint32Array(t.slice(r,r+4))[0];r+=4;var v=new Uint8Array(t.slice(r,r+m));u.push(v),r+=m}}else{var g=Ch[a];if(h=t.slice(r,r+s*g),"float32"===a)u=new Float32Array(h);else if("int32"===a)u=new Int32Array(h);else{if("bool"!==a)throw new Error("Unsupported dtype in weight '"+i+"': "+a);u=new Uint8Array(h)}r+=s*g}n[i]=dn(u,o,a)},a=0,o=e;a<o.length;a++)i(o[a]);return n}function Nh(t){if(null===t)throw new Error("Invalid input value: "+JSON.stringify(t));var e=0,n=[];t.forEach((function(t){if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+t.constructor.name)}));var r=new Uint8Array(e),i=0;return n.forEach((function(t){r.set(new Uint8Array(t.buffer),i),i+=t.byteLength})),r.buffer}var Ih=void 0!==i&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function Rh(t){return Ih?i.byteLength(t):new Blob([t]).size}function Oh(t){var e=0;t.forEach((function(t){e+=t.byteLength}));var n=new Uint8Array(e),r=0;return t.forEach((function(t){n.set(new Uint8Array(t),r),r+=t.byteLength})),n.buffer}function kh(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);var e=t.split("/");return e[e.length-1]}function Lh(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:Rh(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:Rh(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}var Dh=function(){function t(){this.saveRouters=[],this.loadRouters=[]}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerSaveRouter=function(e){t.getInstance().saveRouters.push(e)},t.registerLoadRouter=function(e){t.getInstance().loadRouters.push(e)},t.getSaveHandlers=function(e){return t.getHandlers(e,"save")},t.getLoadHandlers=function(e,n){return t.getHandlers(e,"load",n)},t.getHandlers=function(e,n,r){var i=[];return("load"===n?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach((function(t){var n=t(e,r);null!==n&&i.push(n)})),i},t}(),Ph="://",Fh=function(){function t(){this.managers={}}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerManager=function(e,n){T(null!=e,(function(){return"scheme must not be undefined or null."})),e.endsWith(Ph)&&(e=e.slice(0,e.indexOf(Ph))),T(e.length>0,(function(){return"scheme must not be an empty string."}));var r=t.getInstance();T(null==r.managers[e],(function(){return"A model store manager is already registered for scheme '"+e+"'."})),r.managers[e]=n},t.getManager=function(t){var e=this.getInstance().managers[t];if(null==e)throw new Error("Cannot find model manager for scheme '"+t+"'");return e},t.getSchemes=function(){return Object.keys(this.getInstance().managers)},t}();function Bh(t){if(-1===t.indexOf(Ph))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+Fh.getSchemes().join(","));return{scheme:t.split(Ph)[0],path:t.split(Ph)[1]}}function zh(t,e,n){return void 0===n&&(n=!1),u(this,void 0,void 0,(function(){var r,i,a,o,s,u,l,h,p;return c(this,(function(c){switch(c.label){case 0:return T(t!==e,(function(){return"Old path and new path are the same: '"+t+"'"})),T((r=Dh.getLoadHandlers(t)).length>0,(function(){return"Copying failed because no load handler is found for source URL "+t+"."})),T(r.length<2,(function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+t+"."})),i=r[0],T((a=Dh.getSaveHandlers(e)).length>0,(function(){return"Copying failed because no save handler is found for destination URL "+e+"."})),T(a.length<2,(function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+e+"."})),o=a[0],s=Bh(t).scheme,u=Bh(t).path,l=s===Bh(t).scheme,[4,i.load()];case 1:return h=c.sent(),n&&l?[4,Fh.getManager(s).removeModel(u)]:[3,3];case 2:c.sent(),c.label=3;case 3:return[4,o.save(h)];case 4:return p=c.sent(),!n||l?[3,6]:[4,Fh.getManager(s).removeModel(u)];case 5:c.sent(),c.label=6;case 6:return[2,p.modelArtifactsInfo]}}))}))}var Uh="models_store",jh="model_info_store";function Wh(){if(!p().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var t=window||self,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Vh(t){var e=t.result;e.createObjectStore(Uh,{keyPath:"modelPath"}),e.createObjectStore(jh,{keyPath:"modelPath"})}var Hh=function(){function t(t){if(this.indexedDB=Wh(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return t.prototype.save=function(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]}))}))},t.prototype.load=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){return[2,this.databaseAction(this.modelPath)]}))}))},t.prototype.databaseAction=function(t,e){var n=this;return new Promise((function(t,r){var i=n.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return Vh(i)},i.onsuccess=function(){var a=i.result;if(null==e){var o=a.transaction(Uh,"readonly"),s=o.objectStore(Uh).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return a.close(),r(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));t(s.result.modelArtifacts)},s.onerror=function(t){return a.close(),r(s.error)},o.oncomplete=function(){return a.close()}}else{var u,c=Lh(e),l=a.transaction(jh,"readwrite"),h=l.objectStore(jh),p=h.put({modelPath:n.modelPath,modelArtifactsInfo:c});p.onsuccess=function(){var i=(u=a.transaction(Uh,"readwrite")).objectStore(Uh).put({modelPath:n.modelPath,modelArtifacts:e,modelArtifactsInfo:c});i.onsuccess=function(){return t({modelArtifactsInfo:c})},i.onerror=function(t){var e=(h=l.objectStore(jh)).delete(n.modelPath);e.onsuccess=function(){return a.close(),r(i.error)},e.onerror=function(t){return a.close(),r(i.error)}}},p.onerror=function(t){return a.close(),r(p.error)},l.oncomplete=function(){null==u?a.close():u.oncomplete=function(){return a.close()}}}},i.onerror=function(t){return r(i.error)}}))},t.URL_SCHEME="indexeddb://",t}(),Gh=function(t){return p().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Hh.URL_SCHEME)?(e=t.slice(Hh.URL_SCHEME.length),new Hh(e)):null;var e};Dh.registerSaveRouter(Gh),Dh.registerLoadRouter(Gh);var qh=function(){function t(){this.indexedDB=Wh()}return t.prototype.listModels=function(){return u(this,void 0,void 0,(function(){var t=this;return c(this,(function(e){return[2,new Promise((function(e,n){var r=t.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=function(){return Vh(r)},r.onsuccess=function(){var t=r.result,i=t.transaction(jh,"readonly"),a=i.objectStore(jh).getAll();a.onsuccess=function(){for(var t={},n=0,r=a.result;n<r.length;n++){var i=r[n];t[i.modelPath]=i.modelArtifactsInfo}e(t)},a.onerror=function(e){return t.close(),n(a.error)},i.oncomplete=function(){return t.close()}},r.onerror=function(t){return n(r.error)}}))]}))}))},t.prototype.removeModel=function(t){return u(this,void 0,void 0,(function(){var e=this;return c(this,(function(n){var r;return t=(r=t).startsWith(Hh.URL_SCHEME)?r.slice(Hh.URL_SCHEME.length):r,[2,new Promise((function(n,r){var i=e.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return Vh(i)},i.onsuccess=function(){var e,a=i.result,o=a.transaction(jh,"readwrite"),s=o.objectStore(jh),u=s.get(t);u.onsuccess=function(){if(null==u.result)return a.close(),r(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var i=s.delete(t),o=function(){var i=(e=a.transaction(Uh,"readwrite")).objectStore(Uh).delete(t);i.onsuccess=function(){return n(u.result.modelArtifactsInfo)},i.onerror=function(t){return r(u.error)}};i.onsuccess=o,i.onerror=function(t){return o(),a.close(),r(u.error)}},u.onerror=function(t){return a.close(),r(u.error)},o.oncomplete=function(){null==e?a.close():e.oncomplete=function(){return a.close()}}},i.onerror=function(t){return r(i.error)}}))]}))}))},t}();if(p().getBool("IS_BROWSER"))try{Fh.registerManager(Hh.URL_SCHEME,new qh)}catch(o){}var Xh="/",$h="tensorflowjs_models",Yh="info",Kh="model_topology",Jh="weight_specs",Zh="weight_data",Qh="model_metadata";function tp(t){return{info:[$h,t,Yh].join(Xh),topology:[$h,t,Kh].join(Xh),weightSpecs:[$h,t,Jh].join(Xh),weightData:[$h,t,Zh].join(Xh),modelMetadata:[$h,t,Qh].join(Xh)}}function ep(t){var e=t.split(Xh);if(e.length<3)throw new Error("Invalid key format: "+t);return e.slice(1,e.length-1).join(Xh)}var np=function(){function t(t){if(!p().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=tp(this.modelPath)}return t.prototype.save=function(t){return u(this,void 0,void 0,(function(){var e,n,r;return c(this,(function(a){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),r=Lh(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(t){if(Ih)return i.from(t).toString("base64");for(var e=new Uint8Array(t),n="",r=0,a=e.length;r<a;r++)n+=String.fromCharCode(e[r]);return btoa(n)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:r}]}catch(t){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+r.modelTopologyBytes+", weightSpecsBytes="+r.weightSpecsBytes+", weightDataBytes="+r.weightDataBytes+".")}return[2]}))}))},t.prototype.load=function(){return u(this,void 0,void 0,(function(){var t,e,n,r,a,o,s;return c(this,(function(u){if(null==(t=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(e={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(e.modelTopology=n,null==(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(e.weightSpecs=r,null!=(a=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(a),e.format=o.format,e.generatedBy=o.generatedBy,e.convertedBy=o.convertedBy,e.userDefinedMetadata=o.userDefinedMetadata),null==(s=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return e.weightData=function(t){if(Ih){var e=i.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}for(var n=atob(t),r=new Uint8Array(n.length),a=0;a<n.length;++a)r.set([n.charCodeAt(a)],a);return r.buffer}(s),[2,e]}))}))},t.URL_SCHEME="localstorage://",t}(),rp=function(t){return p().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(np.URL_SCHEME)?(e=t.slice(np.URL_SCHEME.length),new np(e)):null;var e};Dh.registerSaveRouter(rp),Dh.registerLoadRouter(rp);var ip=function(){function t(){T(p().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),T("undefined"==typeof window||void 0!==window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return t.prototype.listModels=function(){return u(this,void 0,void 0,(function(){var t,e,n,r,i,a;return c(this,(function(o){for(t={},e=$h+Xh,n=Xh+Yh,r=0;r<this.LS.length;++r)(i=this.LS.key(r)).startsWith(e)&&i.endsWith(n)&&(a=ep(i),t[a]=JSON.parse(this.LS.getItem(i)));return[2,t]}))}))},t.prototype.removeModel=function(t){return u(this,void 0,void 0,(function(){var e,n;return c(this,(function(r){var i;if(t=(i=t).startsWith(np.URL_SCHEME)?i.slice(np.URL_SCHEME.length):i,e=tp(t),null==this.LS.getItem(e.info))throw new Error("Cannot find model at path '"+t+"'");return n=JSON.parse(this.LS.getItem(e.info)),this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),[2,n]}))}))},t}();if(p().getBool("IS_BROWSER"))try{Fh.registerManager(np.URL_SCHEME,new ip)}catch(o){}function ap(t){return new Promise((function(t){return setTimeout(t)})).then(t)}var op=function(){function t(e){if(!p().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(t.URL_SCHEME)&&(e=e.slice(t.URL_SCHEME.length)),null!=e&&0!==e.length||(e="model"),this.modelTopologyFileName=e+".json",this.weightDataFileName=e+".weights.bin"}return t.prototype.save=function(t){return u(this,void 0,void 0,(function(){var e,n,r,i,a,o;return c(this,(function(s){switch(s.label){case 0:if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:n},i=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),(a=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,a.href=i,[4,ap((function(){return a.dispatchEvent(new MouseEvent("click"))}))];case 2:return s.sent(),null==t.weightData?[3,4]:((o=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,o.href=e,[4,ap((function(){return o.dispatchEvent(new MouseEvent("click"))}))]);case 3:s.sent(),s.label=4;case 4:return[2,{modelArtifactsInfo:Lh(t)}]}}))}))},t.URL_SCHEME="downloads://",t}(),sp=function(){function t(t){if(null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return t.prototype.load=function(){return u(this,void 0,void 0,(function(){var t,e,n=this;return c(this,(function(r){return t=this.files[0],e=this.files.slice(1),[2,new Promise((function(r,i){var a=new FileReader;a.onload=function(a){var o=JSON.parse(a.target.result),s=o.modelTopology;if(null!=s){0===e.length&&r({modelTopology:s});var u=o.weightsManifest;if(null!=u){var c;try{c=n.checkManifestAndWeightFiles(u,e)}catch(t){return void i(t)}var l=[],h=[],p=[];u.forEach((function(t){t.paths.forEach((function(t){h.push(t),p.push(null)})),l.push.apply(l,t.weights)})),u.forEach((function(t){t.paths.forEach((function(t){var e=new FileReader;e.onload=function(e){var n=e.target.result,i=h.indexOf(t);p[i]=n,-1===p.indexOf(null)&&r({modelTopology:s,weightSpecs:l,weightData:Oh(p),format:o.format,generatedBy:o.generatedBy,convertedBy:o.convertedBy,userDefinedMetadata:o.userDefinedMetadata})},e.onerror=function(e){return i("Failed to weights data from file of path '"+t+"'.")},e.readAsArrayBuffer(c[t])}))}))}else i(new Error("weightManifest field is missing from file "+t.name))}else i(new Error("modelTopology field is missing from file "+t.name))},a.onerror=function(e){return i("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},a.readAsText(t)}))]}))}))},t.prototype.checkManifestAndWeightFiles=function(t,e){for(var n=[],r=e.map((function(t){return kh(t.name)})),i={},a=0,o=t;a<o.length;a++)o[a].paths.forEach((function(t){var a=kh(t);if(-1!==n.indexOf(a))throw new Error("Duplicate file basename found in weights manifest: '"+a+"'");if(n.push(a),-1===r.indexOf(a))throw new Error("Weight file with basename '"+a+"' is not provided.");i[t]=e[r.indexOf(a)]}));if(n.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+e.length+").");return i},t}();function up(t,e,n,r){!function(t){T(null!=t&&Array.isArray(t)&&t.length>0,(function(){return"promises must be a none empty array"}))}(t),function(t,e){T(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but got startFraction "+t})),T(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but got endFraction "+e})),T(e>=t,(function(){return"startFraction must be no more than endFraction, but got startFraction "+t+" and endFraction "+e}))}(n=null==n?0:n,r=null==r?1:r);var i=0;return Promise.all(t.map((function(a){return a.then((function(a){var o=n+ ++i/t.length*(r-n);return e(o),a})),a})))}function cp(t,e){return u(this,void 0,void 0,(function(){var n,r,i,a,o,s,u,l,h;return c(this,(function(c){switch(c.label){case 0:return null==e&&(e={}),n=null==e.fetchFunc?p().platform.fetch:e.fetchFunc,r=t.map((function(t){return n(t,e.requestInit,{isBinary:!0})})),i=0,a=.5,null!=e.onProgress?[3,2]:[4,Promise.all(r)];case 1:return o=c.sent(),[3,4];case 2:return[4,up(r,e.onProgress,i,a)];case 3:o=c.sent(),c.label=4;case 4:return s=o.map((function(t){return t.arrayBuffer()})),u=.5,l=1,null!=e.onProgress?[3,6]:[4,Promise.all(s)];case 5:return h=c.sent(),[3,8];case 6:return[4,up(s,e.onProgress,u,l)];case 7:h=c.sent(),c.label=8;case 8:return[2,h]}}))}))}function lp(t){var e=this;return function(n,r,i){return void 0===r&&(r=""),u(e,void 0,void 0,(function(){var e,a,o,s,u,l,h,p,f,d;return c(this,(function(c){switch(c.label){case 0:if(e=n.map((function(){return!1})),a={},o=null!=i?i.map((function(){return!1})):[],s=[],n.forEach((function(t,n){var r=0;t.weights.forEach((function(t){var u="quantization"in t?t.quantization.dtype:t.dtype,c=Ch[u]*I(t.shape),l=function(){e[n]=!0,null==a[n]&&(a[n]=[]),a[n].push({manifestEntry:t,groupOffset:r,sizeBytes:c})};null!=i?i.forEach((function(e,n){e===t.name&&(l(),o[n]=!0)})):l(),s.push(t.name),r+=c}))})),!o.every((function(t){return t})))throw u=i.filter((function(t,e){return!o[e]})),new Error("Could not find weights in manifest with names: "+u.join(", ")+". \nManifest JSON has weights with names: "+s.join(", ")+".");return l=e.reduce((function(t,e,n){return e&&t.push(n),t}),[]),h=[],l.forEach((function(t){n[t].paths.forEach((function(t){var e=r+(r.endsWith("/")?"":"/")+t;h.push(e)}))})),[4,t(h)];case 1:return p=c.sent(),f={},d=0,l.forEach((function(t){for(var e=n[t].paths.length,r=0,i=0;i<e;i++)r+=p[d+i].byteLength;for(var o=new ArrayBuffer(r),s=new Uint8Array(o),u=0,c=0;c<e;c++){var l=new Uint8Array(p[d+c]);s.set(l,u),u+=l.byteLength}a[t].forEach((function(t){var e=Ah(o.slice(t.groupOffset,t.groupOffset+t.sizeBytes),[t.manifestEntry]);for(var n in e)f[n]=e[n]})),d+=e})),[2,f]}}))}))}}Dh.registerSaveRouter((function(t){return p().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(op.URL_SCHEME)?function(t){return void 0===t&&(t="model"),new op(t)}(t.slice(op.URL_SCHEME.length)):null}));var hp=function(){function t(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,null!=e.fetchFunc?(T("function"==typeof e.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=e.fetchFunc):this.fetch=p().platform.fetch,T(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&T(2===t.length,(function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."})),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}return t.prototype.save=function(t){return u(this,void 0,void 0,(function(){var e,n,r,i;return c(this,(function(a){switch(a.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:n},e.body.append("model.json",new Blob([JSON.stringify(r)],{type:"application/json"}),"model.json"),null!=t.weightData&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,e)];case 1:if((i=a.sent()).ok)return[2,{modelArtifactsInfo:Lh(t),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}}))}))},t.prototype.load=function(){return u(this,void 0,void 0,(function(){var t,e,n,r,i,a,o,s,u,l,h,p;return c(this,(function(c){switch(c.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=c.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");c.label=2;case 2:return c.trys.push([2,4,,5]),[4,t.json()];case 3:return e=c.sent(),[3,5];case 4:throw c.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(r=e.modelTopology,i=e.weightsManifest,a=e.generatedBy,o=e.convertedBy,s=e.format,u=e.userDefinedMetadata,null==r&&null==i)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==i?[3,7]:[4,this.loadWeights(i)];case 6:p=c.sent(),l=p[0],h=p[1],c.label=7;case 7:return[2,{modelTopology:r,weightSpecs:l,weightData:h,userDefinedMetadata:u,generatedBy:a,convertedBy:o,format:s}]}}))}))},t.prototype.loadWeights=function(t){return u(this,void 0,void 0,(function(){var e,n,r,i,a,o,s,u,l,h,p;return c(this,(function(c){switch(c.label){case 0:for(e=Array.isArray(this.path)?this.path[1]:this.path,n=function(t){var e=t.lastIndexOf("/"),n=t.lastIndexOf("?");return[t.substring(0,e)+"/",n>e?t.substring(n):""]}(e),r=n[0],i=n[1],a=this.weightPathPrefix||r,o=[],s=0,u=t;s<u.length;s++)l=u[s],o.push.apply(o,l.weights);return h=[],t.forEach((function(t){t.paths.forEach((function(t){h.push(a+t+i)}))})),[4,cp(h,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return p=c.sent(),[2,[o,Oh(p)]]}}))}))},t.URL_SCHEME_REGEX=/^https?:\/\//,t}();function pp(t){return null!=t.match(hp.URL_SCHEME_REGEX)}var fp=function(t,e){return"undefined"==typeof fetch?null:(Array.isArray(t)?t.every((function(t){return pp(t)})):pp(t))?dp(t,{onProgress:e}):null};function dp(t,e){return new hp(t,e)}Dh.registerSaveRouter(fp),Dh.registerLoadRouter(fp);var mp,vp=function(){function t(t){this.modelArtifacts=t}return t.prototype.load=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){return[2,this.modelArtifacts]}))}))},t}(),gp=function(){function t(t){this.saveHandler=t}return t.prototype.save=function(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){return[2,this.saveHandler(t)]}))}))},t}(),yp=Object.freeze({browserFiles:function(t){return new sp(t)},browserHTTPRequest:function(t,e){return dp(t,e)},concatenateArrayBuffers:Oh,decodeWeights:Ah,encodeWeights:function(t,e){return u(this,void 0,void 0,(function(){var n,r,i,a,o,s=this;return c(this,(function(l){switch(l.label){case 0:for(n=[],r=[],i=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t),a=function(a){var o=i[a],l=Array.isArray(t)?t[a].tensor:t[o];if("float32"!==l.dtype&&"int32"!==l.dtype&&"bool"!==l.dtype&&"string"!==l.dtype)throw new Error("Unsupported dtype in weight '"+o+"': "+l.dtype);var h={name:o,shape:l.shape,dtype:l.dtype};if("string"===l.dtype){var p=new Promise((function(t){return u(s,void 0,void 0,(function(){var e,n,r,i,a,o,s;return c(this,(function(u){switch(u.label){case 0:return[4,l.bytes()];case 1:for(e=u.sent(),n=e.reduce((function(t,e){return t+e.length}),0)+4*e.length,r=new Uint8Array(n),i=0,a=0;a<e.length;a++)o=e[a],s=new Uint8Array(new Uint32Array([o.length]).buffer),r.set(s,i),i+=4,r.set(o,i),i+=o.length;return t(r),[2]}}))}))}));r.push(p)}else r.push(l.data());null!=e&&(h.group=e),n.push(h)},o=0;o<i.length;++o)a(o);return[4,Promise.all(r)];case 1:return[2,{data:Nh(l.sent()),specs:n}]}}))}))},fromMemory:function(t,e,n,r){return 1===arguments.length?null!=t.modelTopology||null!=t.weightSpecs?new vp(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new vp({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new vp({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))},getLoadHandlers:function(t,e){return Dh.getLoadHandlers(t,e)},getModelArtifactsInfoForJSON:Lh,getSaveHandlers:function(t){return Dh.getSaveHandlers(t)},http:dp,isHTTPScheme:pp,loadWeights:function(t,e,n,r){return void 0===e&&(e=""),u(this,void 0,void 0,(function(){return c(this,(function(i){return[2,lp((function(t){return cp(t,{requestInit:r})}))(t,e,n)]}))}))},registerLoadRouter:function(t){return Dh.registerLoadRouter(t)},registerSaveRouter:function(t){return Dh.registerSaveRouter(t)},weightsLoaderFactory:lp,withSaveHandler:function(t){return new gp(t)},copyModel:function(t,e){return u(this,void 0,void 0,(function(){return c(this,(function(n){return[2,zh(t,e,!1)]}))}))},listModels:function(){return u(this,void 0,void 0,(function(){var t,e,n,r,i,a,o;return c(this,(function(s){switch(s.label){case 0:t=Fh.getSchemes(),e={},n=0,r=t,s.label=1;case 1:return n<r.length?(i=r[n],[4,Fh.getManager(i).listModels()]):[3,4];case 2:for(o in a=s.sent())e[i+Ph+o]=a[o];s.label=3;case 3:return n++,[3,1];case 4:return[2,e]}}))}))},moveModel:function(t,e){return u(this,void 0,void 0,(function(){return c(this,(function(n){return[2,zh(t,e,!0)]}))}))},removeModel:function(t){return u(this,void 0,void 0,(function(){var e;return c(this,(function(n){return e=Bh(t),[2,Fh.getManager(e.scheme).removeModel(e.path)]}))}))}}),xp=ln({confusionMatrix_:function(t,e,n){var r=Je(t,"labels","confusionMatrix"),i=Je(e,"predictions","confusionMatrix");T(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, but got "+n})),T(1===r.rank,(function(){return"Expected the rank of labels to be 1, but got "+r.rank})),T(1===i.rank,(function(){return"Expected the rank of predictions to be 1, but got "+i.rank})),T(r.shape[0]===i.shape[0],(function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+i.shape[0]+". Labels and predictions should have the same number of elements."})),T(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+n}));var a=yu(r.asType("int32"),n),o=yu(i.asType("int32"),n);return a.transpose().matMul(o).asType("int32")}}),bp=(Object.freeze({confusionMatrix:xp}),ln({fromPixels_:function(t,e){if(void 0===e&&(e=3),e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,i=!1,a=!1,o=!1;if(t.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&t instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement)i=!0;else if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement)a=!0;else{if(null==t.getContext)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);o=!0}if(i&&i&&t.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(null!=v("FromPixels",Ft.backendName))return Ft.runKernel("FromPixels",{pixels:t},{numChannels:e});var s,u,c=i?[t.videoWidth,t.videoHeight]:[t.width,t.height],l=c[0],h=c[1];if(o?s=t.getContext("2d").getImageData(0,0,l,h).data:r||n?s=t.data:(a||i)&&(null==mp&&(mp=document.createElement("canvas").getContext("2d")),mp.canvas.width=l,mp.canvas.height=h,mp.drawImage(t,0,0,l,h),s=mp.getImageData(0,0,l,h).data),4===e)u=new Int32Array(s);else{var p=l*h;u=new Int32Array(p*e);for(var f=0;f<p;f++)for(var d=0;d<e;++d)u[f*e+d]=s[4*f+d]}return xn(u,[h,l,e],"int32")}})),wp=Object.freeze({toPixels:function(t,e){return u(this,void 0,void 0,(function(){var n,r,i,a,o,s,u,l,h,p,f,d,m,v,g,y,x,b,w,_,S,M,E;return c(this,(function(c){switch(c.label){case 0:if(n=Je(t,"img","toPixels"),t instanceof wt||(n=n.toInt()),2!==n.rank&&3!==n.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),i=r[0],a=r[1],(o=2===n.rank?1:n.shape[2])>4||2===o)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+o);return[4,n.data()];case 1:return s=c.sent(),u=n.min(),l=n.max(),[4,Promise.all([u.data(),l.data()])];case 2:if(h=c.sent(),p=h[0],f=h[1],d=p[0],m=f[0],u.dispose(),l.dispose(),"float32"===n.dtype){if(d<0||m>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+d+" - "+m+"].")}else{if("int32"!==n.dtype)throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(d<0||m>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+d+" - "+m+"].")}for(v="float32"===n.dtype?255:1,g=new Uint8ClampedArray(a*i*4),y=0;y<i*a;++y)x=void 0,b=void 0,w=void 0,_=void 0,1===o?(x=s[y]*v,b=s[y]*v,w=s[y]*v,_=255):3===o?(x=s[3*y]*v,b=s[3*y+1]*v,w=s[3*y+2]*v,_=255):4===o&&(x=s[4*y]*v,b=s[4*y+1]*v,w=s[4*y+2]*v,_=s[4*y+3]*v),g[0+(S=4*y)]=Math.round(x),g[S+1]=Math.round(b),g[S+2]=Math.round(w),g[S+3]=Math.round(_);return null!=e&&(e.width=a,e.height=i,M=e.getContext("2d"),E=new ImageData(g,a,i),M.putImageData(E,0,0)),n!==t&&n.dispose(),[2,g]}}))}))},fromPixels:bp}),_p=function(){function t(){}return t.prototype.getClassName=function(){return this.constructor.className},t.fromConfig=function(t,e){return new t(e)},t}(),Sp=function(){function t(){this.classNameMap={}}return t.getMap=function(){return null==t.instance&&(t.instance=new t),t.instance},t.register=function(e){t.getMap().classNameMap[e.className]=[e,e.fromConfig]},t}();function Mp(t){T(null!=t.className,(function(){return"Class being registered does not have the static className property defined."})),T("string"==typeof t.className,(function(){return"className is required to be a string, but got type "+typeof t.className})),T(t.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),Sp.register(t)}Object.freeze({Serializable:_p,SerializationMap:Sp,registerClass:Mp}),Object.freeze({gpgpu_util:Io,webgl_util:Ue,forceHalfFloat:function(){p().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:Ls,setWebGLContext:Gt,GPGPUContext:Ro});var Ep=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.minimize=function(t,e,n){void 0===e&&(e=!1);var r=this.computeGradients(t,n),i=r.value,a=r.grads;if(null!=n){var o=n.map((function(t){return{name:t.name,tensor:a[t.name]}}));this.applyGradients(o)}else this.applyGradients(a);return Ge(a),e?i:(i.dispose(),null)},Object.defineProperty(e.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),e.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},e.prototype.computeGradients=function(t,e){return function(t,e){T(Z(t),(function(){return"The f passed in variableGrads(f) must be a function"})),T(null==e||Array.isArray(e)&&e.every((function(t){return t instanceof Ct})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=e;if(!n)for(var r in e=[],Ft.registeredVariables)e.push(Ft.registeredVariables[r]);var i=n?e.filter((function(t){return!t.trainable})):null,a=e.length;T((e=e.filter((function(t){return t.trainable}))).length>0,(function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+a+" variables is trainable."}));var o=Ft.gradients(t,e,null,!0),s=o.value,u=o.grads;T(u.some((function(t){return null!=t})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),T(0===s.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"}));var c={};return e.forEach((function(t,e){null!=u[e]&&(c[t.name]=u[e])})),null!=i&&i.forEach((function(t){return c[t.name]=null})),{value:s,grads:c}}(t,e)},e.prototype.dispose=function(){null!=this.iterations_&&Ge(this.iterations_)},e.prototype.saveIterations=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:vn(this.iterations_,"int32")}]}))}))},e.prototype.getWeights=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){throw new Error("getWeights() is not implemented for this optimizer yet.")}))}))},e.prototype.setWeights=function(t){return u(this,void 0,void 0,(function(){return c(this,(function(t){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}))}))},e.prototype.extractIterations=function(t){return u(this,void 0,void 0,(function(){var e;return c(this,(function(n){switch(n.label){case 0:return e=this,[4,t[0].tensor.data()];case 1:return e.iterations_=n.sent()[0],[2,t.slice(1)]}}))}))},e}(_p);Object.defineProperty(Ep,Symbol.hasInstance,{value:function(t){return null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients}});var Tp=function(t){function e(e,n,r){void 0===r&&(r=null);var i=t.call(this)||this;return i.learningRate=e,i.rho=n,i.epsilon=r,i.accumulatedGrads=[],i.accumulatedUpdates=[],null==r&&(i.epsilon=Ft.backend.epsilon()),i}return s(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Ft.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:n+"/accum_grad",variable:He((function(){return Cn(i).variable(!1)}))}),null==e.accumulatedUpdates[r]&&(e.accumulatedUpdates[r]={originalName:n+"/accum_var",variable:He((function(){return Cn(i).variable(!1)}))});var a=Array.isArray(t)?t[r].tensor:t[n];if(null!=a){var o=e.accumulatedGrads[r].variable,s=e.accumulatedUpdates[r].variable;He((function(){var t=o.mul(e.rho).add(a.square().mul(1-e.rho)),n=s.add(e.epsilon).sqrt().div(o.add(e.epsilon).sqrt()).mul(a),r=s.mul(e.rho).add(n.square().mul(1-e.rho));o.assign(t),s.assign(r);var u=n.mul(-e.learningRate).add(i);i.assign(u)}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedUpdates&&(Ge(this.accumulatedGrads.map((function(t){return t.variable}))),Ge(this.accumulatedUpdates.map((function(t){return t.variable}))))},e.prototype.getWeights=function(){return u(this,void 0,void 0,(function(){var t;return c(this,(function(e){switch(e.label){case 0:return t=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return u(this,void 0,void 0,(function(){var e;return c(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),e=t.length/2,this.accumulatedGrads=t.slice(0,e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedUpdates=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.rho,e.epsilon)},e.className="Adadelta",e}(Ep);Mp(Tp);var Cp=function(t){function e(e,n){void 0===n&&(n=.1);var r=t.call(this)||this;return r.learningRate=e,r.initialAccumulatorValue=n,r.accumulatedGrads=[],r}return s(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Ft.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:n+"/accumulator",variable:He((function(){return Sn(i.shape,e.initialAccumulatorValue).variable(!1)}))});var a=Array.isArray(t)?t[r].tensor:t[n];if(null!=a){var o=e.accumulatedGrads[r].variable;He((function(){var t=o.add(a.square());o.assign(t);var n=a.div(t.add(Ft.backend.epsilon()).sqrt()).mul(-e.learningRate).add(i);i.assign(n)}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedGrads&&Ge(this.accumulatedGrads.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulatedGrads.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulatedGrads=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},e.fromConfig=function(t,e){return new t(e.learningRate,e.initialAccumulatorValue)},e.className="Adagrad",e}(Ep);Mp(Cp);var Ap=function(t){function e(e,n,r,i){void 0===i&&(i=null);var a=t.call(this)||this;return a.learningRate=e,a.beta1=n,a.beta2=r,a.epsilon=i,a.accumulatedFirstMoment=[],a.accumulatedSecondMoment=[],He((function(){a.accBeta1=vn(n).variable(),a.accBeta2=vn(r).variable()})),null==i&&(a.epsilon=Ft.backend.epsilon()),a}return s(e,t),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);He((function(){var r=ti(1,e.accBeta1),i=ti(1,e.accBeta2);n.forEach((function(n,a){var o=Ft.registeredVariables[n];null==e.accumulatedFirstMoment[a]&&(e.accumulatedFirstMoment[a]={originalName:n+"/m",variable:He((function(){return Cn(o).variable(!1)}))}),null==e.accumulatedSecondMoment[a]&&(e.accumulatedSecondMoment[a]={originalName:n+"/v",variable:He((function(){return Cn(o).variable(!1)}))});var s=Array.isArray(t)?t[a].tensor:t[n];if(null!=s){var u=e.accumulatedFirstMoment[a].variable,c=e.accumulatedSecondMoment[a].variable,l=u.mul(e.beta1).add(s.mul(1-e.beta1)),h=c.mul(e.beta2).add(s.square().mul(1-e.beta2)),p=l.div(r),f=h.div(i);u.assign(l),c.assign(h);var d=p.div(f.sqrt().add(e.epsilon)).mul(-e.learningRate).add(o);o.assign(d)}})),e.accBeta1.assign(e.accBeta1.mul(e.beta1)),e.accBeta2.assign(e.accBeta2.mul(e.beta2))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Ge(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedSecondMoment&&Ge(this.accumulatedSecondMoment.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return u(this,void 0,void 0,(function(){var t;return c(this,(function(e){switch(e.label){case 0:return t=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return u(this,void 0,void 0,(function(){var e,n=this;return c(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),He((function(){n.accBeta1.assign(Jr(n.beta1,n.iterations_+1)),n.accBeta2.assign(Jr(n.beta2,n.iterations_+1))})),e=t.length/2,this.accumulatedFirstMoment=t.slice(0,e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedSecondMoment=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)},e.className="Adam",e}(Ep);Mp(Ap);var Np=function(t){function e(e,n,r,i,a){void 0===i&&(i=null),void 0===a&&(a=0);var o=t.call(this)||this;return o.learningRate=e,o.beta1=n,o.beta2=r,o.epsilon=i,o.decay=a,o.accumulatedFirstMoment=[],o.accumulatedWeightedInfNorm=[],He((function(){o.iteration=vn(0).variable(),o.accBeta1=vn(n).variable()})),null==i&&(o.epsilon=Ft.backend.epsilon()),o}return s(e,t),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);He((function(){var r=ti(1,e.accBeta1),i=ni(-e.learningRate,e.iteration.mul(e.decay).add(1));n.forEach((function(n,a){var o=Ft.registeredVariables[n];null==e.accumulatedFirstMoment[a]&&(e.accumulatedFirstMoment[a]={originalName:n+"/m",variable:Cn(o).variable(!1)}),null==e.accumulatedWeightedInfNorm[a]&&(e.accumulatedWeightedInfNorm[a]={originalName:n+"/v",variable:Cn(o).variable(!1)});var s=Array.isArray(t)?t[a].tensor:t[n];if(null!=s){var u=e.accumulatedFirstMoment[a].variable,c=e.accumulatedWeightedInfNorm[a].variable,l=u.mul(e.beta1).add(s.mul(1-e.beta1)),h=c.mul(e.beta2),p=s.abs(),f=h.maximum(p);u.assign(l),c.assign(f);var d=i.div(r).mul(l.div(f.add(e.epsilon))).add(o);o.assign(d)}})),e.iteration.assign(e.iteration.add(1)),e.accBeta1.assign(e.accBeta1.mul(e.beta1))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Ge(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedWeightedInfNorm&&Ge(this.accumulatedWeightedInfNorm.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){throw new Error("getWeights() is not implemented for Adamax yet.")}))}))},e.prototype.setWeights=function(t){return u(this,void 0,void 0,(function(){return c(this,(function(t){throw new Error("setWeights() is not implemented for Adamax yet.")}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)},e.className="Adamax",e}(Ep);Mp(Np);var Ip=function(t){function e(e){var n=t.call(this)||this;return n.learningRate=e,n.setLearningRate(e),n}return s(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Array.isArray(t)?t[r].tensor:t[n];if(null!=i){var a=Ft.registeredVariables[n];He((function(){var t=e.c.mul(i).add(a);a.assign(t)}))}})),this.incrementIterations()},e.prototype.setLearningRate=function(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=function(t){return Ft.keep(t)}(vn(-t))},e.prototype.dispose=function(){this.c.dispose()},e.prototype.getWeights=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()]]}}))}))},e.prototype.setWeights=function(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:if(0!==(t=e.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate}},e.fromConfig=function(t,e){return new t(e.learningRate)},e.className="SGD",e}(Ep);Mp(Ip);var Rp=function(t){function e(e,n,r){void 0===r&&(r=!1);var i=t.call(this,e)||this;return i.learningRate=e,i.momentum=n,i.useNesterov=r,i.accumulations=[],i.m=vn(i.momentum),i}return s(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Ft.registeredVariables[n];null==e.accumulations[r]&&(e.accumulations[r]={originalName:n+"/momentum",variable:He((function(){return Cn(i).variable(!1)}))});var a=e.accumulations[r].variable,o=Array.isArray(t)?t[r].tensor:t[n];null!=o&&He((function(){var t,n=e.m.mul(a).add(o);t=e.useNesterov?e.c.mul(o.add(n.mul(e.m))).add(i):e.c.mul(n).add(i),a.assign(n),i.assign(t)}))})),this.incrementIterations()},e.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&Ge(this.accumulations.map((function(t){return t.variable})))},e.prototype.setMomentum=function(t){this.momentum=t},e.prototype.getWeights=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulations.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulations=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},e.fromConfig=function(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)},e.className="Momentum",e}(Ip);Mp(Rp);var Op=function(t){function e(e,n,r,i,a){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===i&&(i=null),void 0===a&&(a=!1);var o=t.call(this)||this;if(o.learningRate=e,o.decay=n,o.momentum=r,o.epsilon=i,o.accumulatedMeanSquares=[],o.accumulatedMoments=[],o.accumulatedMeanGrads=[],o.centered=a,null==i&&(o.epsilon=Ft.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.");return o}return s(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Ft.registeredVariables[n];null==e.accumulatedMeanSquares[r]&&(e.accumulatedMeanSquares[r]={originalName:n+"/rms",variable:He((function(){return Cn(i).variable(!1)}))}),null==e.accumulatedMoments[r]&&(e.accumulatedMoments[r]={originalName:n+"/momentum",variable:He((function(){return Cn(i).variable(!1)}))}),null==e.accumulatedMeanGrads[r]&&e.centered&&(e.accumulatedMeanGrads[r]={originalName:n+"/mg",variable:He((function(){return Cn(i).variable(!1)}))});var a=Array.isArray(t)?t[r].tensor:t[n];if(null!=a){var o=e.accumulatedMeanSquares[r].variable,s=e.accumulatedMoments[r].variable;He((function(){var t=o.mul(e.decay).add(a.square().mul(1-e.decay));if(e.centered){var n=e.accumulatedMeanGrads[r].variable,u=n.mul(e.decay).add(a.mul(1-e.decay)),c=s.mul(e.momentum).add(a.mul(e.learningRate).div(t.sub(u.square().add(e.epsilon)).sqrt()));o.assign(t),n.assign(u),s.assign(c);var l=i.sub(c);i.assign(l)}else{var h=o.mul(e.decay).add(a.square().mul(1-e.decay));c=s.mul(e.momentum).add(a.mul(e.learningRate).div(h.add(e.epsilon).sqrt())),o.assign(h),s.assign(c),l=i.sub(c),i.assign(l)}}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&Ge(this.accumulatedMeanSquares.map((function(t){return t.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&Ge(this.accumulatedMeanGrads.map((function(t){return t.variable}))),null!=this.accumulatedMoments&&Ge(this.accumulatedMoments.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return u(this,void 0,void 0,(function(){var t;return c(this,(function(e){switch(e.label){case 0:return t=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&t.push.apply(t,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return u(this,void 0,void 0,(function(){var e;return c(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),e=this.centered?t.length/3:t.length/2,this.accumulatedMeanSquares=t.slice(0,e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedMoments=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}}))),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},e.fromConfig=function(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)},e.className="RMSProp",e}(Ep);Mp(Op);var kp=function(){function t(){}return t.sgd=function(t){return new Ip(t)},t.momentum=function(t,e,n){return void 0===n&&(n=!1),new Rp(t,e,n)},t.rmsprop=function(t,e,n,r,i){return void 0===e&&(e=.9),void 0===n&&(n=0),void 0===r&&(r=null),void 0===i&&(i=!1),new Op(t,e,n,r,i)},t.adam=function(t,e,n,r){return void 0===t&&(t=.001),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),new Ap(t,e,n,r)},t.adadelta=function(t,e,n){return void 0===t&&(t=.001),void 0===e&&(e=.95),void 0===n&&(n=null),new Tp(t,e,n)},t.adamax=function(t,e,n,r,i){return void 0===t&&(t=.002),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),void 0===i&&(i=0),new Np(t,e,n,r,i)},t.adagrad=function(t,e){return void 0===e&&(e=.1),new Cp(t,e)},t}();kp.sgd,kp.momentum,kp.adadelta,kp.adagrad,kp.rmsprop,kp.adamax,kp.adam,"undefined"!=typeof requestAnimationFrame&&requestAnimationFrame;wt.prototype.add=function(t){return er(this,t)},wt.prototype.broadcastTo=function(t){return ou(this,t)},wt.prototype.div=function(t){return ni(this,t)},wt.prototype.divNoNan=function(t){return du(this,t)},wt.prototype.squaredDifference=function(t){return Du(this,t)},wt.prototype.tile=function(t){return mu(this,t)},wt.prototype.oneHot=function(t,e,n){return void 0===e&&(e=1),void 0===n&&(n=0),yu(this,t,e,n)},wt.prototype.transpose=function(t){return wi(this,t)},wt.prototype.pad=function(t,e){return xu(this,t,e)},wt.prototype.batchNorm=function(t,e,n,r,i){return Ks(this,t,e,n,r,i)},xt=Zl}).call(this,n(26),n(94),n(132).Buffer,n(131).setImmediate)},function(t,e,n){var r=n(3),i=n(9),a=n(16),o=n(13),s=n(20),u=function(t,e,n){var c,l,h,p,f=t&u.F,d=t&u.G,m=t&u.S,v=t&u.P,g=t&u.B,y=d?r:m?r[e]||(r[e]={}):(r[e]||{}).prototype,x=d?i:i[e]||(i[e]={}),b=x.prototype||(x.prototype={});for(c in d&&(n=e),n)h=((l=!f&&y&&void 0!==y[c])?y:n)[c],p=g&&l?s(h,r):v&&"function"==typeof h?s(Function.call,h):h,y&&o(y,c,h,t&u.U),x[c]!=h&&a(x,c,p),v&&b[c]!=h&&(b[c]=h)};r.core=i,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,t.exports=u},function(t,e,n){"use strict";n.d(e,"a",(function(){return de})),n.d(e,"b",(function(){return uu})),n.d(e,"c",(function(){return r})),n.d(e,"d",(function(){return Ht})),n.d(e,"e",(function(){return re})),n.d(e,"f",(function(){return ze})),n.d(e,"g",(function(){return Wu})),n.d(e,"h",(function(){return i})),n.d(e,"i",(function(){return Oe})),n.d(e,"j",(function(){return ks})),n.d(e,"k",(function(){return qe})),n.d(e,"l",(function(){return Et})),n.d(e,"m",(function(){return rn})),n.d(e,"n",(function(){return a})),n.d(e,"o",(function(){return K})),n.d(e,"p",(function(){return He})),n.d(e,"q",(function(){return Pt})),n.d(e,"r",(function(){return Ve})),n.d(e,"s",(function(){return p})),n.d(e,"t",(function(){return S})),n.d(e,"u",(function(){return y})),n.d(e,"v",(function(){return ni})),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e});var r=2,i=1006,a=1023,o=a;function s(){}Object.assign(s.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var r=n.indexOf(e);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=e.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,t)}}}});for(var u=[],c=0;c<256;c++)u[c]=(c<16?"0":"")+c.toString(16);var l,h={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(u[255&t]+u[t>>8&255]+u[t>>16&255]+u[t>>24&255]+"-"+u[255&e]+u[e>>8&255]+"-"+u[e>>16&15|64]+u[e>>24&255]+"-"+u[63&n|128]+u[n>>8&255]+"-"+u[n>>16&255]+u[n>>24&255]+u[255&r]+u[r>>8&255]+u[r>>16&255]+u[r>>24&255]).toUpperCase()},clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*h.DEG2RAD},radToDeg:function(t){return t*h.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,r,i){var a=Math.cos,o=Math.sin,s=a(n/2),u=o(n/2),c=a((e+r)/2),l=o((e+r)/2),h=a((e-r)/2),p=o((e-r)/2),f=a((r-e)/2),d=o((r-e)/2);"XYX"===i?t.set(s*l,u*h,u*p,s*c):"YZY"===i?t.set(u*p,s*l,u*h,s*c):"ZXZ"===i?t.set(u*h,u*p,s*l,s*c):"XZX"===i?t.set(s*l,u*d,u*f,s*c):"YXY"===i?t.set(u*f,s*l,u*d,s*c):"ZYZ"===i?t.set(u*d,u*f,s*l,s*c):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};function p(t,e){this.x=t||0,this.y=e||0}function f(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(p.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(p.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,a=this.y-t.y;return this.x=i*n-a*r+t.x,this.y=i*r+a*n+t.y,this}}),Object.assign(f.prototype,{isMatrix3:!0,set:function(t,e,n,r,i,a,o,s,u){var c=this.elements;return c[0]=t,c[1]=r,c[2]=o,c[3]=e,c[4]=i,c[5]=s,c[6]=n,c[7]=a,c[8]=u,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,a=n[0],o=n[3],s=n[6],u=n[1],c=n[4],l=n[7],h=n[2],p=n[5],f=n[8],d=r[0],m=r[3],v=r[6],g=r[1],y=r[4],x=r[7],b=r[2],w=r[5],_=r[8];return i[0]=a*d+o*g+s*b,i[3]=a*m+o*y+s*w,i[6]=a*v+o*x+s*_,i[1]=u*d+c*g+l*b,i[4]=u*m+c*y+l*w,i[7]=u*v+c*x+l*_,i[2]=h*d+p*g+f*b,i[5]=h*m+p*y+f*w,i[8]=h*v+p*x+f*_,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],u=t[7],c=t[8];return e*a*c-e*o*u-n*i*c+n*o*s+r*i*u-r*a*s},getInverse:function(t,e){t&&t.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var n=t.elements,r=this.elements,i=n[0],a=n[1],o=n[2],s=n[3],u=n[4],c=n[5],l=n[6],h=n[7],p=n[8],f=p*u-c*h,d=c*l-p*s,m=h*s-u*l,v=i*f+a*d+o*m;if(0===v){var g="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(g);return console.warn(g),this.identity()}var y=1/v;return r[0]=f*y,r[1]=(o*h-p*a)*y,r[2]=(c*a-o*u)*y,r[3]=d*y,r[4]=(p*i-o*l)*y,r[5]=(o*s-c*i)*y,r[6]=m*y,r[7]=(a*l-h*i)*y,r[8]=(u*i-a*s)*y,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,n,r,i,a,o){var s=Math.cos(i),u=Math.sin(i);this.set(n*s,n*u,-n*(s*a+u*o)+a+t,-r*u,r*s,-r*(-u*a+s*o)+o+e,0,0,1)},scale:function(t,e){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this},rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=this.elements,i=r[0],a=r[3],o=r[6],s=r[1],u=r[4],c=r[7];return r[0]=e*i+n*s,r[3]=e*a+n*u,r[6]=e*o+n*c,r[1]=-n*i+e*s,r[4]=-n*a+e*u,r[7]=-n*o+e*c,this},translate:function(t,e){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<9;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}});var d={getDataURL:function(t){var e;if("undefined"==typeof HTMLCanvasElement)return t.src;if(t instanceof HTMLCanvasElement)e=t;else{void 0===l&&(l=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),l.width=t.width,l.height=t.height;var n=l.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=l}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}},m=0;function v(t,e,n,r,o,s,u,c,l,d){Object.defineProperty(this,"id",{value:m++}),this.uuid=h.generateUUID(),this.name="",this.image=void 0!==t?t:v.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:v.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:1001,this.wrapT=void 0!==r?r:1001,this.magFilter=void 0!==o?o:i,this.minFilter=void 0!==s?s:1008,this.anisotropy=void 0!==l?l:1,this.format=void 0!==u?u:a,this.internalFormat=null,this.type=void 0!==c?c:1009,this.offset=new p(0,0),this.repeat=new p(1,1),this.center=new p(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new f,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==d?d:3e3,this.version=0,this.onUpdate=null}function g(t,e,n,r){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==r?r:1}function y(t,e,n){this.width=t,this.height=e,this.scissor=new g(0,0,t,e),this.scissorTest=!1,this.viewport=new g(0,0,t,e),n=n||{},this.texture=new v(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=e,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:i,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function x(t,e,n){y.call(this,t,e,n),this.samples=4}function b(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==r?r:1}v.DEFAULT_IMAGE=void 0,v.DEFAULT_MAPPING=300,v.prototype=Object.assign(Object.create(s.prototype),{constructor:v,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=h.generateUUID()),!e&&void 0===t.images[r.uuid]){var i;if(Array.isArray(r)){i=[];for(var a=0,o=r.length;a<o;a++)i.push(d.getDataURL(r[a]))}else i=d.getDataURL(r);t.images[r.uuid]={uuid:r.uuid,url:i}}n.image=r.uuid}return e||(t.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case 1001:t.x=t.x<0?0:1;break;case 1002:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case 1001:t.y=t.y<0?0:1;break;case 1002:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(v.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.defineProperties(g.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign(g.prototype,{isVector4:!0,set:function(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=this.w,a=t.elements;return this.x=a[0]*e+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*e+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*e+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*e+a[7]*n+a[11]*r+a[15]*i,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,r,i,a=t.elements,o=a[0],s=a[4],u=a[8],c=a[1],l=a[5],h=a[9],p=a[2],f=a[6],d=a[10];if(Math.abs(s-c)<.01&&Math.abs(u-p)<.01&&Math.abs(h-f)<.01){if(Math.abs(s+c)<.1&&Math.abs(u+p)<.1&&Math.abs(h+f)<.1&&Math.abs(o+l+d-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;var m=(o+1)/2,v=(l+1)/2,g=(d+1)/2,y=(s+c)/4,x=(u+p)/4,b=(h+f)/4;return m>v&&m>g?m<.01?(n=0,r=.707106781,i=.707106781):(r=y/(n=Math.sqrt(m)),i=x/n):v>g?v<.01?(n=.707106781,r=0,i=.707106781):(n=y/(r=Math.sqrt(v)),i=b/r):g<.01?(n=.707106781,r=.707106781,i=0):(n=x/(i=Math.sqrt(g)),r=b/i),this.set(n,r,i,e),this}var w=Math.sqrt((f-h)*(f-h)+(u-p)*(u-p)+(c-s)*(c-s));return Math.abs(w)<.001&&(w=1),this.x=(f-h)/w,this.y=(u-p)/w,this.z=(c-s)/w,this.w=Math.acos((o+l+d-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}}),y.prototype=Object.assign(Object.create(s.prototype),{constructor:y,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.texture.image.width=t,this.texture.image.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),x.prototype=Object.assign(Object.create(y.prototype),{constructor:x,isWebGLMultisampleRenderTarget:!0,copy:function(t){return y.prototype.copy.call(this,t),this.samples=t.samples,this}}),Object.assign(b,{slerp:function(t,e,n,r){return n.copy(t).slerp(e,r)},slerpFlat:function(t,e,n,r,i,a,o){var s=n[r+0],u=n[r+1],c=n[r+2],l=n[r+3],h=i[a+0],p=i[a+1],f=i[a+2],d=i[a+3];if(l!==d||s!==h||u!==p||c!==f){var m=1-o,v=s*h+u*p+c*f+l*d,g=v>=0?1:-1,y=1-v*v;if(y>Number.EPSILON){var x=Math.sqrt(y),b=Math.atan2(x,v*g);m=Math.sin(m*b)/x,o=Math.sin(o*b)/x}var w=o*g;if(s=s*m+h*w,u=u*m+p*w,c=c*m+f*w,l=l*m+d*w,m===1-o){var _=1/Math.sqrt(s*s+u*u+c*c+l*l);s*=_,u*=_,c*=_,l*=_}}t[e]=s,t[e+1]=u,t[e+2]=c,t[e+3]=l}}),Object.defineProperties(b.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Object.assign(b.prototype,{isQuaternion:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,r=t._y,i=t._z,a=t.order,o=Math.cos,s=Math.sin,u=o(n/2),c=o(r/2),l=o(i/2),h=s(n/2),p=s(r/2),f=s(i/2);return"XYZ"===a?(this._x=h*c*l+u*p*f,this._y=u*p*l-h*c*f,this._z=u*c*f+h*p*l,this._w=u*c*l-h*p*f):"YXZ"===a?(this._x=h*c*l+u*p*f,this._y=u*p*l-h*c*f,this._z=u*c*f-h*p*l,this._w=u*c*l+h*p*f):"ZXY"===a?(this._x=h*c*l-u*p*f,this._y=u*p*l+h*c*f,this._z=u*c*f+h*p*l,this._w=u*c*l-h*p*f):"ZYX"===a?(this._x=h*c*l-u*p*f,this._y=u*p*l+h*c*f,this._z=u*c*f-h*p*l,this._w=u*c*l+h*p*f):"YZX"===a?(this._x=h*c*l+u*p*f,this._y=u*p*l+h*c*f,this._z=u*c*f-h*p*l,this._w=u*c*l-h*p*f):"XZY"===a&&(this._x=h*c*l-u*p*f,this._y=u*p*l-h*c*f,this._z=u*c*f+h*p*l,this._w=u*c*l+h*p*f),!1!==e&&this._onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,r=n[0],i=n[4],a=n[8],o=n[1],s=n[5],u=n[9],c=n[2],l=n[6],h=n[10],p=r+s+h;return p>0?(e=.5/Math.sqrt(p+1),this._w=.25/e,this._x=(l-u)*e,this._y=(a-c)*e,this._z=(o-i)*e):r>s&&r>h?(e=2*Math.sqrt(1+r-s-h),this._w=(l-u)/e,this._x=.25*e,this._y=(i+o)/e,this._z=(a+c)/e):s>h?(e=2*Math.sqrt(1+s-r-h),this._w=(a-c)/e,this._x=(i+o)/e,this._y=.25*e,this._z=(u+l)/e):(e=2*Math.sqrt(1+h-r-s),this._w=(o-i)/e,this._x=(a+c)/e,this._y=(u+l)/e,this._z=.25*e),this._onChangeCallback(),this},setFromUnitVectors:function(t,e){var n=t.dot(e)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(h.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var n=this.angleTo(t);if(0===n)return this;var r=Math.min(1,e/n);return this.slerp(t,r),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,r=t._y,i=t._z,a=t._w,o=e._x,s=e._y,u=e._z,c=e._w;return this._x=n*c+a*o+r*u-i*s,this._y=r*c+a*s+i*o-n*u,this._z=i*c+a*u+n*s-r*o,this._w=a*c-n*o-r*s-i*u,this._onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,r=this._y,i=this._z,a=this._w,o=a*t._w+n*t._x+r*t._y+i*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;var s=1-o*o;if(s<=Number.EPSILON){var u=1-e;return this._w=u*a+e*this._w,this._x=u*n+e*this._x,this._y=u*r+e*this._y,this._z=u*i+e*this._z,this.normalize(),this._onChangeCallback(),this}var c=Math.sqrt(s),l=Math.atan2(c,o),h=Math.sin((1-e)*l)/c,p=Math.sin(e*l)/c;return this._w=a*h+this._w*p,this._x=n*h+this._x*p,this._y=r*h+this._y*p,this._z=i*h+this._z*p,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});var w=new S,_=new b;function S(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}Object.assign(S.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(_.setFromEuler(t))},applyAxisAngle:function(t,e){return this.applyQuaternion(_.setFromAxisAngle(t,e))},applyMatrix3:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements,a=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*a,this},applyQuaternion:function(t){var e=this.x,n=this.y,r=this.z,i=t.x,a=t.y,o=t.z,s=t.w,u=s*e+a*r-o*n,c=s*n+o*e-i*r,l=s*r+i*n-a*e,h=-i*e-a*n-o*r;return this.x=u*s+h*-i+c*-o-l*-a,this.y=c*s+h*-a+l*-i-u*-o,this.z=l*s+h*-o+u*-a-c*-i,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var n=t.x,r=t.y,i=t.z,a=e.x,o=e.y,s=e.z;return this.x=r*s-i*o,this.y=i*a-n*s,this.z=n*o-r*a,this},projectOnVector:function(t){var e=t.lengthSq();if(0===e)return this.set(0,0,0);var n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)},projectOnPlane:function(t){return w.copy(this).projectOnVector(t),this.sub(w)},reflect:function(t){return this.sub(w.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;var n=this.dot(t)/e;return Math.acos(h.clamp(n,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,n){var r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},setFromMatrix3Column:function(t,e){return this.fromArray(t.elements,3*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}});var M=new S,E=new R,T=new S(0,0,0),C=new S(1,1,1),A=new S,N=new S,I=new S;function R(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(R.prototype,{isMatrix4:!0,set:function(t,e,n,r,i,a,o,s,u,c,l,h,p,f,d,m){var v=this.elements;return v[0]=t,v[4]=e,v[8]=n,v[12]=r,v[1]=i,v[5]=a,v[9]=o,v[13]=s,v[2]=u,v[6]=c,v[10]=l,v[14]=h,v[3]=p,v[7]=f,v[11]=d,v[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new R).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this},copyPosition:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(t){var e=this.elements,n=t.elements,r=1/M.setFromMatrixColumn(t,0).length(),i=1/M.setFromMatrixColumn(t,1).length(),a=1/M.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*i,e[5]=n[5]*i,e[6]=n[6]*i,e[7]=0,e[8]=n[8]*a,e[9]=n[9]*a,e[10]=n[10]*a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,r=t.y,i=t.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(r),u=Math.sin(r),c=Math.cos(i),l=Math.sin(i);if("XYZ"===t.order){var h=a*c,p=a*l,f=o*c,d=o*l;e[0]=s*c,e[4]=-s*l,e[8]=u,e[1]=p+f*u,e[5]=h-d*u,e[9]=-o*s,e[2]=d-h*u,e[6]=f+p*u,e[10]=a*s}else if("YXZ"===t.order){var m=s*c,v=s*l,g=u*c,y=u*l;e[0]=m+y*o,e[4]=g*o-v,e[8]=a*u,e[1]=a*l,e[5]=a*c,e[9]=-o,e[2]=v*o-g,e[6]=y+m*o,e[10]=a*s}else if("ZXY"===t.order){m=s*c,v=s*l,g=u*c,y=u*l;e[0]=m-y*o,e[4]=-a*l,e[8]=g+v*o,e[1]=v+g*o,e[5]=a*c,e[9]=y-m*o,e[2]=-a*u,e[6]=o,e[10]=a*s}else if("ZYX"===t.order){h=a*c,p=a*l,f=o*c,d=o*l;e[0]=s*c,e[4]=f*u-p,e[8]=h*u+d,e[1]=s*l,e[5]=d*u+h,e[9]=p*u-f,e[2]=-u,e[6]=o*s,e[10]=a*s}else if("YZX"===t.order){var x=a*s,b=a*u,w=o*s,_=o*u;e[0]=s*c,e[4]=_-x*l,e[8]=w*l+b,e[1]=l,e[5]=a*c,e[9]=-o*c,e[2]=-u*c,e[6]=b*l+w,e[10]=x-_*l}else if("XZY"===t.order){x=a*s,b=a*u,w=o*s,_=o*u;e[0]=s*c,e[4]=-l,e[8]=u*c,e[1]=x*l+_,e[5]=a*c,e[9]=b*l-w,e[2]=w*l-b,e[6]=o*c,e[10]=_*l+x}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(T,t,C)},lookAt:function(t,e,n){var r=this.elements;return I.subVectors(t,e),0===I.lengthSq()&&(I.z=1),I.normalize(),A.crossVectors(n,I),0===A.lengthSq()&&(1===Math.abs(n.z)?I.x+=1e-4:I.z+=1e-4,I.normalize(),A.crossVectors(n,I)),A.normalize(),N.crossVectors(I,A),r[0]=A.x,r[4]=N.x,r[8]=I.x,r[1]=A.y,r[5]=N.y,r[9]=I.y,r[2]=A.z,r[6]=N.z,r[10]=I.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,a=n[0],o=n[4],s=n[8],u=n[12],c=n[1],l=n[5],h=n[9],p=n[13],f=n[2],d=n[6],m=n[10],v=n[14],g=n[3],y=n[7],x=n[11],b=n[15],w=r[0],_=r[4],S=r[8],M=r[12],E=r[1],T=r[5],C=r[9],A=r[13],N=r[2],I=r[6],R=r[10],O=r[14],k=r[3],L=r[7],D=r[11],P=r[15];return i[0]=a*w+o*E+s*N+u*k,i[4]=a*_+o*T+s*I+u*L,i[8]=a*S+o*C+s*R+u*D,i[12]=a*M+o*A+s*O+u*P,i[1]=c*w+l*E+h*N+p*k,i[5]=c*_+l*T+h*I+p*L,i[9]=c*S+l*C+h*R+p*D,i[13]=c*M+l*A+h*O+p*P,i[2]=f*w+d*E+m*N+v*k,i[6]=f*_+d*T+m*I+v*L,i[10]=f*S+d*C+m*R+v*D,i[14]=f*M+d*A+m*O+v*P,i[3]=g*w+y*E+x*N+b*k,i[7]=g*_+y*T+x*I+b*L,i[11]=g*S+y*C+x*R+b*D,i[15]=g*M+y*A+x*O+b*P,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],a=t[1],o=t[5],s=t[9],u=t[13],c=t[2],l=t[6],h=t[10],p=t[14];return t[3]*(+i*s*l-r*u*l-i*o*h+n*u*h+r*o*p-n*s*p)+t[7]*(+e*s*p-e*u*h+i*a*h-r*a*p+r*u*c-i*s*c)+t[11]*(+e*u*l-e*o*p-i*a*l+n*a*p+i*o*c-n*u*c)+t[15]*(-r*o*c-e*s*l+e*o*h+r*a*l-n*a*h+n*s*c)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t,e,n){var r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this},getInverse:function(t,e){var n=this.elements,r=t.elements,i=r[0],a=r[1],o=r[2],s=r[3],u=r[4],c=r[5],l=r[6],h=r[7],p=r[8],f=r[9],d=r[10],m=r[11],v=r[12],g=r[13],y=r[14],x=r[15],b=f*y*h-g*d*h+g*l*m-c*y*m-f*l*x+c*d*x,w=v*d*h-p*y*h-v*l*m+u*y*m+p*l*x-u*d*x,_=p*g*h-v*f*h+v*c*m-u*g*m-p*c*x+u*f*x,S=v*f*l-p*g*l-v*c*d+u*g*d+p*c*y-u*f*y,M=i*b+a*w+o*_+s*S;if(0===M){var E="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(E);return console.warn(E),this.identity()}var T=1/M;return n[0]=b*T,n[1]=(g*d*s-f*y*s-g*o*m+a*y*m+f*o*x-a*d*x)*T,n[2]=(c*y*s-g*l*s+g*o*h-a*y*h-c*o*x+a*l*x)*T,n[3]=(f*l*s-c*d*s-f*o*h+a*d*h+c*o*m-a*l*m)*T,n[4]=w*T,n[5]=(p*y*s-v*d*s+v*o*m-i*y*m-p*o*x+i*d*x)*T,n[6]=(v*l*s-u*y*s-v*o*h+i*y*h+u*o*x-i*l*x)*T,n[7]=(u*d*s-p*l*s+p*o*h-i*d*h-u*o*m+i*l*m)*T,n[8]=_*T,n[9]=(v*f*s-p*g*s-v*a*m+i*g*m+p*a*x-i*f*x)*T,n[10]=(u*g*s-v*c*s+v*a*h-i*g*h-u*a*x+i*c*x)*T,n[11]=(p*c*s-u*f*s-p*a*h+i*f*h+u*a*m-i*c*m)*T,n[12]=S*T,n[13]=(p*g*o-v*f*o+v*a*d-i*g*d-p*a*y+i*f*y)*T,n[14]=(v*c*o-u*g*o-v*a*l+i*g*l+u*a*y-i*c*y)*T,n[15]=(u*f*o-p*c*o+p*a*l-i*f*l-u*a*d+i*c*d)*T,this},scale:function(t){var e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=1-n,a=t.x,o=t.y,s=t.z,u=i*a,c=i*o;return this.set(u*a+n,u*o-r*s,u*s+r*o,0,u*o+r*s,c*o+n,c*s-r*a,0,u*s-r*o,c*s+r*a,i*s*s+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){var r=this.elements,i=e._x,a=e._y,o=e._z,s=e._w,u=i+i,c=a+a,l=o+o,h=i*u,p=i*c,f=i*l,d=a*c,m=a*l,v=o*l,g=s*u,y=s*c,x=s*l,b=n.x,w=n.y,_=n.z;return r[0]=(1-(d+v))*b,r[1]=(p+x)*b,r[2]=(f-y)*b,r[3]=0,r[4]=(p-x)*w,r[5]=(1-(h+v))*w,r[6]=(m+g)*w,r[7]=0,r[8]=(f+y)*_,r[9]=(m-g)*_,r[10]=(1-(h+d))*_,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this},decompose:function(t,e,n){var r=this.elements,i=M.set(r[0],r[1],r[2]).length(),a=M.set(r[4],r[5],r[6]).length(),o=M.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),t.x=r[12],t.y=r[13],t.z=r[14],E.copy(this);var s=1/i,u=1/a,c=1/o;return E.elements[0]*=s,E.elements[1]*=s,E.elements[2]*=s,E.elements[4]*=u,E.elements[5]*=u,E.elements[6]*=u,E.elements[8]*=c,E.elements[9]*=c,E.elements[10]*=c,e.setFromRotationMatrix(E),n.x=i,n.y=a,n.z=o,this},makePerspective:function(t,e,n,r,i,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,s=2*i/(e-t),u=2*i/(n-r),c=(e+t)/(e-t),l=(n+r)/(n-r),h=-(a+i)/(a-i),p=-2*a*i/(a-i);return o[0]=s,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=u,o[9]=l,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=p,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(t,e,n,r,i,a){var o=this.elements,s=1/(e-t),u=1/(n-r),c=1/(a-i),l=(e+t)*s,h=(n+r)*u,p=(a+i)*c;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-l,o[1]=0,o[5]=2*u,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-p,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}});var O=new R,k=new b;function L(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._order=r||L.DefaultOrder}function D(){this.mask=1}L.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],L.DefaultOrder="XYZ",Object.defineProperties(L.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),Object.assign(L.prototype,{isEuler:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._order=r||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){var r=h.clamp,i=t.elements,a=i[0],o=i[4],s=i[8],u=i[1],c=i[5],l=i[9],p=i[2],f=i[6],d=i[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-l,d),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(f,c),this._z=0)):"YXZ"===e?(this._x=Math.asin(-r(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(s,d),this._z=Math.atan2(u,c)):(this._y=Math.atan2(-p,a),this._z=0)):"ZXY"===e?(this._x=Math.asin(r(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-p,d),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(u,a))):"ZYX"===e?(this._y=Math.asin(-r(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(f,d),this._z=Math.atan2(u,a)):(this._x=0,this._z=Math.atan2(-o,c))):"YZX"===e?(this._z=Math.asin(r(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-l,c),this._y=Math.atan2(-p,a)):(this._x=0,this._y=Math.atan2(s,d))):"XZY"===e?(this._z=Math.asin(-r(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(f,c),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-l,d),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==n&&this._onChangeCallback(),this},setFromQuaternion:function(t,e,n){return O.makeRotationFromQuaternion(t),this.setFromRotationMatrix(O,e,n)},setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(t){return k.setFromEuler(this),this.setFromQuaternion(k,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new S(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),Object.assign(D.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return 0!=(this.mask&t.mask)}});var P=0,F=new S,B=new b,z=new R,U=new S,j=new S,W=new S,V=new b,H=new S(1,0,0),G=new S(0,1,0),q=new S(0,0,1),X={type:"added"},$={type:"removed"};function Y(){Object.defineProperty(this,"id",{value:P++}),this.uuid=h.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Y.DefaultUp.clone();var t=new S,e=new L,n=new b,r=new S(1,1,1);e._onChange((function(){n.setFromEuler(e,!1)})),n._onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new R},normalMatrix:{value:new f}}),this.matrix=new R,this.matrixWorld=new R,this.matrixAutoUpdate=Y.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new D,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function K(){Y.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Y.DefaultUp=new S(0,1,0),Y.DefaultMatrixAutoUpdate=!0,Y.prototype=Object.assign(Object.create(s.prototype),{constructor:Y,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return B.setFromAxisAngle(t,e),this.quaternion.multiply(B),this},rotateOnWorldAxis:function(t,e){return B.setFromAxisAngle(t,e),this.quaternion.premultiply(B),this},rotateX:function(t){return this.rotateOnAxis(H,t)},rotateY:function(t){return this.rotateOnAxis(G,t)},rotateZ:function(t){return this.rotateOnAxis(q,t)},translateOnAxis:function(t,e){return F.copy(t).applyQuaternion(this.quaternion),this.position.add(F.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(H,t)},translateY:function(t){return this.translateOnAxis(G,t)},translateZ:function(t){return this.translateOnAxis(q,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(z.getInverse(this.matrixWorld))},lookAt:function(t,e,n){t.isVector3?U.copy(t):U.set(t,e,n);var r=this.parent;this.updateWorldMatrix(!0,!1),j.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?z.lookAt(j,U,this.up):z.lookAt(U,j,this.up),this.quaternion.setFromRotationMatrix(z),r&&(z.extractRotation(r.matrixWorld),B.setFromRotationMatrix(z),this.quaternion.premultiply(B.inverse()))},add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(X)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var n=this.children.indexOf(t);return-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent($)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),z.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),z.multiply(t.parent.matrixWorld)),t.applyMatrix4(z),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new S),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new b),this.updateMatrixWorld(!0),this.matrixWorld.decompose(j,t,W),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new S),this.updateMatrixWorld(!0),this.matrixWorld.decompose(j,V,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new S),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){var n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e)for(var r=this.children,i=0,a=r.length;i<a;i++)r[i].updateWorldMatrix(!1,!0)},toJSON:function(t){var e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){r.geometry=i(t.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var o=a.shapes;if(Array.isArray(o))for(var s=0,u=o.length;s<u;s++){var c=o[s];i(t.shapes,c)}else i(t.shapes,o)}}if(void 0!==this.material)if(Array.isArray(this.material)){var l=[];for(s=0,u=this.material.length;s<u;s++)l.push(i(t.materials,this.material[s]));r.material=l}else r.material=i(t.materials,this.material);if(this.children.length>0){r.children=[];for(s=0;s<this.children.length;s++)r.children.push(this.children[s].toJSON(t).object)}if(e){var h=m(t.geometries),p=m(t.materials),f=m(t.textures),d=m(t.images);o=m(t.shapes);h.length>0&&(n.geometries=h),p.length>0&&(n.materials=p),f.length>0&&(n.textures=f),d.length>0&&(n.images=d),o.length>0&&(n.shapes=o)}return n.object=r,n;function m(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++){var r=t.children[n];this.add(r.clone())}return this}}),K.prototype=Object.assign(Object.create(Y.prototype),{constructor:K,isScene:!0,copy:function(t,e){return Y.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=Y.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.environment&&(e.object.environment=this.environment.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e},dispose:function(){this.dispatchEvent({type:"dispose"})}});var J=[new S,new S,new S,new S,new S,new S,new S,new S],Z=new S,Q=new lt,tt=new S,et=new S,nt=new S,rt=new S,it=new S,at=new S,ot=new S,st=new S,ut=new S,ct=new S;function lt(t,e){this.min=void 0!==t?t:new S(1/0,1/0,1/0),this.max=void 0!==e?e:new S(-1/0,-1/0,-1/0)}function ht(t,e,n,r,i){var a,o;for(a=0,o=t.length-3;a<=o;a+=3){ct.fromArray(t,a);var s=i.x*Math.abs(ct.x)+i.y*Math.abs(ct.y)+i.z*Math.abs(ct.z),u=e.dot(ct),c=n.dot(ct),l=r.dot(ct);if(Math.max(-Math.max(u,c,l),Math.min(u,c,l))>s)return!1}return!0}Object.assign(lt.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,u=t.length;s<u;s+=3){var c=t[s],l=t[s+1],h=t[s+2];c<e&&(e=c),l<n&&(n=l),h<r&&(r=h),c>i&&(i=c),l>a&&(a=l),h>o&&(o=h)}return this.min.set(e,n,r),this.max.set(i,a,o),this},setFromBufferAttribute:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,u=t.count;s<u;s++){var c=t.getX(s),l=t.getY(s),h=t.getZ(s);c<e&&(e=c),l<n&&(n=l),h<r&&(r=h),c>i&&(i=c),l>a&&(a=l),h>o&&(o=h)}return this.min.set(e,n,r),this.max.set(i,a,o),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){var n=Z.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new S),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new S),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1);var e=t.geometry;void 0!==e&&(null===e.boundingBox&&e.computeBoundingBox(),Q.copy(e.boundingBox),Q.applyMatrix4(t.matrixWorld),this.expandByPoint(Q.min),this.expandByPoint(Q.max));for(var n=t.children,r=0,i=n.length;r<i;r++)this.expandByObject(n[r]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new S),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,Z),Z.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){var e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant},intersectsTriangle:function(t){if(this.isEmpty())return!1;this.getCenter(ot),st.subVectors(this.max,ot),tt.subVectors(t.a,ot),et.subVectors(t.b,ot),nt.subVectors(t.c,ot),rt.subVectors(et,tt),it.subVectors(nt,et),at.subVectors(tt,nt);var e=[0,-rt.z,rt.y,0,-it.z,it.y,0,-at.z,at.y,rt.z,0,-rt.x,it.z,0,-it.x,at.z,0,-at.x,-rt.y,rt.x,0,-it.y,it.x,0,-at.y,at.x,0];return!!ht(e,tt,et,nt,st)&&(!!ht(e=[1,0,0,0,1,0,0,0,1],tt,et,nt,st)&&(ut.crossVectors(rt,it),ht(e=[ut.x,ut.y,ut.z],tt,et,nt,st)))},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new S),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return Z.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(Z).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()||(J[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),J[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),J[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),J[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),J[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),J[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),J[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),J[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(J)),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var pt=new lt;function ft(t,e){this.center=void 0!==t?t:new S,this.radius=void 0!==e?e:0}Object.assign(ft.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(t,e){var n=this.center;void 0!==e?n.copy(e):pt.setFromPoints(t).getCenter(n);for(var r=0,i=0,a=t.length;i<a;i++)r=Math.max(r,n.distanceToSquared(t[i]));return this.radius=Math.sqrt(r),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var n=this.center.distanceToSquared(t);return void 0===e&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new S),e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new lt),t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}});var dt=new S,mt=new S,vt=new S,gt=new S,yt=new S,xt=new S,bt=new S;function wt(t,e){this.origin=void 0!==t?t:new S,this.direction=void 0!==e?e:new S(0,0,-1)}Object.assign(wt.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return void 0===e&&(console.warn("THREE.Ray: .at() target is now required"),e=new S),e.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,dt)),this},closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),e=new S),e.subVectors(t,this.origin);var n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){var e=dt.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(dt.copy(this.direction).multiplyScalar(e).add(this.origin),dt.distanceToSquared(t))},distanceSqToSegment:function(t,e,n,r){mt.copy(t).add(e).multiplyScalar(.5),vt.copy(e).sub(t).normalize(),gt.copy(this.origin).sub(mt);var i,a,o,s,u=.5*t.distanceTo(e),c=-this.direction.dot(vt),l=gt.dot(this.direction),h=-gt.dot(vt),p=gt.lengthSq(),f=Math.abs(1-c*c);if(f>0)if(a=c*l-h,s=u*f,(i=c*h-l)>=0)if(a>=-s)if(a<=s){var d=1/f;o=(i*=d)*(i+c*(a*=d)+2*l)+a*(c*i+a+2*h)+p}else a=u,o=-(i=Math.max(0,-(c*a+l)))*i+a*(a+2*h)+p;else a=-u,o=-(i=Math.max(0,-(c*a+l)))*i+a*(a+2*h)+p;else a<=-s?o=-(i=Math.max(0,-(-c*u+l)))*i+(a=i>0?-u:Math.min(Math.max(-u,-h),u))*(a+2*h)+p:a<=s?(i=0,o=(a=Math.min(Math.max(-u,-h),u))*(a+2*h)+p):o=-(i=Math.max(0,-(c*u+l)))*i+(a=i>0?u:Math.min(Math.max(-u,-h),u))*(a+2*h)+p;else a=c>0?-u:u,o=-(i=Math.max(0,-(c*a+l)))*i+a*(a+2*h)+p;return n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(vt).multiplyScalar(a).add(mt),o},intersectSphere:function(t,e){dt.subVectors(t.center,this.origin);var n=dt.dot(this.direction),r=dt.dot(dt)-n*n,i=t.radius*t.radius;if(r>i)return null;var a=Math.sqrt(i-r),o=n-a,s=n+a;return o<0&&s<0?null:o<0?this.at(s,e):this.at(o,e)},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null},intersectPlane:function(t,e){var n=this.distanceToPlane(t);return null===n?null:this.at(n,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var n,r,i,a,o,s,u=1/this.direction.x,c=1/this.direction.y,l=1/this.direction.z,h=this.origin;return u>=0?(n=(t.min.x-h.x)*u,r=(t.max.x-h.x)*u):(n=(t.max.x-h.x)*u,r=(t.min.x-h.x)*u),c>=0?(i=(t.min.y-h.y)*c,a=(t.max.y-h.y)*c):(i=(t.max.y-h.y)*c,a=(t.min.y-h.y)*c),n>a||i>r?null:((i>n||n!=n)&&(n=i),(a<r||r!=r)&&(r=a),l>=0?(o=(t.min.z-h.z)*l,s=(t.max.z-h.z)*l):(o=(t.max.z-h.z)*l,s=(t.min.z-h.z)*l),n>s||o>r?null:((o>n||n!=n)&&(n=o),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,e)))},intersectsBox:function(t){return null!==this.intersectBox(t,dt)},intersectTriangle:function(t,e,n,r,i){yt.subVectors(e,t),xt.subVectors(n,t),bt.crossVectors(yt,xt);var a,o=this.direction.dot(bt);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}gt.subVectors(this.origin,t);var s=a*this.direction.dot(xt.crossVectors(gt,xt));if(s<0)return null;var u=a*this.direction.dot(yt.cross(gt));if(u<0)return null;if(s+u>o)return null;var c=-a*gt.dot(bt);return c<0?null:this.at(c/o,i)},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}});var _t=new S,St=new S,Mt=new f;function Et(t,e){this.normal=void 0!==t?t:new S(1,0,0),this.constant=void 0!==e?e:0}Object.assign(Et.prototype,{isPlane:!0,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(t,e,n){var r=_t.subVectors(n,e).cross(St.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return void 0===e&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new S),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,e){void 0===e&&(console.warn("THREE.Plane: .intersectLine() target is now required"),e=new S);var n=t.delta(_t),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(t.start)?e.copy(t.start):void 0;var i=-(t.start.dot(this.normal)+this.constant)/r;return i<0||i>1?void 0:e.copy(n).multiplyScalar(i).add(t.start)},intersectsLine:function(t){var e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new S),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,e){var n=e||Mt.getNormalMatrix(t),r=this.coplanarPoint(_t).applyMatrix4(t),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}});var Tt=new S,Ct=new S,At=new S,Nt=new S,It=new S,Rt=new S,Ot=new S,kt=new S,Lt=new S,Dt=new S;function Pt(t,e,n){this.a=void 0!==t?t:new S,this.b=void 0!==e?e:new S,this.c=void 0!==n?n:new S}Object.assign(Pt,{getNormal:function(t,e,n,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new S),r.subVectors(n,e),Tt.subVectors(t,e),r.cross(Tt);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)},getBarycoord:function(t,e,n,r,i){Tt.subVectors(r,e),Ct.subVectors(n,e),At.subVectors(t,e);var a=Tt.dot(Tt),o=Tt.dot(Ct),s=Tt.dot(At),u=Ct.dot(Ct),c=Ct.dot(At),l=a*u-o*o;if(void 0===i&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),i=new S),0===l)return i.set(-2,-1,-1);var h=1/l,p=(u*s-o*c)*h,f=(a*c-o*s)*h;return i.set(1-p-f,f,p)},containsPoint:function(t,e,n,r){return Pt.getBarycoord(t,e,n,r,Nt),Nt.x>=0&&Nt.y>=0&&Nt.x+Nt.y<=1},getUV:function(t,e,n,r,i,a,o,s){return this.getBarycoord(t,e,n,r,Nt),s.set(0,0),s.addScaledVector(i,Nt.x),s.addScaledVector(a,Nt.y),s.addScaledVector(o,Nt.z),s},isFrontFacing:function(t,e,n,r){return Tt.subVectors(n,e),Ct.subVectors(t,e),Tt.cross(Ct).dot(r)<0}}),Object.assign(Pt.prototype,{set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){return Tt.subVectors(this.c,this.b),Ct.subVectors(this.a,this.b),.5*Tt.cross(Ct).length()},getMidpoint:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new S),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return Pt.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new Et),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,e){return Pt.getBarycoord(t,this.a,this.b,this.c,e)},getUV:function(t,e,n,r,i){return Pt.getUV(t,this.a,this.b,this.c,e,n,r,i)},containsPoint:function(t){return Pt.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return Pt.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),e=new S);var n,r,i=this.a,a=this.b,o=this.c;It.subVectors(a,i),Rt.subVectors(o,i),kt.subVectors(t,i);var s=It.dot(kt),u=Rt.dot(kt);if(s<=0&&u<=0)return e.copy(i);Lt.subVectors(t,a);var c=It.dot(Lt),l=Rt.dot(Lt);if(c>=0&&l<=c)return e.copy(a);var h=s*l-c*u;if(h<=0&&s>=0&&c<=0)return n=s/(s-c),e.copy(i).addScaledVector(It,n);Dt.subVectors(t,o);var p=It.dot(Dt),f=Rt.dot(Dt);if(f>=0&&p<=f)return e.copy(o);var d=p*u-s*f;if(d<=0&&u>=0&&f<=0)return r=u/(u-f),e.copy(i).addScaledVector(Rt,r);var m=c*f-p*l;if(m<=0&&l-c>=0&&p-f>=0)return Ot.subVectors(o,a),r=(l-c)/(l-c+(p-f)),e.copy(a).addScaledVector(Ot,r);var v=1/(m+d+h);return n=d*v,r=h*v,e.copy(i).addScaledVector(It,n).addScaledVector(Rt,r)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}});var Ft={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Bt={h:0,s:0,l:0},zt={h:0,s:0,l:0};function Ut(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}function jt(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function Wt(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Vt(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}function Ht(t,e,n,r,i,a){this.a=t,this.b=e,this.c=n,this.normal=r&&r.isVector3?r:new S,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new Ut,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==a?a:0}Object.assign(Ut.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(t,e,n){if(t=h.euclideanModulo(t,1),e=h.clamp(e,0,1),n=h.clamp(n,0,1),0===e)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+e):n+e-n*e,i=2*n-r;this.r=jt(i,r,t+1/3),this.g=jt(i,r,t),this.b=jt(i,r,t-1/3)}return this},setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var r,i=n[1],a=n[2];switch(i){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,e(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,e(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var o=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,u=parseInt(r[3],10)/100;return e(r[5]),this.setHSL(o,s,u)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){var c=n[1],l=c.length;if(3===l)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===l)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this},setColorName:function(t){var e=Ft[t];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=Wt(t.r),this.g=Wt(t.g),this.b=Wt(t.b),this},copyLinearToSRGB:function(t){return this.r=Vt(t.r),this.g=Vt(t.g),this.b=Vt(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var e,n,r=this.r,i=this.g,a=this.b,o=Math.max(r,i,a),s=Math.min(r,i,a),u=(s+o)/2;if(s===o)e=0,n=0;else{var c=o-s;switch(n=u<=.5?c/(o+s):c/(2-o-s),o){case r:e=(i-a)/c+(i<a?6:0);break;case i:e=(a-r)/c+2;break;case a:e=(r-i)/c+4}e/=6}return t.h=e,t.s=n,t.l=u,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,n){return this.getHSL(Bt),Bt.h+=t,Bt.s+=e,Bt.l+=n,this.setHSL(Bt.h,Bt.s,Bt.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},lerpHSL:function(t,e){this.getHSL(Bt),t.getHSL(zt);var n=h.lerp(Bt.h,zt.h,e),r=h.lerp(Bt.s,zt.s,e),i=h.lerp(Bt.l,zt.l,e);return this.setHSL(n,r,i),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}}),Ut.NAMES=Ft,Object.assign(Ht.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});var Gt=0;function qt(){Object.defineProperty(this,"id",{value:Gt++}),this.uuid=h.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.flatShading=!1,this.vertexTangents=!1,this.vertexColors=0,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function Xt(t){qt.call(this),this.type="MeshBasicMaterial",this.color=new Ut(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(t)}qt.prototype=Object.assign(Object.create(s.prototype),{constructor:qt,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var n=t[e];if(void 0!==n)if("shading"!==e){var r=this[e];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){var e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),0!==this.side&&(n.side=this.side),0!==this.vertexColors&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){var i=r(t.textures),a=r(t.images);i.length>0&&(n.textures=i),a.length>0&&(n.images=a)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexTangents=t.vertexTangents,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var e=t.clippingPlanes,n=null;if(null!==e){var r=e.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=e[i].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(qt.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Xt.prototype=Object.create(qt.prototype),Xt.prototype.constructor=Xt,Xt.prototype.isMeshBasicMaterial=!0,Xt.prototype.copy=function(t){return qt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};var $t=new S;function Yt(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function Kt(t,e,n){Yt.call(this,new Int8Array(t),e,n)}function Jt(t,e,n){Yt.call(this,new Uint8Array(t),e,n)}function Zt(t,e,n){Yt.call(this,new Uint8ClampedArray(t),e,n)}function Qt(t,e,n){Yt.call(this,new Int16Array(t),e,n)}function te(t,e,n){Yt.call(this,new Uint16Array(t),e,n)}function ee(t,e,n){Yt.call(this,new Int32Array(t),e,n)}function ne(t,e,n){Yt.call(this,new Uint32Array(t),e,n)}function re(t,e,n){Yt.call(this,new Float32Array(t),e,n)}function ie(t,e,n){Yt.call(this,new Float64Array(t),e,n)}function ae(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function oe(t){if(0===t.length)return-1/0;for(var e=t[0],n=1,r=t.length;n<r;++n)t[n]>e&&(e=t[n]);return e}Object.defineProperty(Yt.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Yt.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[t+r]=e.array[n+r];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var a=t[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),a=new Ut),e[n++]=a.r,e[n++]=a.g,e[n++]=a.b}return this},copyVector2sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var a=t[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),a=new p),e[n++]=a.x,e[n++]=a.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var a=t[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),a=new S),e[n++]=a.x,e[n++]=a.y,e[n++]=a.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var a=t[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),a=new g),e[n++]=a.x,e[n++]=a.y,e[n++]=a.z,e[n++]=a.w}return this},applyMatrix3:function(t){for(var e=0,n=this.count;e<n;e++)$t.x=this.getX(e),$t.y=this.getY(e),$t.z=this.getZ(e),$t.applyMatrix3(t),this.setXYZ(e,$t.x,$t.y,$t.z);return this},applyMatrix4:function(t){for(var e=0,n=this.count;e<n;e++)$t.x=this.getX(e),$t.y=this.getY(e),$t.z=this.getZ(e),$t.applyMatrix4(t),this.setXYZ(e,$t.x,$t.y,$t.z);return this},applyNormalMatrix:function(t){for(var e=0,n=this.count;e<n;e++)$t.x=this.getX(e),$t.y=this.getY(e),$t.z=this.getZ(e),$t.applyNormalMatrix(t),this.setXYZ(e,$t.x,$t.y,$t.z);return this},transformDirection:function(t){for(var e=0,n=this.count;e<n;e++)$t.x=this.getX(e),$t.y=this.getY(e),$t.z=this.getZ(e),$t.transformDirection(t),this.setXYZ(e,$t.x,$t.y,$t.z);return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=i,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),Kt.prototype=Object.create(Yt.prototype),Kt.prototype.constructor=Kt,Jt.prototype=Object.create(Yt.prototype),Jt.prototype.constructor=Jt,Zt.prototype=Object.create(Yt.prototype),Zt.prototype.constructor=Zt,Qt.prototype=Object.create(Yt.prototype),Qt.prototype.constructor=Qt,te.prototype=Object.create(Yt.prototype),te.prototype.constructor=te,ee.prototype=Object.create(Yt.prototype),ee.prototype.constructor=ee,ne.prototype=Object.create(Yt.prototype),ne.prototype.constructor=ne,re.prototype=Object.create(Yt.prototype),re.prototype.constructor=re,ie.prototype=Object.create(Yt.prototype),ie.prototype.constructor=ie,Object.assign(ae.prototype,{computeGroups:function(t){for(var e,n=[],r=void 0,i=t.faces,a=0;a<i.length;a++){var o=i[a];o.materialIndex!==r&&(r=o.materialIndex,void 0!==e&&(e.count=3*a-e.start,n.push(e)),e={start:3*a,materialIndex:r})}void 0!==e&&(e.count=3*a-e.start,n.push(e)),this.groups=n},fromGeometry:function(t){var e,n=t.faces,r=t.vertices,i=t.faceVertexUvs,a=i[0]&&i[0].length>0,o=i[1]&&i[1].length>0,s=t.morphTargets,u=s.length;if(u>0){e=[];for(var c=0;c<u;c++)e[c]={name:s[c].name,data:[]};this.morphTargets.position=e}var l,h=t.morphNormals,f=h.length;if(f>0){l=[];for(c=0;c<f;c++)l[c]={name:h[c].name,data:[]};this.morphTargets.normal=l}var d=t.skinIndices,m=t.skinWeights,v=d.length===r.length,g=m.length===r.length;r.length>0&&0===n.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(c=0;c<n.length;c++){var y=n[c];this.vertices.push(r[y.a],r[y.b],r[y.c]);var x=y.vertexNormals;if(3===x.length)this.normals.push(x[0],x[1],x[2]);else{var b=y.normal;this.normals.push(b,b,b)}var w,_=y.vertexColors;if(3===_.length)this.colors.push(_[0],_[1],_[2]);else{var S=y.color;this.colors.push(S,S,S)}if(!0===a)void 0!==(w=i[0][c])?this.uvs.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",c),this.uvs.push(new p,new p,new p));if(!0===o)void 0!==(w=i[1][c])?this.uvs2.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",c),this.uvs2.push(new p,new p,new p));for(var M=0;M<u;M++){var E=s[M].vertices;e[M].data.push(E[y.a],E[y.b],E[y.c])}for(M=0;M<f;M++){var T=h[M].vertexNormals[c];l[M].data.push(T.a,T.b,T.c)}v&&this.skinIndices.push(d[y.a],d[y.b],d[y.c]),g&&this.skinWeights.push(m[y.a],m[y.b],m[y.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}});var se=1,ue=new R,ce=new Y,le=new S,he=new lt,pe=new lt,fe=new S;function de(){Object.defineProperty(this,"id",{value:se+=2}),this.uuid=h.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}de.prototype=Object.assign(Object.create(s.prototype),{constructor:de,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(oe(t)>65535?ne:te)(t,1):this.index=t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,e){return this.attributes[t]=e,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix4:function(t){var e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var r=(new f).getNormalMatrix(t);n.applyNormalMatrix(r),n.needsUpdate=!0}var i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(t),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return ue.makeRotationX(t),this.applyMatrix4(ue),this},rotateY:function(t){return ue.makeRotationY(t),this.applyMatrix4(ue),this},rotateZ:function(t){return ue.makeRotationZ(t),this.applyMatrix4(ue),this},translate:function(t,e,n){return ue.makeTranslation(t,e,n),this.applyMatrix4(ue),this},scale:function(t,e,n){return ue.makeScale(t,e,n),this.applyMatrix4(ue),this},lookAt:function(t){return ce.lookAt(t),ce.updateMatrix(),this.applyMatrix4(ce.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(le).negate(),this.translate(le.x,le.y,le.z),this},setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){var n=new re(3*e.vertices.length,3),r=new re(3*e.colors.length,3);if(this.setAttribute("position",n.copyVector3sArray(e.vertices)),this.setAttribute("color",r.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var i=new re(e.lineDistances.length,1);this.setAttribute("lineDistance",i.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},setFromPoints:function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];e.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new re(e,3)),this},updateFromObject:function(t){var e,n=t.geometry;if(t.isMesh){var r=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(r=void 0,n.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(n);r.verticesNeedUpdate=n.verticesNeedUpdate,r.normalsNeedUpdate=n.normalsNeedUpdate,r.colorsNeedUpdate=n.colorsNeedUpdate,r.uvsNeedUpdate=n.uvsNeedUpdate,r.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=r}return!0===n.verticesNeedUpdate&&(void 0!==(e=this.attributes.position)&&(e.copyVector3sArray(n.vertices),e.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(e=this.attributes.normal)&&(e.copyVector3sArray(n.normals),e.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(e=this.attributes.color)&&(e.copyColorsArray(n.colors),e.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(e=this.attributes.uv)&&(e.copyVector2sArray(n.uvs),e.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(e=this.attributes.lineDistance)&&(e.copyArray(n.lineDistances),e.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(t.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new ae).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.setAttribute("position",new Yt(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var n=new Float32Array(3*t.normals.length);this.setAttribute("normal",new Yt(n,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var r=new Float32Array(3*t.colors.length);this.setAttribute("color",new Yt(r,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var i=new Float32Array(2*t.uvs.length);this.setAttribute("uv",new Yt(i,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var a=new Float32Array(2*t.uvs2.length);this.setAttribute("uv2",new Yt(a,2).copyVector2sArray(t.uvs2))}for(var o in this.groups=t.groups,t.morphTargets){for(var s=[],u=t.morphTargets[o],c=0,l=u.length;c<l;c++){var h=u[c],p=new re(3*h.data.length,3);p.name=h.name,s.push(p.copyVector3sArray(h.data))}this.morphAttributes[o]=s}if(t.skinIndices.length>0){var f=new re(4*t.skinIndices.length,4);this.setAttribute("skinIndex",f.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var d=new re(4*t.skinWeights.length,4);this.setAttribute("skinWeight",d.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new lt);var t=this.attributes.position,e=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(var n=0,r=e.length;n<r;n++){var i=e[n];he.setFromBufferAttribute(i),this.morphTargetsRelative?(fe.addVectors(this.boundingBox.min,he.min),this.boundingBox.expandByPoint(fe),fe.addVectors(this.boundingBox.max,he.max),this.boundingBox.expandByPoint(fe)):(this.boundingBox.expandByPoint(he.min),this.boundingBox.expandByPoint(he.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new ft);var t=this.attributes.position,e=this.morphAttributes.position;if(t){var n=this.boundingSphere.center;if(he.setFromBufferAttribute(t),e)for(var r=0,i=e.length;r<i;r++){var a=e[r];pe.setFromBufferAttribute(a),this.morphTargetsRelative?(fe.addVectors(he.min,pe.min),he.expandByPoint(fe),fe.addVectors(he.max,pe.max),he.expandByPoint(fe)):(he.expandByPoint(pe.min),he.expandByPoint(pe.max))}he.getCenter(n);var o=0;for(r=0,i=t.count;r<i;r++)fe.fromBufferAttribute(t,r),o=Math.max(o,n.distanceToSquared(fe));if(e)for(r=0,i=e.length;r<i;r++){a=e[r];for(var s=this.morphTargetsRelative,u=0,c=a.count;u<c;u++)fe.fromBufferAttribute(a,u),s&&(le.fromBufferAttribute(t,u),fe.add(le)),o=Math.max(o,n.distanceToSquared(fe))}this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes;if(e.position){var n=e.position.array;if(void 0===e.normal)this.setAttribute("normal",new Yt(new Float32Array(n.length),3));else for(var r=e.normal.array,i=0,a=r.length;i<a;i++)r[i]=0;var o,s,u,c=e.normal.array,l=new S,h=new S,p=new S,f=new S,d=new S;if(t){var m=t.array;for(i=0,a=t.count;i<a;i+=3)o=3*m[i+0],s=3*m[i+1],u=3*m[i+2],l.fromArray(n,o),h.fromArray(n,s),p.fromArray(n,u),f.subVectors(p,h),d.subVectors(l,h),f.cross(d),c[o]+=f.x,c[o+1]+=f.y,c[o+2]+=f.z,c[s]+=f.x,c[s+1]+=f.y,c[s+2]+=f.z,c[u]+=f.x,c[u+1]+=f.y,c[u+2]+=f.z}else for(i=0,a=n.length;i<a;i+=9)l.fromArray(n,i),h.fromArray(n,i+3),p.fromArray(n,i+6),f.subVectors(p,h),d.subVectors(l,h),f.cross(d),c[i]=f.x,c[i+1]=f.y,c[i+2]=f.z,c[i+3]=f.x,c[i+4]=f.y,c[i+5]=f.z,c[i+6]=f.x,c[i+7]=f.y,c[i+8]=f.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==t.attributes[r])for(var i=n[r].array,a=t.attributes[r],o=a.array,s=a.itemSize*e,u=Math.min(o.length,i.length-s),c=0,l=s;c<u;c++,l++)i[l]=o[c];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){for(var t=this.attributes.normal,e=0,n=t.count;e<n;e++)fe.x=t.getX(e),fe.y=t.getY(e),fe.z=t.getZ(e),fe.normalize(),t.setXYZ(e,fe.x,fe.y,fe.z)},toNonIndexed:function(){function t(t,e){for(var n=t.array,r=t.itemSize,i=new n.constructor(e.length*r),a=0,o=0,s=0,u=e.length;s<u;s++){a=e[s]*r;for(var c=0;c<r;c++)i[o++]=n[a++]}return new Yt(i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new de,n=this.index.array,r=this.attributes;for(var i in r){var a=t(r[i],n);e.setAttribute(i,a)}var o=this.morphAttributes;for(i in o){for(var s=[],u=o[i],c=0,l=u.length;c<l;c++){a=t(u[c],n);s.push(a)}e.morphAttributes[i]=s}e.morphTargetsRelative=this.morphTargetsRelative;for(var h=this.groups,p=(c=0,h.length);c<p;c++){var f=h[c];e.addGroup(f.start,f.count,f.materialIndex)}return e},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};var r=this.index;null!==r&&(t.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(var n in i){var a=(p=i[n]).toJSON();""!==p.name&&(a.name=p.name),t.data.attributes[n]=a}var o={},s=!1;for(var n in this.morphAttributes){for(var u=this.morphAttributes[n],c=[],l=0,h=u.length;l<h;l++){var p;a=(p=u[l]).toJSON();""!==p.name&&(a.name=p.name),c.push(a)}c.length>0&&(o[n]=c,s=!0)}s&&(t.data.morphAttributes=o,t.data.morphTargetsRelative=this.morphTargetsRelative);var f=this.groups;f.length>0&&(t.data.groups=JSON.parse(JSON.stringify(f)));var d=this.boundingSphere;return null!==d&&(t.data.boundingSphere={center:d.center.toArray(),radius:d.radius}),t},clone:function(){return(new de).copy(this)},copy:function(t){var e,n,r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var i=t.index;null!==i&&this.setIndex(i.clone());var a=t.attributes;for(e in a){var o=a[e];this.setAttribute(e,o.clone())}var s=t.morphAttributes;for(e in s){var u=[],c=s[e];for(n=0,r=c.length;n<r;n++)u.push(c[n].clone());this.morphAttributes[e]=u}this.morphTargetsRelative=t.morphTargetsRelative;var l=t.groups;for(n=0,r=l.length;n<r;n++){var h=l[n];this.addGroup(h.start,h.count,h.materialIndex)}var p=t.boundingBox;null!==p&&(this.boundingBox=p.clone());var f=t.boundingSphere;return null!==f&&(this.boundingSphere=f.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var me=new R,ve=new wt,ge=new ft,ye=new S,xe=new S,be=new S,we=new S,_e=new S,Se=new S,Me=new S,Ee=new S,Te=new S,Ce=new p,Ae=new p,Ne=new p,Ie=new S,Re=new S;function Oe(t,e){Y.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new de,this.material=void 0!==e?e:new Xt,this.updateMorphTargets()}function ke(t,e,n,i,a,o,s,u){if(null===(1===e.side?i.intersectTriangle(s,o,a,!0,u):i.intersectTriangle(a,o,s,e.side!==r,u)))return null;Re.copy(u),Re.applyMatrix4(t.matrixWorld);var c=n.ray.origin.distanceTo(Re);return c<n.near||c>n.far?null:{distance:c,point:Re.clone(),object:t}}function Le(t,e,n,r,i,a,o,s,u,c,l,h){ye.fromBufferAttribute(i,c),xe.fromBufferAttribute(i,l),be.fromBufferAttribute(i,h);var f=t.morphTargetInfluences;if(e.morphTargets&&a&&f){Me.set(0,0,0),Ee.set(0,0,0),Te.set(0,0,0);for(var d=0,m=a.length;d<m;d++){var v=f[d],g=a[d];0!==v&&(we.fromBufferAttribute(g,c),_e.fromBufferAttribute(g,l),Se.fromBufferAttribute(g,h),o?(Me.addScaledVector(we,v),Ee.addScaledVector(_e,v),Te.addScaledVector(Se,v)):(Me.addScaledVector(we.sub(ye),v),Ee.addScaledVector(_e.sub(xe),v),Te.addScaledVector(Se.sub(be),v)))}ye.add(Me),xe.add(Ee),be.add(Te)}var y=ke(t,e,n,r,ye,xe,be,Ie);if(y){s&&(Ce.fromBufferAttribute(s,c),Ae.fromBufferAttribute(s,l),Ne.fromBufferAttribute(s,h),y.uv=Pt.getUV(Ie,ye,xe,be,Ce,Ae,Ne,new p)),u&&(Ce.fromBufferAttribute(u,c),Ae.fromBufferAttribute(u,l),Ne.fromBufferAttribute(u,h),y.uv2=Pt.getUV(Ie,ye,xe,be,Ce,Ae,Ne,new p));var x=new Ht(c,l,h);Pt.getNormal(ye,xe,be,x.normal),y.face=x}return y}Oe.prototype=Object.assign(Object.create(Y.prototype),{constructor:Oe,isMesh:!0,copy:function(t){return Y.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t,e,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,a=Object.keys(i);if(a.length>0){var o=i[a[0]];if(void 0!==o)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=o.length;t<e;t++)n=o[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else{var s=r.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(t,e){var n,r=this.geometry,i=this.material,a=this.matrixWorld;if(void 0!==i&&(null===r.boundingSphere&&r.computeBoundingSphere(),ge.copy(r.boundingSphere),ge.applyMatrix4(a),!1!==t.ray.intersectsSphere(ge)&&(me.getInverse(a),ve.copy(t.ray).applyMatrix4(me),null===r.boundingBox||!1!==ve.intersectsBox(r.boundingBox))))if(r.isBufferGeometry){var o,s,u,c,l,h,f,d,m,v=r.index,g=r.attributes.position,y=r.morphAttributes.position,x=r.morphTargetsRelative,b=r.attributes.uv,w=r.attributes.uv2,_=r.groups,S=r.drawRange;if(null!==v)if(Array.isArray(i))for(c=0,h=_.length;c<h;c++)for(m=i[(d=_[c]).materialIndex],l=Math.max(d.start,S.start),f=Math.min(d.start+d.count,S.start+S.count);l<f;l+=3)o=v.getX(l),s=v.getX(l+1),u=v.getX(l+2),(n=Le(this,m,t,ve,g,y,x,b,w,o,s,u))&&(n.faceIndex=Math.floor(l/3),n.face.materialIndex=d.materialIndex,e.push(n));else for(c=Math.max(0,S.start),h=Math.min(v.count,S.start+S.count);c<h;c+=3)o=v.getX(c),s=v.getX(c+1),u=v.getX(c+2),(n=Le(this,i,t,ve,g,y,x,b,w,o,s,u))&&(n.faceIndex=Math.floor(c/3),e.push(n));else if(void 0!==g)if(Array.isArray(i))for(c=0,h=_.length;c<h;c++)for(m=i[(d=_[c]).materialIndex],l=Math.max(d.start,S.start),f=Math.min(d.start+d.count,S.start+S.count);l<f;l+=3)(n=Le(this,m,t,ve,g,y,x,b,w,o=l,s=l+1,u=l+2))&&(n.faceIndex=Math.floor(l/3),n.face.materialIndex=d.materialIndex,e.push(n));else for(c=Math.max(0,S.start),h=Math.min(g.count,S.start+S.count);c<h;c+=3)(n=Le(this,i,t,ve,g,y,x,b,w,o=c,s=c+1,u=c+2))&&(n.faceIndex=Math.floor(c/3),e.push(n))}else if(r.isGeometry){var M,E,T,C,A=Array.isArray(i),N=r.vertices,I=r.faces,R=r.faceVertexUvs[0];R.length>0&&(C=R);for(var O=0,k=I.length;O<k;O++){var L=I[O],D=A?i[L.materialIndex]:i;if(void 0!==D&&(M=N[L.a],E=N[L.b],T=N[L.c],n=ke(this,D,t,ve,M,E,T,Ie))){if(C&&C[O]){var P=C[O];Ce.copy(P[0]),Ae.copy(P[1]),Ne.copy(P[2]),n.uv=Pt.getUV(Ie,M,E,T,Ce,Ae,Ne,new p)}n.face=L,n.faceIndex=O,e.push(n)}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var De=0,Pe=new R,Fe=new Y,Be=new S;function ze(){Object.defineProperty(this,"id",{value:De+=2}),this.uuid=h.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}ze.prototype=Object.assign(Object.create(s.prototype),{constructor:ze,isGeometry:!0,applyMatrix4:function(t){for(var e=(new f).getNormalMatrix(t),n=0,r=this.vertices.length;n<r;n++){this.vertices[n].applyMatrix4(t)}for(n=0,r=this.faces.length;n<r;n++){var i=this.faces[n];i.normal.applyMatrix3(e).normalize();for(var a=0,o=i.vertexNormals.length;a<o;a++)i.vertexNormals[a].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(t){return Pe.makeRotationX(t),this.applyMatrix4(Pe),this},rotateY:function(t){return Pe.makeRotationY(t),this.applyMatrix4(Pe),this},rotateZ:function(t){return Pe.makeRotationZ(t),this.applyMatrix4(Pe),this},translate:function(t,e,n){return Pe.makeTranslation(t,e,n),this.applyMatrix4(Pe),this},scale:function(t,e,n){return Pe.makeScale(t,e,n),this.applyMatrix4(Pe),this},lookAt:function(t){return Fe.lookAt(t),Fe.updateMatrix(),this.applyMatrix4(Fe.matrix),this},fromBufferGeometry:function(t){var e=this,n=null!==t.index?t.index.array:void 0,r=t.attributes;if(void 0===r.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var i=r.position.array,a=void 0!==r.normal?r.normal.array:void 0,o=void 0!==r.color?r.color.array:void 0,s=void 0!==r.uv?r.uv.array:void 0,u=void 0!==r.uv2?r.uv2.array:void 0;void 0!==u&&(this.faceVertexUvs[1]=[]);for(var c=0;c<i.length;c+=3)e.vertices.push((new S).fromArray(i,c)),void 0!==o&&e.colors.push((new Ut).fromArray(o,c));function l(t,n,r,i){var c=void 0===o?[]:[e.colors[t].clone(),e.colors[n].clone(),e.colors[r].clone()],l=new Ht(t,n,r,void 0===a?[]:[(new S).fromArray(a,3*t),(new S).fromArray(a,3*n),(new S).fromArray(a,3*r)],c,i);e.faces.push(l),void 0!==s&&e.faceVertexUvs[0].push([(new p).fromArray(s,2*t),(new p).fromArray(s,2*n),(new p).fromArray(s,2*r)]),void 0!==u&&e.faceVertexUvs[1].push([(new p).fromArray(u,2*t),(new p).fromArray(u,2*n),(new p).fromArray(u,2*r)])}var h=t.groups;if(h.length>0)for(c=0;c<h.length;c++)for(var f=h[c],d=f.start,m=d,v=d+f.count;m<v;m+=3)void 0!==n?l(n[m],n[m+1],n[m+2],f.materialIndex):l(m,m+1,m+2,f.materialIndex);else if(void 0!==n)for(c=0;c<n.length;c+=3)l(n[c],n[c+1],n[c+2]);else for(c=0;c<i.length/3;c+=3)l(c,c+1,c+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Be).negate(),this.translate(Be.x,Be.y,Be.z),this},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,n=0===e?1:1/e,r=new R;return r.set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),this.applyMatrix4(r),this},computeFaceNormals:function(){for(var t=new S,e=new S,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],a=this.vertices[i.a],o=this.vertices[i.b],s=this.vertices[i.c];t.subVectors(s,o),e.subVectors(a,o),t.cross(e),t.normalize(),i.normal.copy(t)}},computeVertexNormals:function(t){var e,n,r,i,a,o;for(void 0===t&&(t=!0),o=new Array(this.vertices.length),e=0,n=this.vertices.length;e<n;e++)o[e]=new S;if(t){var s,u,c,l=new S,h=new S;for(r=0,i=this.faces.length;r<i;r++)a=this.faces[r],s=this.vertices[a.a],u=this.vertices[a.b],c=this.vertices[a.c],l.subVectors(c,u),h.subVectors(s,u),l.cross(h),o[a.a].add(l),o[a.b].add(l),o[a.c].add(l)}else for(this.computeFaceNormals(),r=0,i=this.faces.length;r<i;r++)o[(a=this.faces[r]).a].add(a.normal),o[a.b].add(a.normal),o[a.c].add(a.normal);for(e=0,n=this.vertices.length;e<n;e++)o[e].normalize();for(r=0,i=this.faces.length;r<i;r++){var p=(a=this.faces[r]).vertexNormals;3===p.length?(p[0].copy(o[a.a]),p[1].copy(o[a.b]),p[2].copy(o[a.c])):(p[0]=o[a.a].clone(),p[1]=o[a.b].clone(),p[2]=o[a.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e,n;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){var r=(n=this.faces[t]).vertexNormals;3===r.length?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,n,r,i;for(n=0,r=this.faces.length;n<r;n++)for((i=this.faces[n]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),t=0,e=i.vertexNormals.length;t<e;t++)i.__originalVertexNormals[t]?i.__originalVertexNormals[t].copy(i.vertexNormals[t]):i.__originalVertexNormals[t]=i.vertexNormals[t].clone();var a=new ze;for(a.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var o=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(n=0,r=this.faces.length;n<r;n++)u=new S,c={a:new S,b:new S,c:new S},o.push(u),s.push(c)}var u,c,l=this.morphNormals[t];for(a.vertices=this.morphTargets[t].vertices,a.computeFaceNormals(),a.computeVertexNormals(),n=0,r=this.faces.length;n<r;n++)i=this.faces[n],u=l.faceNormals[n],c=l.vertexNormals[n],u.copy(i.normal),c.a.copy(i.vertexNormals[0]),c.b.copy(i.vertexNormals[1]),c.c.copy(i.vertexNormals[2])}for(n=0,r=this.faces.length;n<r;n++)(i=this.faces[n]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new lt),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new ft),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,n){if(t&&t.isGeometry){var r,i=this.vertices.length,a=this.vertices,o=t.vertices,s=this.faces,u=t.faces,c=this.colors,l=t.colors;void 0===n&&(n=0),void 0!==e&&(r=(new f).getNormalMatrix(e));for(var h=0,p=o.length;h<p;h++){var d=o[h].clone();void 0!==e&&d.applyMatrix4(e),a.push(d)}for(h=0,p=l.length;h<p;h++)c.push(l[h].clone());for(h=0,p=u.length;h<p;h++){var m,v,g,y=u[h],x=y.vertexNormals,b=y.vertexColors;(m=new Ht(y.a+i,y.b+i,y.c+i)).normal.copy(y.normal),void 0!==r&&m.normal.applyMatrix3(r).normalize();for(var w=0,_=x.length;w<_;w++)v=x[w].clone(),void 0!==r&&v.applyMatrix3(r).normalize(),m.vertexNormals.push(v);m.color.copy(y.color);for(w=0,_=b.length;w<_;w++)g=b[w],m.vertexColors.push(g.clone());m.materialIndex=y.materialIndex+n,s.push(m)}for(h=0,p=t.faceVertexUvs.length;h<p;h++){var S=t.faceVertexUvs[h];void 0===this.faceVertexUvs[h]&&(this.faceVertexUvs[h]=[]);for(w=0,_=S.length;w<_;w++){for(var M=S[w],E=[],T=0,C=M.length;T<C;T++)E.push(M[T].clone());this.faceVertexUvs[h].push(E)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){var t,e,n,r,i,a,o,s,u={},c=[],l=[],h=Math.pow(10,4);for(n=0,r=this.vertices.length;n<r;n++)t=this.vertices[n],void 0===u[e=Math.round(t.x*h)+"_"+Math.round(t.y*h)+"_"+Math.round(t.z*h)]?(u[e]=n,c.push(this.vertices[n]),l[n]=c.length-1):l[n]=l[u[e]];var p=[];for(n=0,r=this.faces.length;n<r;n++){(i=this.faces[n]).a=l[i.a],i.b=l[i.b],i.c=l[i.c],a=[i.a,i.b,i.c];for(var f=0;f<3;f++)if(a[f]===a[(f+1)%3]){p.push(n);break}}for(n=p.length-1;n>=0;n--){var d=p[n];for(this.faces.splice(d,1),o=0,s=this.faceVertexUvs.length;o<s;o++)this.faceVertexUvs[o].splice(d,1)}var m=this.vertices.length-c.length;return this.vertices=c,m},setFromPoints:function(t){this.vertices=[];for(var e=0,n=t.length;e<n;e++){var r=t[e];this.vertices.push(new S(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,n=0;n<e;n++)t[n]._id=n;t.sort((function(t,e){return t.materialIndex-e.materialIndex}));var r,i,a=this.faceVertexUvs[0],o=this.faceVertexUvs[1];a&&a.length===e&&(r=[]),o&&o.length===e&&(i=[]);for(n=0;n<e;n++){var s=t[n]._id;r&&r.push(a[s]),i&&i.push(o[s])}r&&(this.faceVertexUvs[0]=r),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}for(var r=[],i=0;i<this.vertices.length;i++){var a=this.vertices[i];r.push(a.x,a.y,a.z)}var o=[],s=[],u={},c=[],l={},h=[],p={};for(i=0;i<this.faces.length;i++){var f=this.faces[i],d=void 0!==this.faceVertexUvs[0][i],m=f.normal.length()>0,v=f.vertexNormals.length>0,g=1!==f.color.r||1!==f.color.g||1!==f.color.b,y=f.vertexColors.length>0,x=0;if(x=S(x,0,0),x=S(x,1,!0),x=S(x,2,!1),x=S(x,3,d),x=S(x,4,m),x=S(x,5,v),x=S(x,6,g),x=S(x,7,y),o.push(x),o.push(f.a,f.b,f.c),o.push(f.materialIndex),d){var b=this.faceVertexUvs[0][i];o.push(T(b[0]),T(b[1]),T(b[2]))}if(m&&o.push(M(f.normal)),v){var w=f.vertexNormals;o.push(M(w[0]),M(w[1]),M(w[2]))}if(g&&o.push(E(f.color)),y){var _=f.vertexColors;o.push(E(_[0]),E(_[1]),E(_[2]))}}function S(t,e,n){return n?t|1<<e:t&~(1<<e)}function M(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==u[e]||(u[e]=s.length/3,s.push(t.x,t.y,t.z)),u[e]}function E(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==l[e]||(l[e]=c.length,c.push(t.getHex())),l[e]}function T(t){var e=t.x.toString()+t.y.toString();return void 0!==p[e]||(p[e]=h.length/2,h.push(t.x,t.y)),p[e]}return t.data={},t.data.vertices=r,t.data.normals=s,c.length>0&&(t.data.colors=c),h.length>0&&(t.data.uvs=[h]),t.data.faces=o,t},clone:function(){return(new ze).copy(this)},copy:function(t){var e,n,r,i,a,o;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var s=t.vertices;for(e=0,n=s.length;e<n;e++)this.vertices.push(s[e].clone());var u=t.colors;for(e=0,n=u.length;e<n;e++)this.colors.push(u[e].clone());var c=t.faces;for(e=0,n=c.length;e<n;e++)this.faces.push(c[e].clone());for(e=0,n=t.faceVertexUvs.length;e<n;e++){var l=t.faceVertexUvs[e];for(void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]),r=0,i=l.length;r<i;r++){var h=l[r],p=[];for(a=0,o=h.length;a<o;a++){var f=h[a];p.push(f.clone())}this.faceVertexUvs[e].push(p)}}var d=t.morphTargets;for(e=0,n=d.length;e<n;e++){var m={};if(m.name=d[e].name,void 0!==d[e].vertices)for(m.vertices=[],r=0,i=d[e].vertices.length;r<i;r++)m.vertices.push(d[e].vertices[r].clone());if(void 0!==d[e].normals)for(m.normals=[],r=0,i=d[e].normals.length;r<i;r++)m.normals.push(d[e].normals[r].clone());this.morphTargets.push(m)}var v=t.morphNormals;for(e=0,n=v.length;e<n;e++){var g={};if(void 0!==v[e].vertexNormals)for(g.vertexNormals=[],r=0,i=v[e].vertexNormals.length;r<i;r++){var y=v[e].vertexNormals[r],x={};x.a=y.a.clone(),x.b=y.b.clone(),x.c=y.c.clone(),g.vertexNormals.push(x)}if(void 0!==v[e].faceNormals)for(g.faceNormals=[],r=0,i=v[e].faceNormals.length;r<i;r++)g.faceNormals.push(v[e].faceNormals[r].clone());this.morphNormals.push(g)}var b=t.skinWeights;for(e=0,n=b.length;e<n;e++)this.skinWeights.push(b[e].clone());var w=t.skinIndices;for(e=0,n=w.length;e<n;e++)this.skinIndices.push(w[e].clone());var _=t.lineDistances;for(e=0,n=_.length;e<n;e++)this.lineDistances.push(_[e]);var S=t.boundingBox;null!==S&&(this.boundingBox=S.clone());var M=t.boundingSphere;return null!==M&&(this.boundingSphere=M.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class Ue extends de{constructor(t,e,n,r,i,a){super(),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:a};var o=this;t=t||1,e=e||1,n=n||1,r=Math.floor(r)||1,i=Math.floor(i)||1,a=Math.floor(a)||1;var s=[],u=[],c=[],l=[],h=0,p=0;function f(t,e,n,r,i,a,f,d,m,v,g){var y,x,b=a/m,w=f/v,_=a/2,M=f/2,E=d/2,T=m+1,C=v+1,A=0,N=0,I=new S;for(x=0;x<C;x++){var R=x*w-M;for(y=0;y<T;y++){var O=y*b-_;I[t]=O*r,I[e]=R*i,I[n]=E,u.push(I.x,I.y,I.z),I[t]=0,I[e]=0,I[n]=d>0?1:-1,c.push(I.x,I.y,I.z),l.push(y/m),l.push(1-x/v),A+=1}}for(x=0;x<v;x++)for(y=0;y<m;y++){var k=h+y+T*x,L=h+y+T*(x+1),D=h+(y+1)+T*(x+1),P=h+(y+1)+T*x;s.push(k,L,P),s.push(L,D,P),N+=6}o.addGroup(p,N,g),p+=N,h+=A}f("z","y","x",-1,-1,n,e,t,a,i,0),f("z","y","x",1,-1,n,e,-t,a,i,1),f("x","z","y",1,1,t,n,e,r,a,2),f("x","z","y",1,-1,t,n,-e,r,a,3),f("x","y","z",1,-1,t,e,n,r,i,4),f("x","y","z",-1,-1,t,e,-n,r,i,5),this.setIndex(s),this.setAttribute("position",new re(u,3)),this.setAttribute("normal",new re(c,3)),this.setAttribute("uv",new re(l,2))}}function je(t){var e={};for(var n in t)for(var r in e[n]={},t[n]){var i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}return e}function We(t){for(var e={},n=0;n<t.length;n++){var r=je(t[n]);for(var i in r)e[i]=r[i]}return e}var Ve={clone:je,merge:We};function He(t){qt.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function Ge(){Y.call(this),this.type="Camera",this.matrixWorldInverse=new R,this.projectionMatrix=new R,this.projectionMatrixInverse=new R}function qe(t,e,n,r){Ge.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}He.prototype=Object.create(qt.prototype),He.prototype.constructor=He,He.prototype.isShaderMaterial=!0,He.prototype.copy=function(t){return qt.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=je(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},He.prototype.toJSON=function(t){var e=qt.prototype.toJSON.call(this,t);for(var n in e.uniforms={},this.uniforms){var r=this.uniforms[n].value;r&&r.isTexture?e.uniforms[n]={type:"t",value:r.toJSON(t).uuid}:r&&r.isColor?e.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?e.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?e.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?e.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?e.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?e.uniforms[n]={type:"m4",value:r.toArray()}:e.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;var i={};for(var a in this.extensions)!0===this.extensions[a]&&(i[a]=!0);return Object.keys(i).length>0&&(e.extensions=i),e},Ge.prototype=Object.assign(Object.create(Y.prototype),{constructor:Ge,isCamera:!0,copy:function(t,e){return Y.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new S),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()},updateMatrixWorld:function(t){Y.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(t,e){Y.prototype.updateWorldMatrix.call(this,t,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),qe.prototype=Object.assign(Object.create(Ge.prototype),{constructor:qe,isPerspectiveCamera:!0,copy:function(t,e){return Ge.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*h.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*h.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*h.RAD2DEG*Math.atan(Math.tan(.5*h.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,r,i,a){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*h.DEG2RAD*this.fov)/this.zoom,n=2*e,r=this.aspect*n,i=-.5*r,a=this.view;if(null!==this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;i+=a.offsetX*r/o,e-=a.offsetY*n/s,r*=a.width/o,n*=a.height/s}var u=this.filmOffset;0!==u&&(i+=t*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,e,e-n,t,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){var e=Y.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}});function Xe(t,e,n,r){Y.call(this),this.type="CubeCamera";var a=new qe(90,1,t,e);a.up.set(0,-1,0),a.lookAt(new S(1,0,0)),this.add(a);var o=new qe(90,1,t,e);o.up.set(0,-1,0),o.lookAt(new S(-1,0,0)),this.add(o);var s=new qe(90,1,t,e);s.up.set(0,0,1),s.lookAt(new S(0,1,0)),this.add(s);var u=new qe(90,1,t,e);u.up.set(0,0,-1),u.lookAt(new S(0,-1,0)),this.add(u);var c=new qe(90,1,t,e);c.up.set(0,-1,0),c.lookAt(new S(0,0,1)),this.add(c);var l=new qe(90,1,t,e);l.up.set(0,-1,0),l.lookAt(new S(0,0,-1)),this.add(l),r=r||{format:1022,magFilter:i,minFilter:i},this.renderTarget=new $e(n,r),this.renderTarget.texture.name="CubeCamera",this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var n=t.getRenderTarget(),r=this.renderTarget,i=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,t.setRenderTarget(r,0),t.render(e,a),t.setRenderTarget(r,1),t.render(e,o),t.setRenderTarget(r,2),t.render(e,s),t.setRenderTarget(r,3),t.render(e,u),t.setRenderTarget(r,4),t.render(e,c),r.texture.generateMipmaps=i,t.setRenderTarget(r,5),t.render(e,l),t.setRenderTarget(n)},this.clear=function(t,e,n,r){for(var i=t.getRenderTarget(),a=this.renderTarget,o=0;o<6;o++)t.setRenderTarget(a,o),t.clear(e,n,r);t.setRenderTarget(i)}}function $e(t,e,n){Number.isInteger(e)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=n),y.call(this,t,t,e)}function Ye(t,e,n,r,i,a,o,s,u,c,l,h){v.call(this,null,a,o,s,u,c,r,i,l,h),this.image={data:t||null,width:e||1,height:n||1},this.magFilter=void 0!==u?u:1003,this.minFilter=void 0!==c?c:1003,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}Xe.prototype=Object.create(Y.prototype),Xe.prototype.constructor=Xe,$e.prototype=Object.create(y.prototype),$e.prototype.constructor=$e,$e.prototype.isWebGLCubeRenderTarget=!0,$e.prototype.fromEquirectangularTexture=function(t,e){this.texture.type=e.type,this.texture.format=e.format,this.texture.encoding=e.encoding;var n=new K,r={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","\tvWorldDirection = transformDirection( position, modelMatrix );","\t#include <begin_vertex>","\t#include <project_vertex>","}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#define RECIPROCAL_PI 0.31830988618","#define RECIPROCAL_PI2 0.15915494","void main() {","\tvec3 direction = normalize( vWorldDirection );","\tvec2 sampleUV;","\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;","\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","\tgl_FragColor = texture2D( tEquirect, sampleUV );","}"].join("\n")},i=new He({type:"CubemapFromEquirect",uniforms:je(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:1,blending:0});i.uniforms.tEquirect.value=e;var a=new Oe(new Ue(5,5,5),i);n.add(a);var o=new Xe(1,10,1);return o.renderTarget=this,o.renderTarget.texture.name="CubeCameraTexture",o.update(t,n),a.geometry.dispose(),a.material.dispose(),this},Ye.prototype=Object.create(v.prototype),Ye.prototype.constructor=Ye,Ye.prototype.isDataTexture=!0;var Ke=new ft,Je=new S;function Ze(t,e,n,r,i,a){this.planes=[void 0!==t?t:new Et,void 0!==e?e:new Et,void 0!==n?n:new Et,void 0!==r?r:new Et,void 0!==i?i:new Et,void 0!==a?a:new Et]}Object.assign(Ze.prototype,{set:function(t,e,n,r,i,a){var o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(n),o[3].copy(r),o[4].copy(i),o[5].copy(a),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,n=0;n<6;n++)e[n].copy(t.planes[n]);return this},setFromProjectionMatrix:function(t){var e=this.planes,n=t.elements,r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],u=n[5],c=n[6],l=n[7],h=n[8],p=n[9],f=n[10],d=n[11],m=n[12],v=n[13],g=n[14],y=n[15];return e[0].setComponents(o-r,l-s,d-h,y-m).normalize(),e[1].setComponents(o+r,l+s,d+h,y+m).normalize(),e[2].setComponents(o+i,l+u,d+p,y+v).normalize(),e[3].setComponents(o-i,l-u,d-p,y-v).normalize(),e[4].setComponents(o-a,l-c,d-f,y-g).normalize(),e[5].setComponents(o+a,l+c,d+f,y+g).normalize(),this},intersectsObject:function(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Ke.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Ke)},intersectsSprite:function(t){return Ke.center.set(0,0,0),Ke.radius=.7071067811865476,Ke.applyMatrix4(t.matrixWorld),this.intersectsSphere(Ke)},intersectsSphere:function(t){for(var e=this.planes,n=t.center,r=-t.radius,i=0;i<6;i++){if(e[i].distanceToPoint(n)<r)return!1}return!0},intersectsBox:function(t){for(var e=this.planes,n=0;n<6;n++){var r=e[n];if(Je.x=r.normal.x>0?t.max.x:t.min.x,Je.y=r.normal.y>0?t.max.y:t.min.y,Je.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(Je)<0)return!1}return!0},containsPoint:function(t){for(var e=this.planes,n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}});var Qe={common:{diffuse:{value:new Ut(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new f},uv2Transform:{value:new f},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new p(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ut(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Ut(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new f}},sprite:{diffuse:{value:new Ut(15658734)},opacity:{value:1},center:{value:new p(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new f}}};function tn(){var t=null,e=!1,n=null;function r(i,a){!1!==e&&(n(i,a),t.requestAnimationFrame(r))}return{start:function(){!0!==e&&null!==n&&(t.requestAnimationFrame(r),e=!0)},stop:function(){e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}function en(t,e){var n=e.isWebGL2,r=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),r.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);var n=r.get(e);n&&(t.deleteBuffer(n.buffer),r.delete(e))},update:function(e,i){e.isInterleavedBufferAttribute&&(e=e.data);var a=r.get(e);void 0===a?r.set(e,function(e,n){var r=e.array,i=e.usage,a=t.createBuffer();t.bindBuffer(n,a),t.bufferData(n,r,i),e.onUploadCallback();var o=5126;return r instanceof Float32Array?o=5126:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?o=5123:r instanceof Int16Array?o=5122:r instanceof Uint32Array?o=5125:r instanceof Int32Array?o=5124:r instanceof Int8Array?o=5120:r instanceof Uint8Array&&(o=5121),{buffer:a,type:o,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version}}(e,i)):a.version<e.version&&(!function(e,r,i){var a=r.array,o=r.updateRange;t.bindBuffer(i,e),-1===o.count?t.bufferSubData(i,0,a):(n?t.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a,o.offset,o.count):t.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a.subarray(o.offset,o.offset+o.count)),o.count=-1)}(a.buffer,e,i),a.version=e.version)}}}function nn(t,e,n,r){ze.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new rn(t,e,n,r)),this.mergeVertices()}function rn(t,e,n,r){de.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};var i,a,o=(t=t||1)/2,s=(e=e||1)/2,u=Math.floor(n)||1,c=Math.floor(r)||1,l=u+1,h=c+1,p=t/u,f=e/c,d=[],m=[],v=[],g=[];for(a=0;a<h;a++){var y=a*f-s;for(i=0;i<l;i++){var x=i*p-o;m.push(x,-y,0),v.push(0,0,1),g.push(i/u),g.push(1-a/c)}}for(a=0;a<c;a++)for(i=0;i<u;i++){var b=i+l*a,w=i+l*(a+1),_=i+1+l*(a+1),S=i+1+l*a;d.push(b,w,S),d.push(w,_,S)}this.setIndex(d),this.setAttribute("position",new re(m,3)),this.setAttribute("normal",new re(v,3)),this.setAttribute("uv",new re(g,2))}nn.prototype=Object.create(ze.prototype),nn.prototype.constructor=nn,rn.prototype=Object.create(de.prototype),rn.prototype.constructor=rn;var an={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n  return m[ 2 ][ 3 ] == - 1.0;\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);\n    } else if (face == 1.0) {\n      uv = vec2(direction.x, -direction.z) / abs(direction.y);\n    } else if (face == 2.0) {\n      uv = direction.xy / abs(direction.z);\n    } else if (face == 3.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);\n    } else if (face == 4.0) {\n      uv = direction.xz / abs(direction.y);\n    } else {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);\n    }\n    return 0.5 * (uv + 1.0);\n}\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);  }\n  return mip;\n}\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\ttransformedNormal = mat3( instanceMatrix ) * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t}  else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) { \n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = saturate( clearcoat );\tmaterial.clearcoatRoughness = max( clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tdirectLight.color *= all( bvec3( pointLight.shadow, directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tdirectLight.color *= all( bvec3( spotLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectLight.color *= all( bvec3( directionalLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_normalmap_pars_fragment:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= all( bvec2( directionalLight.shadow, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= all( bvec2( spotLight.shadow, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= all( bvec2( pointLight.shadow, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n\tuniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSPARENCY\n\t\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},on={basic:{uniforms:We([Qe.common,Qe.specularmap,Qe.envmap,Qe.aomap,Qe.lightmap,Qe.fog]),vertexShader:an.meshbasic_vert,fragmentShader:an.meshbasic_frag},lambert:{uniforms:We([Qe.common,Qe.specularmap,Qe.envmap,Qe.aomap,Qe.lightmap,Qe.emissivemap,Qe.fog,Qe.lights,{emissive:{value:new Ut(0)}}]),vertexShader:an.meshlambert_vert,fragmentShader:an.meshlambert_frag},phong:{uniforms:We([Qe.common,Qe.specularmap,Qe.envmap,Qe.aomap,Qe.lightmap,Qe.emissivemap,Qe.bumpmap,Qe.normalmap,Qe.displacementmap,Qe.fog,Qe.lights,{emissive:{value:new Ut(0)},specular:{value:new Ut(1118481)},shininess:{value:30}}]),vertexShader:an.meshphong_vert,fragmentShader:an.meshphong_frag},standard:{uniforms:We([Qe.common,Qe.envmap,Qe.aomap,Qe.lightmap,Qe.emissivemap,Qe.bumpmap,Qe.normalmap,Qe.displacementmap,Qe.roughnessmap,Qe.metalnessmap,Qe.fog,Qe.lights,{emissive:{value:new Ut(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:an.meshphysical_vert,fragmentShader:an.meshphysical_frag},toon:{uniforms:We([Qe.common,Qe.specularmap,Qe.aomap,Qe.lightmap,Qe.emissivemap,Qe.bumpmap,Qe.normalmap,Qe.displacementmap,Qe.gradientmap,Qe.fog,Qe.lights,{emissive:{value:new Ut(0)},specular:{value:new Ut(1118481)},shininess:{value:30}}]),vertexShader:an.meshtoon_vert,fragmentShader:an.meshtoon_frag},matcap:{uniforms:We([Qe.common,Qe.bumpmap,Qe.normalmap,Qe.displacementmap,Qe.fog,{matcap:{value:null}}]),vertexShader:an.meshmatcap_vert,fragmentShader:an.meshmatcap_frag},points:{uniforms:We([Qe.points,Qe.fog]),vertexShader:an.points_vert,fragmentShader:an.points_frag},dashed:{uniforms:We([Qe.common,Qe.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:an.linedashed_vert,fragmentShader:an.linedashed_frag},depth:{uniforms:We([Qe.common,Qe.displacementmap]),vertexShader:an.depth_vert,fragmentShader:an.depth_frag},normal:{uniforms:We([Qe.common,Qe.bumpmap,Qe.normalmap,Qe.displacementmap,{opacity:{value:1}}]),vertexShader:an.normal_vert,fragmentShader:an.normal_frag},sprite:{uniforms:We([Qe.sprite,Qe.fog]),vertexShader:an.sprite_vert,fragmentShader:an.sprite_frag},background:{uniforms:{uvTransform:{value:new f},t2D:{value:null}},vertexShader:an.background_vert,fragmentShader:an.background_frag},cube:{uniforms:We([Qe.envmap,{opacity:{value:1}}]),vertexShader:an.cube_vert,fragmentShader:an.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:an.equirect_vert,fragmentShader:an.equirect_frag},distanceRGBA:{uniforms:We([Qe.common,Qe.displacementmap,{referencePosition:{value:new S},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:an.distanceRGBA_vert,fragmentShader:an.distanceRGBA_frag},shadow:{uniforms:We([Qe.lights,Qe.fog,{color:{value:new Ut(0)},opacity:{value:1}}]),vertexShader:an.shadow_vert,fragmentShader:an.shadow_frag}};function sn(t,e,n,r){var i,a,o=new Ut(0),s=0,u=null,c=0,l=null;function h(t,n){e.buffers.color.setClear(t.r,t.g,t.b,n,r)}return{getClearColor:function(){return o},setClearColor:function(t,e){o.set(t),h(o,s=void 0!==e?e:1)},getClearAlpha:function(){return s},setClearAlpha:function(t){h(o,s=t)},render:function(e,r,p,f){var d=r.background,m=t.xr,v=m.getSession&&m.getSession();if(v&&"additive"===v.environmentBlendMode&&(d=null),null===d?h(o,s):d&&d.isColor&&(h(d,1),f=!0),(t.autoClear||f)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),d&&(d.isCubeTexture||d.isWebGLCubeRenderTarget||306===d.mapping)){void 0===a&&((a=new Oe(new Ue(1,1,1),new He({type:"BackgroundCubeMaterial",uniforms:je(on.cube.uniforms),vertexShader:on.cube.vertexShader,fragmentShader:on.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),a.geometry.deleteAttribute("uv"),a.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(a.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(a));var g=d.isWebGLCubeRenderTarget?d.texture:d;a.material.uniforms.envMap.value=g,a.material.uniforms.flipEnvMap.value=g.isCubeTexture?-1:1,u===d&&c===g.version&&l===t.toneMapping||(a.material.needsUpdate=!0,u=d,c=g.version,l=t.toneMapping),e.unshift(a,a.geometry,a.material,0,0,null)}else d&&d.isTexture&&(void 0===i&&((i=new Oe(new rn(2,2),new He({type:"BackgroundMaterial",uniforms:je(on.background.uniforms),vertexShader:on.background.vertexShader,fragmentShader:on.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(i.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(i)),i.material.uniforms.t2D.value=d,!0===d.matrixAutoUpdate&&d.updateMatrix(),i.material.uniforms.uvTransform.value.copy(d.matrix),u===d&&c===d.version&&l===t.toneMapping||(i.material.needsUpdate=!0,u=d,c=d.version,l=t.toneMapping),e.unshift(i,i.geometry,i.material,0,0,null))}}}function un(t,e,n,r){var i,a=r.isWebGL2;this.setMode=function(t){i=t},this.render=function(e,r){t.drawArrays(i,e,r),n.update(r,i)},this.renderInstances=function(r,o,s,u){if(0!==u){var c,l;if(a)c=t,l="drawArraysInstanced";else if(l="drawArraysInstancedANGLE",null===(c=e.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[l](i,o,s,u),n.update(s,i,u)}}}function cn(t,e,n){var r;function i(e){if("highp"===e){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var a="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext,o=void 0!==n.precision?n.precision:"highp",s=i(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);var u=!0===n.logarithmicDepthBuffer,c=t.getParameter(34930),l=t.getParameter(35660),h=t.getParameter(3379),p=t.getParameter(34076),f=t.getParameter(34921),d=t.getParameter(36347),m=t.getParameter(36348),v=t.getParameter(36349),g=l>0,y=a||!!e.get("OES_texture_float");return{isWebGL2:a,getMaxAnisotropy:function(){if(void 0!==r)return r;var n=e.get("EXT_texture_filter_anisotropic");return r=null!==n?t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:o,logarithmicDepthBuffer:u,maxTextures:c,maxVertexTextures:l,maxTextureSize:h,maxCubemapSize:p,maxAttributes:f,maxVertexUniforms:d,maxVaryings:m,maxFragmentUniforms:v,vertexTextures:g,floatFragmentTextures:y,floatVertexTextures:g&&y,maxSamples:a?t.getParameter(36183):0}}function ln(){var t=this,e=null,n=0,r=!1,i=!1,a=new Et,o=new f,s={value:null,needsUpdate:!1};function u(){s.value!==e&&(s.value=e,s.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function c(e,n,r,i){var u=null!==e?e.length:0,c=null;if(0!==u){if(c=s.value,!0!==i||null===c){var l=r+4*u,h=n.matrixWorldInverse;o.getNormalMatrix(h),(null===c||c.length<l)&&(c=new Float32Array(l));for(var p=0,f=r;p!==u;++p,f+=4)a.copy(e[p]).applyMatrix4(h,o),a.normal.toArray(c,f),c[f+3]=a.constant}s.value=c,s.needsUpdate=!0}return t.numPlanes=u,c}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(t,i,a){var o=0!==t.length||i||0!==n||r;return r=i,e=c(t,a,0),n=t.length,o},this.beginShadows=function(){i=!0,c(null)},this.endShadows=function(){i=!1,u()},this.setState=function(t,a,o,l,h,p){if(!r||null===t||0===t.length||i&&!o)i?c(null):u();else{var f=i?0:n,d=4*f,m=h.clippingState||null;s.value=m,m=c(t,l,d,p);for(var v=0;v!==d;++v)m[v]=e[v];h.clippingState=m,this.numIntersection=a?this.numPlanes:0,this.numPlanes+=f}}}function hn(t){var e={};return{get:function(n){if(void 0!==e[n])return e[n];var r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(n)}return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),e[n]=r,r}}}function pn(t,e,n){var r=new WeakMap,i=new WeakMap;function a(t){var o=t.target,s=r.get(o);for(var u in null!==s.index&&e.remove(s.index),s.attributes)e.remove(s.attributes[u]);o.removeEventListener("dispose",a),r.delete(o);var c=i.get(s);c&&(e.remove(c),i.delete(s)),n.memory.geometries--}function o(t){var n=[],r=t.index,a=t.attributes.position,o=0;if(null!==r){var s=r.array;o=r.version;for(var u=0,c=s.length;u<c;u+=3){var l=s[u+0],h=s[u+1],p=s[u+2];n.push(l,h,h,p,p,l)}}else{s=a.array;o=a.version;for(u=0,c=s.length/3-1;u<c;u+=3){l=u+0,h=u+1,p=u+2;n.push(l,h,h,p,p,l)}}var f=new(oe(n)>65535?ne:te)(n,1);f.version=o,e.update(f,34963);var d=i.get(t);d&&e.remove(d),i.set(t,f)}return{get:function(t,e){var i=r.get(e);return i||(e.addEventListener("dispose",a),e.isBufferGeometry?i=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new de).setFromObject(t)),i=e._bufferGeometry),r.set(e,i),n.memory.geometries++,i)},update:function(t){var n=t.index,r=t.attributes;for(var i in null!==n&&e.update(n,34963),r)e.update(r[i],34962);var a=t.morphAttributes;for(var i in a)for(var o=a[i],s=0,u=o.length;s<u;s++)e.update(o[s],34962)},getWireframeAttribute:function(t){var e=i.get(t);if(e){var n=t.index;null!==n&&e.version<n.version&&o(t)}else o(t);return i.get(t)}}}function fn(t,e,n,r){var i,a,o,s=r.isWebGL2;this.setMode=function(t){i=t},this.setIndex=function(t){a=t.type,o=t.bytesPerElement},this.render=function(e,r){t.drawElements(i,r,a,e*o),n.update(r,i)},this.renderInstances=function(r,u,c,l){if(0!==l){var h,p;if(s)h=t,p="drawElementsInstanced";else if(p="drawElementsInstancedANGLE",null===(h=e.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[p](i,c,a,u*o,l),n.update(c,i,l)}}}function dn(t){var e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,n,r){switch(r=r||1,e.calls++,n){case 4:e.triangles+=r*(t/3);break;case 1:e.lines+=r*(t/2);break;case 3:e.lines+=r*(t-1);break;case 2:e.lines+=r*t;break;case 0:e.points+=r*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function mn(t,e){return Math.abs(e[1])-Math.abs(t[1])}function vn(t){var e={},n=new Float32Array(8);return{update:function(r,i,a,o){var s=r.morphTargetInfluences,u=void 0===s?0:s.length,c=e[i.id];if(void 0===c){c=[];for(var l=0;l<u;l++)c[l]=[l,0];e[i.id]=c}var h=a.morphTargets&&i.morphAttributes.position,p=a.morphNormals&&i.morphAttributes.normal;for(l=0;l<u;l++){0!==(d=c[l])[1]&&(h&&i.deleteAttribute("morphTarget"+l),p&&i.deleteAttribute("morphNormal"+l))}for(l=0;l<u;l++){(d=c[l])[0]=l,d[1]=s[l]}c.sort(mn);var f=0;for(l=0;l<8;l++){var d;if(d=c[l]){var m=d[0],v=d[1];if(v){h&&i.setAttribute("morphTarget"+l,h[m]),p&&i.setAttribute("morphNormal"+l,p[m]),n[l]=v,f+=v;continue}}n[l]=0}var g=i.morphTargetsRelative?1:1-f;o.getUniforms().setValue(t,"morphTargetBaseInfluence",g),o.getUniforms().setValue(t,"morphTargetInfluences",n)}}}function gn(t,e,n,r){var i={};return{update:function(t){var a=r.render.frame,o=t.geometry,s=e.get(t,o);return i[s.id]!==a&&(o.isGeometry&&s.updateFromObject(t),e.update(s),i[s.id]=a),t.isInstancedMesh&&n.update(t.instanceMatrix,34962),s},dispose:function(){i={}}}}function yn(t,e,n,r,i,a,o,s,u,c){t=void 0!==t?t:[],e=void 0!==e?e:301,o=void 0!==o?o:1022,v.call(this,t,e,n,r,i,a,o,s,u,c),this.flipY=!1}function xn(t,e,n,r){v.call(this,null),this.image={data:t||null,width:e||1,height:n||1,depth:r||1},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function bn(t,e,n,r){v.call(this,null),this.image={data:t||null,width:e||1,height:n||1,depth:r||1},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}on.physical={uniforms:We([on.standard.uniforms,{transparency:{value:0},clearcoat:{value:0},clearcoatRoughness:{value:0},sheen:{value:new Ut(0)},clearcoatNormalScale:{value:new p(1,1)},clearcoatNormalMap:{value:null}}]),vertexShader:an.meshphysical_vert,fragmentShader:an.meshphysical_frag},yn.prototype=Object.create(v.prototype),yn.prototype.constructor=yn,yn.prototype.isCubeTexture=!0,Object.defineProperty(yn.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),xn.prototype=Object.create(v.prototype),xn.prototype.constructor=xn,xn.prototype.isDataTexture2DArray=!0,bn.prototype=Object.create(v.prototype),bn.prototype.constructor=bn,bn.prototype.isDataTexture3D=!0;var wn=new v,_n=new xn,Sn=new bn,Mn=new yn,En=[],Tn=[],Cn=new Float32Array(16),An=new Float32Array(9),Nn=new Float32Array(4);function In(t,e,n){var r=t[0];if(r<=0||r>0)return t;var i=e*n,a=En[i];if(void 0===a&&(a=new Float32Array(i),En[i]=a),0!==e){r.toArray(a,0);for(var o=1,s=0;o!==e;++o)s+=n,t[o].toArray(a,s)}return a}function Rn(t,e){if(t.length!==e.length)return!1;for(var n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}function On(t,e){for(var n=0,r=e.length;n<r;n++)t[n]=e[n]}function kn(t,e){var n=Tn[e];void 0===n&&(n=new Int32Array(e),Tn[e]=n);for(var r=0;r!==e;++r)n[r]=t.allocateTextureUnit();return n}function Ln(t,e){var n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function Dn(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Rn(n,e))return;t.uniform2fv(this.addr,e),On(n,e)}}function Pn(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Rn(n,e))return;t.uniform3fv(this.addr,e),On(n,e)}}function Fn(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Rn(n,e))return;t.uniform4fv(this.addr,e),On(n,e)}}function Bn(t,e){var n=this.cache,r=e.elements;if(void 0===r){if(Rn(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),On(n,e)}else{if(Rn(n,r))return;Nn.set(r),t.uniformMatrix2fv(this.addr,!1,Nn),On(n,r)}}function zn(t,e){var n=this.cache,r=e.elements;if(void 0===r){if(Rn(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),On(n,e)}else{if(Rn(n,r))return;An.set(r),t.uniformMatrix3fv(this.addr,!1,An),On(n,r)}}function Un(t,e){var n=this.cache,r=e.elements;if(void 0===r){if(Rn(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),On(n,e)}else{if(Rn(n,r))return;Cn.set(r),t.uniformMatrix4fv(this.addr,!1,Cn),On(n,r)}}function jn(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(e||wn,i)}function Wn(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(e||_n,i)}function Vn(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(e||Sn,i)}function Hn(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(e||Mn,i)}function Gn(t,e){var n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function qn(t,e){var n=this.cache;Rn(n,e)||(t.uniform2iv(this.addr,e),On(n,e))}function Xn(t,e){var n=this.cache;Rn(n,e)||(t.uniform3iv(this.addr,e),On(n,e))}function $n(t,e){var n=this.cache;Rn(n,e)||(t.uniform4iv(this.addr,e),On(n,e))}function Yn(t,e){var n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function Kn(t,e){t.uniform1fv(this.addr,e)}function Jn(t,e){t.uniform1iv(this.addr,e)}function Zn(t,e){t.uniform2iv(this.addr,e)}function Qn(t,e){t.uniform3iv(this.addr,e)}function tr(t,e){t.uniform4iv(this.addr,e)}function er(t,e){var n=In(e,this.size,2);t.uniform2fv(this.addr,n)}function nr(t,e){var n=In(e,this.size,3);t.uniform3fv(this.addr,n)}function rr(t,e){var n=In(e,this.size,4);t.uniform4fv(this.addr,n)}function ir(t,e){var n=In(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function ar(t,e){var n=In(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function or(t,e){var n=In(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function sr(t,e,n){var r=e.length,i=kn(n,r);t.uniform1iv(this.addr,i);for(var a=0;a!==r;++a)n.safeSetTexture2D(e[a]||wn,i[a])}function ur(t,e,n){var r=e.length,i=kn(n,r);t.uniform1iv(this.addr,i);for(var a=0;a!==r;++a)n.safeSetTextureCube(e[a]||Mn,i[a])}function cr(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=function(t){switch(t){case 5126:return Ln;case 35664:return Dn;case 35665:return Pn;case 35666:return Fn;case 35674:return Bn;case 35675:return zn;case 35676:return Un;case 5124:case 35670:return Gn;case 35667:case 35671:return qn;case 35668:case 35672:return Xn;case 35669:case 35673:return $n;case 5125:return Yn;case 35678:case 36198:case 36298:case 36306:case 35682:return jn;case 35679:case 36299:case 36307:return Vn;case 35680:case 36300:case 36308:case 36293:return Hn;case 36289:case 36303:case 36311:case 36292:return Wn}}(e.type)}function lr(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return Kn;case 35664:return er;case 35665:return nr;case 35666:return rr;case 35674:return ir;case 35675:return ar;case 35676:return or;case 5124:case 35670:return Jn;case 35667:case 35671:return Zn;case 35668:case 35672:return Qn;case 35669:case 35673:return tr;case 35678:case 36198:case 36298:case 36306:case 35682:return sr;case 35680:case 36300:case 36308:case 36293:return ur}}(e.type)}function hr(t){this.id=t,this.seq=[],this.map={}}lr.prototype.updateCache=function(t){var e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),On(e,t)},hr.prototype.setValue=function(t,e,n){for(var r=this.seq,i=0,a=r.length;i!==a;++i){var o=r[i];o.setValue(t,e[o.id],n)}};var pr=/([\w\d_]+)(\])?(\[|\.)?/g;function fr(t,e){t.seq.push(e),t.map[e.id]=e}function dr(t,e,n){var r=t.name,i=r.length;for(pr.lastIndex=0;;){var a=pr.exec(r),o=pr.lastIndex,s=a[1],u="]"===a[2],c=a[3];if(u&&(s|=0),void 0===c||"["===c&&o+2===i){fr(n,void 0===c?new cr(s,t,e):new lr(s,t,e));break}var l=n.map[s];void 0===l&&fr(n,l=new hr(s)),n=l}}function mr(t,e){this.seq=[],this.map={};for(var n=t.getProgramParameter(e,35718),r=0;r<n;++r){var i=t.getActiveUniform(e,r);dr(i,t.getUniformLocation(e,i.name),this)}}function vr(t,e,n){var r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}mr.prototype.setValue=function(t,e,n,r){var i=this.map[e];void 0!==i&&i.setValue(t,n,r)},mr.prototype.setOptional=function(t,e,n){var r=e[n];void 0!==r&&this.setValue(t,n,r)},mr.upload=function(t,e,n,r){for(var i=0,a=e.length;i!==a;++i){var o=e[i],s=n[o.id];!1!==s.needsUpdate&&o.setValue(t,s.value,r)}},mr.seqWithValue=function(t,e){for(var n=[],r=0,i=t.length;r!==i;++r){var a=t[r];a.id in e&&n.push(a)}return n};var gr=0;function yr(t){switch(t){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:throw new Error("unsupported encoding: "+t)}}function xr(t,e,n){var r=t.getShaderParameter(e,35713),i=t.getShaderInfoLog(e).trim();return r&&""===i?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+i+function(t){for(var e=t.split("\n"),n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}(t.getShaderSource(e))}function br(t,e){var n=yr(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function wr(t,e){var n;switch(e){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="Uncharted2";break;case 4:n="OptimizedCineon";break;case 5:n="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function _r(t){return""!==t}function Sr(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Mr(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var Er=/^[ \t]*#include +<([\w\d./]+)>/gm;function Tr(t){return t.replace(Er,Cr)}function Cr(t,e){var n=an[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return Tr(n)}var Ar=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;function Nr(t){return t.replace(Ar,Ir)}function Ir(t,e,n,r){for(var i="",a=parseInt(e);a<parseInt(n);a++)i+=r.replace(/\[ i \]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function Rr(t){var e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function Or(t,e,n){var r,i,a,o,s,u=t.getContext(),c=n.defines,l=n.vertexShader,h=n.fragmentShader,p=function(t){var e="SHADOWMAP_TYPE_BASIC";return 1===t.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===t.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===t.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(n),f=function(t){var e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:case 307:e="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:e="ENVMAP_TYPE_EQUIREC";break;case 305:e="ENVMAP_TYPE_SPHERE"}return e}(n),d=function(t){var e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case 302:case 304:e="ENVMAP_MODE_REFRACTION"}return e}(n),m=function(t){var e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(n),v=t.gammaFactor>0?t.gammaFactor:1,g=n.isWebGL2?"":function(t){return[t.extensionDerivatives||t.envMapCubeUV||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(_r).join("\n")}(n),y=function(t){var e=[];for(var n in t){var r=t[n];!1!==r&&e.push("#define "+n+" "+r)}return e.join("\n")}(c),x=u.createProgram(),b=n.numMultiviewViews;if(n.isRawShaderMaterial?((r=[y].filter(_r).join("\n")).length>0&&(r+="\n"),(i=[g,y].filter(_r).join("\n")).length>0&&(i+="\n")):(r=[Rr(n),"#define SHADER_NAME "+n.shaderName,y,n.instancing?"#define USE_INSTANCING":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+v,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+d:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+p:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(_r).join("\n"),i=[g,Rr(n),"#define SHADER_NAME "+n.shaderName,y,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+v,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+f:"",n.envMap?"#define "+d:"",n.envMap?"#define "+m:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+p:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?an.tonemapping_pars_fragment:"",0!==n.toneMapping?wr("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.outputEncoding||n.mapEncoding||n.matcapEncoding||n.envMapEncoding||n.emissiveMapEncoding||n.lightMapEncoding?an.encodings_pars_fragment:"",n.mapEncoding?br("mapTexelToLinear",n.mapEncoding):"",n.matcapEncoding?br("matcapTexelToLinear",n.matcapEncoding):"",n.envMapEncoding?br("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMapEncoding?br("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMapEncoding?br("lightMapTexelToLinear",n.lightMapEncoding):"",n.outputEncoding?(a="linearToOutputTexel",o=n.outputEncoding,s=yr(o),"vec4 "+a+"( vec4 value ) { return LinearTo"+s[0]+s[1]+"; }"):"",n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(_r).join("\n")),l=Mr(l=Sr(l=Tr(l),n),n),h=Mr(h=Sr(h=Tr(h),n),n),l=Nr(l),h=Nr(h),n.isWebGL2&&!n.isRawShaderMaterial){var w=!1,_=/^\s*#version\s+300\s+es\s*\n/;n.isShaderMaterial&&null!==l.match(_)&&null!==h.match(_)&&(w=!0,l=l.replace(_,""),h=h.replace(_,"")),r=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+r,i=["#version 300 es\n","#define varying in",w?"":"out highp vec4 pc_fragColor;",w?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+i,b>0&&(r=(r=r.replace("#version 300 es\n",["#version 300 es\n","#extension GL_OVR_multiview2 : require","layout(num_views = "+b+") in;","#define VIEW_ID gl_ViewID_OVR"].join("\n"))).replace(["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;"].join("\n"),["uniform mat4 modelViewMatrices["+b+"];","uniform mat4 projectionMatrices["+b+"];","uniform mat4 viewMatrices["+b+"];","uniform mat3 normalMatrices["+b+"];","#define modelViewMatrix modelViewMatrices[VIEW_ID]","#define projectionMatrix projectionMatrices[VIEW_ID]","#define viewMatrix viewMatrices[VIEW_ID]","#define normalMatrix normalMatrices[VIEW_ID]"].join("\n")),i=(i=i.replace("#version 300 es\n",["#version 300 es\n","#extension GL_OVR_multiview2 : require","#define VIEW_ID gl_ViewID_OVR"].join("\n"))).replace("uniform mat4 viewMatrix;",["uniform mat4 viewMatrices["+b+"];","#define viewMatrix viewMatrices[VIEW_ID]"].join("\n")))}var S,M,E=i+h,T=vr(u,35633,r+l),C=vr(u,35632,E);if(u.attachShader(x,T),u.attachShader(x,C),void 0!==n.index0AttributeName?u.bindAttribLocation(x,0,n.index0AttributeName):!0===n.morphTargets&&u.bindAttribLocation(x,0,"position"),u.linkProgram(x),t.debug.checkShaderErrors){var A=u.getProgramInfoLog(x).trim(),N=u.getShaderInfoLog(T).trim(),I=u.getShaderInfoLog(C).trim(),R=!0,O=!0;if(!1===u.getProgramParameter(x,35714)){R=!1;var k=xr(u,T,"vertex"),L=xr(u,C,"fragment");console.error("THREE.WebGLProgram: shader error: ",u.getError(),"35715",u.getProgramParameter(x,35715),"gl.getProgramInfoLog",A,k,L)}else""!==A?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",A):""!==N&&""!==I||(O=!1);O&&(this.diagnostics={runnable:R,programLog:A,vertexShader:{log:N,prefix:r},fragmentShader:{log:I,prefix:i}})}return u.deleteShader(T),u.deleteShader(C),this.getUniforms=function(){return void 0===S&&(S=new mr(u,x)),S},this.getAttributes=function(){return void 0===M&&(M=function(t,e){for(var n={},r=t.getProgramParameter(e,35721),i=0;i<r;i++){var a=t.getActiveAttrib(e,i).name;n[a]=t.getAttribLocation(e,a)}return n}(u,x)),M},this.destroy=function(){u.deleteProgram(x),this.program=void 0},this.name=n.shaderName,this.id=gr++,this.cacheKey=e,this.usedTimes=1,this.program=x,this.vertexShader=T,this.fragmentShader=C,this.numMultiviewViews=b,this}function kr(t,e,n){var i=[],a=n.isWebGL2,o=n.logarithmicDepthBuffer,s=n.floatVertexTextures,u=n.precision,c=n.maxVertexUniforms,l=n.vertexTextures,h={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},p=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","numMultiviewViews","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen"];function f(t){var e;return t?t.isTexture?e=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),e=t.texture.encoding):e=3e3,e}this.getParameters=function(i,p,d,m,v,g,y){var x=m.fog,b=i.isMeshStandardMaterial?m.environment:null,w=i.envMap||b,_=h[i.type],S=y.isSkinnedMesh?function(t){var e=t.skeleton.bones;if(s)return 1024;var n=c,r=Math.floor((n-20)/4),i=Math.min(r,e.length);return i<e.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+e.length+" bones. This GPU supports "+i+"."),0):i}(y):0;null!==i.precision&&(u=n.getMaxPrecision(i.precision))!==i.precision&&console.warn("THREE.WebGLProgram.getParameters:",i.precision,"not supported, using",u,"instead.");var M=function(t,e){var n;if(e){var r=on[e];n={name:t.type,uniforms:Ve.clone(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader}}else n={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};return n}(i,_);i.onBeforeCompile(M,t);var E=t.getRenderTarget(),T=E&&E.isWebGLMultiviewRenderTarget?E.numViews:0;return{isWebGL2:a,shaderID:_,shaderName:M.name,uniforms:M.uniforms,vertexShader:M.vertexShader,fragmentShader:M.fragmentShader,defines:i.defines,isRawShaderMaterial:i.isRawShaderMaterial,isShaderMaterial:i.isShaderMaterial,precision:u,instancing:!0===y.isInstancedMesh,supportsVertexTextures:l,numMultiviewViews:T,outputEncoding:null!==E?f(E.texture):t.outputEncoding,map:!!i.map,mapEncoding:f(i.map),matcap:!!i.matcap,matcapEncoding:f(i.matcap),envMap:!!w,envMapMode:w&&w.mapping,envMapEncoding:f(w),envMapCubeUV:!!w&&(306===w.mapping||307===w.mapping),lightMap:!!i.lightMap,lightMapEncoding:f(i.lightMap),aoMap:!!i.aoMap,emissiveMap:!!i.emissiveMap,emissiveMapEncoding:f(i.emissiveMap),bumpMap:!!i.bumpMap,normalMap:!!i.normalMap,objectSpaceNormalMap:1===i.normalMapType,tangentSpaceNormalMap:0===i.normalMapType,clearcoatNormalMap:!!i.clearcoatNormalMap,displacementMap:!!i.displacementMap,roughnessMap:!!i.roughnessMap,metalnessMap:!!i.metalnessMap,specularMap:!!i.specularMap,alphaMap:!!i.alphaMap,gradientMap:!!i.gradientMap,sheen:!!i.sheen,combine:i.combine,vertexTangents:i.normalMap&&i.vertexTangents,vertexColors:i.vertexColors,vertexUvs:!!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatNormalMap||i.displacementMap),uvsVertexOnly:!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatNormalMap||!i.displacementMap),fog:!!x,useFog:i.fog,fogExp2:x&&x.isFogExp2,flatShading:i.flatShading,sizeAttenuation:i.sizeAttenuation,logarithmicDepthBuffer:o,skinning:i.skinning&&S>0,maxBones:S,useVertexTexture:s,morphTargets:i.morphTargets,morphNormals:i.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:p.directional.length,numPointLights:p.point.length,numSpotLights:p.spot.length,numRectAreaLights:p.rectArea.length,numHemiLights:p.hemi.length,numDirLightShadows:p.directionalShadowMap.length,numPointLightShadows:p.pointShadowMap.length,numSpotLightShadows:p.spotShadowMap.length,numClippingPlanes:v,numClipIntersection:g,dithering:i.dithering,shadowMapEnabled:t.shadowMap.enabled&&d.length>0,shadowMapType:t.shadowMap.type,toneMapping:i.toneMapped?t.toneMapping:0,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:i.premultipliedAlpha,alphaTest:i.alphaTest,doubleSided:i.side===r,flipSided:1===i.side,depthPacking:void 0!==i.depthPacking&&i.depthPacking,index0AttributeName:i.index0AttributeName,extensionDerivatives:i.extensions&&i.extensions.derivatives,extensionFragDepth:i.extensions&&i.extensions.frawbuffers,extensionDrawbuffers:i.extensions&&i.extensions.drawbuffers,extensionShaderTextureLOD:i.extensions&&i.extensions.shaderTextureLOD,rendererExtensionFragDepth:a||null!==e.get("EXT_frag_depth"),rendererExtensionDrawBuffers:a||null!==e.get("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:a||null!==e.get("EXT_shader_texture_lod"),onBeforeCompile:i.onBeforeCompile}},this.getProgramCacheKey=function(e){var n=[];if(e.shaderID?n.push(e.shaderID):(n.push(e.fragmentShader),n.push(e.vertexShader)),void 0!==e.defines)for(var r in e.defines)n.push(r),n.push(e.defines[r]);if(void 0===e.isRawShaderMaterial){for(var i=0;i<p.length;i++)n.push(e[p[i]]);n.push(t.outputEncoding),n.push(t.gammaFactor)}return n.push(e.onBeforeCompile.toString()),n.join()},this.acquireProgram=function(e,n){for(var r,a=0,o=i.length;a<o;a++){var s=i[a];if(s.cacheKey===n){++(r=s).usedTimes;break}}return void 0===r&&(r=new Or(t,n,e),i.push(r)),r},this.releaseProgram=function(t){if(0==--t.usedTimes){var e=i.indexOf(t);i[e]=i[i.length-1],i.pop(),t.destroy()}},this.programs=i}function Lr(){var t=new WeakMap;return{get:function(e){var n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,r){t.get(e)[n]=r},dispose:function(){t=new WeakMap}}}function Dr(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Pr(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Fr(){var t=[],e=0,n=[],r=[],i={id:-1};function a(n,r,a,o,s,u){var c=t[e];return void 0===c?(c={id:n.id,object:n,geometry:r,material:a,program:a.program||i,groupOrder:o,renderOrder:n.renderOrder,z:s,group:u},t[e]=c):(c.id=n.id,c.object=n,c.geometry=r,c.material=a,c.program=a.program||i,c.groupOrder=o,c.renderOrder=n.renderOrder,c.z=s,c.group=u),e++,c}return{opaque:n,transparent:r,init:function(){e=0,n.length=0,r.length=0},push:function(t,e,i,o,s,u){var c=a(t,e,i,o,s,u);(!0===i.transparent?r:n).push(c)},unshift:function(t,e,i,o,s,u){var c=a(t,e,i,o,s,u);(!0===i.transparent?r:n).unshift(c)},sort:function(t,e){n.length>1&&n.sort(t||Dr),r.length>1&&r.sort(e||Pr)}}}function Br(){var t=new WeakMap;function e(n){var r=n.target;r.removeEventListener("dispose",e),t.delete(r)}return{get:function(n,r){var i,a=t.get(n);return void 0===a?(i=new Fr,t.set(n,new WeakMap),t.get(n).set(r,i),n.addEventListener("dispose",e)):void 0===(i=a.get(r))&&(i=new Fr,a.set(r,i)),i},dispose:function(){t=new WeakMap}}}function zr(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":n={direction:new S,color:new Ut,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new p};break;case"SpotLight":n={position:new S,direction:new S,color:new Ut,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new p};break;case"PointLight":n={position:new S,color:new Ut,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new p,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":n={direction:new S,skyColor:new Ut,groundColor:new Ut};break;case"RectAreaLight":n={color:new Ut,position:new S,halfWidth:new S,halfHeight:new S}}return t[e.id]=n,n}}}var Ur=0;function jr(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function Wr(){for(var t=new zr,e={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},n=0;n<9;n++)e.probe.push(new S);var r=new S,i=new R,a=new R;return{setup:function(n,o,s){for(var u=0,c=0,l=0,h=0;h<9;h++)e.probe[h].set(0,0,0);var p=0,f=0,d=0,m=0,v=0,g=0,y=0,x=0,b=s.matrixWorldInverse;n.sort(jr),h=0;for(var w=n.length;h<w;h++){var _=n[h],S=_.color,M=_.intensity,E=_.distance,T=_.shadow&&_.shadow.map?_.shadow.map.texture:null;if(_.isAmbientLight)u+=S.r*M,c+=S.g*M,l+=S.b*M;else if(_.isLightProbe)for(var C=0;C<9;C++)e.probe[C].addScaledVector(_.sh.coefficients[C],M);else if(_.isDirectionalLight){if((N=t.get(_)).color.copy(_.color).multiplyScalar(_.intensity),N.direction.setFromMatrixPosition(_.matrixWorld),r.setFromMatrixPosition(_.target.matrixWorld),N.direction.sub(r),N.direction.transformDirection(b),N.shadow=_.castShadow,_.castShadow){var A=_.shadow;N.shadowBias=A.bias,N.shadowRadius=A.radius,N.shadowMapSize=A.mapSize,e.directionalShadowMap[p]=T,e.directionalShadowMatrix[p]=_.shadow.matrix,g++}e.directional[p]=N,p++}else if(_.isSpotLight){if((N=t.get(_)).position.setFromMatrixPosition(_.matrixWorld),N.position.applyMatrix4(b),N.color.copy(S).multiplyScalar(M),N.distance=E,N.direction.setFromMatrixPosition(_.matrixWorld),r.setFromMatrixPosition(_.target.matrixWorld),N.direction.sub(r),N.direction.transformDirection(b),N.coneCos=Math.cos(_.angle),N.penumbraCos=Math.cos(_.angle*(1-_.penumbra)),N.decay=_.decay,N.shadow=_.castShadow,_.castShadow){A=_.shadow;N.shadowBias=A.bias,N.shadowRadius=A.radius,N.shadowMapSize=A.mapSize,e.spotShadowMap[d]=T,e.spotShadowMatrix[d]=_.shadow.matrix,x++}e.spot[d]=N,d++}else if(_.isRectAreaLight){(N=t.get(_)).color.copy(S).multiplyScalar(M),N.position.setFromMatrixPosition(_.matrixWorld),N.position.applyMatrix4(b),a.identity(),i.copy(_.matrixWorld),i.premultiply(b),a.extractRotation(i),N.halfWidth.set(.5*_.width,0,0),N.halfHeight.set(0,.5*_.height,0),N.halfWidth.applyMatrix4(a),N.halfHeight.applyMatrix4(a),e.rectArea[m]=N,m++}else if(_.isPointLight){if((N=t.get(_)).position.setFromMatrixPosition(_.matrixWorld),N.position.applyMatrix4(b),N.color.copy(_.color).multiplyScalar(_.intensity),N.distance=_.distance,N.decay=_.decay,N.shadow=_.castShadow,_.castShadow){A=_.shadow;N.shadowBias=A.bias,N.shadowRadius=A.radius,N.shadowMapSize=A.mapSize,N.shadowCameraNear=A.camera.near,N.shadowCameraFar=A.camera.far,e.pointShadowMap[f]=T,e.pointShadowMatrix[f]=_.shadow.matrix,y++}e.point[f]=N,f++}else if(_.isHemisphereLight){var N;(N=t.get(_)).direction.setFromMatrixPosition(_.matrixWorld),N.direction.transformDirection(b),N.direction.normalize(),N.skyColor.copy(_.color).multiplyScalar(M),N.groundColor.copy(_.groundColor).multiplyScalar(M),e.hemi[v]=N,v++}}e.ambient[0]=u,e.ambient[1]=c,e.ambient[2]=l;var I=e.hash;I.directionalLength===p&&I.pointLength===f&&I.spotLength===d&&I.rectAreaLength===m&&I.hemiLength===v&&I.numDirectionalShadows===g&&I.numPointShadows===y&&I.numSpotShadows===x||(e.directional.length=p,e.spot.length=d,e.rectArea.length=m,e.point.length=f,e.hemi.length=v,e.directionalShadowMap.length=g,e.pointShadowMap.length=y,e.spotShadowMap.length=x,e.directionalShadowMatrix.length=g,e.pointShadowMatrix.length=y,e.spotShadowMatrix.length=x,I.directionalLength=p,I.pointLength=f,I.spotLength=d,I.rectAreaLength=m,I.hemiLength=v,I.numDirectionalShadows=g,I.numPointShadows=y,I.numSpotShadows=x,e.version=Ur++)},state:e}}function Vr(){var t=new Wr,e=[],n=[];return{init:function(){e.length=0,n.length=0},state:{lightsArray:e,shadowsArray:n,lights:t},setupLights:function(r){t.setup(e,n,r)},pushLight:function(t){e.push(t)},pushShadow:function(t){n.push(t)}}}function Hr(){var t=new WeakMap;function e(n){var r=n.target;r.removeEventListener("dispose",e),t.delete(r)}return{get:function(n,r){var i;return!1===t.has(n)?(i=new Vr,t.set(n,new WeakMap),t.get(n).set(r,i),n.addEventListener("dispose",e)):!1===t.get(n).has(r)?(i=new Vr,t.get(n).set(r,i)):i=t.get(n).get(r),i},dispose:function(){t=new WeakMap}}}function Gr(t){qt.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function qr(t){qt.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new S,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}Gr.prototype=Object.create(qt.prototype),Gr.prototype.constructor=Gr,Gr.prototype.isMeshDepthMaterial=!0,Gr.prototype.copy=function(t){return qt.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},qr.prototype=Object.create(qt.prototype),qr.prototype.constructor=qr,qr.prototype.isMeshDistanceMaterial=!0,qr.prototype.copy=function(t){return qt.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this};function Xr(t,e,n){var o=new Ze,s=new p,u=new p,c=new g,l=[],h=[],f={},d={0:1,1:0,2:r},m=new He({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new p},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = sqrt( squared_mean - mean * mean );\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),v=m.clone();v.defines.HORIZONAL_PASS=1;var x=new de;x.setAttribute("position",new Yt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var b=new Oe(x,m),w=this;function _(n,r){var i=e.update(b);m.uniforms.shadow_pass.value=n.map.texture,m.uniforms.resolution.value=n.mapSize,m.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(r,null,i,m,b,null),v.uniforms.shadow_pass.value=n.mapPass.texture,v.uniforms.resolution.value=n.mapSize,v.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(r,null,i,v,b,null)}function S(t,e,n){var r=t<<0|e<<1|n<<2,i=l[r];return void 0===i&&(i=new Gr({depthPacking:3201,morphTargets:t,skinning:e}),l[r]=i),i}function M(t,e,n){var r=t<<0|e<<1|n<<2,i=h[r];return void 0===i&&(i=new qr({morphTargets:t,skinning:e}),h[r]=i),i}function E(e,n,r,i,a,o){var s=e.geometry,u=null,c=S,l=e.customDepthMaterial;if(!0===r.isPointLight&&(c=M,l=e.customDistanceMaterial),void 0===l){var h=!1;!0===n.morphTargets&&(!0===s.isBufferGeometry?h=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:!0===s.isGeometry&&(h=s.morphTargets&&s.morphTargets.length>0));var p=!1;!0===e.isSkinnedMesh&&(!0===n.skinning?p=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e)),u=c(h,p,!0===e.isInstancedMesh)}else u=l;if(t.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){var m=u.uuid,v=n.uuid,g=f[m];void 0===g&&(g={},f[m]=g);var y=g[v];void 0===y&&(y=u.clone(),g[v]=y),u=y}return u.visible=n.visible,u.wireframe=n.wireframe,u.side=3===o?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:d[n.side],u.clipShadows=n.clipShadows,u.clippingPlanes=n.clippingPlanes,u.clipIntersection=n.clipIntersection,u.wireframeLinewidth=n.wireframeLinewidth,u.linewidth=n.linewidth,!0===r.isPointLight&&!0===u.isMeshDistanceMaterial&&(u.referencePosition.setFromMatrixPosition(r.matrixWorld),u.nearDistance=i,u.farDistance=a),u}function T(n,r,i,a,s){if(!1!==n.visible){if(n.layers.test(r.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===s)&&(!n.frustumCulled||o.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,n.matrixWorld);var u=e.update(n),c=n.material;if(Array.isArray(c))for(var l=u.groups,h=0,p=l.length;h<p;h++){var f=l[h],d=c[f.materialIndex];if(d&&d.visible){var m=E(n,d,a,i.near,i.far,s);t.renderBufferDirect(i,null,u,m,n,f)}}else if(c.visible){m=E(n,c,a,i.near,i.far,s);t.renderBufferDirect(i,null,u,m,n,null)}}for(var v=n.children,g=0,y=v.length;g<y;g++)T(v[g],r,i,a,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(e,r,l){if(!1!==w.enabled&&(!1!==w.autoUpdate||!1!==w.needsUpdate)&&0!==e.length){var h=t.getRenderTarget(),p=t.getActiveCubeFace(),f=t.getActiveMipmapLevel(),d=t.state;d.setBlending(0),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(var m=0,v=e.length;m<v;m++){var g=e[m],x=g.shadow;if(void 0!==x){s.copy(x.mapSize);var b=x.getFrameExtents();if(s.multiply(b),u.copy(x.mapSize),(s.x>n||s.y>n)&&(console.warn("THREE.WebGLShadowMap:",g,"has shadow exceeding max texture size, reducing"),s.x>n&&(u.x=Math.floor(n/b.x),s.x=u.x*b.x,x.mapSize.x=u.x),s.y>n&&(u.y=Math.floor(n/b.y),s.y=u.y*b.y,x.mapSize.y=u.y)),null===x.map&&!x.isPointLightShadow&&3===this.type){var S={minFilter:i,magFilter:i,format:a};x.map=new y(s.x,s.y,S),x.map.texture.name=g.name+".shadowMap",x.mapPass=new y(s.x,s.y,S),x.camera.updateProjectionMatrix()}if(null===x.map){S={minFilter:1003,magFilter:1003,format:a};x.map=new y(s.x,s.y,S),x.map.texture.name=g.name+".shadowMap",x.camera.updateProjectionMatrix()}t.setRenderTarget(x.map),t.clear();for(var M=x.getViewportCount(),E=0;E<M;E++){var C=x.getViewport(E);c.set(u.x*C.x,u.y*C.y,u.x*C.z,u.y*C.w),d.viewport(c),x.updateMatrices(g,E),o=x.getFrustum(),T(r,l,x.camera,g,this.type)}x.isPointLightShadow||3!==this.type||_(x,l)}else console.warn("THREE.WebGLShadowMap:",g,"has no shadow.")}w.needsUpdate=!1,t.setRenderTarget(h,p,f)}}}function $r(t,e,n){var i=n.isWebGL2;var a=new function(){var e=!1,n=new g,r=null,i=new g(0,0,0,0);return{setMask:function(n){r===n||e||(t.colorMask(n,n,n,n),r=n)},setLocked:function(t){e=t},setClear:function(e,r,a,o,s){!0===s&&(e*=o,r*=o,a*=o),n.set(e,r,a,o),!1===i.equals(n)&&(t.clearColor(e,r,a,o),i.copy(n))},reset:function(){e=!1,r=null,i.set(-1,0,0,0)}}},o=new function(){var e=!1,n=null,r=null,i=null;return{setTest:function(t){t?U(2929):j(2929)},setMask:function(r){n===r||e||(t.depthMask(r),n=r)},setFunc:function(e){if(r!==e){if(e)switch(e){case 0:t.depthFunc(512);break;case 1:t.depthFunc(519);break;case 2:t.depthFunc(513);break;case 3:t.depthFunc(515);break;case 4:t.depthFunc(514);break;case 5:t.depthFunc(518);break;case 6:t.depthFunc(516);break;case 7:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);r=e}},setLocked:function(t){e=t},setClear:function(e){i!==e&&(t.clearDepth(e),i=e)},reset:function(){e=!1,n=null,r=null,i=null}}},s=new function(){var e=!1,n=null,r=null,i=null,a=null,o=null,s=null,u=null,c=null;return{setTest:function(t){e||(t?U(2960):j(2960))},setMask:function(r){n===r||e||(t.stencilMask(r),n=r)},setFunc:function(e,n,o){r===e&&i===n&&a===o||(t.stencilFunc(e,n,o),r=e,i=n,a=o)},setOp:function(e,n,r){o===e&&s===n&&u===r||(t.stencilOp(e,n,r),o=e,s=n,u=r)},setLocked:function(t){e=t},setClear:function(e){c!==e&&(t.clearStencil(e),c=e)},reset:function(){e=!1,n=null,r=null,i=null,a=null,o=null,s=null,u=null,c=null}}},u=t.getParameter(34921),c=new Uint8Array(u),l=new Uint8Array(u),h=new Uint8Array(u),p={},f=null,d=null,m=null,v=null,y=null,x=null,b=null,w=null,_=null,S=!1,M=null,E=null,T=null,C=null,A=null,N=t.getParameter(35661),I=!1,R=0,O=t.getParameter(7938);-1!==O.indexOf("WebGL")?(R=parseFloat(/^WebGL\ ([0-9])/.exec(O)[1]),I=R>=1):-1!==O.indexOf("OpenGL ES")&&(R=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(O)[1]),I=R>=2);var k=null,L={},D=new g,P=new g;function F(e,n,r){var i=new Uint8Array(4),a=t.createTexture();t.bindTexture(e,a),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728);for(var o=0;o<r;o++)t.texImage2D(n+o,0,6408,1,1,0,6408,5121,i);return a}var B={};function z(n,r){(c[n]=1,0===l[n]&&(t.enableVertexAttribArray(n),l[n]=1),h[n]!==r)&&((i?t:e.get("ANGLE_instanced_arrays"))[i?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,r),h[n]=r)}function U(e){!0!==p[e]&&(t.enable(e),p[e]=!0)}function j(e){!1!==p[e]&&(t.disable(e),p[e]=!1)}B[3553]=F(3553,3553,1),B[34067]=F(34067,34069,6),a.setClear(0,0,0,1),o.setClear(1),s.setClear(0),U(2929),o.setFunc(3),q(!1),X(1),U(2884),G(0);var W={100:32774,101:32778,102:32779};if(i)W[103]=32775,W[104]=32776;else{var V=e.get("EXT_blend_minmax");null!==V&&(W[103]=V.MIN_EXT,W[104]=V.MAX_EXT)}var H={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function G(e,n,r,i,a,o,s,u){if(0!==e){if(d||(U(3042),d=!0),5===e)a=a||n,o=o||r,s=s||i,n===v&&a===b||(t.blendEquationSeparate(W[n],W[a]),v=n,b=a),r===y&&i===x&&o===w&&s===_||(t.blendFuncSeparate(H[r],H[i],H[o],H[s]),y=r,x=i,w=o,_=s),m=e,S=null;else if(e!==m||u!==S){if(100===v&&100===b||(t.blendEquation(32774),v=100,b=100),u)switch(e){case 1:t.blendFuncSeparate(1,771,1,771);break;case 2:t.blendFunc(1,1);break;case 3:t.blendFuncSeparate(0,0,769,771);break;case 4:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case 1:t.blendFuncSeparate(770,771,1,771);break;case 2:t.blendFunc(770,1);break;case 3:t.blendFunc(0,769);break;case 4:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}y=null,x=null,w=null,_=null,m=e,S=u}}else d&&(j(3042),d=!1)}function q(e){M!==e&&(e?t.frontFace(2304):t.frontFace(2305),M=e)}function X(e){0!==e?(U(2884),e!==E&&(1===e?t.cullFace(1029):2===e?t.cullFace(1028):t.cullFace(1032))):j(2884),E=e}function $(e,n,r){e?(U(32823),C===n&&A===r||(t.polygonOffset(n,r),C=n,A=r)):j(32823)}function Y(e){void 0===e&&(e=33984+N-1),k!==e&&(t.activeTexture(e),k=e)}return{buffers:{color:a,depth:o,stencil:s},initAttributes:function(){for(var t=0,e=c.length;t<e;t++)c[t]=0},enableAttribute:function(t){z(t,0)},enableAttributeAndDivisor:z,disableUnusedAttributes:function(){for(var e=0,n=l.length;e!==n;++e)l[e]!==c[e]&&(t.disableVertexAttribArray(e),l[e]=0)},enable:U,disable:j,useProgram:function(e){return f!==e&&(t.useProgram(e),f=e,!0)},setBlending:G,setMaterial:function(t,e){t.side===r?j(2884):U(2884);var n=1===t.side;e&&(n=!n),q(n),1===t.blending&&!1===t.transparent?G(0):G(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),o.setFunc(t.depthFunc),o.setTest(t.depthTest),o.setMask(t.depthWrite),a.setMask(t.colorWrite);var i=t.stencilWrite;s.setTest(i),i&&(s.setMask(t.stencilWriteMask),s.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),s.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),$(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:q,setCullFace:X,setLineWidth:function(e){e!==T&&(I&&t.lineWidth(e),T=e)},setPolygonOffset:$,setScissorTest:function(t){t?U(3089):j(3089)},activeTexture:Y,bindTexture:function(e,n){null===k&&Y();var r=L[k];void 0===r&&(r={type:void 0,texture:void 0},L[k]=r),r.type===e&&r.texture===n||(t.bindTexture(e,n||B[e]),r.type=e,r.texture=n)},unbindTexture:function(){var e=L[k];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(e){!1===D.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),D.copy(e))},viewport:function(e){!1===P.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),P.copy(e))},reset:function(){for(var e=0;e<l.length;e++)1===l[e]&&(t.disableVertexAttribArray(e),l[e]=0);p={},k=null,L={},f=null,m=null,M=null,E=null,a.reset(),o.reset(),s.reset()}}}function Yr(t,e,n,r,o,s,u){var c,l=o.isWebGL2,p=o.maxTextures,f=o.maxCubemapSize,d=o.maxTextureSize,m=o.maxSamples,v=new WeakMap,g=!1;try{g="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(t){}function y(t,e){return g?new OffscreenCanvas(t,e):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function x(t,e,n,r){var i=1;if((t.width>r||t.height>r)&&(i=r/Math.max(t.width,t.height)),i<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){var a=e?h.floorPowerOfTwo:Math.floor,o=a(i*t.width),s=a(i*t.height);void 0===c&&(c=y(o,s));var u=n?y(o,s):c;return u.width=o,u.height=s,u.getContext("2d").drawImage(t,0,0,o,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+o+"x"+s+")."),u}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+")."),t}return t}function b(t){return h.isPowerOfTwo(t.width)&&h.isPowerOfTwo(t.height)}function w(t,e){return t.generateMipmaps&&e&&1003!==t.minFilter&&t.minFilter!==i}function _(e,n,i,a){t.generateMipmap(e),r.get(n).__maxMipLevel=Math.log(Math.max(i,a))*Math.LOG2E}function S(n,r,i){if(!1===l)return r;if(null!==n){if(void 0!==t[n])return t[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var a=r;return 6403===r&&(5126===i&&(a=33326),5131===i&&(a=33325),5121===i&&(a=33321)),6407===r&&(5126===i&&(a=34837),5131===i&&(a=34843),5121===i&&(a=32849)),6408===r&&(5126===i&&(a=34836),5131===i&&(a=34842),5121===i&&(a=32856)),33325===a||33326===a||34842===a||34836===a?e.get("EXT_color_buffer_float"):34843!==a&&34837!==a||console.warn("THREE.WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead."),a}function M(t){return 1003===t||1004===t||1005===t?9728:9729}function E(e){var n=e.target;n.removeEventListener("dispose",E),function(e){var n=r.get(e);if(void 0===n.__webglInit)return;t.deleteTexture(n.__webglTexture),r.remove(e)}(n),n.isVideoTexture&&v.delete(n),u.memory.textures--}function T(e){var n=e.target;n.removeEventListener("dispose",T),function(e){var n=r.get(e),i=r.get(e.texture);if(!e)return;void 0!==i.__webglTexture&&t.deleteTexture(i.__webglTexture);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLCubeRenderTarget)for(var a=0;a<6;a++)t.deleteFramebuffer(n.__webglFramebuffer[a]),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[a]);else t.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer);if(e.isWebGLMultiviewRenderTarget){t.deleteTexture(n.__webglColorTexture),t.deleteTexture(n.__webglDepthStencilTexture),u.memory.textures-=2;a=0;for(var o=n.__webglViewFramebuffers.length;a<o;a++)t.deleteFramebuffer(n.__webglViewFramebuffers[a])}r.remove(e.texture),r.remove(e)}(n),u.memory.textures--}var C=0;function A(t,e){var i=r.get(t);if(t.isVideoTexture&&function(t){var e=u.render.frame;v.get(t)!==e&&(v.set(t,e),t.update())}(t),t.version>0&&i.__version!==t.version){var a=t.image;if(void 0===a)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==a.complete)return void D(i,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+e),n.bindTexture(3553,i.__webglTexture)}function N(e,i){if(6===e.image.length){var o=r.get(e);if(e.version>0&&o.__version!==e.version){L(o,e),n.activeTexture(33984+i),n.bindTexture(34067,o.__webglTexture),t.pixelStorei(37440,e.flipY);for(var u=e&&(e.isCompressedTexture||e.image[0].isCompressedTexture),c=e.image[0]&&e.image[0].isDataTexture,h=[],p=0;p<6;p++)h[p]=u||c?c?e.image[p].image:e.image[p]:x(e.image[p],!1,!0,f);var d,m=h[0],v=b(m)||l,g=s.convert(e.format),y=s.convert(e.type),M=S(e.internalFormat,g,y);if(k(34067,e,v),u){for(p=0;p<6;p++){d=h[p].mipmaps;for(var E=0;E<d.length;E++){var T=d[E];e.format!==a&&1022!==e.format?null!==g?n.compressedTexImage2D(34069+p,E,M,T.width,T.height,0,T.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+p,E,M,T.width,T.height,0,g,y,T.data)}}o.__maxMipLevel=d.length-1}else{d=e.mipmaps;for(p=0;p<6;p++)if(c){n.texImage2D(34069+p,0,M,h[p].width,h[p].height,0,g,y,h[p].data);for(E=0;E<d.length;E++){var C=(T=d[E]).image[p].image;n.texImage2D(34069+p,E+1,M,C.width,C.height,0,g,y,C.data)}}else{n.texImage2D(34069+p,0,M,g,y,h[p]);for(E=0;E<d.length;E++){T=d[E];n.texImage2D(34069+p,E+1,M,g,y,T.image[p])}}o.__maxMipLevel=d.length}w(e,v)&&_(34067,e,m.width,m.height),o.__version=e.version,e.onUpdate&&e.onUpdate(e)}else n.activeTexture(33984+i),n.bindTexture(34067,o.__webglTexture)}}function I(t,e){n.activeTexture(33984+e),n.bindTexture(34067,r.get(t).__webglTexture)}var R={1e3:10497,1001:33071,1002:33648},O={1003:9728,1004:9984,1005:9986,[i]:9729,1007:9985,1008:9987};function k(n,a,s){s?(t.texParameteri(n,10242,R[a.wrapS]),t.texParameteri(n,10243,R[a.wrapT]),32879!==n&&35866!==n||t.texParameteri(n,32882,R[a.wrapR]),t.texParameteri(n,10240,O[a.magFilter]),t.texParameteri(n,10241,O[a.minFilter])):(t.texParameteri(n,10242,33071),t.texParameteri(n,10243,33071),32879!==n&&35866!==n||t.texParameteri(n,32882,33071),1001===a.wrapS&&1001===a.wrapT||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(n,10240,M(a.magFilter)),t.texParameteri(n,10241,M(a.minFilter)),1003!==a.minFilter&&a.minFilter!==i&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var u=e.get("EXT_texture_filter_anisotropic");if(u){if(1015===a.type&&null===e.get("OES_texture_float_linear"))return;if(1016===a.type&&null===(l||e.get("OES_texture_half_float_linear")))return;(a.anisotropy>1||r.get(a).__currentAnisotropy)&&(t.texParameterf(n,u.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,o.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy)}}function L(e,n){void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",E),e.__webglTexture=t.createTexture(),u.memory.textures++)}function D(e,r,o){var u=3553;r.isDataTexture2DArray&&(u=35866),r.isDataTexture3D&&(u=32879),L(e,r),n.activeTexture(33984+o),n.bindTexture(u,e.__webglTexture),t.pixelStorei(37440,r.flipY),t.pixelStorei(37441,r.premultiplyAlpha),t.pixelStorei(3317,r.unpackAlignment);var c=function(t){return!l&&(1001!==t.wrapS||1001!==t.wrapT||1003!==t.minFilter&&t.minFilter!==i)}(r)&&!1===b(r.image),h=x(r.image,c,!1,d),p=b(h)||l,f=s.convert(r.format),m=s.convert(r.type),v=S(r.internalFormat,f,m);k(u,r,p);var g,y=r.mipmaps;if(r.isDepthTexture){if(v=6402,1015===r.type){if(!1===l)throw new Error("Float Depth Texture only supported in WebGL2.0");v=36012}else l&&(v=33189);1026===r.format&&6402===v&&1012!==r.type&&1014!==r.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=1012,m=s.convert(r.type)),1027===r.format&&(v=34041,1020!==r.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=1020,m=s.convert(r.type))),n.texImage2D(3553,0,v,h.width,h.height,0,f,m,null)}else if(r.isDataTexture)if(y.length>0&&p){for(var M=0,E=y.length;M<E;M++)g=y[M],n.texImage2D(3553,M,v,g.width,g.height,0,f,m,g.data);r.generateMipmaps=!1,e.__maxMipLevel=y.length-1}else n.texImage2D(3553,0,v,h.width,h.height,0,f,m,h.data),e.__maxMipLevel=0;else if(r.isCompressedTexture){for(M=0,E=y.length;M<E;M++)g=y[M],r.format!==a&&1022!==r.format?null!==f?n.compressedTexImage2D(3553,M,v,g.width,g.height,0,g.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,M,v,g.width,g.height,0,f,m,g.data);e.__maxMipLevel=y.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,v,h.width,h.height,h.depth,0,f,m,h.data),e.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,v,h.width,h.height,h.depth,0,f,m,h.data),e.__maxMipLevel=0;else if(y.length>0&&p){for(M=0,E=y.length;M<E;M++)g=y[M],n.texImage2D(3553,M,v,f,m,g);r.generateMipmaps=!1,e.__maxMipLevel=y.length-1}else n.texImage2D(3553,0,v,f,m,h),e.__maxMipLevel=0;w(r,p)&&_(u,r,h.width,h.height),e.__version=r.version,r.onUpdate&&r.onUpdate(r)}function P(e,i,a,o){var u=s.convert(i.texture.format),c=s.convert(i.texture.type),l=S(i.texture.internalFormat,u,c);n.texImage2D(o,0,l,i.width,i.height,0,u,c,null),t.bindFramebuffer(36160,e),t.framebufferTexture2D(36160,a,o,r.get(i.texture).__webglTexture,0),t.bindFramebuffer(36160,null)}function F(e,n,r){if(t.bindRenderbuffer(36161,e),n.depthBuffer&&!n.stencilBuffer){if(r){var i=z(n);t.renderbufferStorageMultisample(36161,i,33189,n.width,n.height)}else t.renderbufferStorage(36161,33189,n.width,n.height);t.framebufferRenderbuffer(36160,36096,36161,e)}else if(n.depthBuffer&&n.stencilBuffer){if(r){i=z(n);t.renderbufferStorageMultisample(36161,i,35056,n.width,n.height)}else t.renderbufferStorage(36161,34041,n.width,n.height);t.framebufferRenderbuffer(36160,33306,36161,e)}else{var a=s.convert(n.texture.format),o=s.convert(n.texture.type),u=S(n.texture.internalFormat,a,o);if(r){i=z(n);t.renderbufferStorageMultisample(36161,i,u,n.width,n.height)}else t.renderbufferStorage(36161,u,n.width,n.height)}t.bindRenderbuffer(36161,null)}function B(e){var n=r.get(e),i=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,n){if(n&&n.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,e),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),A(n.depthTexture,0);var i=r.get(n.depthTexture).__webglTexture;if(1026===n.depthTexture.format)t.framebufferTexture2D(36160,36096,3553,i,0);else{if(1027!==n.depthTexture.format)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(36160,33306,3553,i,0)}}(n.__webglFramebuffer,e)}else if(i){n.__webglDepthbuffer=[];for(var a=0;a<6;a++)t.bindFramebuffer(36160,n.__webglFramebuffer[a]),n.__webglDepthbuffer[a]=t.createRenderbuffer(),F(n.__webglDepthbuffer[a],e)}else t.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=t.createRenderbuffer(),F(n.__webglDepthbuffer,e);t.bindFramebuffer(36160,null)}function z(t){return l&&t.isWebGLMultisampleRenderTarget?Math.min(m,t.samples):0}var U=!1,j=!1;this.allocateTextureUnit=function(){var t=C;return t>=p&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+p),C+=1,t},this.resetTextureUnits=function(){C=0},this.setTexture2D=A,this.setTexture2DArray=function(t,e){var i=r.get(t);t.version>0&&i.__version!==t.version?D(i,t,e):(n.activeTexture(33984+e),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(t,e){var i=r.get(t);t.version>0&&i.__version!==t.version?D(i,t,e):(n.activeTexture(33984+e),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=N,this.setTextureCubeDynamic=I,this.setupRenderTarget=function(i){var a=r.get(i),o=r.get(i.texture);i.addEventListener("dispose",T),o.__webglTexture=t.createTexture(),u.memory.textures++;var c=!0===i.isWebGLCubeRenderTarget,h=!0===i.isWebGLMultisampleRenderTarget,p=!0===i.isWebGLMultiviewRenderTarget,f=b(i)||l;if(c){a.__webglFramebuffer=[];for(var d=0;d<6;d++)a.__webglFramebuffer[d]=t.createFramebuffer()}else if(a.__webglFramebuffer=t.createFramebuffer(),h)if(l){a.__webglMultisampledFramebuffer=t.createFramebuffer(),a.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,a.__webglColorRenderbuffer);var m=s.convert(i.texture.format),v=s.convert(i.texture.type),g=S(i.texture.internalFormat,m,v),y=z(i);t.renderbufferStorageMultisample(36161,y,g,i.width,i.height),t.bindFramebuffer(36160,a.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,a.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),i.depthBuffer&&(a.__webglDepthRenderbuffer=t.createRenderbuffer(),F(a.__webglDepthRenderbuffer,i,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");else if(p){var x=i.width,M=i.height,E=i.numViews;t.bindFramebuffer(36160,a.__webglFramebuffer);var C=e.get("OVR_multiview2");u.memory.textures+=2;var A=t.createTexture();t.bindTexture(35866,A),t.texParameteri(35866,10240,9728),t.texParameteri(35866,10241,9728),t.texImage3D(35866,0,32856,x,M,E,0,6408,5121,null),C.framebufferTextureMultiviewOVR(36160,36064,A,0,0,E);var N=t.createTexture();t.bindTexture(35866,N),t.texParameteri(35866,10240,9728),t.texParameteri(35866,10241,9728),t.texImage3D(35866,0,35056,x,M,E,0,34041,34042,null),C.framebufferTextureMultiviewOVR(36160,33306,N,0,0,E);var I=new Array(E);for(d=0;d<E;++d)I[d]=t.createFramebuffer(),t.bindFramebuffer(36160,I[d]),t.framebufferTextureLayer(36160,36064,A,0,d);a.__webglColorTexture=A,a.__webglDepthStencilTexture=N,a.__webglViewFramebuffers=I,t.bindFramebuffer(36160,null),t.bindTexture(35866,null)}if(c){n.bindTexture(34067,o.__webglTexture),k(34067,i.texture,f);for(d=0;d<6;d++)P(a.__webglFramebuffer[d],i,36064,34069+d);w(i.texture,f)&&_(34067,i.texture,i.width,i.height),n.bindTexture(34067,null)}else p||(n.bindTexture(3553,o.__webglTexture),k(3553,i.texture,f),P(a.__webglFramebuffer,i,36064,3553),w(i.texture,f)&&_(3553,i.texture,i.width,i.height),n.bindTexture(3553,null));i.depthBuffer&&B(i)},this.updateRenderTargetMipmap=function(t){var e=t.texture;if(w(e,b(t)||l)){var i=t.isWebGLCubeRenderTarget?34067:3553,a=r.get(e).__webglTexture;n.bindTexture(i,a),_(i,e,t.width,t.height),n.bindTexture(i,null)}},this.updateMultisampleRenderTarget=function(e){if(e.isWebGLMultisampleRenderTarget)if(l){var n=r.get(e);t.bindFramebuffer(36008,n.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,n.__webglFramebuffer);var i=e.width,a=e.height,o=16384;e.depthBuffer&&(o|=256),e.stencilBuffer&&(o|=1024),t.blitFramebuffer(0,0,i,a,0,0,i,a,o,9728)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(t,e){t&&t.isWebGLRenderTarget&&(!1===U&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),U=!0),t=t.texture),A(t,e)},this.safeSetTextureCube=function(t,e){t&&t.isWebGLCubeRenderTarget&&(!1===j&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),j=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?N(t,e):I(t,e)}}function Kr(t,e,n){var r=n.isWebGL2;return{convert:function(t){var n;if(1009===t)return 5121;if(1017===t)return 32819;if(1018===t)return 32820;if(1019===t)return 33635;if(1010===t)return 5120;if(1011===t)return 5122;if(1012===t)return 5123;if(1013===t)return 5124;if(1014===t)return 5125;if(1015===t)return 5126;if(1016===t)return r?5131:null!==(n=e.get("OES_texture_half_float"))?n.HALF_FLOAT_OES:null;if(1021===t)return 6406;if(1022===t)return 6407;if(t===a)return 6408;if(1024===t)return 6409;if(1025===t)return 6410;if(1026===t)return 6402;if(1027===t)return 34041;if(1028===t)return 6403;if(1029===t)return 36244;if(1030===t)return 33319;if(1031===t)return 33320;if(1032===t)return 36248;if(1033===t)return 36249;if(33776===t||33777===t||33778===t||33779===t){if(null===(n=e.get("WEBGL_compressed_texture_s3tc")))return null;if(33776===t)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===t)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===t)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===t)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===t||35841===t||35842===t||35843===t){if(null===(n=e.get("WEBGL_compressed_texture_pvrtc")))return null;if(35840===t)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===t)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===t)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===t)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}return 36196===t?null!==(n=e.get("WEBGL_compressed_texture_etc1"))?n.COMPRESSED_RGB_ETC1_WEBGL:null:37808===t||37809===t||37810===t||37811===t||37812===t||37813===t||37814===t||37815===t||37816===t||37817===t||37818===t||37819===t||37820===t||37821===t?null!==(n=e.get("WEBGL_compressed_texture_astc"))?t:null:1020===t?r?34042:null!==(n=e.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function Jr(t,e,n,r){y.call(this,t,e,r),this.depthBuffer=!1,this.stencilBuffer=!1,this.numViews=n}function Zr(t,e){var n,r,i,a,o,s,u,c=t.extensions,l=t.properties,h=0;function d(t){return t.isArrayCamera?t.cameras:(o[0]=t,o)}this.isAvailable=function(){if(void 0===u){var t=c.get("OVR_multiview2");if(u=null!==t&&!1===e.getContextAttributes().antialias){h=e.getParameter(t.MAX_VIEWS_OVR),n=new Jr(0,0,2),s=new p,a=[],i=[],o=[];for(var r=0;r<h;r++)a[r]=new R,i[r]=new f}}return u},this.attachCamera=function(e){!1!==function(t){if(void 0===t.isArrayCamera)return!0;var e=t.cameras;if(e.length>h)return!1;for(var n=1,r=e.length;n<r;n++)if(e[0].viewport.z!==e[n].viewport.z||e[0].viewport.w!==e[n].viewport.w)return!1;return!0}(e)&&(r=t.getRenderTarget(),function(e){if(r?s.set(r.width,r.height):t.getDrawingBufferSize(s),e.isArrayCamera){var i=e.cameras[0].viewport;n.setSize(i.z,i.w),n.setNumViews(e.cameras.length)}else n.setSize(s.x,s.y),n.setNumViews(2)}(e),t.setRenderTarget(n))},this.detachCamera=function(i){n===t.getRenderTarget()&&(t.setRenderTarget(r),function(t){var r=n,i=r.numViews,a=l.get(r).__webglViewFramebuffers,o=r.width,u=r.height;if(t.isArrayCamera)for(var c=0;c<i;c++){var h=t.cameras[c].viewport,p=h.x,f=h.y,d=p+h.z,m=f+h.w;e.bindFramebuffer(36008,a[c]),e.blitFramebuffer(0,0,o,u,p,f,d,m,16384,9728)}else e.bindFramebuffer(36008,a[0]),e.blitFramebuffer(0,0,o,u,0,0,s.x,s.y,16384,9728)}(i))},this.updateCameraProjectionMatricesUniform=function(t,n){for(var r=d(t),i=0;i<r.length;i++)a[i].copy(r[i].projectionMatrix);n.setValue(e,"projectionMatrices",a)},this.updateCameraViewMatricesUniform=function(t,n){for(var r=d(t),i=0;i<r.length;i++)a[i].copy(r[i].matrixWorldInverse);n.setValue(e,"viewMatrices",a)},this.updateObjectMatricesUniforms=function(t,n,r){for(var o=d(n),s=0;s<o.length;s++)a[s].multiplyMatrices(o[s].matrixWorldInverse,t.matrixWorld),i[s].getNormalMatrix(a[s]);r.setValue(e,"modelViewMatrices",a),r.setValue(e,"normalMatrices",i)}}function Qr(t){qe.call(this),this.cameras=t||[]}function ti(){Y.call(this),this.type="Group"}function ei(t,e){var n=this,r=null,i=null,a="local-floor",o=null,s=[],u=new Map,c=new qe;c.layers.enable(1),c.viewport=new g;var l=new qe;l.layers.enable(2),l.viewport=new g;var h=new Qr([c,l]);h.layers.enable(1),h.layers.enable(2);var p=null,f=null;function d(t){var e=u.get(t.inputSource);e&&(e.targetRay&&e.targetRay.dispatchEvent({type:t.type}),e.grip&&e.grip.dispatchEvent({type:t.type}))}function m(){u.forEach((function(t,e){t.targetRay&&(t.targetRay.dispatchEvent({type:"disconnected",data:e}),t.targetRay.visible=!1),t.grip&&(t.grip.dispatchEvent({type:"disconnected",data:e}),t.grip.visible=!1)})),u.clear(),t.setFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),M.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function v(t){i=t,M.setContext(r),M.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}function y(t){for(var e=r.inputSources,n=0;n<s.length;n++)u.set(e[n],s[n]);for(n=0;n<t.removed.length;n++){var i=t.removed[n];(a=u.get(i))&&(a.targetRay&&a.targetRay.dispatchEvent({type:"disconnected",data:i}),a.grip&&a.grip.dispatchEvent({type:"disconnected",data:i}),u.delete(i))}for(n=0;n<t.added.length;n++){var a;i=t.added[n];(a=u.get(i))&&(a.targetRay&&a.targetRay.dispatchEvent({type:"connected",data:i}),a.grip&&a.grip.dispatchEvent({type:"connected",data:i}))}}this.enabled=!1,this.isPresenting=!1,this.getController=function(t){var e=s[t];return void 0===e&&(e={},s[t]=e),void 0===e.targetRay&&(e.targetRay=new ti,e.targetRay.matrixAutoUpdate=!1,e.targetRay.visible=!1),e.targetRay},this.getControllerGrip=function(t){var e=s[t];return void 0===e&&(e={},s[t]=e),void 0===e.grip&&(e.grip=new ti,e.grip.matrixAutoUpdate=!1,e.grip.visible=!1),e.grip},this.setFramebufferScaleFactor=function(){},this.setReferenceSpaceType=function(t){a=t},this.getReferenceSpace=function(){return i},this.getSession=function(){return r},this.setSession=function(t){if(null!==(r=t)){r.addEventListener("select",d),r.addEventListener("selectstart",d),r.addEventListener("selectend",d),r.addEventListener("squeeze",d),r.addEventListener("squeezestart",d),r.addEventListener("squeezeend",d),r.addEventListener("end",m);var n=e.getContextAttributes(),i={antialias:n.antialias,alpha:n.alpha,depth:n.depth,stencil:n.stencil},o=new XRWebGLLayer(r,e,i);r.updateRenderState({baseLayer:o}),r.requestReferenceSpace(a).then(v),r.addEventListener("inputsourceschange",y)}};var x=new S,b=new S;function w(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.getInverse(t.matrixWorld)}this.getCamera=function(t){h.near=l.near=c.near=t.near,h.far=l.far=c.far=t.far,p===h.near&&f===h.far||(r.updateRenderState({depthNear:h.near,depthFar:h.far}),p=h.near,f=h.far);var e=t.parent,n=h.cameras;w(h,e);for(var i=0;i<n.length;i++)w(n[i],e);t.matrixWorld.copy(h.matrixWorld);for(var a=t.children,o=(i=0,a.length);i<o;i++)a[i].updateMatrixWorld(!0);return function(t,e,n){x.setFromMatrixPosition(e.matrixWorld),b.setFromMatrixPosition(n.matrixWorld);var r=x.distanceTo(b),i=e.projectionMatrix.elements,a=n.projectionMatrix.elements,o=i[14]/(i[10]-1),s=i[14]/(i[10]+1),u=(i[9]+1)/i[5],c=(i[9]-1)/i[5],l=(i[8]-1)/i[0],h=(a[8]+1)/a[0],p=o*l,f=o*h,d=r/(-l+h),m=d*-l;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(d),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.getInverse(t.matrixWorld);var v=o+d,g=s+d,y=p-m,w=f+(r-m),_=u*s/g*v,S=c*s/g*v;t.projectionMatrix.makePerspective(y,w,_,S,v,g)}(h,c,l),h};var _=null;var M=new tn;M.setAnimationLoop((function(e,n){if(null!==(o=n.getViewerPose(i))){var a=o.views,u=r.renderState.baseLayer;t.setFramebuffer(u.framebuffer);for(var c=0;c<a.length;c++){var l=a[c],p=u.getViewport(l),f=h.cameras[c];f.matrix.fromArray(l.transform.matrix),f.projectionMatrix.fromArray(l.projectionMatrix),f.viewport.set(p.x,p.y,p.width,p.height),0===c&&h.matrix.copy(f.matrix)}}var d=r.inputSources;for(c=0;c<s.length;c++){var m=s[c],v=d[c],g=null,y=null;v&&(m.targetRay&&null!==(g=n.getPose(v.targetRaySpace,i))&&(m.targetRay.matrix.fromArray(g.transform.matrix),m.targetRay.matrix.decompose(m.targetRay.position,m.targetRay.rotation,m.targetRay.scale)),m.grip&&v.gripSpace&&null!==(y=n.getPose(v.gripSpace,i))&&(m.grip.matrix.fromArray(y.transform.matrix),m.grip.matrix.decompose(m.grip.position,m.grip.rotation,m.grip.scale))),m.targetRay&&(m.targetRay.visible=null!==g),m.grip&&(m.grip.visible=null!==y)}_&&_(e,n)})),this.setAnimationLoop=function(t){_=t},this.dispose=function(){}}function ni(t){var e=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==t.context?t.context:null,r=void 0!==t.alpha&&t.alpha,i=void 0===t.depth||t.depth,o=void 0===t.stencil||t.stencil,s=void 0!==t.antialias&&t.antialias,u=void 0===t.premultipliedAlpha||t.premultipliedAlpha,c=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,l=void 0!==t.powerPreference?t.powerPreference:"default",f=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat,d=null,m=null;this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=3e3,this.physicallyCorrectLights=!1,this.toneMapping=1,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var v,y,x,b,w,_,M,E,T,C,A,N,I,O,k,L,D,P,F=this,B=!1,z=null,U=0,j=0,W=null,V=null,H=-1,G={geometry:null,program:null,wireframe:!1},q=null,X=null,$=new g,Y=new g,J=null,Z=e.width,Q=e.height,tt=1,et=null,nt=null,rt=new g(0,0,Z,Q),it=new g(0,0,Z,Q),at=!1,ot=new Ze,st=new ln,ut=!1,ct=!1,lt=new R,ht=new S;function pt(){return null===W?tt:1}try{var ft={alpha:r,depth:i,stencil:o,antialias:s,premultipliedAlpha:u,preserveDrawingBuffer:c,powerPreference:l,failIfMajorPerformanceCaveat:f,xrCompatible:!0};if(e.addEventListener("webglcontextlost",yt,!1),e.addEventListener("webglcontextrestored",xt,!1),null===(v=n||e.getContext("webgl",ft)||e.getContext("experimental-webgl",ft)))throw null!==e.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===v.getShaderPrecisionFormat&&(v.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw console.error("THREE.WebGLRenderer: "+t.message),t}function dt(){y=new hn(v),!1===(x=new cn(v,y,t)).isWebGL2&&(y.get("WEBGL_depth_texture"),y.get("OES_texture_float"),y.get("OES_texture_half_float"),y.get("OES_texture_half_float_linear"),y.get("OES_standard_derivatives"),y.get("OES_element_index_uint"),y.get("ANGLE_instanced_arrays")),y.get("OES_texture_float_linear"),P=new Kr(v,y,x),(b=new $r(v,y,x)).scissor(Y.copy(it).multiplyScalar(tt).floor()),b.viewport($.copy(rt).multiplyScalar(tt).floor()),w=new dn(v),_=new Lr,M=new Yr(v,y,b,_,x,P,w),E=new en(v,x),T=new pn(v,E,w),C=new gn(v,T,E,w),k=new vn(v),A=new kr(F,y,x),N=new Br,I=new Hr,O=new sn(F,b,C,u),L=new un(v,y,w,x),D=new fn(v,y,w,x),w.programs=A.programs,F.capabilities=x,F.extensions=y,F.properties=_,F.renderLists=N,F.state=b,F.info=w}dt();var mt=new ei(F,v);this.xr=mt;var vt=new Zr(F,v),gt=new Xr(F,C,x.maxTextureSize);function yt(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),B=!0}function xt(){console.log("THREE.WebGLRenderer: Context Restored."),B=!1,dt()}function bt(t){var e=t.target;e.removeEventListener("dispose",bt),function(t){wt(t),_.remove(t)}(e)}function wt(t){var e=_.get(t).program;t.program=void 0,void 0!==e&&A.releaseProgram(e)}this.shadowMap=gt,this.getContext=function(){return v},this.getContextAttributes=function(){return v.getContextAttributes()},this.forceContextLoss=function(){var t=y.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=y.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return tt},this.setPixelRatio=function(t){void 0!==t&&(tt=t,this.setSize(Z,Q,!1))},this.getSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),t=new p),t.set(Z,Q)},this.setSize=function(t,n,r){mt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Z=t,Q=n,e.width=Math.floor(t*tt),e.height=Math.floor(n*tt),!1!==r&&(e.style.width=t+"px",e.style.height=n+"px"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),t=new p),t.set(Z*tt,Q*tt).floor()},this.setDrawingBufferSize=function(t,n,r){Z=t,Q=n,tt=r,e.width=Math.floor(t*r),e.height=Math.floor(n*r),this.setViewport(0,0,t,n)},this.getCurrentViewport=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),t=new g),t.copy($)},this.getViewport=function(t){return t.copy(rt)},this.setViewport=function(t,e,n,r){t.isVector4?rt.set(t.x,t.y,t.z,t.w):rt.set(t,e,n,r),b.viewport($.copy(rt).multiplyScalar(tt).floor())},this.getScissor=function(t){return t.copy(it)},this.setScissor=function(t,e,n,r){t.isVector4?it.set(t.x,t.y,t.z,t.w):it.set(t,e,n,r),b.scissor(Y.copy(it).multiplyScalar(tt).floor())},this.getScissorTest=function(){return at},this.setScissorTest=function(t){b.setScissorTest(at=t)},this.setOpaqueSort=function(t){et=t},this.setTransparentSort=function(t){nt=t},this.getClearColor=function(){return O.getClearColor()},this.setClearColor=function(){O.setClearColor.apply(O,arguments)},this.getClearAlpha=function(){return O.getClearAlpha()},this.setClearAlpha=function(){O.setClearAlpha.apply(O,arguments)},this.clear=function(t,e,n){var r=0;(void 0===t||t)&&(r|=16384),(void 0===e||e)&&(r|=256),(void 0===n||n)&&(r|=1024),v.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",yt,!1),e.removeEventListener("webglcontextrestored",xt,!1),N.dispose(),I.dispose(),_.dispose(),C.dispose(),mt.dispose(),Mt.stop()},this.renderBufferImmediate=function(t,e){b.initAttributes();var n=_.get(t);t.hasPositions&&!n.position&&(n.position=v.createBuffer()),t.hasNormals&&!n.normal&&(n.normal=v.createBuffer()),t.hasUvs&&!n.uv&&(n.uv=v.createBuffer()),t.hasColors&&!n.color&&(n.color=v.createBuffer());var r=e.getAttributes();t.hasPositions&&(v.bindBuffer(34962,n.position),v.bufferData(34962,t.positionArray,35048),b.enableAttribute(r.position),v.vertexAttribPointer(r.position,3,5126,!1,0,0)),t.hasNormals&&(v.bindBuffer(34962,n.normal),v.bufferData(34962,t.normalArray,35048),b.enableAttribute(r.normal),v.vertexAttribPointer(r.normal,3,5126,!1,0,0)),t.hasUvs&&(v.bindBuffer(34962,n.uv),v.bufferData(34962,t.uvArray,35048),b.enableAttribute(r.uv),v.vertexAttribPointer(r.uv,2,5126,!1,0,0)),t.hasColors&&(v.bindBuffer(34962,n.color),v.bufferData(34962,t.colorArray,35048),b.enableAttribute(r.color),v.vertexAttribPointer(r.color,3,5126,!1,0,0)),b.disableUnusedAttributes(),v.drawArrays(4,0,t.count),t.count=0};var _t=new K;this.renderBufferDirect=function(t,e,n,r,i,a){null===e&&(e=_t);var o=i.isMesh&&i.matrixWorld.determinant()<0,s=Nt(t,e,r,i);b.setMaterial(r,o);var u=!1;G.geometry===n.id&&G.program===s.id&&G.wireframe===(!0===r.wireframe)||(G.geometry=n.id,G.program=s.id,G.wireframe=!0===r.wireframe,u=!0),(r.morphTargets||r.morphNormals)&&(k.update(i,n,r,s),u=!0);var c=n.index,l=n.attributes.position;if(null===c){if(void 0===l||0===l.count)return}else if(0===c.count)return;var h,p=1;!0===r.wireframe&&(c=T.getWireframeAttribute(n),p=2);var f=L;null!==c&&(h=E.get(c),(f=D).setIndex(h)),u&&(!function(t,e,n,r){if(!1===x.isWebGL2&&(t.isInstancedMesh||e.isInstancedBufferGeometry)&&null===y.get("ANGLE_instanced_arrays"))return;b.initAttributes();var i=e.attributes,a=r.getAttributes(),o=n.defaultAttributeValues;for(var s in a){var u=a[s];if(u>=0){var c=i[s];if(void 0!==c){var l=c.normalized,h=c.itemSize;if(void 0===(_=E.get(c)))continue;var p=_.buffer,f=_.type,d=_.bytesPerElement;if(c.isInterleavedBufferAttribute){var m=c.data,g=m.stride,w=c.offset;m&&m.isInstancedInterleavedBuffer?(b.enableAttributeAndDivisor(u,m.meshPerAttribute),void 0===e.maxInstancedCount&&(e.maxInstancedCount=m.meshPerAttribute*m.count)):b.enableAttribute(u),v.bindBuffer(34962,p),v.vertexAttribPointer(u,h,f,l,g*d,w*d)}else c.isInstancedBufferAttribute?(b.enableAttributeAndDivisor(u,c.meshPerAttribute),void 0===e.maxInstancedCount&&(e.maxInstancedCount=c.meshPerAttribute*c.count)):b.enableAttribute(u),v.bindBuffer(34962,p),v.vertexAttribPointer(u,h,f,l,0,0)}else if("instanceMatrix"===s){var _;if(void 0===(_=E.get(t.instanceMatrix)))continue;p=_.buffer,f=_.type;b.enableAttributeAndDivisor(u+0,1),b.enableAttributeAndDivisor(u+1,1),b.enableAttributeAndDivisor(u+2,1),b.enableAttributeAndDivisor(u+3,1),v.bindBuffer(34962,p),v.vertexAttribPointer(u+0,4,f,!1,64,0),v.vertexAttribPointer(u+1,4,f,!1,64,16),v.vertexAttribPointer(u+2,4,f,!1,64,32),v.vertexAttribPointer(u+3,4,f,!1,64,48)}else if(void 0!==o){var S=o[s];if(void 0!==S)switch(S.length){case 2:v.vertexAttrib2fv(u,S);break;case 3:v.vertexAttrib3fv(u,S);break;case 4:v.vertexAttrib4fv(u,S);break;default:v.vertexAttrib1fv(u,S)}}}}b.disableUnusedAttributes()}(i,n,r,s),null!==c&&v.bindBuffer(34963,h.buffer));var d=null!==c?c.count:l.count,m=n.drawRange.start*p,g=n.drawRange.count*p,w=null!==a?a.start*p:0,_=null!==a?a.count*p:1/0,S=Math.max(m,w),M=Math.min(d,m+g,w+_)-1,C=Math.max(0,M-S+1);if(0!==C){if(i.isMesh)!0===r.wireframe?(b.setLineWidth(r.wireframeLinewidth*pt()),f.setMode(1)):f.setMode(4);else if(i.isLine){var A=r.linewidth;void 0===A&&(A=1),b.setLineWidth(A*pt()),i.isLineSegments?f.setMode(1):i.isLineLoop?f.setMode(2):f.setMode(3)}else i.isPoints?f.setMode(0):i.isSprite&&f.setMode(4);i.isInstancedMesh?f.renderInstances(n,S,C,i.count):n.isInstancedBufferGeometry?f.renderInstances(n,S,C,n.maxInstancedCount):f.render(S,C)}},this.compile=function(t,e){(m=I.get(t,e)).init(),t.traverse((function(t){t.isLight&&(m.pushLight(t),t.castShadow&&m.pushShadow(t))})),m.setupLights(e);var n={};t.traverse((function(e){if(e.material)if(Array.isArray(e.material))for(var r=0;r<e.material.length;r++)e.material[r].uuid in n==!1&&(At(e.material[r],t,e),n[e.material[r].uuid]=!0);else e.material.uuid in n==!1&&(At(e.material,t,e),n[e.material.uuid]=!0)}))};var St=null;var Mt=new tn;function Et(t,e,n,r){if(!1!==t.visible){if(t.layers.test(e.layers))if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)m.pushLight(t),t.castShadow&&m.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||ot.intersectsSprite(t)){r&&ht.setFromMatrixPosition(t.matrixWorld).applyMatrix4(lt);var i=C.update(t);(a=t.material).visible&&d.push(t,i,a,n,ht.z,null)}}else if(t.isImmediateRenderObject)r&&ht.setFromMatrixPosition(t.matrixWorld).applyMatrix4(lt),d.push(t,null,t.material,n,ht.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==w.render.frame&&(t.skeleton.update(),t.skeleton.frame=w.render.frame),!t.frustumCulled||ot.intersectsObject(t))){r&&ht.setFromMatrixPosition(t.matrixWorld).applyMatrix4(lt);i=C.update(t);var a=t.material;if(Array.isArray(a))for(var o=i.groups,s=0,u=o.length;s<u;s++){var c=o[s],l=a[c.materialIndex];l&&l.visible&&d.push(t,i,l,n,ht.z,c)}else a.visible&&d.push(t,i,a,n,ht.z,null)}var h=t.children;for(s=0,u=h.length;s<u;s++)Et(h[s],e,n,r)}}function Tt(t,e,n,r){for(var i=0,a=t.length;i<a;i++){var o=t[i],s=o.object,u=o.geometry,c=void 0===r?o.material:r,l=o.group;if(n.isArrayCamera)if(X=n,mt.enabled&&vt.isAvailable())Ct(s,e,n,u,c,l);else for(var h=n.cameras,p=0,f=h.length;p<f;p++){var d=h[p];s.layers.test(d.layers)&&(b.viewport($.copy(d.viewport)),m.setupLights(d),Ct(s,e,d,u,c,l))}else X=null,Ct(s,e,n,u,c,l)}}function Ct(t,e,n,r,i,a){if(t.onBeforeRender(F,e,n,r,i,a),m=I.get(e,X||n),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){var o=Nt(n,e,i,t);b.setMaterial(i),G.geometry=null,G.program=null,G.wireframe=!1,function(t,e){t.render((function(t){F.renderBufferImmediate(t,e)}))}(t,o)}else F.renderBufferDirect(n,e,r,i,t,a);t.onAfterRender(F,e,n,r,i,a),m=I.get(e,X||n)}function At(t,e,n){var r=_.get(t),i=m.state.lights,a=m.state.shadowsArray,o=i.state.version,s=A.getParameters(t,i.state,a,e,st.numPlanes,st.numIntersection,n),u=A.getProgramCacheKey(s),c=r.program,l=!0;if(void 0===c)t.addEventListener("dispose",bt);else if(c.cacheKey!==u)wt(t);else if(r.lightsStateVersion!==o)r.lightsStateVersion=o,l=!1;else{if(void 0!==s.shaderID)return;l=!1}l&&(c=A.acquireProgram(s,u),r.program=c,r.uniforms=s.uniforms,r.environment=t.isMeshStandardMaterial?e.environment:null,r.outputEncoding=F.outputEncoding,t.program=c);var h=c.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var p=0;p<F.maxMorphTargets;p++)h["morphTarget"+p]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;for(p=0;p<F.maxMorphNormals;p++)h["morphNormal"+p]>=0&&t.numSupportedMorphNormals++}var f=r.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(r.numClippingPlanes=st.numPlanes,r.numIntersection=st.numIntersection,f.clippingPlanes=st.uniform),r.fog=e.fog,r.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),r.lightsStateVersion=o,r.needsLights&&(f.ambientLightColor.value=i.state.ambient,f.lightProbe.value=i.state.probe,f.directionalLights.value=i.state.directional,f.spotLights.value=i.state.spot,f.rectAreaLights.value=i.state.rectArea,f.pointLights.value=i.state.point,f.hemisphereLights.value=i.state.hemi,f.directionalShadowMap.value=i.state.directionalShadowMap,f.directionalShadowMatrix.value=i.state.directionalShadowMatrix,f.spotShadowMap.value=i.state.spotShadowMap,f.spotShadowMatrix.value=i.state.spotShadowMatrix,f.pointShadowMap.value=i.state.pointShadowMap,f.pointShadowMatrix.value=i.state.pointShadowMatrix);var d=r.program.getUniforms(),v=mr.seqWithValue(d.seq,f);r.uniformsList=v}function Nt(t,e,n,r){M.resetTextureUnits();var i=e.fog,o=n.isMeshStandardMaterial?e.environment:null,s=_.get(n),u=m.state.lights;if(ut&&(ct||t!==q)){var c=t===q&&n.id===H;st.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,t,s,c)}n.version===s.__version?void 0===s.program||n.fog&&s.fog!==i||s.environment!==o||s.needsLights&&s.lightsStateVersion!==u.state.version?At(n,e,r):void 0===s.numClippingPlanes||s.numClippingPlanes===st.numPlanes&&s.numIntersection===st.numIntersection?s.outputEncoding!==F.outputEncoding&&At(n,e,r):At(n,e,r):(At(n,e,r),s.__version=n.version);var l,p,f=!1,d=!1,g=!1,y=s.program,w=y.getUniforms(),S=s.uniforms;if(b.useProgram(y.program)&&(f=!0,d=!0,g=!0),n.id!==H&&(H=n.id,d=!0),f||q!==t){if(y.numMultiviewViews>0?vt.updateCameraProjectionMatricesUniform(t,w):w.setValue(v,"projectionMatrix",t.projectionMatrix),x.logarithmicDepthBuffer&&w.setValue(v,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),q!==t&&(q=t,d=!0,g=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){var E=w.map.cameraPosition;void 0!==E&&E.setValue(v,ht.setFromMatrixPosition(t.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&w.setValue(v,"isOrthographic",!0===t.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&(y.numMultiviewViews>0?vt.updateCameraViewMatricesUniform(t,w):w.setValue(v,"viewMatrix",t.matrixWorldInverse))}if(n.skinning){w.setOptional(v,r,"bindMatrix"),w.setOptional(v,r,"bindMatrixInverse");var T=r.skeleton;if(T){var C=T.bones;if(x.floatVertexTextures){if(void 0===T.boneTexture){var A=Math.sqrt(4*C.length);A=h.ceilPowerOfTwo(A),A=Math.max(A,4);var N=new Float32Array(A*A*4);N.set(T.boneMatrices);var I=new Ye(N,A,A,a,1015);T.boneMatrices=N,T.boneTexture=I,T.boneTextureSize=A}w.setValue(v,"boneTexture",T.boneTexture,M),w.setValue(v,"boneTextureSize",T.boneTextureSize)}else w.setOptional(v,T,"boneMatrices")}}return(d||s.receiveShadow!==r.receiveShadow)&&(s.receiveShadow=r.receiveShadow,w.setValue(v,"receiveShadow",r.receiveShadow)),d&&(w.setValue(v,"toneMappingExposure",F.toneMappingExposure),w.setValue(v,"toneMappingWhitePoint",F.toneMappingWhitePoint),s.needsLights&&(p=g,(l=S).ambientLightColor.needsUpdate=p,l.lightProbe.needsUpdate=p,l.directionalLights.needsUpdate=p,l.pointLights.needsUpdate=p,l.spotLights.needsUpdate=p,l.rectAreaLights.needsUpdate=p,l.hemisphereLights.needsUpdate=p),i&&n.fog&&function(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)}(S,i),n.isMeshBasicMaterial?It(S,n):n.isMeshLambertMaterial?(It(S,n),function(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}(S,n)):n.isMeshToonMaterial?(It(S,n),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.gradientMap&&(t.gradientMap.value=e.gradientMap);e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(S,n)):n.isMeshPhongMaterial?(It(S,n),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(S,n)):n.isMeshStandardMaterial?(It(S,n,o),n.isMeshPhysicalMaterial?function(t,e,n){Rt(t,e,n),t.reflectivity.value=e.reflectivity,t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.sheen&&t.sheen.value.copy(e.sheen);e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,1===e.side&&t.clearcoatNormalScale.value.negate());t.transparency.value=e.transparency}(S,n,o):Rt(S,n,o)):n.isMeshMatcapMaterial?(It(S,n),function(t,e){e.matcap&&(t.matcap.value=e.matcap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(S,n)):n.isMeshDepthMaterial?(It(S,n),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(S,n)):n.isMeshDistanceMaterial?(It(S,n),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias);t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(S,n)):n.isMeshNormalMaterial?(It(S,n),function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(S,n)):n.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity}(S,n),n.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(S,n)):n.isPointsMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*tt,t.scale.value=.5*Q,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);var n;e.map?n=e.map:e.alphaMap&&(n=e.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(S,n):n.isSpriteMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);var n;e.map?n=e.map:e.alphaMap&&(n=e.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(S,n):n.isShadowMaterial&&(S.color.value.copy(n.color),S.opacity.value=n.opacity),void 0!==S.ltc_1&&(S.ltc_1.value=Qe.LTC_1),void 0!==S.ltc_2&&(S.ltc_2.value=Qe.LTC_2),mr.upload(v,s.uniformsList,S,M),n.isShaderMaterial&&(n.uniformsNeedUpdate=!1)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(mr.upload(v,s.uniformsList,S,M),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&w.setValue(v,"center",r.center),y.numMultiviewViews>0?vt.updateObjectMatricesUniforms(r,t,w):(w.setValue(v,"modelViewMatrix",r.modelViewMatrix),w.setValue(v,"normalMatrix",r.normalMatrix)),w.setValue(v,"modelMatrix",r.matrixWorld),y}function It(t,e,n){t.opacity.value=e.opacity,e.color&&t.diffuse.value.copy(e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap);var r,i,a=e.envMap||n;a&&(t.envMap.value=a,t.flipEnvMap.value=a.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio,t.maxMipLevel.value=_.get(a).__maxMipLevel),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity),e.map?r=e.map:e.specularMap?r=e.specularMap:e.displacementMap?r=e.displacementMap:e.normalMap?r=e.normalMap:e.bumpMap?r=e.bumpMap:e.roughnessMap?r=e.roughnessMap:e.metalnessMap?r=e.metalnessMap:e.alphaMap?r=e.alphaMap:e.emissiveMap&&(r=e.emissiveMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix)),e.aoMap?i=e.aoMap:e.lightMap&&(i=e.lightMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uv2Transform.value.copy(i.matrix))}function Rt(t,e,n){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),(e.envMap||n)&&(t.envMapIntensity.value=e.envMapIntensity)}Mt.setAnimationLoop((function(t){mt.isPresenting||St&&St(t)})),"undefined"!=typeof window&&Mt.setContext(window),this.setAnimationLoop=function(t){St=t,mt.setAnimationLoop(t),Mt.start()},this.render=function(t,e){var n,r;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),r=arguments[3]),e&&e.isCamera){if(!B){G.geometry=null,G.program=null,G.wireframe=!1,H=-1,q=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),mt.enabled&&mt.isPresenting&&(e=mt.getCamera(e)),(m=I.get(t,e)).init(),t.onBeforeRender(F,t,e,n||W),lt.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),ot.setFromProjectionMatrix(lt),ct=this.localClippingEnabled,ut=st.init(this.clippingPlanes,ct,e),(d=N.get(t,e)).init(),Et(t,e,0,F.sortObjects),!0===F.sortObjects&&d.sort(et,nt),ut&&st.beginShadows();var i=m.state.shadowsArray;gt.render(i,t,e),m.setupLights(e),ut&&st.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),mt.enabled&&vt.isAvailable()&&vt.attachCamera(e),O.render(d,t,e,r);var a=d.opaque,o=d.transparent;if(t.overrideMaterial){var s=t.overrideMaterial;a.length&&Tt(a,t,e,s),o.length&&Tt(o,t,e,s)}else a.length&&Tt(a,t,e),o.length&&Tt(o,t,e);t.onAfterRender(F,t,e),null!==W&&(M.updateRenderTargetMipmap(W),M.updateMultisampleRenderTarget(W)),b.buffers.depth.setTest(!0),b.buffers.depth.setMask(!0),b.buffers.color.setMask(!0),b.setPolygonOffset(!1),mt.enabled&&vt.isAvailable()&&vt.detachCamera(e),d=null,m=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(t){z!==t&&null===W&&v.bindFramebuffer(36160,t),z=t},this.getActiveCubeFace=function(){return U},this.getActiveMipmapLevel=function(){return j},this.getRenderTarget=function(){return W},this.setRenderTarget=function(t,e,n){W=t,U=e,j=n,t&&void 0===_.get(t).__webglFramebuffer&&M.setupRenderTarget(t);var r=z,i=!1;if(t){var a=_.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(r=a[e||0],i=!0):r=t.isWebGLMultisampleRenderTarget?_.get(t).__webglMultisampledFramebuffer:a,$.copy(t.viewport),Y.copy(t.scissor),J=t.scissorTest}else $.copy(rt).multiplyScalar(tt).floor(),Y.copy(it).multiplyScalar(tt).floor(),J=at;if(V!==r&&(v.bindFramebuffer(36160,r),V=r),b.viewport($),b.scissor(Y),b.setScissorTest(J),i){var o=_.get(t.texture);v.framebufferTexture2D(36160,36064,34069+(e||0),o.__webglTexture,n||0)}},this.readRenderTargetPixels=function(t,e,n,r,i,o,s){if(t&&t.isWebGLRenderTarget){var u=_.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==s&&(u=u[s]),u){var c=!1;u!==V&&(v.bindFramebuffer(36160,u),c=!0);try{var l=t.texture,h=l.format,p=l.type;if(h!==a&&P.convert(h)!==v.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(1009===p||P.convert(p)===v.getParameter(35738)||1015===p&&(x.isWebGL2||y.get("OES_texture_float")||y.get("WEBGL_color_buffer_float"))||1016===p&&(x.isWebGL2?y.get("EXT_color_buffer_float"):y.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===v.checkFramebufferStatus(36160)?e>=0&&e<=t.width-r&&n>=0&&n<=t.height-i&&v.readPixels(e,n,r,i,P.convert(h),P.convert(p),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{c&&v.bindFramebuffer(36160,V)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(t,e,n){void 0===n&&(n=0);var r=Math.pow(2,-n),i=Math.floor(e.image.width*r),a=Math.floor(e.image.height*r),o=P.convert(e.format);M.setTexture2D(e,0),v.copyTexImage2D(3553,n,o,t.x,t.y,i,a,0),b.unbindTexture()},this.copyTextureToTexture=function(t,e,n,r){var i=e.image.width,a=e.image.height,o=P.convert(n.format),s=P.convert(n.type);M.setTexture2D(n,0),e.isDataTexture?v.texSubImage2D(3553,r||0,t.x,t.y,i,a,o,s,e.image.data):v.texSubImage2D(3553,r||0,t.x,t.y,o,s,e.image),b.unbindTexture()},this.initTexture=function(t){M.setTexture2D(t,0),b.unbindTexture()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function ri(t,e){this.name="",this.color=new Ut(t),this.density=void 0!==e?e:25e-5}function ii(t,e,n){this.name="",this.color=new Ut(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3}function ai(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}Jr.prototype=Object.assign(Object.create(y.prototype),{constructor:Jr,isWebGLMultiviewRenderTarget:!0,copy:function(t){return y.prototype.copy.call(this,t),this.numViews=t.numViews,this},setNumViews:function(t){return this.numViews!==t&&(this.numViews=t,this.dispose()),this}}),Qr.prototype=Object.assign(Object.create(qe.prototype),{constructor:Qr,isArrayCamera:!0}),ti.prototype=Object.assign(Object.create(Y.prototype),{constructor:ti,isGroup:!0}),Object.assign(ei.prototype,s.prototype),Object.assign(ri.prototype,{isFogExp2:!0,clone:function(){return new ri(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(ii.prototype,{isFog:!0,clone:function(){return new ii(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(ai.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(ai.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(var r=0,i=this.stride;r<i;r++)this.array[t+r]=e.array[n+r];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}});var oi,si=new S;function ui(t,e,n,r){this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===r}function ci(t){qt.call(this),this.type="SpriteMaterial",this.color=new Ut(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}Object.defineProperties(ui.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(ui.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(var e=0,n=this.data.count;e<n;e++)si.x=this.getX(e),si.y=this.getY(e),si.z=this.getZ(e),si.applyMatrix4(t),this.setXYZ(e,si.x,si.y,si.z);return this},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=i,this}}),ci.prototype=Object.create(qt.prototype),ci.prototype.constructor=ci,ci.prototype.isSpriteMaterial=!0,ci.prototype.copy=function(t){return qt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};var li=new S,hi=new S,pi=new S,fi=new p,di=new p,mi=new R,vi=new S,gi=new S,yi=new S,xi=new p,bi=new p,wi=new p;function _i(t){if(Y.call(this),this.type="Sprite",void 0===oi){oi=new de;var e=new ai(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);oi.setIndex([0,1,2,0,2,3]),oi.setAttribute("position",new ui(e,3,0,!1)),oi.setAttribute("uv",new ui(e,2,3,!1))}this.geometry=oi,this.material=void 0!==t?t:new ci,this.center=new p(.5,.5)}function Si(t,e,n,r,i,a){fi.subVectors(t,n).addScalar(.5).multiply(r),void 0!==i?(di.x=a*fi.x-i*fi.y,di.y=i*fi.x+a*fi.y):di.copy(fi),t.copy(e),t.x+=di.x,t.y+=di.y,t.applyMatrix4(mi)}_i.prototype=Object.assign(Object.create(Y.prototype),{constructor:_i,isSprite:!0,raycast:function(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),hi.setFromMatrixScale(this.matrixWorld),mi.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),pi.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&hi.multiplyScalar(-pi.z);var n,r,i=this.material.rotation;0!==i&&(r=Math.cos(i),n=Math.sin(i));var a=this.center;Si(vi.set(-.5,-.5,0),pi,a,hi,n,r),Si(gi.set(.5,-.5,0),pi,a,hi,n,r),Si(yi.set(.5,.5,0),pi,a,hi,n,r),xi.set(0,0),bi.set(1,0),wi.set(1,1);var o=t.ray.intersectTriangle(vi,gi,yi,!1,li);if(null!==o||(Si(gi.set(-.5,.5,0),pi,a,hi,n,r),bi.set(0,1),null!==(o=t.ray.intersectTriangle(vi,yi,gi,!1,li)))){var s=t.ray.origin.distanceTo(li);s<t.near||s>t.far||e.push({distance:s,point:li.clone(),uv:Pt.getUV(li,vi,gi,yi,xi,bi,wi,new p),face:null,object:this})}},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return Y.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this}});var Mi=new S,Ei=new S;function Ti(){Y.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function Ci(t,e){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Oe.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new R,this.bindMatrixInverse=new R}Ti.prototype=Object.assign(Object.create(Y.prototype),{constructor:Ti,isLOD:!0,copy:function(t){Y.prototype.copy.call(this,t,!1);for(var e=t.levels,n=0,r=e.length;n<r;n++){var i=e[n];this.addLevel(i.object.clone(),i.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var n=this.levels,r=0;r<n.length&&!(e<n[r].distance);r++);return n.splice(r,0,{distance:e,object:t}),this.add(t),this},getObjectForDistance:function(t){var e=this.levels;if(e.length>0){for(var n=1,r=e.length;n<r&&!(t<e[n].distance);n++);return e[n-1].object}return null},raycast:function(t,e){if(this.levels.length>0){Mi.setFromMatrixPosition(this.matrixWorld);var n=t.ray.origin.distanceTo(Mi);this.getObjectForDistance(n).raycast(t,e)}},update:function(t){var e=this.levels;if(e.length>1){Mi.setFromMatrixPosition(t.matrixWorld),Ei.setFromMatrixPosition(this.matrixWorld);var n=Mi.distanceTo(Ei);e[0].object.visible=!0;for(var r=1,i=e.length;r<i&&n>=e[r].distance;r++)e[r-1].object.visible=!1,e[r].object.visible=!0;for(;r<i;r++)e[r].object.visible=!1}},toJSON:function(t){var e=Y.prototype.toJSON.call(this,t);!1===this.autoUpdate&&(e.object.autoUpdate=!1),e.object.levels=[];for(var n=this.levels,r=0,i=n.length;r<i;r++){var a=n[r];e.object.levels.push({object:a.object.uuid,distance:a.distance})}return e}}),Ci.prototype=Object.assign(Object.create(Oe.prototype),{constructor:Ci,isSkinnedMesh:!0,bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new g,e=this.geometry.attributes.skinWeight,n=0,r=e.count;n<r;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);var i=1/t.manhattanLength();i!==1/0?t.multiplyScalar(i):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){Oe.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Ai=new R,Ni=new R;function Ii(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new R)}}function Ri(){Y.call(this),this.type="Bone"}Object.assign(Ii.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var n=new R;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},pose:function(){var t,e,n;for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){for(var t=this.bones,e=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,a=t.length;i<a;i++){var o=t[i]?t[i].matrixWorld:Ni;Ai.multiplyMatrices(o,e[i]),Ai.toArray(n,16*i)}void 0!==r&&(r.needsUpdate=!0)},clone:function(){return new Ii(this.bones,this.boneInverses)},getBoneByName:function(t){for(var e=0,n=this.bones.length;e<n;e++){var r=this.bones[e];if(r.name===t)return r}}}),Ri.prototype=Object.assign(Object.create(Y.prototype),{constructor:Ri,isBone:!0});var Oi=new R,ki=new R,Li=[],Di=new Oe;function Pi(t,e,n){Oe.call(this,t,e),this.instanceMatrix=new Yt(new Float32Array(16*n),16),this.count=n,this.frustumCulled=!1}function Fi(t){qt.call(this),this.type="LineBasicMaterial",this.color=new Ut(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(t)}Pi.prototype=Object.assign(Object.create(Oe.prototype),{constructor:Pi,isInstancedMesh:!0,getMatrixAt:function(t,e){e.fromArray(this.instanceMatrix.array,16*t)},raycast:function(t,e){var n=this.matrixWorld,r=this.count;if(Di.geometry=this.geometry,Di.material=this.material,void 0!==Di.material)for(var i=0;i<r;i++)this.getMatrixAt(i,Oi),ki.multiplyMatrices(n,Oi),Di.matrixWorld=ki,Di.raycast(t,Li),Li.length>0&&(Li[0].instanceId=i,Li[0].object=this,e.push(Li[0]),Li.length=0)},setMatrixAt:function(t,e){e.toArray(this.instanceMatrix.array,16*t)},updateMorphTargets:function(){}}),Fi.prototype=Object.create(qt.prototype),Fi.prototype.constructor=Fi,Fi.prototype.isLineBasicMaterial=!0,Fi.prototype.copy=function(t){return qt.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this};var Bi=new S,zi=new S,Ui=new R,ji=new wt,Wi=new ft;function Vi(t,e,n){1===n&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Y.call(this),this.type="Line",this.geometry=void 0!==t?t:new de,this.material=void 0!==e?e:new Fi}Vi.prototype=Object.assign(Object.create(Y.prototype),{constructor:Vi,isLine:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,n=[0],r=1,i=e.count;r<i;r++)Bi.fromBufferAttribute(e,r-1),zi.fromBufferAttribute(e,r),n[r]=n[r-1],n[r]+=Bi.distanceTo(zi);t.setAttribute("lineDistance",new re(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){var a=t.vertices;(n=t.lineDistances)[0]=0;for(r=1,i=a.length;r<i;r++)n[r]=n[r-1],n[r]+=a[r-1].distanceTo(a[r])}return this},raycast:function(t,e){var n=t.linePrecision,r=this.geometry,i=this.matrixWorld;if(null===r.boundingSphere&&r.computeBoundingSphere(),Wi.copy(r.boundingSphere),Wi.applyMatrix4(i),Wi.radius+=n,!1!==t.ray.intersectsSphere(Wi)){Ui.getInverse(i),ji.copy(t.ray).applyMatrix4(Ui);var a=n/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,s=new S,u=new S,c=new S,l=new S,h=this&&this.isLineSegments?2:1;if(r.isBufferGeometry){var p=r.index,f=r.attributes.position.array;if(null!==p)for(var d=p.array,m=0,v=d.length-1;m<v;m+=h){var g=d[m],y=d[m+1];if(s.fromArray(f,3*g),u.fromArray(f,3*y),!(ji.distanceSqToSegment(s,u,l,c)>o))l.applyMatrix4(this.matrixWorld),(w=t.ray.origin.distanceTo(l))<t.near||w>t.far||e.push({distance:w,point:c.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}else for(m=0,v=f.length/3-1;m<v;m+=h){if(s.fromArray(f,3*m),u.fromArray(f,3*m+3),!(ji.distanceSqToSegment(s,u,l,c)>o))l.applyMatrix4(this.matrixWorld),(w=t.ray.origin.distanceTo(l))<t.near||w>t.far||e.push({distance:w,point:c.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}else if(r.isGeometry){var x=r.vertices,b=x.length;for(m=0;m<b-1;m+=h){var w;if(!(ji.distanceSqToSegment(x[m],x[m+1],l,c)>o))l.applyMatrix4(this.matrixWorld),(w=t.ray.origin.distanceTo(l))<t.near||w>t.far||e.push({distance:w,point:c.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Hi=new S,Gi=new S;function qi(t,e){Vi.call(this,t,e),this.type="LineSegments"}function Xi(t,e){Vi.call(this,t,e),this.type="LineLoop"}function $i(t){qt.call(this),this.type="PointsMaterial",this.color=new Ut(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}qi.prototype=Object.assign(Object.create(Vi.prototype),{constructor:qi,isLineSegments:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,n=[],r=0,i=e.count;r<i;r+=2)Hi.fromBufferAttribute(e,r),Gi.fromBufferAttribute(e,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+Hi.distanceTo(Gi);t.setAttribute("lineDistance",new re(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){var a=t.vertices;for(n=t.lineDistances,r=0,i=a.length;r<i;r+=2)Hi.copy(a[r]),Gi.copy(a[r+1]),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+Hi.distanceTo(Gi)}return this}}),Xi.prototype=Object.assign(Object.create(Vi.prototype),{constructor:Xi,isLineLoop:!0}),$i.prototype=Object.create(qt.prototype),$i.prototype.constructor=$i,$i.prototype.isPointsMaterial=!0,$i.prototype.copy=function(t){return qt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this};var Yi=new R,Ki=new wt,Ji=new ft,Zi=new S;function Qi(t,e){Y.call(this),this.type="Points",this.geometry=void 0!==t?t:new de,this.material=void 0!==e?e:new $i,this.updateMorphTargets()}function ta(t,e,n,r,i,a,o){var s=Ki.distanceSqToPoint(t);if(s<n){var u=new S;Ki.closestPointToPoint(t,u),u.applyMatrix4(r);var c=i.ray.origin.distanceTo(u);if(c<i.near||c>i.far)return;a.push({distance:c,distanceToRay:Math.sqrt(s),point:u,index:e,face:null,object:o})}}function ea(t,e,n,r,a,o,s,u,c){v.call(this,t,e,n,r,a,o,s,u,c),this.format=void 0!==s?s:1022,this.minFilter=void 0!==o?o:i,this.magFilter=void 0!==a?a:i,this.generateMipmaps=!1}function na(t,e,n,r,i,a,o,s,u,c,l,h){v.call(this,null,a,o,s,u,c,r,i,l,h),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function ra(t,e,n,r,i,a,o,s,u){v.call(this,t,e,n,r,i,a,o,s,u),this.needsUpdate=!0}function ia(t,e,n,r,i,a,o,s,u,c){if(1026!==(c=void 0!==c?c:1026)&&1027!==c)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&1026===c&&(n=1012),void 0===n&&1027===c&&(n=1020),v.call(this,null,r,i,a,o,s,c,n,u),this.image={width:t,height:e},this.magFilter=void 0!==o?o:1003,this.minFilter=void 0!==s?s:1003,this.flipY=!1,this.generateMipmaps=!1}function aa(t){de.call(this),this.type="WireframeGeometry";var e,n,r,i,a,o,s,u,c,l,h=[],p=[0,0],f={},d=["a","b","c"];if(t&&t.isGeometry){var m=t.faces;for(e=0,r=m.length;e<r;e++){var v=m[e];for(n=0;n<3;n++)s=v[d[n]],u=v[d[(n+1)%3]],p[0]=Math.min(s,u),p[1]=Math.max(s,u),void 0===f[c=p[0]+","+p[1]]&&(f[c]={index1:p[0],index2:p[1]})}for(c in f)o=f[c],l=t.vertices[o.index1],h.push(l.x,l.y,l.z),l=t.vertices[o.index2],h.push(l.x,l.y,l.z)}else if(t&&t.isBufferGeometry){var g,y,x,b,w,_,M;if(l=new S,null!==t.index){for(g=t.attributes.position,y=t.index,0===(x=t.groups).length&&(x=[{start:0,count:y.count,materialIndex:0}]),i=0,a=x.length;i<a;++i)for(e=w=(b=x[i]).start,r=w+b.count;e<r;e+=3)for(n=0;n<3;n++)s=y.getX(e+n),u=y.getX(e+(n+1)%3),p[0]=Math.min(s,u),p[1]=Math.max(s,u),void 0===f[c=p[0]+","+p[1]]&&(f[c]={index1:p[0],index2:p[1]});for(c in f)o=f[c],l.fromBufferAttribute(g,o.index1),h.push(l.x,l.y,l.z),l.fromBufferAttribute(g,o.index2),h.push(l.x,l.y,l.z)}else for(e=0,r=(g=t.attributes.position).count/3;e<r;e++)for(n=0;n<3;n++)_=3*e+n,l.fromBufferAttribute(g,_),h.push(l.x,l.y,l.z),M=3*e+(n+1)%3,l.fromBufferAttribute(g,M),h.push(l.x,l.y,l.z)}this.setAttribute("position",new re(h,3))}function oa(t,e,n){ze.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n},this.fromBufferGeometry(new sa(t,e,n)),this.mergeVertices()}function sa(t,e,n){de.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:n};var r,i,a=[],o=[],s=[],u=[],c=1e-5,l=new S,h=new S,p=new S,f=new S,d=new S;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var m=e+1;for(r=0;r<=n;r++){var v=r/n;for(i=0;i<=e;i++){var g=i/e;t(g,v,h),o.push(h.x,h.y,h.z),g-c>=0?(t(g-c,v,p),f.subVectors(h,p)):(t(g+c,v,p),f.subVectors(p,h)),v-c>=0?(t(g,v-c,p),d.subVectors(h,p)):(t(g,v+c,p),d.subVectors(p,h)),l.crossVectors(f,d).normalize(),s.push(l.x,l.y,l.z),u.push(g,v)}}for(r=0;r<n;r++)for(i=0;i<e;i++){var y=r*m+i,x=r*m+i+1,b=(r+1)*m+i+1,w=(r+1)*m+i;a.push(y,x,w),a.push(x,b,w)}this.setIndex(a),this.setAttribute("position",new re(o,3)),this.setAttribute("normal",new re(s,3)),this.setAttribute("uv",new re(u,2))}function ua(t,e,n,r){ze.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},this.fromBufferGeometry(new ca(t,e,n,r)),this.mergeVertices()}function ca(t,e,n,r){de.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},n=n||1;var i=[],a=[];function o(t,e,n,r){var i,a,o=Math.pow(2,r),u=[];for(i=0;i<=o;i++){u[i]=[];var c=t.clone().lerp(n,i/o),l=e.clone().lerp(n,i/o),h=o-i;for(a=0;a<=h;a++)u[i][a]=0===a&&i===o?c:c.clone().lerp(l,a/h)}for(i=0;i<o;i++)for(a=0;a<2*(o-i)-1;a++){var p=Math.floor(a/2);a%2==0?(s(u[i][p+1]),s(u[i+1][p]),s(u[i][p])):(s(u[i][p+1]),s(u[i+1][p+1]),s(u[i+1][p]))}}function s(t){i.push(t.x,t.y,t.z)}function u(e,n){var r=3*e;n.x=t[r+0],n.y=t[r+1],n.z=t[r+2]}function c(t,e,n,r){r<0&&1===t.x&&(a[e]=t.x-1),0===n.x&&0===n.z&&(a[e]=r/2/Math.PI+.5)}function l(t){return Math.atan2(t.z,-t.x)}!function(t){for(var n=new S,r=new S,i=new S,a=0;a<e.length;a+=3)u(e[a+0],n),u(e[a+1],r),u(e[a+2],i),o(n,r,i,t)}(r=r||0),function(t){for(var e=new S,n=0;n<i.length;n+=3)e.x=i[n+0],e.y=i[n+1],e.z=i[n+2],e.normalize().multiplyScalar(t),i[n+0]=e.x,i[n+1]=e.y,i[n+2]=e.z}(n),function(){for(var t=new S,e=0;e<i.length;e+=3){t.x=i[e+0],t.y=i[e+1],t.z=i[e+2];var n=l(t)/2/Math.PI+.5,r=(o=t,Math.atan2(-o.y,Math.sqrt(o.x*o.x+o.z*o.z))/Math.PI+.5);a.push(n,1-r)}var o;(function(){for(var t=new S,e=new S,n=new S,r=new S,o=new p,s=new p,u=new p,h=0,f=0;h<i.length;h+=9,f+=6){t.set(i[h+0],i[h+1],i[h+2]),e.set(i[h+3],i[h+4],i[h+5]),n.set(i[h+6],i[h+7],i[h+8]),o.set(a[f+0],a[f+1]),s.set(a[f+2],a[f+3]),u.set(a[f+4],a[f+5]),r.copy(t).add(e).add(n).divideScalar(3);var d=l(r);c(o,f+0,t,d),c(s,f+2,e,d),c(u,f+4,n,d)}})(),function(){for(var t=0;t<a.length;t+=6){var e=a[t+0],n=a[t+2],r=a[t+4],i=Math.max(e,n,r),o=Math.min(e,n,r);i>.9&&o<.1&&(e<.2&&(a[t+0]+=1),n<.2&&(a[t+2]+=1),r<.2&&(a[t+4]+=1))}}()}(),this.setAttribute("position",new re(i,3)),this.setAttribute("normal",new re(i.slice(),3)),this.setAttribute("uv",new re(a,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function la(t,e){ze.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new ha(t,e)),this.mergeVertices()}function ha(t,e){ca.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function pa(t,e){ze.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new fa(t,e)),this.mergeVertices()}function fa(t,e){ca.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function da(t,e){ze.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new ma(t,e)),this.mergeVertices()}function ma(t,e){var n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1];ca.call(this,r,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function va(t,e){ze.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new ga(t,e)),this.mergeVertices()}function ga(t,e){var n=(1+Math.sqrt(5))/2,r=1/n,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r];ca.call(this,i,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function ya(t,e,n,r,i,a){ze.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},void 0!==a&&console.warn("THREE.TubeGeometry: taper has been removed.");var o=new xa(t,e,n,r,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals,this.fromBufferGeometry(o),this.mergeVertices()}function xa(t,e,n,r,i){de.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},e=e||64,n=n||1,r=r||8,i=i||!1;var a=t.computeFrenetFrames(e,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;var o,s,u=new S,c=new S,l=new p,h=new S,f=[],d=[],m=[],v=[];function g(i){h=t.getPointAt(i/e,h);var o=a.normals[i],l=a.binormals[i];for(s=0;s<=r;s++){var p=s/r*Math.PI*2,m=Math.sin(p),v=-Math.cos(p);c.x=v*o.x+m*l.x,c.y=v*o.y+m*l.y,c.z=v*o.z+m*l.z,c.normalize(),d.push(c.x,c.y,c.z),u.x=h.x+n*c.x,u.y=h.y+n*c.y,u.z=h.z+n*c.z,f.push(u.x,u.y,u.z)}}!function(){for(o=0;o<e;o++)g(o);g(!1===i?e:0),function(){for(o=0;o<=e;o++)for(s=0;s<=r;s++)l.x=o/e,l.y=s/r,m.push(l.x,l.y)}(),function(){for(s=1;s<=e;s++)for(o=1;o<=r;o++){var t=(r+1)*(s-1)+(o-1),n=(r+1)*s+(o-1),i=(r+1)*s+o,a=(r+1)*(s-1)+o;v.push(t,n,a),v.push(n,i,a)}}()}(),this.setIndex(v),this.setAttribute("position",new re(f,3)),this.setAttribute("normal",new re(d,3)),this.setAttribute("uv",new re(m,2))}function ba(t,e,n,r,i,a,o){ze.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:a},void 0!==o&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new wa(t,e,n,r,i,a)),this.mergeVertices()}function wa(t,e,n,r,i,a){de.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:a},t=t||1,e=e||.4,n=Math.floor(n)||64,r=Math.floor(r)||8,i=i||2,a=a||3;var o,s,u=[],c=[],l=[],h=[],p=new S,f=new S,d=new S,m=new S,v=new S,g=new S,y=new S;for(o=0;o<=n;++o){var x=o/n*i*Math.PI*2;for(A(x,i,a,t,d),A(x+.01,i,a,t,m),g.subVectors(m,d),y.addVectors(m,d),v.crossVectors(g,y),y.crossVectors(v,g),v.normalize(),y.normalize(),s=0;s<=r;++s){var b=s/r*Math.PI*2,w=-e*Math.cos(b),_=e*Math.sin(b);p.x=d.x+(w*y.x+_*v.x),p.y=d.y+(w*y.y+_*v.y),p.z=d.z+(w*y.z+_*v.z),c.push(p.x,p.y,p.z),f.subVectors(p,d).normalize(),l.push(f.x,f.y,f.z),h.push(o/n),h.push(s/r)}}for(s=1;s<=n;s++)for(o=1;o<=r;o++){var M=(r+1)*(s-1)+(o-1),E=(r+1)*s+(o-1),T=(r+1)*s+o,C=(r+1)*(s-1)+o;u.push(M,E,C),u.push(E,T,C)}function A(t,e,n,r,i){var a=Math.cos(t),o=Math.sin(t),s=n/e*t,u=Math.cos(s);i.x=r*(2+u)*.5*a,i.y=r*(2+u)*o*.5,i.z=r*Math.sin(s)*.5}this.setIndex(u),this.setAttribute("position",new re(c,3)),this.setAttribute("normal",new re(l,3)),this.setAttribute("uv",new re(h,2))}function _a(t,e,n,r,i){ze.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new Sa(t,e,n,r,i)),this.mergeVertices()}function Sa(t,e,n,r,i){de.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},t=t||1,e=e||.4,n=Math.floor(n)||8,r=Math.floor(r)||6,i=i||2*Math.PI;var a,o,s=[],u=[],c=[],l=[],h=new S,p=new S,f=new S;for(a=0;a<=n;a++)for(o=0;o<=r;o++){var d=o/r*i,m=a/n*Math.PI*2;p.x=(t+e*Math.cos(m))*Math.cos(d),p.y=(t+e*Math.cos(m))*Math.sin(d),p.z=e*Math.sin(m),u.push(p.x,p.y,p.z),h.x=t*Math.cos(d),h.y=t*Math.sin(d),f.subVectors(p,h).normalize(),c.push(f.x,f.y,f.z),l.push(o/r),l.push(a/n)}for(a=1;a<=n;a++)for(o=1;o<=r;o++){var v=(r+1)*a+o-1,g=(r+1)*(a-1)+o-1,y=(r+1)*(a-1)+o,x=(r+1)*a+o;s.push(v,g,x),s.push(g,y,x)}this.setIndex(s),this.setAttribute("position",new re(u,3)),this.setAttribute("normal",new re(c,3)),this.setAttribute("uv",new re(l,2))}Qi.prototype=Object.assign(Object.create(Y.prototype),{constructor:Qi,isPoints:!0,raycast:function(t,e){var n=this.geometry,r=this.matrixWorld,i=t.params.Points.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),Ji.copy(n.boundingSphere),Ji.applyMatrix4(r),Ji.radius+=i,!1!==t.ray.intersectsSphere(Ji)){Yi.getInverse(r),Ki.copy(t.ray).applyMatrix4(Yi);var a=i/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a;if(n.isBufferGeometry){var s=n.index,u=n.attributes.position.array;if(null!==s)for(var c=s.array,l=0,h=c.length;l<h;l++){var p=c[l];Zi.fromArray(u,3*p),ta(Zi,p,o,r,t,e,this)}else{l=0;for(var f=u.length/3;l<f;l++)Zi.fromArray(u,3*l),ta(Zi,l,o,r,t,e,this)}}else{var d=n.vertices;for(l=0,f=d.length;l<f;l++)ta(d[l],l,o,r,t,e,this)}}},updateMorphTargets:function(){var t,e,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,a=Object.keys(i);if(a.length>0){var o=i[a[0]];if(void 0!==o)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=o.length;t<e;t++)n=o[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else{var s=r.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),ea.prototype=Object.assign(Object.create(v.prototype),{constructor:ea,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),na.prototype=Object.create(v.prototype),na.prototype.constructor=na,na.prototype.isCompressedTexture=!0,ra.prototype=Object.create(v.prototype),ra.prototype.constructor=ra,ra.prototype.isCanvasTexture=!0,ia.prototype=Object.create(v.prototype),ia.prototype.constructor=ia,ia.prototype.isDepthTexture=!0,aa.prototype=Object.create(de.prototype),aa.prototype.constructor=aa,oa.prototype=Object.create(ze.prototype),oa.prototype.constructor=oa,sa.prototype=Object.create(de.prototype),sa.prototype.constructor=sa,ua.prototype=Object.create(ze.prototype),ua.prototype.constructor=ua,ca.prototype=Object.create(de.prototype),ca.prototype.constructor=ca,la.prototype=Object.create(ze.prototype),la.prototype.constructor=la,ha.prototype=Object.create(ca.prototype),ha.prototype.constructor=ha,pa.prototype=Object.create(ze.prototype),pa.prototype.constructor=pa,fa.prototype=Object.create(ca.prototype),fa.prototype.constructor=fa,da.prototype=Object.create(ze.prototype),da.prototype.constructor=da,ma.prototype=Object.create(ca.prototype),ma.prototype.constructor=ma,va.prototype=Object.create(ze.prototype),va.prototype.constructor=va,ga.prototype=Object.create(ca.prototype),ga.prototype.constructor=ga,ya.prototype=Object.create(ze.prototype),ya.prototype.constructor=ya,xa.prototype=Object.create(de.prototype),xa.prototype.constructor=xa,xa.prototype.toJSON=function(){var t=de.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t},ba.prototype=Object.create(ze.prototype),ba.prototype.constructor=ba,wa.prototype=Object.create(de.prototype),wa.prototype.constructor=wa,_a.prototype=Object.create(ze.prototype),_a.prototype.constructor=_a,Sa.prototype=Object.create(de.prototype),Sa.prototype.constructor=Sa;var Ma=function(t,e,n){n=n||2;var r,i,a,o,s,u,c,l=e&&e.length,h=l?e[0]*n:t.length,p=Ea(t,0,h,n,!0),f=[];if(!p||p.next===p.prev)return f;if(l&&(p=function(t,e,n,r){var i,a,o,s,u,c=[];for(i=0,a=e.length;i<a;i++)o=e[i]*r,s=i<a-1?e[i+1]*r:t.length,(u=Ea(t,o,s,r,!1))===u.next&&(u.steiner=!0),c.push(Da(u));for(c.sort(Oa),i=0;i<c.length;i++)ka(c[i],n),n=Ta(n,n.next);return n}(t,e,p,n)),t.length>80*n){r=a=t[0],i=o=t[1];for(var d=n;d<h;d+=n)(s=t[d])<r&&(r=s),(u=t[d+1])<i&&(i=u),s>a&&(a=s),u>o&&(o=u);c=0!==(c=Math.max(a-r,o-i))?1/c:0}return Ca(p,f,n,r,i,c),f};function Ea(t,e,n,r,i){var a,o;if(i===function(t,e,n,r){for(var i=0,a=e,o=n-r;a<n;a+=r)i+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return i}(t,e,n,r)>0)for(a=e;a<n;a+=r)o=Va(a,t[a],t[a+1],o);else for(a=n-r;a>=e;a-=r)o=Va(a,t[a],t[a+1],o);return o&&za(o,o.next)&&(Ha(o),o=o.next),o}function Ta(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!za(r,r.next)&&0!==Ba(r.prev,r,r.next))r=r.next;else{if(Ha(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function Ca(t,e,n,r,i,a,o){if(t){!o&&a&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=La(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,a,o,s,u,c=1;do{for(n=t,t=null,a=null,o=0;n;){for(o++,r=n,s=0,e=0;e<c&&(s++,r=r.nextZ);e++);for(u=c;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),a?a.nextZ=i:t=i,i.prevZ=a,a=i;n=r}a.nextZ=null,c*=2}while(o>1)}(i)}(t,r,i,a);for(var s,u,c=t;t.prev!==t.next;)if(s=t.prev,u=t.next,a?Na(t,r,i,a):Aa(t))e.push(s.i/n),e.push(t.i/n),e.push(u.i/n),Ha(t),t=u.next,c=u.next;else if((t=u)===c){o?1===o?Ca(t=Ia(t,e,n),e,n,r,i,a,2):2===o&&Ra(t,e,n,r,i,a):Ca(Ta(t),e,n,r,i,a,1);break}}}function Aa(t){var e=t.prev,n=t,r=t.next;if(Ba(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(Pa(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&Ba(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function Na(t,e,n,r){var i=t.prev,a=t,o=t.next;if(Ba(i,a,o)>=0)return!1;for(var s=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,u=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,c=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,l=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,h=La(s,u,e,n,r),p=La(c,l,e,n,r),f=t.prevZ,d=t.nextZ;f&&f.z>=h&&d&&d.z<=p;){if(f!==t.prev&&f!==t.next&&Pa(i.x,i.y,a.x,a.y,o.x,o.y,f.x,f.y)&&Ba(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,d!==t.prev&&d!==t.next&&Pa(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&Ba(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;f&&f.z>=h;){if(f!==t.prev&&f!==t.next&&Pa(i.x,i.y,a.x,a.y,o.x,o.y,f.x,f.y)&&Ba(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;d&&d.z<=p;){if(d!==t.prev&&d!==t.next&&Pa(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&Ba(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function Ia(t,e,n){var r=t;do{var i=r.prev,a=r.next.next;!za(i,a)&&Ua(i,r,r.next,a)&&ja(i,a)&&ja(a,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(a.i/n),Ha(r),Ha(r.next),r=t=a),r=r.next}while(r!==t);return r}function Ra(t,e,n,r,i,a){var o=t;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Fa(o,s)){var u=Wa(o,s);return o=Ta(o,o.next),u=Ta(u,u.next),Ca(o,e,n,r,i,a),void Ca(u,e,n,r,i,a)}s=s.next}o=o.next}while(o!==t)}function Oa(t,e){return t.x-e.x}function ka(t,e){if(e=function(t,e){var n,r=e,i=t.x,a=t.y,o=-1/0;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){var s=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>o){if(o=s,s===i){if(a===r.y)return r;if(a===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===o)return n.prev;var u,c=n,l=n.x,h=n.y,p=1/0;r=n.next;for(;r!==c;)i>=r.x&&r.x>=l&&i!==r.x&&Pa(a<h?i:o,a,l,h,a<h?o:i,a,r.x,r.y)&&((u=Math.abs(a-r.y)/(i-r.x))<p||u===p&&r.x>n.x)&&ja(r,t)&&(n=r,p=u),r=r.next;return n}(t,e)){var n=Wa(e,t);Ta(n,n.next)}}function La(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Da(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function Pa(t,e,n,r,i,a,o,s){return(i-o)*(e-s)-(t-o)*(a-s)>=0&&(t-o)*(r-s)-(n-o)*(e-s)>=0&&(n-o)*(a-s)-(i-o)*(r-s)>=0}function Fa(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Ua(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&ja(t,e)&&ja(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,a=(t.y+e.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)}function Ba(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function za(t,e){return t.x===e.x&&t.y===e.y}function Ua(t,e,n,r){return!!(za(t,n)&&za(e,r)||za(t,r)&&za(n,e))||Ba(t,e,n)>0!=Ba(t,e,r)>0&&Ba(n,r,t)>0!=Ba(n,r,e)>0}function ja(t,e){return Ba(t.prev,t,t.next)<0?Ba(t,e,t.next)>=0&&Ba(t,t.prev,e)>=0:Ba(t,e,t.prev)<0||Ba(t,t.next,e)<0}function Wa(t,e){var n=new Ga(t.i,t.x,t.y),r=new Ga(e.i,e.x,e.y),i=t.next,a=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function Va(t,e,n,r){var i=new Ga(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Ha(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ga(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var qa={area:function(t){for(var e=t.length,n=0,r=e-1,i=0;i<e;r=i++)n+=t[r].x*t[i].y-t[i].x*t[r].y;return.5*n},isClockWise:function(t){return qa.area(t)<0},triangulateShape:function(t,e){var n=[],r=[],i=[];Xa(t),$a(n,t);var a=t.length;e.forEach(Xa);for(var o=0;o<e.length;o++)r.push(a),a+=e[o].length,$a(n,e[o]);var s=Ma(n,r);for(o=0;o<s.length;o+=3)i.push(s.slice(o,o+3));return i}};function Xa(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function $a(t,e){for(var n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}function Ya(t,e){ze.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new Ka(t,e)),this.mergeVertices()}function Ka(t,e){de.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];for(var n=this,r=[],i=[],a=0,o=t.length;a<o;a++){s(t[a])}function s(t){var a=[],o=void 0!==e.curveSegments?e.curveSegments:12,s=void 0!==e.steps?e.steps:1,u=void 0!==e.depth?e.depth:100,c=void 0===e.bevelEnabled||e.bevelEnabled,l=void 0!==e.bevelThickness?e.bevelThickness:6,h=void 0!==e.bevelSize?e.bevelSize:l-2,f=void 0!==e.bevelOffset?e.bevelOffset:0,d=void 0!==e.bevelSegments?e.bevelSegments:3,m=e.extrudePath,v=void 0!==e.UVGenerator?e.UVGenerator:Ja;void 0!==e.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),u=e.amount);var g,y,x,b,w,_,M,E,T=!1;m&&(g=m.getSpacedPoints(s),T=!0,c=!1,y=m.computeFrenetFrames(s,!1),x=new S,b=new S,w=new S),c||(d=0,l=0,h=0,f=0);var C=t.extractPoints(o),A=C.shape,N=C.holes;if(!qa.isClockWise(A))for(A=A.reverse(),M=0,E=N.length;M<E;M++)_=N[M],qa.isClockWise(_)&&(N[M]=_.reverse());var I=qa.triangulateShape(A,N),R=A;for(M=0,E=N.length;M<E;M++)_=N[M],A=A.concat(_);function O(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}var k,L,D,P,F,B,z=A.length,U=I.length;function j(t,e,n){var r,i,a,o=t.x-e.x,s=t.y-e.y,u=n.x-t.x,c=n.y-t.y,l=o*o+s*s,h=o*c-s*u;if(Math.abs(h)>Number.EPSILON){var f=Math.sqrt(l),d=Math.sqrt(u*u+c*c),m=e.x-s/f,v=e.y+o/f,g=((n.x-c/d-m)*c-(n.y+u/d-v)*u)/(o*c-s*u),y=(r=m+o*g-t.x)*r+(i=v+s*g-t.y)*i;if(y<=2)return new p(r,i);a=Math.sqrt(y/2)}else{var x=!1;o>Number.EPSILON?u>Number.EPSILON&&(x=!0):o<-Number.EPSILON?u<-Number.EPSILON&&(x=!0):Math.sign(s)===Math.sign(c)&&(x=!0),x?(r=-s,i=o,a=Math.sqrt(l)):(r=o,i=s,a=Math.sqrt(l/2))}return new p(r/a,i/a)}for(var W=[],V=0,H=R.length,G=H-1,q=V+1;V<H;V++,G++,q++)G===H&&(G=0),q===H&&(q=0),W[V]=j(R[V],R[G],R[q]);var X,$,Y=[],K=W.concat();for(M=0,E=N.length;M<E;M++){for(_=N[M],X=[],V=0,G=(H=_.length)-1,q=V+1;V<H;V++,G++,q++)G===H&&(G=0),q===H&&(q=0),X[V]=j(_[V],_[G],_[q]);Y.push(X),K=K.concat(X)}for(k=0;k<d;k++){for(D=k/d,P=l*Math.cos(D*Math.PI/2),L=h*Math.sin(D*Math.PI/2)+f,V=0,H=R.length;V<H;V++)Z((F=O(R[V],W[V],L)).x,F.y,-P);for(M=0,E=N.length;M<E;M++)for(_=N[M],X=Y[M],V=0,H=_.length;V<H;V++)Z((F=O(_[V],X[V],L)).x,F.y,-P)}for(L=h+f,V=0;V<z;V++)F=c?O(A[V],K[V],L):A[V],T?(b.copy(y.normals[0]).multiplyScalar(F.x),x.copy(y.binormals[0]).multiplyScalar(F.y),w.copy(g[0]).add(b).add(x),Z(w.x,w.y,w.z)):Z(F.x,F.y,0);for($=1;$<=s;$++)for(V=0;V<z;V++)F=c?O(A[V],K[V],L):A[V],T?(b.copy(y.normals[$]).multiplyScalar(F.x),x.copy(y.binormals[$]).multiplyScalar(F.y),w.copy(g[$]).add(b).add(x),Z(w.x,w.y,w.z)):Z(F.x,F.y,u/s*$);for(k=d-1;k>=0;k--){for(D=k/d,P=l*Math.cos(D*Math.PI/2),L=h*Math.sin(D*Math.PI/2)+f,V=0,H=R.length;V<H;V++)Z((F=O(R[V],W[V],L)).x,F.y,u+P);for(M=0,E=N.length;M<E;M++)for(_=N[M],X=Y[M],V=0,H=_.length;V<H;V++)F=O(_[V],X[V],L),T?Z(F.x,F.y+g[s-1].y,g[s-1].x+P):Z(F.x,F.y,u+P)}function J(t,e){var n,r;for(V=t.length;--V>=0;){n=V,(r=V-1)<0&&(r=t.length-1);var i=0,a=s+2*d;for(i=0;i<a;i++){var o=z*i,u=z*(i+1);tt(e+n+o,e+r+o,e+r+u,e+n+u)}}}function Z(t,e,n){a.push(t),a.push(e),a.push(n)}function Q(t,e,i){et(t),et(e),et(i);var a=r.length/3,o=v.generateTopUV(n,r,a-3,a-2,a-1);nt(o[0]),nt(o[1]),nt(o[2])}function tt(t,e,i,a){et(t),et(e),et(a),et(e),et(i),et(a);var o=r.length/3,s=v.generateSideWallUV(n,r,o-6,o-3,o-2,o-1);nt(s[0]),nt(s[1]),nt(s[3]),nt(s[1]),nt(s[2]),nt(s[3])}function et(t){r.push(a[3*t+0]),r.push(a[3*t+1]),r.push(a[3*t+2])}function nt(t){i.push(t.x),i.push(t.y)}!function(){var t=r.length/3;if(c){var e=0,i=z*e;for(V=0;V<U;V++)Q((B=I[V])[2]+i,B[1]+i,B[0]+i);for(i=z*(e=s+2*d),V=0;V<U;V++)Q((B=I[V])[0]+i,B[1]+i,B[2]+i)}else{for(V=0;V<U;V++)Q((B=I[V])[2],B[1],B[0]);for(V=0;V<U;V++)Q((B=I[V])[0]+z*s,B[1]+z*s,B[2]+z*s)}n.addGroup(t,r.length/3-t,0)}(),function(){var t=r.length/3,e=0;for(J(R,e),e+=R.length,M=0,E=N.length;M<E;M++)J(_=N[M],e),e+=_.length;n.addGroup(t,r.length/3-t,1)}()}this.setAttribute("position",new re(r,3)),this.setAttribute("uv",new re(i,2)),this.computeVertexNormals()}Ya.prototype=Object.create(ze.prototype),Ya.prototype.constructor=Ya,Ya.prototype.toJSON=function(){var t=ze.prototype.toJSON.call(this);return Za(this.parameters.shapes,this.parameters.options,t)},Ka.prototype=Object.create(de.prototype),Ka.prototype.constructor=Ka,Ka.prototype.toJSON=function(){var t=de.prototype.toJSON.call(this);return Za(this.parameters.shapes,this.parameters.options,t)};var Ja={generateTopUV:function(t,e,n,r,i){var a=e[3*n],o=e[3*n+1],s=e[3*r],u=e[3*r+1],c=e[3*i],l=e[3*i+1];return[new p(a,o),new p(s,u),new p(c,l)]},generateSideWallUV:function(t,e,n,r,i,a){var o=e[3*n],s=e[3*n+1],u=e[3*n+2],c=e[3*r],l=e[3*r+1],h=e[3*r+2],f=e[3*i],d=e[3*i+1],m=e[3*i+2],v=e[3*a],g=e[3*a+1],y=e[3*a+2];return Math.abs(s-l)<.01?[new p(o,1-u),new p(c,1-h),new p(f,1-m),new p(v,1-y)]:[new p(s,1-u),new p(l,1-h),new p(d,1-m),new p(g,1-y)]}};function Za(t,e,n){if(n.shapes=[],Array.isArray(t))for(var r=0,i=t.length;r<i;r++){var a=t[r];n.shapes.push(a.uuid)}else n.shapes.push(t.uuid);return void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON()),n}function Qa(t,e){ze.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new to(t,e)),this.mergeVertices()}function to(t,e){var n=(e=e||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new ze;var r=n.generateShapes(t,e.size);e.depth=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),Ka.call(this,r,e),this.type="TextBufferGeometry"}function eo(t,e,n,r,i,a,o){ze.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:o},this.fromBufferGeometry(new no(t,e,n,r,i,a,o)),this.mergeVertices()}function no(t,e,n,r,i,a,o){de.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:o},t=t||1,e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI,a=void 0!==a?a:0,o=void 0!==o?o:Math.PI;var s,u,c=Math.min(a+o,Math.PI),l=0,h=[],p=new S,f=new S,d=[],m=[],v=[],g=[];for(u=0;u<=n;u++){var y=[],x=u/n,b=0;for(0==u&&0==a?b=.5/e:u==n&&c==Math.PI&&(b=-.5/e),s=0;s<=e;s++){var w=s/e;p.x=-t*Math.cos(r+w*i)*Math.sin(a+x*o),p.y=t*Math.cos(a+x*o),p.z=t*Math.sin(r+w*i)*Math.sin(a+x*o),m.push(p.x,p.y,p.z),f.copy(p).normalize(),v.push(f.x,f.y,f.z),g.push(w+b,1-x),y.push(l++)}h.push(y)}for(u=0;u<n;u++)for(s=0;s<e;s++){var _=h[u][s+1],M=h[u][s],E=h[u+1][s],T=h[u+1][s+1];(0!==u||a>0)&&d.push(_,M,T),(u!==n-1||c<Math.PI)&&d.push(M,E,T)}this.setIndex(d),this.setAttribute("position",new re(m,3)),this.setAttribute("normal",new re(v,3)),this.setAttribute("uv",new re(g,2))}function ro(t,e,n,r,i,a){ze.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:a},this.fromBufferGeometry(new io(t,e,n,r,i,a)),this.mergeVertices()}function io(t,e,n,r,i,a){de.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:a},t=t||.5,e=e||1,i=void 0!==i?i:0,a=void 0!==a?a:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var o,s,u,c=[],l=[],h=[],f=[],d=t,m=(e-t)/(r=void 0!==r?Math.max(1,r):1),v=new S,g=new p;for(s=0;s<=r;s++){for(u=0;u<=n;u++)o=i+u/n*a,v.x=d*Math.cos(o),v.y=d*Math.sin(o),l.push(v.x,v.y,v.z),h.push(0,0,1),g.x=(v.x/e+1)/2,g.y=(v.y/e+1)/2,f.push(g.x,g.y);d+=m}for(s=0;s<r;s++){var y=s*(n+1);for(u=0;u<n;u++){var x=o=u+y,b=o+n+1,w=o+n+2,_=o+1;c.push(x,b,_),c.push(b,w,_)}}this.setIndex(c),this.setAttribute("position",new re(l,3)),this.setAttribute("normal",new re(h,3)),this.setAttribute("uv",new re(f,2))}function ao(t,e,n,r){ze.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},this.fromBufferGeometry(new oo(t,e,n,r)),this.mergeVertices()}function oo(t,e,n,r){de.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},e=Math.floor(e)||12,n=n||0,r=r||2*Math.PI,r=h.clamp(r,0,2*Math.PI);var i,a,o,s=[],u=[],c=[],l=1/e,f=new S,d=new p;for(a=0;a<=e;a++){var m=n+a*l*r,v=Math.sin(m),g=Math.cos(m);for(o=0;o<=t.length-1;o++)f.x=t[o].x*v,f.y=t[o].y,f.z=t[o].x*g,u.push(f.x,f.y,f.z),d.x=a/e,d.y=o/(t.length-1),c.push(d.x,d.y)}for(a=0;a<e;a++)for(o=0;o<t.length-1;o++){var y=i=o+a*t.length,x=i+t.length,b=i+t.length+1,w=i+1;s.push(y,x,w),s.push(x,b,w)}if(this.setIndex(s),this.setAttribute("position",new re(u,3)),this.setAttribute("uv",new re(c,2)),this.computeVertexNormals(),r===2*Math.PI){var _=this.attributes.normal.array,M=new S,E=new S,T=new S;for(i=e*t.length*3,a=0,o=0;a<t.length;a++,o+=3)M.x=_[o+0],M.y=_[o+1],M.z=_[o+2],E.x=_[i+o+0],E.y=_[i+o+1],E.z=_[i+o+2],T.addVectors(M,E).normalize(),_[o+0]=_[i+o+0]=T.x,_[o+1]=_[i+o+1]=T.y,_[o+2]=_[i+o+2]=T.z}}function so(t,e){ze.call(this),this.type="ShapeGeometry","object"==typeof e&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new uo(t,e)),this.mergeVertices()}function uo(t,e){de.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var n=[],r=[],i=[],a=[],o=0,s=0;if(!1===Array.isArray(t))c(t);else for(var u=0;u<t.length;u++)c(t[u]),this.addGroup(o,s,u),o+=s,s=0;function c(t){var o,u,c,l=r.length/3,h=t.extractPoints(e),p=h.shape,f=h.holes;for(!1===qa.isClockWise(p)&&(p=p.reverse()),o=0,u=f.length;o<u;o++)c=f[o],!0===qa.isClockWise(c)&&(f[o]=c.reverse());var d=qa.triangulateShape(p,f);for(o=0,u=f.length;o<u;o++)c=f[o],p=p.concat(c);for(o=0,u=p.length;o<u;o++){var m=p[o];r.push(m.x,m.y,0),i.push(0,0,1),a.push(m.x,m.y)}for(o=0,u=d.length;o<u;o++){var v=d[o],g=v[0]+l,y=v[1]+l,x=v[2]+l;n.push(g,y,x),s+=3}}this.setIndex(n),this.setAttribute("position",new re(r,3)),this.setAttribute("normal",new re(i,3)),this.setAttribute("uv",new re(a,2))}function co(t,e){if(e.shapes=[],Array.isArray(t))for(var n=0,r=t.length;n<r;n++){var i=t[n];e.shapes.push(i.uuid)}else e.shapes.push(t.uuid);return e}function lo(t,e){de.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e},e=void 0!==e?e:1;var n,r,i,a,o=[],s=Math.cos(h.DEG2RAD*e),u=[0,0],c={},l=["a","b","c"];t.isBufferGeometry?(a=new ze).fromBufferGeometry(t):a=t.clone(),a.mergeVertices(),a.computeFaceNormals();for(var p=a.vertices,f=a.faces,d=0,m=f.length;d<m;d++)for(var v=f[d],g=0;g<3;g++)n=v[l[g]],r=v[l[(g+1)%3]],u[0]=Math.min(n,r),u[1]=Math.max(n,r),void 0===c[i=u[0]+","+u[1]]?c[i]={index1:u[0],index2:u[1],face1:d,face2:void 0}:c[i].face2=d;for(i in c){var y=c[i];if(void 0===y.face2||f[y.face1].normal.dot(f[y.face2].normal)<=s){var x=p[y.index1];o.push(x.x,x.y,x.z),x=p[y.index2],o.push(x.x,x.y,x.z)}}this.setAttribute("position",new re(o,3))}function ho(t,e,n,r,i,a,o,s){ze.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new po(t,e,n,r,i,a,o,s)),this.mergeVertices()}function po(t,e,n,r,i,a,o,s){de.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s};var u=this;t=void 0!==t?t:1,e=void 0!==e?e:1,n=n||1,r=Math.floor(r)||8,i=Math.floor(i)||1,a=void 0!==a&&a,o=void 0!==o?o:0,s=void 0!==s?s:2*Math.PI;var c=[],l=[],h=[],f=[],d=0,m=[],v=n/2,g=0;function y(n){var i,a,m,y=new p,x=new S,b=0,w=!0===n?t:e,_=!0===n?1:-1;for(a=d,i=1;i<=r;i++)l.push(0,v*_,0),h.push(0,_,0),f.push(.5,.5),d++;for(m=d,i=0;i<=r;i++){var M=i/r*s+o,E=Math.cos(M),T=Math.sin(M);x.x=w*T,x.y=v*_,x.z=w*E,l.push(x.x,x.y,x.z),h.push(0,_,0),y.x=.5*E+.5,y.y=.5*T*_+.5,f.push(y.x,y.y),d++}for(i=0;i<r;i++){var C=a+i,A=m+i;!0===n?c.push(A,A+1,C):c.push(A+1,A,C),b+=3}u.addGroup(g,b,!0===n?1:2),g+=b}!function(){var a,p,y=new S,x=new S,b=0,w=(e-t)/n;for(p=0;p<=i;p++){var _=[],M=p/i,E=M*(e-t)+t;for(a=0;a<=r;a++){var T=a/r,C=T*s+o,A=Math.sin(C),N=Math.cos(C);x.x=E*A,x.y=-M*n+v,x.z=E*N,l.push(x.x,x.y,x.z),y.set(A,w,N).normalize(),h.push(y.x,y.y,y.z),f.push(T,1-M),_.push(d++)}m.push(_)}for(a=0;a<r;a++)for(p=0;p<i;p++){var I=m[p][a],R=m[p+1][a],O=m[p+1][a+1],k=m[p][a+1];c.push(I,R,k),c.push(R,O,k),b+=6}u.addGroup(g,b,0),g+=b}(),!1===a&&(t>0&&y(!0),e>0&&y(!1)),this.setIndex(c),this.setAttribute("position",new re(l,3)),this.setAttribute("normal",new re(h,3)),this.setAttribute("uv",new re(f,2))}function fo(t,e,n,r,i,a,o){ho.call(this,0,t,e,n,r,i,a,o),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:a,thetaLength:o}}function mo(t,e,n,r,i,a,o){po.call(this,0,t,e,n,r,i,a,o),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:a,thetaLength:o}}function vo(t,e,n,r){ze.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new go(t,e,n,r)),this.mergeVertices()}function go(t,e,n,r){de.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},t=t||1,e=void 0!==e?Math.max(3,e):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var i,a,o=[],s=[],u=[],c=[],l=new S,h=new p;for(s.push(0,0,0),u.push(0,0,1),c.push(.5,.5),a=0,i=3;a<=e;a++,i+=3){var f=n+a/e*r;l.x=t*Math.cos(f),l.y=t*Math.sin(f),s.push(l.x,l.y,l.z),u.push(0,0,1),h.x=(s[i]/t+1)/2,h.y=(s[i+1]/t+1)/2,c.push(h.x,h.y)}for(i=1;i<=e;i++)o.push(i,i+1,0);this.setIndex(o),this.setAttribute("position",new re(s,3)),this.setAttribute("normal",new re(u,3)),this.setAttribute("uv",new re(c,2))}Qa.prototype=Object.create(ze.prototype),Qa.prototype.constructor=Qa,to.prototype=Object.create(Ka.prototype),to.prototype.constructor=to,eo.prototype=Object.create(ze.prototype),eo.prototype.constructor=eo,no.prototype=Object.create(de.prototype),no.prototype.constructor=no,ro.prototype=Object.create(ze.prototype),ro.prototype.constructor=ro,io.prototype=Object.create(de.prototype),io.prototype.constructor=io,ao.prototype=Object.create(ze.prototype),ao.prototype.constructor=ao,oo.prototype=Object.create(de.prototype),oo.prototype.constructor=oo,so.prototype=Object.create(ze.prototype),so.prototype.constructor=so,so.prototype.toJSON=function(){var t=ze.prototype.toJSON.call(this);return co(this.parameters.shapes,t)},uo.prototype=Object.create(de.prototype),uo.prototype.constructor=uo,uo.prototype.toJSON=function(){var t=de.prototype.toJSON.call(this);return co(this.parameters.shapes,t)},lo.prototype=Object.create(de.prototype),lo.prototype.constructor=lo,ho.prototype=Object.create(ze.prototype),ho.prototype.constructor=ho,po.prototype=Object.create(de.prototype),po.prototype.constructor=po,fo.prototype=Object.create(ho.prototype),fo.prototype.constructor=fo,mo.prototype=Object.create(po.prototype),mo.prototype.constructor=mo,vo.prototype=Object.create(ze.prototype),vo.prototype.constructor=vo,go.prototype=Object.create(de.prototype),go.prototype.constructor=go;var yo=Object.freeze({__proto__:null,WireframeGeometry:aa,ParametricGeometry:oa,ParametricBufferGeometry:sa,TetrahedronGeometry:la,TetrahedronBufferGeometry:ha,OctahedronGeometry:pa,OctahedronBufferGeometry:fa,IcosahedronGeometry:da,IcosahedronBufferGeometry:ma,DodecahedronGeometry:va,DodecahedronBufferGeometry:ga,PolyhedronGeometry:ua,PolyhedronBufferGeometry:ca,TubeGeometry:ya,TubeBufferGeometry:xa,TorusKnotGeometry:ba,TorusKnotBufferGeometry:wa,TorusGeometry:_a,TorusBufferGeometry:Sa,TextGeometry:Qa,TextBufferGeometry:to,SphereGeometry:eo,SphereBufferGeometry:no,RingGeometry:ro,RingBufferGeometry:io,PlaneGeometry:nn,PlaneBufferGeometry:rn,LatheGeometry:ao,LatheBufferGeometry:oo,ShapeGeometry:so,ShapeBufferGeometry:uo,ExtrudeGeometry:Ya,ExtrudeBufferGeometry:Ka,EdgesGeometry:lo,ConeGeometry:fo,ConeBufferGeometry:mo,CylinderGeometry:ho,CylinderBufferGeometry:po,CircleGeometry:vo,CircleBufferGeometry:go,BoxGeometry:class extends ze{constructor(t,e,n,r,i,a){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:a},this.fromBufferGeometry(new Ue(t,e,n,r,i,a)),this.mergeVertices()}},BoxBufferGeometry:Ue});function xo(t){qt.call(this),this.type="ShadowMaterial",this.color=new Ut(0),this.transparent=!0,this.setValues(t)}function bo(t){He.call(this,t),this.type="RawShaderMaterial"}function wo(t){qt.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ut(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new p(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function _o(t){wo.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearcoat=0,this.clearcoatRoughness=0,this.sheen=null,this.clearcoatNormalScale=new p(1,1),this.clearcoatNormalMap=null,this.transparency=0,this.setValues(t)}function So(t){qt.call(this),this.type="MeshPhongMaterial",this.color=new Ut(16777215),this.specular=new Ut(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new p(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Mo(t){qt.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ut(16777215),this.specular=new Ut(1118481),this.shininess=30,this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new p(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Eo(t){qt.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new p(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function To(t){qt.call(this),this.type="MeshLambertMaterial",this.color=new Ut(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Co(t){qt.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ut(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new p(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Ao(t){Fi.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}xo.prototype=Object.create(qt.prototype),xo.prototype.constructor=xo,xo.prototype.isShadowMaterial=!0,xo.prototype.copy=function(t){return qt.prototype.copy.call(this,t),this.color.copy(t.color),this},bo.prototype=Object.create(He.prototype),bo.prototype.constructor=bo,bo.prototype.isRawShaderMaterial=!0,wo.prototype=Object.create(qt.prototype),wo.prototype.constructor=wo,wo.prototype.isMeshStandardMaterial=!0,wo.prototype.copy=function(t){return qt.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},_o.prototype=Object.create(wo.prototype),_o.prototype.constructor=_o,_o.prototype.isMeshPhysicalMaterial=!0,_o.prototype.copy=function(t){return wo.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearcoat=t.clearcoat,this.clearcoatRoughness=t.clearcoatRoughness,t.sheen?this.sheen=(this.sheen||new Ut).copy(t.sheen):this.sheen=null,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.transparency=t.transparency,this},So.prototype=Object.create(qt.prototype),So.prototype.constructor=So,So.prototype.isMeshPhongMaterial=!0,So.prototype.copy=function(t){return qt.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Mo.prototype=Object.create(qt.prototype),Mo.prototype.constructor=Mo,Mo.prototype.isMeshToonMaterial=!0,Mo.prototype.copy=function(t){return qt.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Eo.prototype=Object.create(qt.prototype),Eo.prototype.constructor=Eo,Eo.prototype.isMeshNormalMaterial=!0,Eo.prototype.copy=function(t){return qt.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},To.prototype=Object.create(qt.prototype),To.prototype.constructor=To,To.prototype.isMeshLambertMaterial=!0,To.prototype.copy=function(t){return qt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Co.prototype=Object.create(qt.prototype),Co.prototype.constructor=Co,Co.prototype.isMeshMatcapMaterial=!0,Co.prototype.copy=function(t){return qt.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Ao.prototype=Object.create(Fi.prototype),Ao.prototype.constructor=Ao,Ao.prototype.isLineDashedMaterial=!0,Ao.prototype.copy=function(t){return Fi.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var No=Object.freeze({__proto__:null,ShadowMaterial:xo,SpriteMaterial:ci,RawShaderMaterial:bo,ShaderMaterial:He,PointsMaterial:$i,MeshPhysicalMaterial:_o,MeshStandardMaterial:wo,MeshPhongMaterial:So,MeshToonMaterial:Mo,MeshNormalMaterial:Eo,MeshLambertMaterial:To,MeshDepthMaterial:Gr,MeshDistanceMaterial:qr,MeshBasicMaterial:Xt,MeshMatcapMaterial:Co,LineDashedMaterial:Ao,LineBasicMaterial:Fi,Material:qt}),Io={arraySlice:function(t,e,n){return Io.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,n=new Array(e),r=0;r!==e;++r)n[r]=r;return n.sort((function(e,n){return t[e]-t[n]})),n},sortedArray:function(t,e,n){for(var r=t.length,i=new t.constructor(r),a=0,o=0;o!==r;++a)for(var s=n[a]*e,u=0;u!==e;++u)i[o++]=t[s+u];return i},flattenJSON:function(t,e,n,r){for(var i=1,a=t[0];void 0!==a&&void 0===a[r];)a=t[i++];if(void 0!==a){var o=a[r];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=a[r])&&(e.push(a.time),n.push.apply(n,o)),a=t[i++]}while(void 0!==a);else if(void 0!==o.toArray)do{void 0!==(o=a[r])&&(e.push(a.time),o.toArray(n,n.length)),a=t[i++]}while(void 0!==a);else do{void 0!==(o=a[r])&&(e.push(a.time),n.push(o)),a=t[i++]}while(void 0!==a)}},subclip:function(t,e,n,r,i){i=i||30;var a=t.clone();a.name=e;for(var o=[],s=0;s<a.tracks.length;++s){for(var u=a.tracks[s],c=u.getValueSize(),l=[],h=[],p=0;p<u.times.length;++p){var f=u.times[p]*i;if(!(f<n||f>=r)){l.push(u.times[p]);for(var d=0;d<c;++d)h.push(u.values[p*c+d])}}0!==l.length&&(u.times=Io.convertArray(l,u.times.constructor),u.values=Io.convertArray(h,u.values.constructor),o.push(u))}a.tracks=o;var m=1/0;for(s=0;s<a.tracks.length;++s)m>a.tracks[s].times[0]&&(m=a.tracks[s].times[0]);for(s=0;s<a.tracks.length;++s)a.tracks[s].shift(-1*m);return a.resetDuration(),a}};function Ro(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function Oo(t,e,n,r){Ro.call(this,t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function ko(t,e,n,r){Ro.call(this,t,e,n,r)}function Lo(t,e,n,r){Ro.call(this,t,e,n,r)}function Do(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Io.convertArray(e,this.TimeBufferType),this.values=Io.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}function Po(t,e,n){Do.call(this,t,e,n)}function Fo(t,e,n,r){Do.call(this,t,e,n,r)}function Bo(t,e,n,r){Do.call(this,t,e,n,r)}function zo(t,e,n,r){Ro.call(this,t,e,n,r)}function Uo(t,e,n,r){Do.call(this,t,e,n,r)}function jo(t,e,n,r){Do.call(this,t,e,n,r)}function Wo(t,e,n,r){Do.call(this,t,e,n,r)}function Vo(t,e,n){this.name=t,this.tracks=n,this.duration=void 0!==e?e:-1,this.uuid=h.generateUUID(),this.duration<0&&this.resetDuration()}function Ho(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Bo;case"vector":case"vector2":case"vector3":case"vector4":return Wo;case"color":return Fo;case"quaternion":return Uo;case"bool":case"boolean":return Po;case"string":return jo}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){var n=[],r=[];Io.flattenJSON(t.keys,n,r,"value"),t.times=n,t.values=r}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}Object.assign(Ro.prototype,{evaluate:function(t){var e=this.parameterPositions,n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{var a;n:{r:if(!(t<r)){for(var o=n+2;;){if(void 0===r){if(t<i)break r;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,i)}if(n===o)break;if(i=r,t<(r=e[++n]))break e}a=e.length;break n}if(t>=i)break t;var s=e[1];t<s&&(n=2,i=s);for(o=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===o)break;if(r=i,t>=(i=e[--n-1]))break e}a=n,n=0}for(;n<a;){var u=n+a>>>1;t<e[u]?a=u:n=u+1}if(r=e[n],void 0===(i=e[n-1]))return this._cachedIndex=0,this.beforeStart_(0,t,r);if(void 0===r)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,i,t)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r,a=0;a!==r;++a)e[a]=n[i+a];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(Ro.prototype,{beforeStart_:Ro.prototype.copySampleValue_,afterEnd_:Ro.prototype.copySampleValue_}),Oo.prototype=Object.assign(Object.create(Ro.prototype),{constructor:Oo,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,e,n){var r=this.parameterPositions,i=t-2,a=t+1,o=r[i],s=r[a];if(void 0===o)switch(this.getSettings_().endingStart){case 2401:i=t,o=2*e-n;break;case 2402:o=e+r[i=r.length-2]-r[i+1];break;default:i=t,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:a=t,s=2*n-e;break;case 2402:a=1,s=n+r[1]-r[0];break;default:a=t-1,s=e}var u=.5*(n-e),c=this.valueSize;this._weightPrev=u/(e-o),this._weightNext=u/(s-n),this._offsetPrev=i*c,this._offsetNext=a*c},interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,u=s-o,c=this._offsetPrev,l=this._offsetNext,h=this._weightPrev,p=this._weightNext,f=(n-e)/(r-e),d=f*f,m=d*f,v=-h*m+2*h*d-h*f,g=(1+h)*m+(-1.5-2*h)*d+(-.5+h)*f+1,y=(-1-p)*m+(1.5+p)*d+.5*f,x=p*m-p*d,b=0;b!==o;++b)i[b]=v*a[c+b]+g*a[u+b]+y*a[s+b]+x*a[l+b];return i}}),ko.prototype=Object.assign(Object.create(Ro.prototype),{constructor:ko,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,u=s-o,c=(n-e)/(r-e),l=1-c,h=0;h!==o;++h)i[h]=a[u+h]*l+a[s+h]*c;return i}}),Lo.prototype=Object.assign(Object.create(Ro.prototype),{constructor:Lo,interpolate_:function(t){return this.copySampleValue_(t-1)}}),Object.assign(Do,{toJSON:function(t){var e,n=t.constructor;if(void 0!==n.toJSON)e=n.toJSON(t);else{e={name:t.name,times:Io.convertArray(t.times,Array),values:Io.convertArray(t.values,Array)};var r=t.getInterpolation();r!==t.DefaultInterpolation&&(e.interpolation=r)}return e.type=t.ValueTypeName,e}}),Object.assign(Do.prototype,{constructor:Do,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(t){return new Lo(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new ko(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new Oo(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case 2300:e=this.InterpolantFactoryMethodDiscrete;break;case 2301:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=e,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]*=t;return this},trim:function(t,e){for(var n=this.times,r=n.length,i=0,a=r-1;i!==r&&n[i]<t;)++i;for(;-1!==a&&n[a]>e;)--a;if(++a,0!==i||a!==r){i>=a&&(i=(a=Math.max(a,1))-1);var o=this.getValueSize();this.times=Io.arraySlice(n,i,a),this.values=Io.arraySlice(this.values,i*o,a*o)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var a=null,o=0;o!==i;o++){var s=n[o];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),t=!1;break}if(null!==a&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),t=!1;break}a=s}if(void 0!==r&&Io.isTypedArray(r)){o=0;for(var u=r.length;o!==u;++o){var c=r[o];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,c),t=!1;break}}}return t},optimize:function(){for(var t=Io.arraySlice(this.times),e=Io.arraySlice(this.values),n=this.getValueSize(),r=2302===this.getInterpolation(),i=1,a=t.length-1,o=1;o<a;++o){var s=!1,u=t[o];if(u!==t[o+1]&&(1!==o||u!==u[0]))if(r)s=!0;else for(var c=o*n,l=c-n,h=c+n,p=0;p!==n;++p){var f=e[c+p];if(f!==e[l+p]||f!==e[h+p]){s=!0;break}}if(s){if(o!==i){t[i]=t[o];var d=o*n,m=i*n;for(p=0;p!==n;++p)e[m+p]=e[d+p]}++i}}if(a>0){t[i]=t[a];for(d=a*n,m=i*n,p=0;p!==n;++p)e[m+p]=e[d+p];++i}return i!==t.length?(this.times=Io.arraySlice(t,0,i),this.values=Io.arraySlice(e,0,i*n)):(this.times=t,this.values=e),this},clone:function(){var t=Io.arraySlice(this.times,0),e=Io.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}),Po.prototype=Object.assign(Object.create(Do.prototype),{constructor:Po,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Fo.prototype=Object.assign(Object.create(Do.prototype),{constructor:Fo,ValueTypeName:"color"}),Bo.prototype=Object.assign(Object.create(Do.prototype),{constructor:Bo,ValueTypeName:"number"}),zo.prototype=Object.assign(Object.create(Ro.prototype),{constructor:zo,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,u=(n-e)/(r-e),c=s+o;s!==c;s+=4)b.slerpFlat(i,0,a,s-o,a,s,u);return i}}),Uo.prototype=Object.assign(Object.create(Do.prototype),{constructor:Uo,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(t){return new zo(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),jo.prototype=Object.assign(Object.create(Do.prototype),{constructor:jo,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Wo.prototype=Object.assign(Object.create(Do.prototype),{constructor:Wo,ValueTypeName:"vector"}),Object.assign(Vo,{parse:function(t){for(var e=[],n=t.tracks,r=1/(t.fps||1),i=0,a=n.length;i!==a;++i)e.push(Ho(n[i]).scale(r));return new Vo(t.name,t.duration,e)},toJSON:function(t){for(var e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid},i=0,a=n.length;i!==a;++i)e.push(Do.toJSON(n[i]));return r},CreateFromMorphTargetSequence:function(t,e,n,r){for(var i=e.length,a=[],o=0;o<i;o++){var s=[],u=[];s.push((o+i-1)%i,o,(o+1)%i),u.push(0,1,0);var c=Io.getKeyframeOrder(s);s=Io.sortedArray(s,1,c),u=Io.sortedArray(u,1,c),r||0!==s[0]||(s.push(i),u.push(u[0])),a.push(new Bo(".morphTargetInfluences["+e[o].name+"]",s,u).scale(1/n))}return new Vo(t,-1,a)},findByName:function(t,e){var n=t;if(!Array.isArray(t)){var r=t;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===e)return n[i];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,a=0,o=t.length;a<o;a++){var s=t[a],u=s.name.match(i);if(u&&u.length>1){var c=r[h=u[1]];c||(r[h]=c=[]),c.push(s)}}var l=[];for(var h in r)l.push(Vo.CreateFromMorphTargetSequence(h,r[h],e,n));return l},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(t,e,n,r,i){if(0!==n.length){var a=[],o=[];Io.flattenJSON(n,a,o,r),0!==a.length&&i.push(new t(e,a,o))}},r=[],i=t.name||"default",a=t.length||-1,o=t.fps||30,s=t.hierarchy||[],u=0;u<s.length;u++){var c=s[u].keys;if(c&&0!==c.length)if(c[0].morphTargets){for(var l={},h=0;h<c.length;h++)if(c[h].morphTargets)for(var p=0;p<c[h].morphTargets.length;p++)l[c[h].morphTargets[p]]=-1;for(var f in l){var d=[],m=[];for(p=0;p!==c[h].morphTargets.length;++p){var v=c[h];d.push(v.time),m.push(v.morphTarget===f?1:0)}r.push(new Bo(".morphTargetInfluence["+f+"]",d,m))}a=l.length*(o||1)}else{var g=".bones["+e[u].name+"]";n(Wo,g+".position",c,"pos",r),n(Uo,g+".quaternion",c,"rot",r),n(Wo,g+".scale",c,"scl",r)}}return 0===r.length?null:new Vo(i,a,r)}}),Object.assign(Vo.prototype,{resetDuration:function(){for(var t=0,e=0,n=this.tracks.length;e!==n;++e){var r=this.tracks[e];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new Vo(this.name,this.duration,t)}});var Go={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function qo(t,e,n){var r=this,i=!1,a=0,o=0,s=void 0,u=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){o++,!1===i&&void 0!==r.onStart&&r.onStart(t,a,o),i=!0},this.itemEnd=function(t){a++,void 0!==r.onProgress&&r.onProgress(t,a,o),a===o&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this},this.addHandler=function(t,e){return u.push(t,e),this},this.removeHandler=function(t){var e=u.indexOf(t);return-1!==e&&u.splice(e,2),this},this.getHandler=function(t){for(var e=0,n=u.length;e<n;e+=2){var r=u[e],i=u[e+1];if(r.global&&(r.lastIndex=0),r.test(t))return i}return null}}var Xo=new qo;function $o(t){this.manager=void 0!==t?t:Xo,this.crossOrigin="anonymous",this.path="",this.resourcePath=""}Object.assign($o.prototype,{load:function(){},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this}});var Yo={};function Ko(t){$o.call(this,t)}function Jo(t){$o.call(this,t)}function Zo(t){$o.call(this,t)}function Qo(t){$o.call(this,t)}function ts(t){$o.call(this,t)}function es(t){$o.call(this,t)}function ns(t){$o.call(this,t)}function rs(){this.type="Curve",this.arcLengthDivisions=200}function is(t,e,n,r,i,a,o,s){rs.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=a||2*Math.PI,this.aClockwise=o||!1,this.aRotation=s||0}function as(t,e,n,r,i,a){is.call(this,t,e,n,n,r,i,a),this.type="ArcCurve"}function os(){var t=0,e=0,n=0,r=0;function i(i,a,o,s){t=i,e=o,n=-3*i+3*a-2*o-s,r=2*i-2*a+o+s}return{initCatmullRom:function(t,e,n,r,a){i(e,n,a*(n-t),a*(r-e))},initNonuniformCatmullRom:function(t,e,n,r,a,o,s){var u=(e-t)/a-(n-t)/(a+o)+(n-e)/o,c=(n-e)/o-(r-e)/(o+s)+(r-n)/s;i(e,n,u*=o,c*=o)},calc:function(i){var a=i*i;return t+e*i+n*a+r*(a*i)}}}Ko.prototype=Object.assign(Object.create($o.prototype),{constructor:Ko,load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,a=Go.get(t);if(void 0!==a)return i.manager.itemStart(t),setTimeout((function(){e&&e(a),i.manager.itemEnd(t)}),0),a;if(void 0===Yo[t]){var o=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(o){var s=o[1],u=!!o[2],c=o[3];c=decodeURIComponent(c),u&&(c=atob(c));try{var l,h=(this.responseType||"").toLowerCase();switch(h){case"arraybuffer":case"blob":for(var p=new Uint8Array(c.length),f=0;f<c.length;f++)p[f]=c.charCodeAt(f);l="blob"===h?new Blob([p.buffer],{type:s}):p.buffer;break;case"document":var d=new DOMParser;l=d.parseFromString(c,s);break;case"json":l=JSON.parse(c);break;default:l=c}setTimeout((function(){e&&e(l),i.manager.itemEnd(t)}),0)}catch(e){setTimeout((function(){r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)}),0)}}else{Yo[t]=[],Yo[t].push({onLoad:e,onProgress:n,onError:r});var m=new XMLHttpRequest;for(var v in m.open("GET",t,!0),m.addEventListener("load",(function(e){var n=this.response,r=Yo[t];if(delete Yo[t],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Go.add(t,n);for(var a=0,o=r.length;a<o;a++){(s=r[a]).onLoad&&s.onLoad(n)}i.manager.itemEnd(t)}else{for(a=0,o=r.length;a<o;a++){var s;(s=r[a]).onError&&s.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}}),!1),m.addEventListener("progress",(function(e){for(var n=Yo[t],r=0,i=n.length;r<i;r++){var a=n[r];a.onProgress&&a.onProgress(e)}}),!1),m.addEventListener("error",(function(e){var n=Yo[t];delete Yo[t];for(var r=0,a=n.length;r<a;r++){var o=n[r];o.onError&&o.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}),!1),m.addEventListener("abort",(function(e){var n=Yo[t];delete Yo[t];for(var r=0,a=n.length;r<a;r++){var o=n[r];o.onError&&o.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}),!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(v,this.requestHeader[v]);m.send(null)}return i.manager.itemStart(t),m}Yo[t].push({onLoad:e,onProgress:n,onError:r})},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}}),Jo.prototype=Object.assign(Object.create($o.prototype),{constructor:Jo,load:function(t,e,n,r){var i=this,a=new Ko(i.manager);a.setPath(i.path),a.load(t,(function(t){e(i.parse(JSON.parse(t)))}),n,r)},parse:function(t){for(var e=[],n=0;n<t.length;n++){var r=Vo.parse(t[n]);e.push(r)}return e}}),Zo.prototype=Object.assign(Object.create($o.prototype),{constructor:Zo,load:function(t,e,n,r){var a=this,o=[],s=new na;s.image=o;var u=new Ko(this.manager);function c(c){u.load(t[c],(function(t){var n=a.parse(t,!0);o[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(l+=1)&&(1===n.mipmapCount&&(s.minFilter=i),s.format=n.format,s.needsUpdate=!0,e&&e(s))}),n,r)}if(u.setPath(this.path),u.setResponseType("arraybuffer"),Array.isArray(t))for(var l=0,h=0,p=t.length;h<p;++h)c(h);else u.load(t,(function(t){var n=a.parse(t,!0);if(n.isCubemap)for(var r=n.mipmaps.length/n.mipmapCount,u=0;u<r;u++){o[u]={mipmaps:[]};for(var c=0;c<n.mipmapCount;c++)o[u].mipmaps.push(n.mipmaps[u*n.mipmapCount+c]),o[u].format=n.format,o[u].width=n.width,o[u].height=n.height}else s.image.width=n.width,s.image.height=n.height,s.mipmaps=n.mipmaps;1===n.mipmapCount&&(s.minFilter=i),s.format=n.format,s.needsUpdate=!0,e&&e(s)}),n,r);return s}}),Qo.prototype=Object.assign(Object.create($o.prototype),{constructor:Qo,load:function(t,e,n,r){var a=this,o=new Ye,s=new Ko(this.manager);return s.setResponseType("arraybuffer"),s.setPath(this.path),s.load(t,(function(t){var n=a.parse(t);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:1001,o.wrapT=void 0!==n.wrapT?n.wrapT:1001,o.magFilter=void 0!==n.magFilter?n.magFilter:i,o.minFilter=void 0!==n.minFilter?n.minFilter:i,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps,o.minFilter=1008),1===n.mipmapCount&&(o.minFilter=i),o.needsUpdate=!0,e&&e(o,n))}),n,r),o}}),ts.prototype=Object.assign(Object.create($o.prototype),{constructor:ts,load:function(t,e,n,r){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,a=Go.get(t);if(void 0!==a)return i.manager.itemStart(t),setTimeout((function(){e&&e(a),i.manager.itemEnd(t)}),0),a;var o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){o.removeEventListener("load",s,!1),o.removeEventListener("error",u,!1),Go.add(t,this),e&&e(this),i.manager.itemEnd(t)}function u(e){o.removeEventListener("load",s,!1),o.removeEventListener("error",u,!1),r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)}return o.addEventListener("load",s,!1),o.addEventListener("error",u,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(t),o.src=t,o}}),es.prototype=Object.assign(Object.create($o.prototype),{constructor:es,load:function(t,e,n,r){var i=new yn,a=new ts(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;function s(n){a.load(t[n],(function(t){i.images[n]=t,6===++o&&(i.needsUpdate=!0,e&&e(i))}),void 0,r)}for(var u=0;u<t.length;++u)s(u);return i}}),ns.prototype=Object.assign(Object.create($o.prototype),{constructor:ns,load:function(t,e,n,r){var i=new v,o=new ts(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,(function(n){i.image=n;var r=t.search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/);i.format=r?1022:a,i.needsUpdate=!0,void 0!==e&&e(i)}),n,r),i}}),Object.assign(rs.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){var n=this.getUtoTmapping(t);return this.getPoint(n,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n,r=[],i=this.getPoint(0),a=0;for(r.push(0),n=1;n<=t;n++)a+=(e=this.getPoint(n/t)).distanceTo(i),r.push(a),i=e;return this.cacheArcLengths=r,r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var n,r=this.getLengths(),i=0,a=r.length;n=e||t*r[a-1];for(var o,s=0,u=a-1;s<=u;)if((o=r[i=Math.floor(s+(u-s)/2)]-n)<0)s=i+1;else{if(!(o>0)){u=i;break}u=i-1}if(r[i=u]===n)return i/(a-1);var c=r[i];return(i+(n-c)/(r[i+1]-c))/(a-1)},getTangent:function(t){var e=t-1e-4,n=t+1e-4;e<0&&(e=0),n>1&&(n=1);var r=this.getPoint(e);return this.getPoint(n).clone().sub(r).normalize()},getTangentAt:function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)},computeFrenetFrames:function(t,e){var n,r,i,a=new S,o=[],s=[],u=[],c=new S,l=new R;for(n=0;n<=t;n++)r=n/t,o[n]=this.getTangentAt(r),o[n].normalize();s[0]=new S,u[0]=new S;var p=Number.MAX_VALUE,f=Math.abs(o[0].x),d=Math.abs(o[0].y),m=Math.abs(o[0].z);for(f<=p&&(p=f,a.set(1,0,0)),d<=p&&(p=d,a.set(0,1,0)),m<=p&&a.set(0,0,1),c.crossVectors(o[0],a).normalize(),s[0].crossVectors(o[0],c),u[0].crossVectors(o[0],s[0]),n=1;n<=t;n++)s[n]=s[n-1].clone(),u[n]=u[n-1].clone(),c.crossVectors(o[n-1],o[n]),c.length()>Number.EPSILON&&(c.normalize(),i=Math.acos(h.clamp(o[n-1].dot(o[n]),-1,1)),s[n].applyMatrix4(l.makeRotationAxis(c,i))),u[n].crossVectors(o[n],s[n]);if(!0===e)for(i=Math.acos(h.clamp(s[0].dot(s[t]),-1,1)),i/=t,o[0].dot(c.crossVectors(s[0],s[t]))>0&&(i=-i),n=1;n<=t;n++)s[n].applyMatrix4(l.makeRotationAxis(o[n],i*n)),u[n].crossVectors(o[n],s[n]);return{tangents:o,normals:s,binormals:u}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),is.prototype=Object.create(rs.prototype),is.prototype.constructor=is,is.prototype.isEllipseCurve=!0,is.prototype.getPoint=function(t,e){for(var n=e||new p,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,a=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=a?0:r),!0!==this.aClockwise||a||(i===r?i=-r:i-=r);var o=this.aStartAngle+t*i,s=this.aX+this.xRadius*Math.cos(o),u=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var c=Math.cos(this.aRotation),l=Math.sin(this.aRotation),h=s-this.aX,f=u-this.aY;s=h*c-f*l+this.aX,u=h*l+f*c+this.aY}return n.set(s,u)},is.prototype.copy=function(t){return rs.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},is.prototype.toJSON=function(){var t=rs.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},is.prototype.fromJSON=function(t){return rs.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},as.prototype=Object.create(is.prototype),as.prototype.constructor=as,as.prototype.isArcCurve=!0;var ss=new S,us=new os,cs=new os,ls=new os;function hs(t,e,n,r){rs.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=n||"centripetal",this.tension=r||.5}function ps(t,e,n,r,i){var a=.5*(r-e),o=.5*(i-n),s=t*t;return(2*n-2*r+a+o)*(t*s)+(-3*n+3*r-2*a-o)*s+a*t+n}function fs(t,e,n,r){return function(t,e){var n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,r)}function ds(t,e,n,r,i){return function(t,e){var n=1-t;return n*n*n*e}(t,e)+function(t,e){var n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,r)+function(t,e){return t*t*t*e}(t,i)}function ms(t,e,n,r){rs.call(this),this.type="CubicBezierCurve",this.v0=t||new p,this.v1=e||new p,this.v2=n||new p,this.v3=r||new p}function vs(t,e,n,r){rs.call(this),this.type="CubicBezierCurve3",this.v0=t||new S,this.v1=e||new S,this.v2=n||new S,this.v3=r||new S}function gs(t,e){rs.call(this),this.type="LineCurve",this.v1=t||new p,this.v2=e||new p}function ys(t,e){rs.call(this),this.type="LineCurve3",this.v1=t||new S,this.v2=e||new S}function xs(t,e,n){rs.call(this),this.type="QuadraticBezierCurve",this.v0=t||new p,this.v1=e||new p,this.v2=n||new p}function bs(t,e,n){rs.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new S,this.v1=e||new S,this.v2=n||new S}function ws(t){rs.call(this),this.type="SplineCurve",this.points=t||[]}hs.prototype=Object.create(rs.prototype),hs.prototype.constructor=hs,hs.prototype.isCatmullRomCurve3=!0,hs.prototype.getPoint=function(t,e){var n,r,i,a,o=e||new S,s=this.points,u=s.length,c=(u-(this.closed?0:1))*t,l=Math.floor(c),h=c-l;if(this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/u)+1)*u:0===h&&l===u-1&&(l=u-2,h=1),this.closed||l>0?n=s[(l-1)%u]:(ss.subVectors(s[0],s[1]).add(s[0]),n=ss),r=s[l%u],i=s[(l+1)%u],this.closed||l+2<u?a=s[(l+2)%u]:(ss.subVectors(s[u-1],s[u-2]).add(s[u-1]),a=ss),"centripetal"===this.curveType||"chordal"===this.curveType){var p="chordal"===this.curveType?.5:.25,f=Math.pow(n.distanceToSquared(r),p),d=Math.pow(r.distanceToSquared(i),p),m=Math.pow(i.distanceToSquared(a),p);d<1e-4&&(d=1),f<1e-4&&(f=d),m<1e-4&&(m=d),us.initNonuniformCatmullRom(n.x,r.x,i.x,a.x,f,d,m),cs.initNonuniformCatmullRom(n.y,r.y,i.y,a.y,f,d,m),ls.initNonuniformCatmullRom(n.z,r.z,i.z,a.z,f,d,m)}else"catmullrom"===this.curveType&&(us.initCatmullRom(n.x,r.x,i.x,a.x,this.tension),cs.initCatmullRom(n.y,r.y,i.y,a.y,this.tension),ls.initCatmullRom(n.z,r.z,i.z,a.z,this.tension));return o.set(us.calc(h),cs.calc(h),ls.calc(h)),o},hs.prototype.copy=function(t){rs.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push(r.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},hs.prototype.toJSON=function(){var t=rs.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){var r=this.points[e];t.points.push(r.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},hs.prototype.fromJSON=function(t){rs.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new S).fromArray(r))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},ms.prototype=Object.create(rs.prototype),ms.prototype.constructor=ms,ms.prototype.isCubicBezierCurve=!0,ms.prototype.getPoint=function(t,e){var n=e||new p,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(ds(t,r.x,i.x,a.x,o.x),ds(t,r.y,i.y,a.y,o.y)),n},ms.prototype.copy=function(t){return rs.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},ms.prototype.toJSON=function(){var t=rs.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},ms.prototype.fromJSON=function(t){return rs.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},vs.prototype=Object.create(rs.prototype),vs.prototype.constructor=vs,vs.prototype.isCubicBezierCurve3=!0,vs.prototype.getPoint=function(t,e){var n=e||new S,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(ds(t,r.x,i.x,a.x,o.x),ds(t,r.y,i.y,a.y,o.y),ds(t,r.z,i.z,a.z,o.z)),n},vs.prototype.copy=function(t){return rs.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},vs.prototype.toJSON=function(){var t=rs.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},vs.prototype.fromJSON=function(t){return rs.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},gs.prototype=Object.create(rs.prototype),gs.prototype.constructor=gs,gs.prototype.isLineCurve=!0,gs.prototype.getPoint=function(t,e){var n=e||new p;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},gs.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},gs.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},gs.prototype.copy=function(t){return rs.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},gs.prototype.toJSON=function(){var t=rs.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},gs.prototype.fromJSON=function(t){return rs.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},ys.prototype=Object.create(rs.prototype),ys.prototype.constructor=ys,ys.prototype.isLineCurve3=!0,ys.prototype.getPoint=function(t,e){var n=e||new S;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},ys.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},ys.prototype.copy=function(t){return rs.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ys.prototype.toJSON=function(){var t=rs.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ys.prototype.fromJSON=function(t){return rs.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},xs.prototype=Object.create(rs.prototype),xs.prototype.constructor=xs,xs.prototype.isQuadraticBezierCurve=!0,xs.prototype.getPoint=function(t,e){var n=e||new p,r=this.v0,i=this.v1,a=this.v2;return n.set(fs(t,r.x,i.x,a.x),fs(t,r.y,i.y,a.y)),n},xs.prototype.copy=function(t){return rs.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},xs.prototype.toJSON=function(){var t=rs.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},xs.prototype.fromJSON=function(t){return rs.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},bs.prototype=Object.create(rs.prototype),bs.prototype.constructor=bs,bs.prototype.isQuadraticBezierCurve3=!0,bs.prototype.getPoint=function(t,e){var n=e||new S,r=this.v0,i=this.v1,a=this.v2;return n.set(fs(t,r.x,i.x,a.x),fs(t,r.y,i.y,a.y),fs(t,r.z,i.z,a.z)),n},bs.prototype.copy=function(t){return rs.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},bs.prototype.toJSON=function(){var t=rs.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},bs.prototype.fromJSON=function(t){return rs.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},ws.prototype=Object.create(rs.prototype),ws.prototype.constructor=ws,ws.prototype.isSplineCurve=!0,ws.prototype.getPoint=function(t,e){var n=e||new p,r=this.points,i=(r.length-1)*t,a=Math.floor(i),o=i-a,s=r[0===a?a:a-1],u=r[a],c=r[a>r.length-2?r.length-1:a+1],l=r[a>r.length-3?r.length-1:a+2];return n.set(ps(o,s.x,u.x,c.x,l.x),ps(o,s.y,u.y,c.y,l.y)),n},ws.prototype.copy=function(t){rs.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push(r.clone())}return this},ws.prototype.toJSON=function(){var t=rs.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){var r=this.points[e];t.points.push(r.toArray())}return t},ws.prototype.fromJSON=function(t){rs.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new p).fromArray(r))}return this};var _s=Object.freeze({__proto__:null,ArcCurve:as,CatmullRomCurve3:hs,CubicBezierCurve:ms,CubicBezierCurve3:vs,EllipseCurve:is,LineCurve:gs,LineCurve3:ys,QuadraticBezierCurve:xs,QuadraticBezierCurve3:bs,SplineCurve:ws});function Ss(){rs.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Ms(t){Ss.call(this),this.type="Path",this.currentPoint=new p,t&&this.setFromPoints(t)}function Es(t){Ms.call(this,t),this.uuid=h.generateUUID(),this.type="Shape",this.holes=[]}function Ts(t,e){Y.call(this),this.type="Light",this.color=new Ut(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function Cs(t,e,n){Ts.call(this,t,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Y.DefaultUp),this.updateMatrix(),this.groundColor=new Ut(e)}function As(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new p(512,512),this.map=null,this.mapPass=null,this.matrix=new R,this._frustum=new Ze,this._frameExtents=new p(1,1),this._viewportCount=1,this._viewports=[new g(0,0,1,1)]}function Ns(){As.call(this,new qe(50,1,.5,500))}function Is(t,e,n,r,i,a){Ts.call(this,t,e),this.type="SpotLight",this.position.copy(Y.DefaultUp),this.updateMatrix(),this.target=new Y,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==a?a:1,this.shadow=new Ns}function Rs(){As.call(this,new qe(90,1,.5,500)),this._frameExtents=new p(4,2),this._viewportCount=6,this._viewports=[new g(2,1,1,1),new g(0,1,1,1),new g(3,1,1,1),new g(1,1,1,1),new g(3,0,1,1),new g(1,0,1,1)],this._cubeDirections=[new S(1,0,0),new S(-1,0,0),new S(0,0,1),new S(0,0,-1),new S(0,1,0),new S(0,-1,0)],this._cubeUps=[new S(0,1,0),new S(0,1,0),new S(0,1,0),new S(0,1,0),new S(0,0,1),new S(0,0,-1)]}function Os(t,e,n,r){Ts.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new Rs}function ks(t,e,n,r,i,a){Ge.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==t?t:-1,this.right=void 0!==e?e:1,this.top=void 0!==n?n:1,this.bottom=void 0!==r?r:-1,this.near=void 0!==i?i:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()}function Ls(){As.call(this,new ks(-5,5,5,-5,.5,500))}function Ds(t,e){Ts.call(this,t,e),this.type="DirectionalLight",this.position.copy(Y.DefaultUp),this.updateMatrix(),this.target=new Y,this.shadow=new Ls}function Ps(t,e){Ts.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function Fs(t,e,n,r){Ts.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}function Bs(t){$o.call(this,t),this.textures={}}Ss.prototype=Object.assign(Object.create(rs.prototype),{constructor:Ss,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new gs(e,t))},getPoint:function(t){for(var e=t*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=e){var i=n[r]-e,a=this.curves[r],o=a.getLength(),s=0===o?0:1-i/o;return a.getPointAt(s)}r++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,n=[],r=0,i=this.curves;r<i.length;r++)for(var a=i[r],o=a&&a.isEllipseCurve?2*t:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?t*a.points.length:t,s=a.getPoints(o),u=0;u<s.length;u++){var c=s[u];e&&e.equals(c)||(n.push(c),e=c)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(t){rs.prototype.copy.call(this,t),this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var r=t.curves[e];this.curves.push(r.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){var t=rs.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,n=this.curves.length;e<n;e++){var r=this.curves[e];t.curves.push(r.toJSON())}return t},fromJSON:function(t){rs.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var r=t.curves[e];this.curves.push((new _s[r.type]).fromJSON(r))}return this}}),Ms.prototype=Object.assign(Object.create(Ss.prototype),{constructor:Ms,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this},moveTo:function(t,e){return this.currentPoint.set(t,e),this},lineTo:function(t,e){var n=new gs(this.currentPoint.clone(),new p(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this},quadraticCurveTo:function(t,e,n,r){var i=new xs(this.currentPoint.clone(),new p(t,e),new p(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this},bezierCurveTo:function(t,e,n,r,i,a){var o=new ms(this.currentPoint.clone(),new p(t,e),new p(n,r),new p(i,a));return this.curves.push(o),this.currentPoint.set(i,a),this},splineThru:function(t){var e=new ws([this.currentPoint.clone()].concat(t));return this.curves.push(e),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,e,n,r,i,a){var o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(t+o,e+s,n,r,i,a),this},absarc:function(t,e,n,r,i,a){return this.absellipse(t,e,n,n,r,i,a),this},ellipse:function(t,e,n,r,i,a,o,s){var u=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(t+u,e+c,n,r,i,a,o,s),this},absellipse:function(t,e,n,r,i,a,o,s){var u=new is(t,e,n,r,i,a,o,s);if(this.curves.length>0){var c=u.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(u);var l=u.getPoint(1);return this.currentPoint.copy(l),this},copy:function(t){return Ss.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=Ss.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return Ss.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),Es.prototype=Object.assign(Object.create(Ms.prototype),{constructor:Es,getPointsHoles:function(t){for(var e=[],n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){Ms.prototype.copy.call(this,t),this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var r=t.holes[e];this.holes.push(r.clone())}return this},toJSON:function(){var t=Ms.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,n=this.holes.length;e<n;e++){var r=this.holes[e];t.holes.push(r.toJSON())}return t},fromJSON:function(t){Ms.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var r=t.holes[e];this.holes.push((new Ms).fromJSON(r))}return this}}),Ts.prototype=Object.assign(Object.create(Y.prototype),{constructor:Ts,isLight:!0,copy:function(t){return Y.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var e=Y.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),Cs.prototype=Object.assign(Object.create(Ts.prototype),{constructor:Cs,isHemisphereLight:!0,copy:function(t){return Ts.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(As.prototype,{_projScreenMatrix:new R,_lightPositionWorld:new S,_lookTarget:new S,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){var e=this.camera,n=this.matrix,r=this._projScreenMatrix,i=this._lookTarget,a=this._lightPositionWorld;a.setFromMatrixPosition(t.matrixWorld),e.position.copy(a),i.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(i),e.updateMatrixWorld(),r.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(r),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),Ns.prototype=Object.assign(Object.create(As.prototype),{constructor:Ns,isSpotLightShadow:!0,updateMatrices:function(t){var e=this.camera,n=2*h.RAD2DEG*t.angle,r=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;n===e.fov&&r===e.aspect&&i===e.far||(e.fov=n,e.aspect=r,e.far=i,e.updateProjectionMatrix()),As.prototype.updateMatrices.call(this,t)}}),Is.prototype=Object.assign(Object.create(Ts.prototype),{constructor:Is,isSpotLight:!0,copy:function(t){return Ts.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Rs.prototype=Object.assign(Object.create(As.prototype),{constructor:Rs,isPointLightShadow:!0,updateMatrices:function(t,e){void 0===e&&(e=0);var n=this.camera,r=this.matrix,i=this._lightPositionWorld,a=this._lookTarget,o=this._projScreenMatrix;i.setFromMatrixPosition(t.matrixWorld),n.position.copy(i),a.copy(n.position),a.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(a),n.updateMatrixWorld(),r.makeTranslation(-i.x,-i.y,-i.z),o.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(o)}}),Os.prototype=Object.assign(Object.create(Ts.prototype),{constructor:Os,isPointLight:!0,copy:function(t){return Ts.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),ks.prototype=Object.assign(Object.create(Ge.prototype),{constructor:ks,isOrthographicCamera:!0,copy:function(t,e){return Ge.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,r,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-t,a=n+t,o=r+e,s=r-e;if(null!==this.view&&this.view.enabled){var u=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a=(i+=u*this.view.offsetX)+u*this.view.width,s=(o-=c*this.view.offsetY)-c*this.view.height}this.projectionMatrix.makeOrthographic(i,a,o,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){var e=Y.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}),Ls.prototype=Object.assign(Object.create(As.prototype),{constructor:Ls,isDirectionalLightShadow:!0,updateMatrices:function(t){As.prototype.updateMatrices.call(this,t)}}),Ds.prototype=Object.assign(Object.create(Ts.prototype),{constructor:Ds,isDirectionalLight:!0,copy:function(t){return Ts.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Ps.prototype=Object.assign(Object.create(Ts.prototype),{constructor:Ps,isAmbientLight:!0}),Fs.prototype=Object.assign(Object.create(Ts.prototype),{constructor:Fs,isRectAreaLight:!0,copy:function(t){return Ts.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){var e=Ts.prototype.toJSON.call(this,t);return e.object.width=this.width,e.object.height=this.height,e}}),Bs.prototype=Object.assign(Object.create($o.prototype),{constructor:Bs,load:function(t,e,n,r){var i=this,a=new Ko(i.manager);a.setPath(i.path),a.load(t,(function(t){e(i.parse(JSON.parse(t)))}),n,r)},parse:function(t){var e=this.textures;function n(t){return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]}var r=new No[t.type];if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.sheen&&(r.sheen=(new Ut).setHex(t.sheen)),void 0!==t.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&r.specular.setHex(t.specular),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.clearcoat&&(r.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(r.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.vertexColors&&(r.vertexColors=t.vertexColors),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.flatShading&&(r.flatShading=t.flatShading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.combine&&(r.combine=t.combine),void 0!==t.side&&(r.side=t.side),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(r.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(r.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(r.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(r.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(r.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(r.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(r.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(r.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(r.rotation=t.rotation),1!==t.linewidth&&(r.linewidth=t.linewidth),void 0!==t.dashSize&&(r.dashSize=t.dashSize),void 0!==t.gapSize&&(r.gapSize=t.gapSize),void 0!==t.scale&&(r.scale=t.scale),void 0!==t.polygonOffset&&(r.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(r.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(r.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(r.skinning=t.skinning),void 0!==t.morphTargets&&(r.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(r.morphNormals=t.morphNormals),void 0!==t.dithering&&(r.dithering=t.dithering),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.toneMapped&&(r.toneMapped=t.toneMapped),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.uniforms)for(var i in t.uniforms){var a=t.uniforms[i];switch(r.uniforms[i]={},a.type){case"t":r.uniforms[i].value=n(a.value);break;case"c":r.uniforms[i].value=(new Ut).setHex(a.value);break;case"v2":r.uniforms[i].value=(new p).fromArray(a.value);break;case"v3":r.uniforms[i].value=(new S).fromArray(a.value);break;case"v4":r.uniforms[i].value=(new g).fromArray(a.value);break;case"m3":r.uniforms[i].value=(new f).fromArray(a.value);case"m4":r.uniforms[i].value=(new R).fromArray(a.value);break;default:r.uniforms[i].value=a.value}}if(void 0!==t.defines&&(r.defines=t.defines),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(var o in t.extensions)r.extensions[o]=t.extensions[o];if(void 0!==t.shading&&(r.flatShading=1===t.shading),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=n(t.map)),void 0!==t.matcap&&(r.matcap=n(t.matcap)),void 0!==t.alphaMap&&(r.alphaMap=n(t.alphaMap),r.transparent=!0),void 0!==t.bumpMap&&(r.bumpMap=n(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=n(t.normalMap)),void 0!==t.normalMapType&&(r.normalMapType=t.normalMapType),void 0!==t.normalScale){var s=t.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new p).fromArray(s)}return void 0!==t.displacementMap&&(r.displacementMap=n(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=n(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=n(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=n(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=n(t.specularMap)),void 0!==t.envMap&&(r.envMap=n(t.envMap)),void 0!==t.envMapIntensity&&(r.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(r.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(r.lightMap=n(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=n(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(r.gradientMap=n(t.gradientMap)),void 0!==t.clearcoatNormalMap&&(r.clearcoatNormalMap=n(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(r.clearcoatNormalScale=(new p).fromArray(t.clearcoatNormalScale)),r},setTextures:function(t){return this.textures=t,this}});var zs=function(t){var e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)};function Us(){de.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function js(t,e,n,r){"number"==typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Yt.call(this,t,e,n),this.meshPerAttribute=r||1}function Ws(t){$o.call(this,t)}Us.prototype=Object.assign(Object.create(de.prototype),{constructor:Us,isInstancedBufferGeometry:!0,copy:function(t){return de.prototype.copy.call(this,t),this.maxInstancedCount=t.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t=de.prototype.toJSON.call(this);return t.maxInstancedCount=this.maxInstancedCount,t.isInstancedBufferGeometry=!0,t}}),js.prototype=Object.assign(Object.create(Yt.prototype),{constructor:js,isInstancedBufferAttribute:!0,copy:function(t){return Yt.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){var t=Yt.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}),Ws.prototype=Object.assign(Object.create($o.prototype),{constructor:Ws,load:function(t,e,n,r){var i=this,a=new Ko(i.manager);a.setPath(i.path),a.load(t,(function(t){e(i.parse(JSON.parse(t)))}),n,r)},parse:function(t){var e=t.isInstancedBufferGeometry?new Us:new de,n=t.data.index;if(void 0!==n){var r=new Vs[n.type](n.array);e.setIndex(new Yt(r,1))}var i=t.data.attributes;for(var a in i){var o=i[a],s=(r=new Vs[o.type](o.array),new(o.isInstancedBufferAttribute?js:Yt)(r,o.itemSize,o.normalized));void 0!==o.name&&(s.name=o.name),e.setAttribute(a,s)}var u=t.data.morphAttributes;if(u)for(var a in u){for(var c=u[a],l=[],h=0,p=c.length;h<p;h++){o=c[h],s=new Yt(r=new Vs[o.type](o.array),o.itemSize,o.normalized);void 0!==o.name&&(s.name=o.name),l.push(s)}e.morphAttributes[a]=l}t.data.morphTargetsRelative&&(e.morphTargetsRelative=!0);var f=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==f){h=0;for(var d=f.length;h!==d;++h){var m=f[h];e.addGroup(m.start,m.count,m.materialIndex)}}var v=t.data.boundingSphere;if(void 0!==v){var g=new S;void 0!==v.center&&g.fromArray(v.center),e.boundingSphere=new ft(g,v.radius)}return t.name&&(e.name=t.name),t.userData&&(e.userData=t.userData),e}});var Vs={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Hs(t){$o.call(this,t)}Hs.prototype=Object.assign(Object.create($o.prototype),{constructor:Hs,load:function(t,e,n,r){var i=this,a=""===this.path?zs(t):this.path;this.resourcePath=this.resourcePath||a;var o=new Ko(i.manager);o.setPath(this.path),o.load(t,(function(n){var a=null;try{a=JSON.parse(n)}catch(e){return void 0!==r&&r(e),void console.error("THREE:ObjectLoader: Can't parse "+t+".",e.message)}var o=a.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?i.parse(a,e):console.error("THREE.ObjectLoader: Can't load "+t)}),n,r)},parse:function(t,e){var n=this.parseShape(t.shapes),r=this.parseGeometries(t.geometries,n),i=this.parseImages(t.images,(function(){void 0!==e&&e(s)})),a=this.parseTextures(t.textures,i),o=this.parseMaterials(t.materials,a),s=this.parseObject(t.object,r,o);return t.animations&&(s.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(s),s},parseShape:function(t){var e={};if(void 0!==t)for(var n=0,r=t.length;n<r;n++){var i=(new Es).fromJSON(t[n]);e[i.uuid]=i}return e},parseGeometries:function(t,e){var n={};if(void 0!==t)for(var r=new Ws,i=0,a=t.length;i<a;i++){var o,s=t[i];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":o=new yo[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":o=new yo[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":o=new yo[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":o=new yo[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":o=new yo[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":o=new yo[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":o=new yo[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":o=new yo[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":o=new yo[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":o=new yo[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":o=new yo[s.type]((new _s[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":o=new yo[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":o=new yo[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var u=[],c=0,l=s.shapes.length;c<l;c++){var h=e[s.shapes[c]];u.push(h)}o=new yo[s.type](u,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(u=[],c=0,l=s.shapes.length;c<l;c++){h=e[s.shapes[c]];u.push(h)}var p=s.options.extrudePath;void 0!==p&&(s.options.extrudePath=(new _s[p.type]).fromJSON(p)),o=new yo[s.type](u,s.options);break;case"BufferGeometry":case"InstancedBufferGeometry":o=r.parse(s);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE)o=(new THREE.LegacyJSONLoader).parse(s,this.resourcePath).geometry;else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),!0===o.isBufferGeometry&&void 0!==s.userData&&(o.userData=s.userData),n[s.uuid]=o}return n},parseMaterials:function(t,e){var n={},r={};if(void 0!==t){var i=new Bs;i.setTextures(e);for(var a=0,o=t.length;a<o;a++){var s=t[a];if("MultiMaterial"===s.type){for(var u=[],c=0;c<s.materials.length;c++){var l=s.materials[c];void 0===n[l.uuid]&&(n[l.uuid]=i.parse(l)),u.push(n[l.uuid])}r[s.uuid]=u}else void 0===n[s.uuid]&&(n[s.uuid]=i.parse(s)),r[s.uuid]=n[s.uuid]}}return r},parseAnimations:function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n],i=Vo.parse(r);void 0!==r.uuid&&(i.uuid=r.uuid),e.push(i)}return e},parseImages:function(t,e){var n=this,r={};function i(t){return n.manager.itemStart(t),a.load(t,(function(){n.manager.itemEnd(t)}),void 0,(function(){n.manager.itemError(t),n.manager.itemEnd(t)}))}if(void 0!==t&&t.length>0){var a=new ts(new qo(e));a.setCrossOrigin(this.crossOrigin);for(var o=0,s=t.length;o<s;o++){var u=t[o],c=u.url;if(Array.isArray(c)){r[u.uuid]=[];for(var l=0,h=c.length;l<h;l++){var p=c[l],f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(p)?p:n.resourcePath+p;r[u.uuid].push(i(f))}}else{f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u.url)?u.url:n.resourcePath+u.url;r[u.uuid]=i(f)}}}return r},parseTextures:function(t,e){function n(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var r={};if(void 0!==t)for(var i=0,a=t.length;i<a;i++){var o,s=t[i];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===e[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image),(o=Array.isArray(e[s.image])?new yn(e[s.image]):new v(e[s.image])).needsUpdate=!0,o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),void 0!==s.mapping&&(o.mapping=n(s.mapping,qs)),void 0!==s.offset&&o.offset.fromArray(s.offset),void 0!==s.repeat&&o.repeat.fromArray(s.repeat),void 0!==s.center&&o.center.fromArray(s.center),void 0!==s.rotation&&(o.rotation=s.rotation),void 0!==s.wrap&&(o.wrapS=n(s.wrap[0],Xs),o.wrapT=n(s.wrap[1],Xs)),void 0!==s.format&&(o.format=s.format),void 0!==s.type&&(o.type=s.type),void 0!==s.encoding&&(o.encoding=s.encoding),void 0!==s.minFilter&&(o.minFilter=n(s.minFilter,$s)),void 0!==s.magFilter&&(o.magFilter=n(s.magFilter,$s)),void 0!==s.anisotropy&&(o.anisotropy=s.anisotropy),void 0!==s.flipY&&(o.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(o.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(o.unpackAlignment=s.unpackAlignment),r[s.uuid]=o}return r},parseObject:function(t,e,n){var r;function i(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function a(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],r=0,i=t.length;r<i;r++){var a=t[r];void 0===n[a]&&console.warn("THREE.ObjectLoader: Undefined material",a),e.push(n[a])}return e}return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),n[t]}}switch(t.type){case"Scene":r=new K,void 0!==t.background&&Number.isInteger(t.background)&&(r.background=new Ut(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?r.fog=new ii(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(r.fog=new ri(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":r=new qe(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(r.focus=t.focus),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.filmGauge&&(r.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(r.filmOffset=t.filmOffset),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"OrthographicCamera":r=new ks(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"AmbientLight":r=new Ps(t.color,t.intensity);break;case"DirectionalLight":r=new Ds(t.color,t.intensity);break;case"PointLight":r=new Os(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":r=new Fs(t.color,t.intensity,t.width,t.height);break;case"SpotLight":r=new Is(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":r=new Cs(t.color,t.groundColor,t.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var o=i(t.geometry),s=a(t.material);r=o.bones&&o.bones.length>0?new Ci(o,s):new Oe(o,s);break;case"InstancedMesh":o=i(t.geometry),s=a(t.material);var u=t.count,c=t.instanceMatrix;(r=new Pi(o,s,u)).instanceMatrix=new Yt(new Float32Array(c.array),16);break;case"LOD":r=new Ti;break;case"Line":r=new Vi(i(t.geometry),a(t.material),t.mode);break;case"LineLoop":r=new Xi(i(t.geometry),a(t.material));break;case"LineSegments":r=new qi(i(t.geometry),a(t.material));break;case"PointCloud":case"Points":r=new Qi(i(t.geometry),a(t.material));break;case"Sprite":r=new _i(a(t.material));break;case"Group":r=new ti;break;default:r=new Y}if(r.uuid=t.uuid,void 0!==t.name&&(r.name=t.name),void 0!==t.matrix?(r.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(r.matrixAutoUpdate=t.matrixAutoUpdate),r.matrixAutoUpdate&&r.matrix.decompose(r.position,r.quaternion,r.scale)):(void 0!==t.position&&r.position.fromArray(t.position),void 0!==t.rotation&&r.rotation.fromArray(t.rotation),void 0!==t.quaternion&&r.quaternion.fromArray(t.quaternion),void 0!==t.scale&&r.scale.fromArray(t.scale)),void 0!==t.castShadow&&(r.castShadow=t.castShadow),void 0!==t.receiveShadow&&(r.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(r.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(r.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&r.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(r.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.frustumCulled&&(r.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(r.renderOrder=t.renderOrder),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.layers&&(r.layers.mask=t.layers),void 0!==t.children)for(var l=t.children,h=0;h<l.length;h++)r.add(this.parseObject(l[h],e,n));if("LOD"===t.type){void 0!==t.autoUpdate&&(r.autoUpdate=t.autoUpdate);for(var p=t.levels,f=0;f<p.length;f++){var d=p[f],m=r.getObjectByProperty("uuid",d.object);void 0!==m&&r.addLevel(m,d.distance)}}return r}});var Gs,qs={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},Xs={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},$s={NearestFilter:1003,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:1005,LinearFilter:i,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:1008};function Ys(t){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),$o.call(this,t),this.options=void 0}function Ks(){this.type="ShapePath",this.color=new Ut,this.subPaths=[],this.currentPath=null}function Js(t){this.type="Font",this.data=t}function Zs(t,e,n,r,i){var a=i.glyphs[t]||i.glyphs["?"];if(a){var o,s,u,c,l,h,p,f,d=new Ks;if(a.o)for(var m=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),v=0,g=m.length;v<g;){switch(m[v++]){case"m":o=m[v++]*e+n,s=m[v++]*e+r,d.moveTo(o,s);break;case"l":o=m[v++]*e+n,s=m[v++]*e+r,d.lineTo(o,s);break;case"q":u=m[v++]*e+n,c=m[v++]*e+r,l=m[v++]*e+n,h=m[v++]*e+r,d.quadraticCurveTo(l,h,u,c);break;case"b":u=m[v++]*e+n,c=m[v++]*e+r,l=m[v++]*e+n,h=m[v++]*e+r,p=m[v++]*e+n,f=m[v++]*e+r,d.bezierCurveTo(l,h,p,f,u,c)}}return{offsetX:a.ha*e,path:d}}console.error('THREE.Font: character "'+t+'" does not exists in font family '+i.familyName+".")}function Qs(t){$o.call(this,t)}Ys.prototype=Object.assign(Object.create($o.prototype),{constructor:Ys,setOptions:function(t){return this.options=t,this},load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,a=Go.get(t);if(void 0!==a)return i.manager.itemStart(t),setTimeout((function(){e&&e(a),i.manager.itemEnd(t)}),0),a;fetch(t).then((function(t){return t.blob()})).then((function(t){return void 0===i.options?createImageBitmap(t):createImageBitmap(t,i.options)})).then((function(n){Go.add(t,n),e&&e(n),i.manager.itemEnd(t)})).catch((function(e){r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)})),i.manager.itemStart(t)}}),Object.assign(Ks.prototype,{moveTo:function(t,e){return this.currentPath=new Ms,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this},lineTo:function(t,e){return this.currentPath.lineTo(t,e),this},quadraticCurveTo:function(t,e,n,r){return this.currentPath.quadraticCurveTo(t,e,n,r),this},bezierCurveTo:function(t,e,n,r,i,a){return this.currentPath.bezierCurveTo(t,e,n,r,i,a),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,e){function n(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n],a=new Es;a.curves=i.curves,e.push(a)}return e}function r(t,e){for(var n=e.length,r=!1,i=n-1,a=0;a<n;i=a++){var o=e[i],s=e[a],u=s.x-o.x,c=s.y-o.y;if(Math.abs(c)>Number.EPSILON){if(c<0&&(o=e[a],u=-u,s=e[i],c=-c),t.y<o.y||t.y>s.y)continue;if(t.y===o.y){if(t.x===o.x)return!0}else{var l=c*(t.x-o.x)-u*(t.y-o.y);if(0===l)return!0;if(l<0)continue;r=!r}}else{if(t.y!==o.y)continue;if(s.x<=t.x&&t.x<=o.x||o.x<=t.x&&t.x<=s.x)return!0}}return r}var i=qa.isClockWise,a=this.subPaths;if(0===a.length)return[];if(!0===e)return n(a);var o,s,u,c=[];if(1===a.length)return s=a[0],(u=new Es).curves=s.curves,c.push(u),c;var l=!i(a[0].getPoints());l=t?!l:l;var h,p,f=[],d=[],m=[],v=0;d[v]=void 0,m[v]=[];for(var g=0,y=a.length;g<y;g++)o=i(h=(s=a[g]).getPoints()),(o=t?!o:o)?(!l&&d[v]&&v++,d[v]={s:new Es,p:h},d[v].s.curves=s.curves,l&&v++,m[v]=[]):m[v].push({h:s,p:h[0]});if(!d[0])return n(a);if(d.length>1){for(var x=!1,b=[],w=0,_=d.length;w<_;w++)f[w]=[];for(w=0,_=d.length;w<_;w++)for(var S=m[w],M=0;M<S.length;M++){for(var E=S[M],T=!0,C=0;C<d.length;C++)r(E.p,d[C].p)&&(w!==C&&b.push({froms:w,tos:C,hole:M}),T?(T=!1,f[C].push(E)):x=!0);T&&f[w].push(E)}b.length>0&&(x||(m=f))}g=0;for(var A=d.length;g<A;g++){u=d[g].s,c.push(u);for(var N=0,I=(p=m[g]).length;N<I;N++)u.holes.push(p[N].h)}return c}}),Object.assign(Js.prototype,{isFont:!0,generateShapes:function(t,e){void 0===e&&(e=100);for(var n=[],r=function(t,e,n){for(var r=Array.from?Array.from(t):String(t).split(""),i=e/n.resolution,a=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,o=[],s=0,u=0,c=0;c<r.length;c++){var l=r[c];if("\n"===l)s=0,u-=a;else{var h=Zs(l,i,s,u,n);s+=h.offsetX,o.push(h.path)}}return o}(t,e,this.data),i=0,a=r.length;i<a;i++)Array.prototype.push.apply(n,r[i].toShapes());return n}}),Qs.prototype=Object.assign(Object.create($o.prototype),{constructor:Qs,load:function(t,e,n,r){var i=this,a=new Ko(this.manager);a.setPath(this.path),a.load(t,(function(t){var n;try{n=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(t.substring(65,t.length-2))}var r=i.parse(n);e&&e(r)}),n,r)},parse:function(t){return new Js(t)}});var tu=function(){return void 0===Gs&&(Gs=new(window.AudioContext||window.webkitAudioContext)),Gs};function eu(t){$o.call(this,t)}function nu(){this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new S)}function ru(t,e){Ts.call(this,void 0,e),this.sh=void 0!==t?t:new nu}function iu(t,e,n){ru.call(this,void 0,n);var r=(new Ut).set(t),i=(new Ut).set(e),a=new S(r.r,r.g,r.b),o=new S(i.r,i.g,i.b),s=Math.sqrt(Math.PI),u=s*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(o).multiplyScalar(s),this.sh.coefficients[1].copy(a).sub(o).multiplyScalar(u)}function au(t,e){ru.call(this,void 0,e);var n=(new Ut).set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}eu.prototype=Object.assign(Object.create($o.prototype),{constructor:eu,load:function(t,e,n,r){var i=new Ko(this.manager);i.setResponseType("arraybuffer"),i.setPath(this.path),i.load(t,(function(t){var n=t.slice(0);tu().decodeAudioData(n,(function(t){e(t)}))}),n,r)}}),Object.assign(nu.prototype,{isSphericalHarmonics3:!0,set:function(t){for(var e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this},zero:function(){for(var t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},getAt:function(t,e){var n=t.x,r=t.y,i=t.z,a=this.coefficients;return e.copy(a[0]).multiplyScalar(.282095),e.addScale(a[1],.488603*r),e.addScale(a[2],.488603*i),e.addScale(a[3],.488603*n),e.addScale(a[4],n*r*1.092548),e.addScale(a[5],r*i*1.092548),e.addScale(a[6],.315392*(3*i*i-1)),e.addScale(a[7],n*i*1.092548),e.addScale(a[8],.546274*(n*n-r*r)),e},getIrradianceAt:function(t,e){var n=t.x,r=t.y,i=t.z,a=this.coefficients;return e.copy(a[0]).multiplyScalar(.886227),e.addScale(a[1],1.023328*r),e.addScale(a[2],1.023328*i),e.addScale(a[3],1.023328*n),e.addScale(a[4],.858086*n*r),e.addScale(a[5],.858086*r*i),e.addScale(a[6],.743125*i*i-.247708),e.addScale(a[7],.858086*n*i),e.addScale(a[8],.429043*(n*n-r*r)),e},add:function(t){for(var e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this},scale:function(t){for(var e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this},lerp:function(t,e){for(var n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this},equals:function(t){for(var e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0},copy:function(t){return this.set(t.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(t,e){void 0===e&&(e=0);for(var n=this.coefficients,r=0;r<9;r++)n[r].fromArray(t,e+3*r);return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);for(var n=this.coefficients,r=0;r<9;r++)n[r].toArray(t,e+3*r);return t}}),Object.assign(nu,{getBasisAt:function(t,e){var n=t.x,r=t.y,i=t.z;e[0]=.282095,e[1]=.488603*r,e[2]=.488603*i,e[3]=.488603*n,e[4]=1.092548*n*r,e[5]=1.092548*r*i,e[6]=.315392*(3*i*i-1),e[7]=1.092548*n*i,e[8]=.546274*(n*n-r*r)}}),ru.prototype=Object.assign(Object.create(Ts.prototype),{constructor:ru,isLightProbe:!0,copy:function(t){return Ts.prototype.copy.call(this,t),this.sh.copy(t.sh),this.intensity=t.intensity,this},toJSON:function(t){return Ts.prototype.toJSON.call(this,t)}}),iu.prototype=Object.assign(Object.create(ru.prototype),{constructor:iu,isHemisphereLightProbe:!0,copy:function(t){return ru.prototype.copy.call(this,t),this},toJSON:function(t){return ru.prototype.toJSON.call(this,t)}}),au.prototype=Object.assign(Object.create(ru.prototype),{constructor:au,isAmbientLightProbe:!0,copy:function(t){return ru.prototype.copy.call(this,t),this},toJSON:function(t){return ru.prototype.toJSON.call(this,t)}});var ou=new R,su=new R;function uu(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign(function(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new qe,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new qe,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}.prototype,{update:function(t){var e=this._cache;if(e.focus!==t.focus||e.fov!==t.fov||e.aspect!==t.aspect*this.aspect||e.near!==t.near||e.far!==t.far||e.zoom!==t.zoom||e.eyeSep!==this.eyeSep){e.focus=t.focus,e.fov=t.fov,e.aspect=t.aspect*this.aspect,e.near=t.near,e.far=t.far,e.zoom=t.zoom,e.eyeSep=this.eyeSep;var n,r,i=t.projectionMatrix.clone(),a=e.eyeSep/2,o=a*e.near/e.focus,s=e.near*Math.tan(h.DEG2RAD*e.fov*.5)/e.zoom;su.elements[12]=-a,ou.elements[12]=a,n=-s*e.aspect+o,r=s*e.aspect+o,i.elements[0]=2*e.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraL.projectionMatrix.copy(i),n=-s*e.aspect-o,r=s*e.aspect-o,i.elements[0]=2*e.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraR.projectionMatrix.copy(i)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(su),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(ou)}}),Object.assign(uu.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=("undefined"==typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}});var cu=new S,lu=new b,hu=new S,pu=new S;function fu(){Y.call(this),this.type="AudioListener",this.context=tu(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new uu}function du(t){Y.call(this),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._pausedAt=0,this.filters=[]}fu.prototype=Object.assign(Object.create(Y.prototype),{constructor:fu,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},updateMatrixWorld:function(t){Y.prototype.updateMatrixWorld.call(this,t);var e=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(cu,lu,hu),pu.set(0,0,-1).applyQuaternion(lu),e.positionX){var r=this.context.currentTime+this.timeDelta;e.positionX.linearRampToValueAtTime(cu.x,r),e.positionY.linearRampToValueAtTime(cu.y,r),e.positionZ.linearRampToValueAtTime(cu.z,r),e.forwardX.linearRampToValueAtTime(pu.x,r),e.forwardY.linearRampToValueAtTime(pu.y,r),e.forwardZ.linearRampToValueAtTime(pu.z,r),e.upX.linearRampToValueAtTime(n.x,r),e.upY.linearRampToValueAtTime(n.y,r),e.upZ.linearRampToValueAtTime(n.z,r)}else e.setPosition(cu.x,cu.y,cu.z),e.setOrientation(pu.x,pu.y,pu.z,n.x,n.y,n.z)}}),du.prototype=Object.assign(Object.create(Y.prototype),{constructor:du,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setMediaElementSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},setMediaStreamSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(t){if(void 0===t&&(t=0),!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+t;var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._pausedAt+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._pausedAt=(this.context.currentTime-this._startedAt)*this.playbackRate,this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this._pausedAt=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},setDetune:function(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},setLoopStart:function(t){return this.loopStart=t,this},setLoopEnd:function(t){return this.loopEnd=t,this},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}});var mu=new S,vu=new b,gu=new S,yu=new S;function xu(t){du.call(this,t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function bu(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function wu(t,e,n){this.binding=t,this.valueSize=n;var r,i=Float64Array;switch(e){case"quaternion":r=this._slerp;break;case"string":case"bool":i=Array,r=this._select;break;default:r=this._lerp}this.buffer=new i(4*n),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}xu.prototype=Object.assign(Object.create(du.prototype),{constructor:xu,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){return this.panner.refDistance=t,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){return this.panner.rolloffFactor=t,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){return this.panner.distanceModel=t,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){return this.panner.maxDistance=t,this},setDirectionalCone:function(t,e,n){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=n,this},updateMatrixWorld:function(t){if(Y.prototype.updateMatrixWorld.call(this,t),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(mu,vu,gu),yu.set(0,0,1).applyQuaternion(vu);var e=this.panner;if(e.positionX){var n=this.context.currentTime+this.listener.timeDelta;e.positionX.linearRampToValueAtTime(mu.x,n),e.positionY.linearRampToValueAtTime(mu.y,n),e.positionZ.linearRampToValueAtTime(mu.z,n),e.orientationX.linearRampToValueAtTime(yu.x,n),e.orientationY.linearRampToValueAtTime(yu.y,n),e.orientationZ.linearRampToValueAtTime(yu.z,n)}else e.setPosition(mu.x,mu.y,mu.z),e.setOrientation(yu.x,yu.y,yu.z)}}}),Object.assign(bu.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),n=0;n<e.length;n++)t+=e[n];return t/e.length}}),Object.assign(wu.prototype,{accumulate:function(t,e){var n=this.buffer,r=this.valueSize,i=t*r+r,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==r;++o)n[i+o]=n[o];a=e}else{var s=e/(a+=e);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=a},apply:function(t){var e=this.valueSize,n=this.buffer,r=t*e+e,i=this.cumulativeWeight,a=this.binding;if(this.cumulativeWeight=0,i<1){var o=3*e;this._mixBufferRegion(n,r,o,1-i,e)}for(var s=e,u=e+e;s!==u;++s)if(n[s]!==n[s+e]){a.setValue(n,r);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,n=this.valueSize,r=3*n;t.getValue(e,r);for(var i=n,a=r;i!==a;++i)e[i]=e[r+i%n];this.cumulativeWeight=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_select:function(t,e,n,r,i){if(r>=.5)for(var a=0;a!==i;++a)t[e+a]=t[n+a]},_slerp:function(t,e,n,r){b.slerpFlat(t,e,t,e,t,n,r)},_lerp:function(t,e,n,r,i){for(var a=1-r,o=0;o!==i;++o){var s=e+o;t[s]=t[s]*a+t[n+o]*r}}});var _u=new RegExp("[\\[\\]\\.:\\/]","g"),Su="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",Mu=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),Eu=/(WCOD+)?/.source.replace("WCOD",Su),Tu=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Cu=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Au=new RegExp("^"+Mu+Eu+Tu+Cu+"$"),Nu=["material","materials","bones"];function Iu(t,e,n){var r=n||Ru.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}function Ru(t,e,n){this.path=e,this.parsedPath=n||Ru.parseTrackName(e),this.node=Ru.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function Ou(t,e,n){this._mixer=t,this._clip=e,this._localRoot=n||null;for(var r=e.tracks,i=r.length,a=new Array(i),o={endingStart:2400,endingEnd:2400},s=0;s!==i;++s){var u=r[s].createInterpolant(null);a[s]=u,u.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function ku(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Lu(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function Du(t,e,n){ai.call(this,t,e),this.meshPerAttribute=n||1}function Pu(t,e){return t.distance-e.distance}function Fu(t,e,n,r){if(!1!==t.visible&&(t.raycast(e,n),!0===r))for(var i=t.children,a=0,o=i.length;a<o;a++)Fu(i[a],e,n,!0)}Object.assign(Iu.prototype,{getValue:function(t,e){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(t,e)},setValue:function(t,e){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}),Object.assign(Ru,{Composite:Iu,create:function(t,e,n){return t&&t.isAnimationObjectGroup?new Ru.Composite(t,e,n):new Ru(t,e,n)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(_u,"")},parseTrackName:function(t){var e=Au.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==Nu.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n},findNode:function(t,e){if(!e||""===e||"root"===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){var r=function(t){for(var n=0;n<t.length;n++){var i=t[n];if(i.name===e||i.uuid===e)return i;var a=r(i.children);if(a)return a}return null},i=r(t.children);if(i)return i}return null}}),Object.assign(Ru.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)t[e++]=n[r]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,n=e.objectName,r=e.propertyName,i=e.propertyIndex;if(t||(t=Ru.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(n){var a=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var o=0;o<t.length;o++)if(t[o].name===a){a=o;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==a){if(void 0===t[a])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[a]}}var s=t[r];if(void 0!==s){var u=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?u=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(u=this.Versioning.MatrixWorldNeedsUpdate);var c=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(o=0;o<this.node.geometry.morphAttributes.position.length;o++)if(t.geometry.morphAttributes.position[o].name===i){i=o;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(o=0;o<this.node.geometry.morphTargets.length;o++)if(t.geometry.morphTargets[o].name===i){i=o;break}}}c=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(c=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][u]}else{var l=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+r+" but it wasn't found.",t)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(Ru.prototype,{_getValue_unbound:Ru.prototype.getValue,_setValue_unbound:Ru.prototype.setValue}),Object.assign(function(){this.uuid=h.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,n=arguments.length;e!==n;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,e=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._paths,a=this._parsedPaths,o=this._bindings,s=o.length,u=void 0,c=0,l=arguments.length;c!==l;++c){var h=arguments[c],p=h.uuid,f=r[p];if(void 0===f){f=e++,r[p]=f,t.push(h);for(var d=0,m=s;d!==m;++d)o[d].push(new Ru(h,i[d],a[d]))}else if(f<n){u=t[f];var v=--n,g=t[v];r[g.uuid]=f,t[f]=g,r[p]=v,t[v]=h;for(d=0,m=s;d!==m;++d){var y=o[d],x=y[v],b=y[f];y[f]=x,void 0===b&&(b=new Ru(h,i[d],a[d])),y[v]=b}}else t[f]!==u&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var t=this._objects,e=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,i=r.length,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],u=s.uuid,c=n[u];if(void 0!==c&&c>=e){var l=e++,h=t[l];n[h.uuid]=c,t[c]=h,n[u]=l,t[l]=s;for(var p=0,f=i;p!==f;++p){var d=r[p],m=d[l],v=d[c];d[c]=m,d[l]=v}}}this.nCachedObjects_=e},uncache:function(){for(var t=this._objects,e=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._bindings,a=i.length,o=0,s=arguments.length;o!==s;++o){var u=arguments[o],c=u.uuid,l=r[c];if(void 0!==l)if(delete r[c],l<n){var h=--n,p=t[h],f=t[y=--e];r[p.uuid]=l,t[l]=p,r[f.uuid]=h,t[h]=f,t.pop();for(var d=0,m=a;d!==m;++d){var v=(x=i[d])[h],g=x[y];x[l]=v,x[h]=g,x.pop()}}else{var y;r[(f=t[y=--e]).uuid]=l,t[l]=f,t.pop();for(d=0,m=a;d!==m;++d){var x;(x=i[d])[l]=x[y],x.pop()}}}this.nCachedObjects_=n},subscribe_:function(t,e){var n=this._bindingsIndicesByPath,r=n[t],i=this._bindings;if(void 0!==r)return i[r];var a=this._paths,o=this._parsedPaths,s=this._objects,u=s.length,c=this.nCachedObjects_,l=new Array(u);r=i.length,n[t]=r,a.push(t),o.push(e),i.push(l);for(var h=c,p=s.length;h!==p;++h){var f=s[h];l[h]=new Ru(f,t,e)}return l},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){var r=this._paths,i=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];e[t[o]]=n,a[n]=s,a.pop(),i[n]=i[o],i.pop(),r[n]=r[o],r.pop()}}}),Object.assign(Ou.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){var r=this._clip.duration,i=t._clip.duration,a=i/r,o=r/i;t.warp(1,a,e),this.warp(o,1,e)}return this},crossFadeTo:function(t,e,n){return t.crossFadeFrom(this,e,n)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,n){var r=this._mixer,i=r.time,a=this._timeScaleInterpolant,o=this.timeScale;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);var s=a.parameterPositions,u=a.sampleValues;return s[0]=i,s[1]=i+n,u[0]=t/o,u[1]=e/o,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var a=(t-i)*n;if(a<0||0===n)return;this._startTime=null,e=n*a}e*=this._updateTimeScale(t);var o=this._updateTime(e),s=this._updateWeight(t);if(s>0)for(var u=this._interpolants,c=this._propertyBindings,l=0,h=u.length;l!==h;++l)u[l].evaluate(o),c[l].accumulate(r,s)}else this._updateWeight(t)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t,n=this._clip.duration,r=this.loop,i=this._loopCount,a=2202===r;if(0===t)return-1===i?e:a&&1==(1&i)?n-e:e;if(2200===r){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(e>=n)e=n;else{if(!(e<0)){this.time=e;break t}e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=e,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),e>=n||e<0){var o=Math.floor(e/n);e-=n*o,i+=Math.abs(o);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?n:0,this.time=e,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===s){var u=t<0;this._setEndings(u,!u,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this.time=e,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=e;if(a&&1==(1&i))return n-e}return e},_setEndings:function(t,e,n){var r=this._interpolantSettings;n?(r.endingStart=2401,r.endingEnd=2401):(r.endingStart=t?this.zeroSlopeAtStart?2401:2400:2402,r.endingEnd=e?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(t,e,n){var r=this._mixer,i=r.time,a=this._weightInterpolant;null===a&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=i,s[0]=e,o[1]=i+t,s[1]=n,this}}),ku.prototype=Object.assign(Object.create(s.prototype),{constructor:ku,_bindAction:function(t,e){var n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,a=t._propertyBindings,o=t._interpolants,s=n.uuid,u=this._bindingsByRootAndName,c=u[s];void 0===c&&(c={},u[s]=c);for(var l=0;l!==i;++l){var h=r[l],p=h.name,f=c[p];if(void 0!==f)a[l]=f;else{if(void 0!==(f=a[l])){null===f._cacheIndex&&(++f.referenceCount,this._addInactiveBinding(f,s,p));continue}var d=e&&e._propertyBindings[l].binding.parsedPath;++(f=new wu(Ru.create(n,p,d),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(f,s,p),a[l]=f}o[l].resultBuffer=f.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}for(var i=t._propertyBindings,a=0,o=i.length;a!==o;++a){var s=i[a];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,n){var r=this._actions,i=this._actionsByClip,a=i[e];if(void 0===a)a={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=a;else{var o=a.knownActions;t._byClipCacheIndex=o.length,o.push(t)}t._cacheIndex=r.length,r.push(t),a.actionByRoot[n]=t},_removeInactiveAction:function(t){var e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;var i=t._clip.uuid,a=this._actionsByClip,o=a[i],s=o.knownActions,u=s[s.length-1],c=t._byClipCacheIndex;u._byClipCacheIndex=c,s[c]=u,s.pop(),t._byClipCacheIndex=null,delete o.actionByRoot[(t._localRoot||this._root).uuid],0===s.length&&delete a[i],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(t){var e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackAction:function(t){var e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_addInactiveBinding:function(t,e,n){var r=this._bindingsByRootAndName,i=r[e],a=this._bindings;void 0===i&&(i={},r[e]=i),i[n]=t,t._cacheIndex=a.length,a.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,n=t.binding,r=n.rootNode.uuid,i=n.path,a=this._bindingsByRootAndName,o=a[r],s=e[e.length-1],u=t._cacheIndex;s._cacheIndex=u,e[u]=s,e.pop(),delete o[i],0===Object.keys(o).length&&delete a[r]},_lendBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return void 0===n&&((n=new ko(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?Vo.findByName(n,t):t,a=null!==i?i.uuid:t,o=this._actionsByClip[a],s=null;if(void 0!==o){var u=o.actionByRoot[r];if(void 0!==u)return u;s=o.knownActions[0],null===i&&(i=s._clip)}if(null===i)return null;var c=new Ou(this,i,e);return this._bindAction(c,s),this._addInactiveAction(c,a,r),c},existingAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?Vo.findByName(n,t):t,a=i?i.uuid:t,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[r]||null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,n=this._bindings,r=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==e;++i)t[i].reset();for(i=0;i!==r;++i)n[i].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,n=this._nActiveActions,r=this.time+=t,i=Math.sign(t),a=this._accuIndex^=1,o=0;o!==n;++o){e[o]._update(r,t,i,a)}var s=this._bindings,u=this._nActiveBindings;for(o=0;o!==u;++o)s[o].apply(a);return this},setTime:function(t){this.time=0;for(var e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,n=t.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var a=i.knownActions,o=0,s=a.length;o!==s;++o){var u=a[o];this._deactivateAction(u);var c=u._cacheIndex,l=e[e.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,l._cacheIndex=c,e[c]=l,e.pop(),this._removeInactiveBindingsForAction(u)}delete r[n]}},uncacheRoot:function(t){var e=t.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[e];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var a=this._bindingsByRootAndName[e];if(void 0!==a)for(var o in a){var s=a[o];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(t,e){var n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),Lu.prototype.clone=function(){return new Lu(void 0===this.value.clone?this.value:this.value.clone())},Du.prototype=Object.assign(Object.create(ai.prototype),{constructor:Du,isInstancedInterleavedBuffer:!0,copy:function(t){return ai.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Object.assign(function(t,e,n,r){this.ray=new wt(t,e),this.near=n||0,this.far=r||1/0,this.camera=null,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}.prototype,{linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e,n){var r=n||[];return Fu(t,this,r,e),r.sort(Pu),r},intersectObjects:function(t,e,n){var r=n||[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var i=0,a=t.length;i<a;i++)Fu(t[i],this,r,e);return r.sort(Pu),r}}),Object.assign(function(t,e,n){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==n?n:0,this}.prototype,{set:function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(h.clamp(e/this.radius,-1,1))),this}}),Object.assign(function(t,e,n){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==n?n:0,this}.prototype,{set:function(t,e,n){return this.radius=t,this.theta=e,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,n){return this.radius=Math.sqrt(t*t+n*n),this.theta=Math.atan2(t,n),this.y=e,this}});var Bu=new p;function zu(t,e){this.min=void 0!==t?t:new p(1/0,1/0),this.max=void 0!==e?e:new p(-1/0,-1/0)}Object.assign(zu.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){var n=Bu.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new p),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new p),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .getParameter() target is now required"),e=new p),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .clampPoint() target is now required"),e=new p),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return Bu.copy(t).clamp(this.min,this.max).sub(t).length()},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var Uu=new S,ju=new S;function Wu(t,e){this.start=void 0!==t?t:new S,this.end=void 0!==e?e:new S}function Vu(t){Y.call(this),this.material=t,this.render=function(){}}Object.assign(Wu.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new S),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new S),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){return void 0===e&&(console.warn("THREE.Line3: .at() target is now required"),e=new S),this.delta(e).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(t,e){Uu.subVectors(t,this.start),ju.subVectors(this.end,this.start);var n=ju.dot(ju),r=ju.dot(Uu)/n;return e&&(r=h.clamp(r,0,1)),r},closestPointToPoint:function(t,e,n){var r=this.closestPointToPointParameter(t,e);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new S),this.delta(n).multiplyScalar(r).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),Vu.prototype=Object.create(Y.prototype),Vu.prototype.constructor=Vu,Vu.prototype.isImmediateRenderObject=!0;var Hu=new S;function Gu(t,e){Y.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;for(var n=new de,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,a=1;i<32;i++,a++){var o=i/32*Math.PI*2,s=a/32*Math.PI*2;r.push(Math.cos(o),Math.sin(o),1,Math.cos(s),Math.sin(s),1)}n.setAttribute("position",new re(r,3));var u=new Fi({fog:!1});this.cone=new qi(n,u),this.add(this.cone),this.update()}Gu.prototype=Object.create(Y.prototype),Gu.prototype.constructor=Gu,Gu.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Gu.prototype.update=function(){this.light.updateMatrixWorld();var t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),Hu.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Hu),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var qu=new S,Xu=new R,$u=new R;function Yu(t){for(var e=function t(e){var n=[];e&&e.isBone&&n.push(e);for(var r=0;r<e.children.length;r++)n.push.apply(n,t(e.children[r]));return n}(t),n=new de,r=[],i=[],a=new Ut(0,0,1),o=new Ut(0,1,0),s=0;s<e.length;s++){var u=e[s];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(a.r,a.g,a.b),i.push(o.r,o.g,o.b))}n.setAttribute("position",new re(r,3)),n.setAttribute("color",new re(i,3));var c=new Fi({vertexColors:2,depthTest:!1,depthWrite:!1,transparent:!0});qi.call(this,n,c),this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function Ku(t,e,n){this.light=t,this.light.updateMatrixWorld(),this.color=n;var r=new no(e,4,2),i=new Xt({wireframe:!0,fog:!1});Oe.call(this,r,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}Yu.prototype=Object.create(qi.prototype),Yu.prototype.constructor=Yu,Yu.prototype.updateMatrixWorld=function(t){var e=this.bones,n=this.geometry,r=n.getAttribute("position");$u.getInverse(this.root.matrixWorld);for(var i=0,a=0;i<e.length;i++){var o=e[i];o.parent&&o.parent.isBone&&(Xu.multiplyMatrices($u,o.matrixWorld),qu.setFromMatrixPosition(Xu),r.setXYZ(a,qu.x,qu.y,qu.z),Xu.multiplyMatrices($u,o.parent.matrixWorld),qu.setFromMatrixPosition(Xu),r.setXYZ(a+1,qu.x,qu.y,qu.z),a+=2)}n.getAttribute("position").needsUpdate=!0,Y.prototype.updateMatrixWorld.call(this,t)},Ku.prototype=Object.create(Oe.prototype),Ku.prototype.constructor=Ku,Ku.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Ku.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};var Ju=new S,Zu=new Ut,Qu=new Ut;function tc(t,e,n){Y.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var r=new fa(e);r.rotateY(.5*Math.PI),this.material=new Xt({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=2);var i=r.getAttribute("position"),a=new Float32Array(3*i.count);r.setAttribute("color",new Yt(a,3)),this.add(new Oe(r,this.material)),this.update()}function ec(t,e,n,r){t=t||10,e=e||10,n=new Ut(void 0!==n?n:4473924),r=new Ut(void 0!==r?r:8947848);for(var i=e/2,a=t/e,o=t/2,s=[],u=[],c=0,l=0,h=-o;c<=e;c++,h+=a){s.push(-o,0,h,o,0,h),s.push(h,0,-o,h,0,o);var p=c===i?n:r;p.toArray(u,l),l+=3,p.toArray(u,l),l+=3,p.toArray(u,l),l+=3,p.toArray(u,l),l+=3}var f=new de;f.setAttribute("position",new re(s,3)),f.setAttribute("color",new re(u,3));var d=new Fi({vertexColors:2});qi.call(this,f,d)}function nc(t,e,n,r,i,a){t=t||10,e=e||16,n=n||8,r=r||64,i=new Ut(void 0!==i?i:4473924),a=new Ut(void 0!==a?a:8947848);var o,s,u,c,l,h,p,f=[],d=[];for(c=0;c<=e;c++)u=c/e*(2*Math.PI),o=Math.sin(u)*t,s=Math.cos(u)*t,f.push(0,0,0),f.push(o,0,s),p=1&c?i:a,d.push(p.r,p.g,p.b),d.push(p.r,p.g,p.b);for(c=0;c<=n;c++)for(p=1&c?i:a,h=t-t/n*c,l=0;l<r;l++)u=l/r*(2*Math.PI),o=Math.sin(u)*h,s=Math.cos(u)*h,f.push(o,0,s),d.push(p.r,p.g,p.b),u=(l+1)/r*(2*Math.PI),o=Math.sin(u)*h,s=Math.cos(u)*h,f.push(o,0,s),d.push(p.r,p.g,p.b);var m=new de;m.setAttribute("position",new re(f,3)),m.setAttribute("color",new re(d,3));var v=new Fi({vertexColors:2});qi.call(this,m,v)}tc.prototype=Object.create(Y.prototype),tc.prototype.constructor=tc,tc.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},tc.prototype.update=function(){var t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var e=t.geometry.getAttribute("color");Zu.copy(this.light.color),Qu.copy(this.light.groundColor);for(var n=0,r=e.count;n<r;n++){var i=n<r/2?Zu:Qu;e.setXYZ(n,i.r,i.g,i.b)}e.needsUpdate=!0}t.lookAt(Ju.setFromMatrixPosition(this.light.matrixWorld).negate())},ec.prototype=Object.assign(Object.create(qi.prototype),{constructor:ec,copy:function(t){return qi.prototype.copy.call(this,t),this.geometry.copy(t.geometry),this.material.copy(t.material),this},clone:function(){return(new this.constructor).copy(this)}}),nc.prototype=Object.create(qi.prototype),nc.prototype.constructor=nc;var rc=new S,ic=new S,ac=new S;function oc(t,e,n){Y.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===e&&(e=1);var r=new de;r.setAttribute("position",new re([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var i=new Fi({fog:!1});this.lightPlane=new Vi(r,i),this.add(this.lightPlane),(r=new de).setAttribute("position",new re([0,0,0,0,0,1],3)),this.targetLine=new Vi(r,i),this.add(this.targetLine),this.update()}oc.prototype=Object.create(Y.prototype),oc.prototype.constructor=oc,oc.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},oc.prototype.update=function(){rc.setFromMatrixPosition(this.light.matrixWorld),ic.setFromMatrixPosition(this.light.target.matrixWorld),ac.subVectors(ic,rc),this.lightPlane.lookAt(ic),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(ic),this.targetLine.scale.z=ac.length()};var sc=new S,uc=new Ge;function cc(t){var e=new de,n=new Fi({color:16777215,vertexColors:1}),r=[],i=[],a={},o=new Ut(16755200),s=new Ut(16711680),u=new Ut(43775),c=new Ut(16777215),l=new Ut(3355443);function h(t,e,n){p(t,n),p(e,n)}function p(t,e){r.push(0,0,0),i.push(e.r,e.g,e.b),void 0===a[t]&&(a[t]=[]),a[t].push(r.length/3-1)}h("n1","n2",o),h("n2","n4",o),h("n4","n3",o),h("n3","n1",o),h("f1","f2",o),h("f2","f4",o),h("f4","f3",o),h("f3","f1",o),h("n1","f1",o),h("n2","f2",o),h("n3","f3",o),h("n4","f4",o),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",u),h("u2","u3",u),h("u3","u1",u),h("c","t",c),h("p","c",l),h("cn1","cn2",l),h("cn3","cn4",l),h("cf1","cf2",l),h("cf3","cf4",l),e.setAttribute("position",new re(r,3)),e.setAttribute("color",new re(i,3)),qi.call(this,e,n),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}function lc(t,e,n,r,i,a,o){sc.set(i,a,o).unproject(r);var s=e[t];if(void 0!==s)for(var u=n.getAttribute("position"),c=0,l=s.length;c<l;c++)u.setXYZ(s[c],sc.x,sc.y,sc.z)}cc.prototype=Object.create(qi.prototype),cc.prototype.constructor=cc,cc.prototype.update=function(){var t=this.geometry,e=this.pointMap;uc.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),lc("c",e,t,uc,0,0,-1),lc("t",e,t,uc,0,0,1),lc("n1",e,t,uc,-1,-1,-1),lc("n2",e,t,uc,1,-1,-1),lc("n3",e,t,uc,-1,1,-1),lc("n4",e,t,uc,1,1,-1),lc("f1",e,t,uc,-1,-1,1),lc("f2",e,t,uc,1,-1,1),lc("f3",e,t,uc,-1,1,1),lc("f4",e,t,uc,1,1,1),lc("u1",e,t,uc,.7,1.1,-1),lc("u2",e,t,uc,-.7,1.1,-1),lc("u3",e,t,uc,0,2,-1),lc("cf1",e,t,uc,-1,0,1),lc("cf2",e,t,uc,1,0,1),lc("cf3",e,t,uc,0,-1,1),lc("cf4",e,t,uc,0,1,1),lc("cn1",e,t,uc,-1,0,-1),lc("cn2",e,t,uc,1,0,-1),lc("cn3",e,t,uc,0,-1,-1),lc("cn4",e,t,uc,0,1,-1),t.getAttribute("position").needsUpdate=!0};var hc=new lt;function pc(t,e){this.object=t,void 0===e&&(e=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new de;i.setIndex(new Yt(n,1)),i.setAttribute("position",new Yt(r,3)),qi.call(this,i,new Fi({color:e})),this.matrixAutoUpdate=!1,this.update()}function fc(t,e){this.type="Box3Helper",this.box=t,e=e||16776960;var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new de;r.setIndex(new Yt(n,1)),r.setAttribute("position",new re([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),qi.call(this,r,new Fi({color:e})),this.geometry.computeBoundingSphere()}function dc(t,e,n){this.type="PlaneHelper",this.plane=t,this.size=void 0===e?1:e;var r=void 0!==n?n:16776960,i=new de;i.setAttribute("position",new re([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),Vi.call(this,i,new Fi({color:r}));var a=new de;a.setAttribute("position",new re([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),a.computeBoundingSphere(),this.add(new Oe(a,new Xt({color:r,opacity:.2,transparent:!0,depthWrite:!1})))}pc.prototype=Object.create(qi.prototype),pc.prototype.constructor=pc,pc.prototype.update=function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&hc.setFromObject(this.object),!hc.isEmpty()){var e=hc.min,n=hc.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=e.x,i[4]=n.y,i[5]=n.z,i[6]=e.x,i[7]=e.y,i[8]=n.z,i[9]=n.x,i[10]=e.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=e.z,i[15]=e.x,i[16]=n.y,i[17]=e.z,i[18]=e.x,i[19]=e.y,i[20]=e.z,i[21]=n.x,i[22]=e.y,i[23]=e.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}},pc.prototype.setFromObject=function(t){return this.object=t,this.update(),this},pc.prototype.copy=function(t){return qi.prototype.copy.call(this,t),this.object=t.object,this},pc.prototype.clone=function(){return(new this.constructor).copy(this)},fc.prototype=Object.create(qi.prototype),fc.prototype.constructor=fc,fc.prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),Y.prototype.updateMatrixWorld.call(this,t))},dc.prototype=Object.create(Vi.prototype),dc.prototype.constructor=dc,dc.prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.children[0].material.side=e<0?1:0,this.lookAt(this.plane.normal),Y.prototype.updateMatrixWorld.call(this,t)};var mc,vc,gc=new S;function yc(t,e,n,r,i,a){Y.call(this),void 0===t&&(t=new S(0,0,1)),void 0===e&&(e=new S(0,0,0)),void 0===n&&(n=1),void 0===r&&(r=16776960),void 0===i&&(i=.2*n),void 0===a&&(a=.2*i),void 0===mc&&((mc=new de).setAttribute("position",new re([0,0,0,0,1,0],3)),(vc=new po(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(e),this.line=new Vi(mc,new Fi({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Oe(vc,new Xt({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,i,a)}function xc(t){var e=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=new de;n.setAttribute("position",new re(e,3)),n.setAttribute("color",new re([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var r=new Fi({vertexColors:2});qi.call(this,n,r)}yc.prototype=Object.create(Y.prototype),yc.prototype.constructor=yc,yc.prototype.setDirection=function(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{gc.set(t.z,0,-t.x).normalize();var e=Math.acos(t.y);this.quaternion.setFromAxisAngle(gc,e)}},yc.prototype.setLength=function(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),this.line.scale.set(1,Math.max(1e-4,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()},yc.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},yc.prototype.copy=function(t){return Y.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},yc.prototype.clone=function(){return(new this.constructor).copy(this)},xc.prototype=Object.create(qi.prototype),xc.prototype.constructor=xc;var bc,wc,_c,Sc,Mc=Math.pow(2,8),Ec=[.125,.215,.35,.446,.526,.582],Tc=5+Ec.length,Cc={3e3:0,3001:1,3002:2,3004:3,3005:4,3006:5,3007:6},Ac=new ks,Nc=(bc=20,wc=new Float32Array(bc),_c=new S(0,1,0),(Sc=new bo({defines:{n:bc},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:wc},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:_c},inputEncoding:{value:Cc[3e3]},outputEncoding:{value:Cc[3e3]}},vertexShader:Zc(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform int samples;\nuniform float weights[n];\nuniform bool latitudinal;\nuniform float dTheta;\nuniform float mipInt;\nuniform vec3 poleAxis;\n\n${Qc()}\n\n#define ENVMAP_TYPE_CUBE_UV\n#include <cube_uv_reflection_fragment>\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tfor (int i = 0; i < n; i++) {\n\t\tif (i >= samples)\n\t\t\tbreak;\n\t\tfor (int dir = -1; dir < 2; dir += 2) {\n\t\t\tif (i == 0 && dir == 1)\n\t\t\t\tcontinue;\n\t\t\tvec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);\n\t\t\tif (all(equal(axis, vec3(0.0))))\n\t\t\t\taxis = cross(vec3(0.0, 1.0, 0.0), vOutputDirection);\n\t\t\taxis = normalize(axis);\n\t\t\tfloat theta = dTheta * float(dir * i);\n\t\t\tfloat cosTheta = cos(theta);\n\t\t\t// Rodrigues' axis-angle rotation\n\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross(axis, vOutputDirection) * sin(theta)\n\t\t\t\t\t+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);\n\t\t\tgl_FragColor.rgb +=\n\t\t\t\t\tweights[i] * bilinearCubeUV(envMap, sampleDirection, mipInt);\n\t\t}\n\t}\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:0,depthTest:!1,depthWrite:!1})).type="SphericalGaussianBlur",Sc),Ic=null,Rc=null,{_lodPlanes:Oc,_sizeLods:kc,_sigmas:Lc}=function(){for(var t=[],e=[],n=[],r=8,i=0;i<Tc;i++){var a=Math.pow(2,r);e.push(a);var o=1/a;i>4?o=Ec[i-8+4-1]:0==i&&(o=0),n.push(o);for(var s=1/(a-1),u=-s/2,c=1+s/2,l=[u,u,c,u,c,c,u,u,c,c,u,c],h=new Float32Array(108),p=new Float32Array(72),f=new Float32Array(36),d=0;d<6;d++){var m=d%3*2/3-1,v=d>2?0:-1,g=[m,v,0,m+2/3,v,0,m+2/3,v+1,0,m,v,0,m+2/3,v+1,0,m,v+1,0];h.set(g,18*d),p.set(l,12*d);var y=[d,d,d,d,d,d];f.set(y,6*d)}var x=new de;x.setAttribute("position",new Yt(h,3)),x.setAttribute("uv",new Yt(p,2)),x.setAttribute("faceIndex",new Yt(f,1)),t.push(x),r>4&&r--}return{_lodPlanes:t,_sizeLods:e,_sigmas:n}}(),Dc=null,Pc=null,Fc=null,Bc=(1+Math.sqrt(5))/2,zc=1/Bc,Uc=[new S(1,1,1),new S(-1,1,1),new S(1,1,-1),new S(-1,1,-1),new S(0,Bc,zc),new S(0,Bc,-zc),new S(zc,0,Bc),new S(-zc,0,Bc),new S(Bc,zc,0),new S(-Bc,zc,0)];function jc(t){Pc=t,Hc(Nc)}function Wc(t){var e={magFilter:1003,minFilter:1003,generateMipmaps:!1,type:t?t.type:1009,format:t?t.format:o,encoding:t?t.encoding:3002,depthBuffer:!1,stencilBuffer:!1},n=Gc(e);return n.depthBuffer=!t,Dc=Gc(e),n}function Vc(t){Dc.dispose(),Pc.setRenderTarget(Fc),t.scissorTest=!1,t.setSize(t.width,t.height)}function Hc(t){var e=new K;e.add(new Oe(Oc[0],t)),Pc.compile(e,Ac)}function Gc(t){var e=new y(3*Mc,3*Mc,t);return e.texture.mapping=306,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function qc(t,e,n,r,i){t.viewport.set(e,n,r,i),t.scissor.set(e,n,r,i)}function Xc(t){var e=Pc.autoClear;Pc.autoClear=!1;for(var n=1;n<Tc;n++){$c(t,n-1,n,Math.sqrt(Lc[n]*Lc[n]-Lc[n-1]*Lc[n-1]),Uc[(n-1)%Uc.length])}Pc.autoClear=e}function $c(t,e,n,r,i){Yc(t,Dc,e,n,r,"latitudinal",i),Yc(Dc,t,n,n,r,"longitudinal",i)}function Yc(t,e,n,r,i,a,o){"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");var s=new K;s.add(new Oe(Oc[r],Nc));var u=Nc.uniforms,c=kc[n]-1,l=isFinite(i)?Math.PI/(2*c):2*Math.PI/39,h=i/l,p=isFinite(i)?1+Math.floor(3*h):20;p>20&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${p} samples when the maximum is set to 20`);for(var f=[],d=0,m=0;m<20;++m){var v=m/h,g=Math.exp(-v*v/2);f.push(g),0==m?d+=g:m<p&&(d+=2*g)}for(m=0;m<f.length;m++)f[m]=f[m]/d;u.envMap.value=t.texture,u.samples.value=p,u.weights.value=f,u.latitudinal.value="latitudinal"===a,o&&(u.poleAxis.value=o),u.dTheta.value=l,u.mipInt.value=8-n,u.inputEncoding.value=Cc[t.texture.encoding],u.outputEncoding.value=Cc[t.texture.encoding];var y=kc[r];qc(e,v=3*Math.max(0,Mc-2*y),(0===r?0:2*Mc)+2*y*(r>4?r-8+4:0),3*y,2*y),Pc.setRenderTarget(e),Pc.render(s,Ac)}function Kc(){var t=new bo({uniforms:{envMap:{value:null},texelSize:{value:new p(1,1)},inputEncoding:{value:Cc[3e3]},outputEncoding:{value:Cc[3e3]}},vertexShader:Zc(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform vec2 texelSize;\n\n${Qc()}\n\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tvec3 outputDirection = normalize(vOutputDirection);\n\tvec2 uv;\n\tuv.y = asin(clamp(outputDirection.y, -1.0, 1.0)) * RECIPROCAL_PI + 0.5;\n\tuv.x = atan(outputDirection.z, outputDirection.x) * RECIPROCAL_PI2 + 0.5;\n\tvec2 f = fract(uv / texelSize - 0.5);\n\tuv -= f * texelSize;\n\tvec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x += texelSize.x;\n\tvec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.y += texelSize.y;\n\tvec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x -= texelSize.x;\n\tvec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tvec3 tm = mix(tl, tr, f.x);\n\tvec3 bm = mix(bl, br, f.x);\n\tgl_FragColor.rgb = mix(tm, bm, f.y);\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:0,depthTest:!1,depthWrite:!1});return t.type="EquirectangularToCubeUV",t}function Jc(){var t=new bo({uniforms:{envMap:{value:null},inputEncoding:{value:Cc[3e3]},outputEncoding:{value:Cc[3e3]}},vertexShader:Zc(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform samplerCube envMap;\n\n${Qc()}\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:0,depthTest:!1,depthWrite:!1});return t.type="CubemapToCubeUV",t}function Zc(){return"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.x *= -1.0;\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.y *= -1.0;\n\t} else if (face == 5.0) {\n\t\tdirection.xz *= -1.0;\n\t}\n\treturn direction;\n}\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t"}function Qc(){return"\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t"}jc.prototype={constructor:jc,fromScene:function(t,e=0,n=.1,r=100){Fc=Pc.getRenderTarget();var i=Wc();return function(t,e,n,r){var i=new qe(90,1,e,n),a=[1,1,1,1,-1,1],o=[1,1,-1,-1,-1,1],s=Pc.outputEncoding,u=Pc.toneMapping,c=Pc.toneMappingExposure,l=Pc.getClearColor(),h=Pc.getClearAlpha();Pc.toneMapping=1,Pc.toneMappingExposure=1,Pc.outputEncoding=3e3,t.scale.z*=-1;var p=t.background;if(p&&p.isColor){p.convertSRGBToLinear();var f=Math.max(p.r,p.g,p.b),d=Math.min(Math.max(Math.ceil(Math.log2(f)),-128),127);p=p.multiplyScalar(Math.pow(2,-d));var m=(d+128)/255;Pc.setClearColor(p,m),t.background=null}for(var v=0;v<6;v++){var g=v%3;0==g?(i.up.set(0,a[v],0),i.lookAt(o[v],0,0)):1==g?(i.up.set(0,0,a[v]),i.lookAt(0,o[v],0)):(i.up.set(0,a[v],0),i.lookAt(0,0,o[v])),qc(r,g*Mc,v>2?Mc:0,Mc,Mc),Pc.setRenderTarget(r),Pc.render(t,i)}Pc.toneMapping=u,Pc.toneMappingExposure=c,Pc.outputEncoding=s,Pc.setClearColor(l,h),t.scale.z*=-1}(t,n,r,i),e>0&&$c(i,0,0,e),Xc(i),Vc(i),i},fromEquirectangular:function(t){return t.magFilter=1003,t.minFilter=1003,t.generateMipmaps=!1,this.fromCubemap(t)},fromCubemap:function(t){Fc=Pc.getRenderTarget();var e=Wc(t);return function(t,e){var n=new K;t.isCubeTexture?null==Rc&&(Rc=Jc()):null==Ic&&(Ic=Kc());var r=t.isCubeTexture?Rc:Ic;n.add(new Oe(Oc[0],r));var i=r.uniforms;i.envMap.value=t,t.isCubeTexture||i.texelSize.value.set(1/t.image.width,1/t.image.height);i.inputEncoding.value=Cc[t.encoding],i.outputEncoding.value=Cc[t.encoding],qc(e,0,0,3*Mc,2*Mc),Pc.setRenderTarget(e),Pc.render(n,Ac)}(t,e),Xc(e),Vc(e),e},compileCubemapShader:function(){null==Rc&&Hc(Rc=Jc())},compileEquirectangularShader:function(){null==Ic&&Hc(Ic=Kc())},dispose:function(){Nc.dispose(),null!=Rc&&Rc.dispose(),null!=Ic&&Ic.dispose();for(var t=0;t<Oc.length;t++)Oc[t].dispose()}};function tl(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),hs.call(this,t),this.type="catmullrom"}rs.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(rs.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Object.assign(Ss.prototype,{createPointsGeometry:function(t){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getPoints(t);return this.createGeometry(e)},createSpacedPointsGeometry:function(t){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getSpacedPoints(t);return this.createGeometry(e)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var e=new ze,n=0,r=t.length;n<r;n++){var i=t[n];e.vertices.push(new S(i.x,i.y,i.z||0))}return e}}),Object.assign(Ms.prototype,{fromPoints:function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),Object.create(hs.prototype),Object.create(hs.prototype),tl.prototype=Object.create(hs.prototype),Object.assign(tl.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),ec.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Yu.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign($o.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),zs(t)}}),$o.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(Hs.prototype,{setTexturePath:function(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}),Object.assign(zu.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(lt.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),Ze.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},Wu.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(h,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),h.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),h.ceilPowerOfTwo(t)}}),Object.assign(f.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(R.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new S).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,n,r,i,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,r,n,i,a)}}),Et.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},b.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(wt.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(Pt.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(Pt,{barycoordFromPoint:function(t,e,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Pt.getBarycoord(t,e,n,r,i)},normal:function(t,e,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Pt.getNormal(t,e,n,r)}}),Object.assign(Es.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ya(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new so(this,t)}}),Object.assign(p.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(S.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(g.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(ze.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.assign(Y.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(Y.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(Oe.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(Oe.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(Ti.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Ii.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Ci.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(rs.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),qe.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(Ts.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(Yt.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),35048===this.usage},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(35048)}}}),Object.assign(Yt.prototype,{setDynamic:function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?35048:35044),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(de.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addAttribute:function(t,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(t,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new Yt(arguments[1],arguments[2])))},addDrawCall:function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},applyMatrix:function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(de.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(ai.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),35048===this.usage},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),Object.assign(ai.prototype,{setDynamic:function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?35048:35044),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Ka.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(Lu.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(qt.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Ut}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===t}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Object.defineProperties(So.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(He.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(ni.prototype,{clearTarget:function(t,e,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,n,r)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(ni.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?3001:3e3}}}),Object.defineProperties(Xr.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(y.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(du.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this;return(new eu).load(t,(function(t){e.setBuffer(t)})),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),bu.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Xe.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)};d.crossOrigin=void 0,d.loadTexture=function(t,e,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new ns;i.setCrossOrigin(this.crossOrigin);var a=i.load(t,n,void 0,r);return e&&(a.mapping=e),a},d.loadTextureCube=function(t,e,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new es;i.setCrossOrigin(this.crossOrigin);var a=i.load(t,n,void 0,r);return e&&(a.mapping=e),a},d.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},d.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"113"}}))},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){var r=n(6);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){var r=n(54)("wks"),i=n(33),a=n(3).Symbol,o="function"==typeof a;(t.exports=function(t){return r[t]||(r[t]=o&&a[t]||(o?a:i)("Symbol."+t))}).store=r},function(t,e,n){var r=n(22),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},function(t,e){var n=t.exports={version:"2.6.11"};"number"==typeof __e&&(__e=n)},function(t,e,n){t.exports=!n(4)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(t,e,n){var r=n(5),i=n(98),a=n(30),o=Object.defineProperty;e.f=n(10)?Object.defineProperty:function(t,e,n){if(r(t),e=a(e,!0),r(n),i)try{return o(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var r=n(28);t.exports=function(t){return Object(r(t))}},function(t,e,n){var r=n(3),i=n(16),a=n(15),o=n(33)("src"),s=n(151),u=(""+s).split("toString");n(9).inspectSource=function(t){return s.call(t)},(t.exports=function(t,e,n,s){var c="function"==typeof n;c&&(a(n,"name")||i(n,"name",e)),t[e]!==n&&(c&&(a(n,o)||i(n,o,t[e]?""+t[e]:u.join(String(e)))),t===r?t[e]=n:s?t[e]?t[e]=n:i(t,e,n):(delete t[e],i(t,e,n)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[o]||s.call(this)}))},function(t,e,n){var r=n(1),i=n(4),a=n(28),o=/"/g,s=function(t,e,n,r){var i=String(a(t)),s="<"+e;return""!==n&&(s+=" "+n+'="'+String(r).replace(o,"&quot;")+'"'),s+">"+i+"</"+e+">"};t.exports=function(t,e){var n={};n[t]=e(s),r(r.P+r.F*i((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3})),"String",n)}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var r=n(11),i=n(32);t.exports=n(10)?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var r=n(49),i=n(28);t.exports=function(t){return r(i(t))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r,i,a,o=n(2);function s(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}Object.assign(s.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),s.FullScreenQuad=(r=new o.j(-1,1,1,-1,0,1),i=new o.m(2,2),a=function(t){this._mesh=new o.i(i,t)},Object.defineProperty(a.prototype,"material",{get:function(){return this._mesh.material},set:function(t){this._mesh.material=t}}),Object.assign(a.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(t){t.render(this._mesh,r)}}),a)},function(t,e,n){"use strict";var r=n(4);t.exports=function(t,e){return!!t&&r((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},function(t,e,n){var r=n(21);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e,n){var r=n(50),i=n(32),a=n(17),o=n(30),s=n(15),u=n(98),c=Object.getOwnPropertyDescriptor;e.f=n(10)?c:function(t,e){if(t=a(t),e=o(e,!0),u)try{return c(t,e)}catch(t){}if(s(t,e))return i(!r.f.call(t,e),t[e])}},function(t,e,n){var r=n(1),i=n(9),a=n(4);t.exports=function(t,e){var n=(i.Object||{})[t]||Object[t],o={};o[t]=e(n),r(r.S+r.F*a((function(){n(1)})),"Object",o)}},function(t,e,n){var r=n(20),i=n(49),a=n(12),o=n(8),s=n(114);t.exports=function(t,e){var n=1==t,u=2==t,c=3==t,l=4==t,h=6==t,p=5==t||h,f=e||s;return function(e,s,d){for(var m,v,g=a(e),y=i(g),x=r(s,d,3),b=o(y.length),w=0,_=n?f(e,b):u?f(e,0):void 0;b>w;w++)if((p||w in y)&&(v=x(m=y[w],w,g),t))if(n)_[w]=v;else if(v)switch(t){case 3:return!0;case 5:return m;case 6:return w;case 2:_.push(m)}else if(l)return!1;return h?-1:c||l?l:_}}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){"use strict";if(n(10)){var r=n(34),i=n(3),a=n(4),o=n(1),s=n(65),u=n(90),c=n(20),l=n(46),h=n(32),p=n(16),f=n(47),d=n(22),m=n(8),v=n(125),g=n(36),y=n(30),x=n(15),b=n(51),w=n(6),_=n(12),S=n(82),M=n(37),E=n(39),T=n(38).f,C=n(84),A=n(33),N=n(7),I=n(25),R=n(55),O=n(52),k=n(86),L=n(44),D=n(58),P=n(45),F=n(85),B=n(116),z=n(11),U=n(23),j=z.f,W=U.f,V=i.RangeError,H=i.TypeError,G=i.Uint8Array,q=Array.prototype,X=u.ArrayBuffer,$=u.DataView,Y=I(0),K=I(2),J=I(3),Z=I(4),Q=I(5),tt=I(6),et=R(!0),nt=R(!1),rt=k.values,it=k.keys,at=k.entries,ot=q.lastIndexOf,st=q.reduce,ut=q.reduceRight,ct=q.join,lt=q.sort,ht=q.slice,pt=q.toString,ft=q.toLocaleString,dt=N("iterator"),mt=N("toStringTag"),vt=A("typed_constructor"),gt=A("def_constructor"),yt=s.CONSTR,xt=s.TYPED,bt=s.VIEW,wt=I(1,(function(t,e){return Tt(O(t,t[gt]),e)})),_t=a((function(){return 1===new G(new Uint16Array([1]).buffer)[0]})),St=!!G&&!!G.prototype.set&&a((function(){new G(1).set({})})),Mt=function(t,e){var n=d(t);if(n<0||n%e)throw V("Wrong offset!");return n},Et=function(t){if(w(t)&&xt in t)return t;throw H(t+" is not a typed array!")},Tt=function(t,e){if(!w(t)||!(vt in t))throw H("It is not a typed array constructor!");return new t(e)},Ct=function(t,e){return At(O(t,t[gt]),e)},At=function(t,e){for(var n=0,r=e.length,i=Tt(t,r);r>n;)i[n]=e[n++];return i},Nt=function(t,e,n){j(t,e,{get:function(){return this._d[n]}})},It=function(t){var e,n,r,i,a,o,s=_(t),u=arguments.length,l=u>1?arguments[1]:void 0,h=void 0!==l,p=C(s);if(null!=p&&!S(p)){for(o=p.call(s),r=[],e=0;!(a=o.next()).done;e++)r.push(a.value);s=r}for(h&&u>2&&(l=c(l,arguments[2],2)),e=0,n=m(s.length),i=Tt(this,n);n>e;e++)i[e]=h?l(s[e],e):s[e];return i},Rt=function(){for(var t=0,e=arguments.length,n=Tt(this,e);e>t;)n[t]=arguments[t++];return n},Ot=!!G&&a((function(){ft.call(new G(1))})),kt=function(){return ft.apply(Ot?ht.call(Et(this)):Et(this),arguments)},Lt={copyWithin:function(t,e){return B.call(Et(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return Z(Et(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return F.apply(Et(this),arguments)},filter:function(t){return Ct(this,K(Et(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return Q(Et(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return tt(Et(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){Y(Et(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return nt(Et(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return et(Et(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return ct.apply(Et(this),arguments)},lastIndexOf:function(t){return ot.apply(Et(this),arguments)},map:function(t){return wt(Et(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return st.apply(Et(this),arguments)},reduceRight:function(t){return ut.apply(Et(this),arguments)},reverse:function(){for(var t,e=Et(this).length,n=Math.floor(e/2),r=0;r<n;)t=this[r],this[r++]=this[--e],this[e]=t;return this},some:function(t){return J(Et(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return lt.call(Et(this),t)},subarray:function(t,e){var n=Et(this),r=n.length,i=g(t,r);return new(O(n,n[gt]))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,m((void 0===e?r:g(e,r))-i))}},Dt=function(t,e){return Ct(this,ht.call(Et(this),t,e))},Pt=function(t){Et(this);var e=Mt(arguments[1],1),n=this.length,r=_(t),i=m(r.length),a=0;if(i+e>n)throw V("Wrong length!");for(;a<i;)this[e+a]=r[a++]},Ft={entries:function(){return at.call(Et(this))},keys:function(){return it.call(Et(this))},values:function(){return rt.call(Et(this))}},Bt=function(t,e){return w(t)&&t[xt]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},zt=function(t,e){return Bt(t,e=y(e,!0))?h(2,t[e]):W(t,e)},Ut=function(t,e,n){return!(Bt(t,e=y(e,!0))&&w(n)&&x(n,"value"))||x(n,"get")||x(n,"set")||n.configurable||x(n,"writable")&&!n.writable||x(n,"enumerable")&&!n.enumerable?j(t,e,n):(t[e]=n.value,t)};yt||(U.f=zt,z.f=Ut),o(o.S+o.F*!yt,"Object",{getOwnPropertyDescriptor:zt,defineProperty:Ut}),a((function(){pt.call({})}))&&(pt=ft=function(){return ct.call(this)});var jt=f({},Lt);f(jt,Ft),p(jt,dt,Ft.values),f(jt,{slice:Dt,set:Pt,constructor:function(){},toString:pt,toLocaleString:kt}),Nt(jt,"buffer","b"),Nt(jt,"byteOffset","o"),Nt(jt,"byteLength","l"),Nt(jt,"length","e"),j(jt,mt,{get:function(){return this[xt]}}),t.exports=function(t,e,n,u){var c=t+((u=!!u)?"Clamped":"")+"Array",h="get"+t,f="set"+t,d=i[c],g=d||{},y=d&&E(d),x=!d||!s.ABV,_={},S=d&&d.prototype,C=function(t,n){j(t,n,{get:function(){return function(t,n){var r=t._d;return r.v[h](n*e+r.o,_t)}(this,n)},set:function(t){return function(t,n,r){var i=t._d;u&&(r=(r=Math.round(r))<0?0:r>255?255:255&r),i.v[f](n*e+i.o,r,_t)}(this,n,t)},enumerable:!0})};x?(d=n((function(t,n,r,i){l(t,d,c,"_d");var a,o,s,u,h=0,f=0;if(w(n)){if(!(n instanceof X||"ArrayBuffer"==(u=b(n))||"SharedArrayBuffer"==u))return xt in n?At(d,n):It.call(d,n);a=n,f=Mt(r,e);var g=n.byteLength;if(void 0===i){if(g%e)throw V("Wrong length!");if((o=g-f)<0)throw V("Wrong length!")}else if((o=m(i)*e)+f>g)throw V("Wrong length!");s=o/e}else s=v(n),a=new X(o=s*e);for(p(t,"_d",{b:a,o:f,l:o,e:s,v:new $(a)});h<s;)C(t,h++)})),S=d.prototype=M(jt),p(S,"constructor",d)):a((function(){d(1)}))&&a((function(){new d(-1)}))&&D((function(t){new d,new d(null),new d(1.5),new d(t)}),!0)||(d=n((function(t,n,r,i){var a;return l(t,d,c),w(n)?n instanceof X||"ArrayBuffer"==(a=b(n))||"SharedArrayBuffer"==a?void 0!==i?new g(n,Mt(r,e),i):void 0!==r?new g(n,Mt(r,e)):new g(n):xt in n?At(d,n):It.call(d,n):new g(v(n))})),Y(y!==Function.prototype?T(g).concat(T(y)):T(g),(function(t){t in d||p(d,t,g[t])})),d.prototype=S,r||(S.constructor=d));var A=S[dt],N=!!A&&("values"==A.name||null==A.name),I=Ft.values;p(d,vt,!0),p(S,xt,c),p(S,bt,!0),p(S,gt,d),(u?new d(1)[mt]==c:mt in S)||j(S,mt,{get:function(){return c}}),_[c]=d,o(o.G+o.W+o.F*(d!=g),_),o(o.S,c,{BYTES_PER_ELEMENT:e}),o(o.S+o.F*a((function(){g.of.call(d,1)})),c,{from:It,of:Rt}),"BYTES_PER_ELEMENT"in S||p(S,"BYTES_PER_ELEMENT",e),o(o.P,c,Lt),P(c),o(o.P+o.F*St,c,{set:Pt}),o(o.P+o.F*!N,c,Ft),r||S.toString==pt||(S.toString=pt),o(o.P+o.F*a((function(){new d(1).slice()})),c,{slice:Dt}),o(o.P+o.F*(a((function(){return[1,2].toLocaleString()!=new d([1,2]).toLocaleString()}))||!a((function(){S.toLocaleString.call([1,2])}))),c,{toLocaleString:kt}),L[c]=N?A:I,r||N||p(S,dt,I)}}else t.exports=function(){}},function(t,e,n){var r=n(6);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var r=n(33)("meta"),i=n(6),a=n(15),o=n(11).f,s=0,u=Object.isExtensible||function(){return!0},c=!n(4)((function(){return u(Object.preventExtensions({}))})),l=function(t){o(t,r,{value:{i:"O"+ ++s,w:{}}})},h=t.exports={KEY:r,NEED:!1,fastKey:function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!a(t,r)){if(!u(t))return"F";if(!e)return"E";l(t)}return t[r].i},getWeak:function(t,e){if(!a(t,r)){if(!u(t))return!0;if(!e)return!1;l(t)}return t[r].w},onFreeze:function(t){return c&&h.NEED&&u(t)&&!a(t,r)&&l(t),t}}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},function(t,e){t.exports=!1},function(t,e,n){var r=n(100),i=n(69);t.exports=Object.keys||function(t){return r(t,i)}},function(t,e,n){var r=n(22),i=Math.max,a=Math.min;t.exports=function(t,e){return(t=r(t))<0?i(t+e,0):a(t,e)}},function(t,e,n){var r=n(5),i=n(101),a=n(69),o=n(68)("IE_PROTO"),s=function(){},u=function(){var t,e=n(66)("iframe"),r=a.length;for(e.style.display="none",n(70).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),u=t.F;r--;)delete u.prototype[a[r]];return u()};t.exports=Object.create||function(t,e){var n;return null!==t?(s.prototype=r(t),n=new s,s.prototype=null,n[o]=t):n=u(),void 0===e?n:i(n,e)}},function(t,e,n){var r=n(100),i=n(69).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},function(t,e,n){var r=n(15),i=n(12),a=n(68)("IE_PROTO"),o=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),r(t,a)?t[a]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?o:null}},function(t,e,n){var r=n(7)("unscopables"),i=Array.prototype;null==i[r]&&n(16)(i,r,{}),t.exports=function(t){i[r][t]=!0}},function(t,e,n){var r=n(6);t.exports=function(t,e){if(!r(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e,n){var r=n(11).f,i=n(15),a=n(7)("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,a)&&r(t,a,{configurable:!0,value:e})}},function(t,e,n){var r=n(1),i=n(28),a=n(4),o=n(72),s="["+o+"]",u=RegExp("^"+s+s+"*"),c=RegExp(s+s+"*$"),l=function(t,e,n){var i={},s=a((function(){return!!o[t]()||"​"!="​"[t]()})),u=i[t]=s?e(h):o[t];n&&(i[n]=u),r(r.P+r.F*s,"String",i)},h=l.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(u,"")),2&e&&(t=t.replace(c,"")),t};t.exports=l},function(t,e){t.exports={}},function(t,e,n){"use strict";var r=n(3),i=n(11),a=n(10),o=n(7)("species");t.exports=function(t){var e=r[t];a&&e&&!e[o]&&i.f(e,o,{configurable:!0,get:function(){return this}})}},function(t,e){t.exports=function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var r=n(13);t.exports=function(t,e,n){for(var i in e)r(t,i,e[i],n);return t}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(2),i=n(18),a=function(t,e){i.a.call(this),this.textureID=void 0!==e?e:"tDiffuse",t instanceof r.p?(this.uniforms=t.uniforms,this.material=t):t&&(this.uniforms=r.r.clone(t.uniforms),this.material=new r.p({defines:Object.assign({},t.defines),uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader})),this.fsQuad=new i.a.FullScreenQuad(this.material)};a.prototype=Object.assign(Object.create(i.a.prototype),{constructor:a,render:function(t,e,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?(t.setRenderTarget(null),this.fsQuad.render(t)):(t.setRenderTarget(e),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),this.fsQuad.render(t))}})},function(t,e,n){var r=n(27);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){var r=n(27),i=n(7)("toStringTag"),a="Arguments"==r(function(){return arguments}());t.exports=function(t){var e,n,o;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),i))?n:a?r(e):"Object"==(o=r(e))&&"function"==typeof e.callee?"Arguments":o}},function(t,e,n){var r=n(5),i=n(21),a=n(7)("species");t.exports=function(t,e){var n,o=r(t).constructor;return void 0===o||null==(n=r(o)[a])?e:i(n)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[127,34,139,11,0,37,232,231,120,72,37,39,128,121,47,232,121,128,104,69,67,175,171,148,157,154,155,118,50,101,73,39,40,9,151,108,48,115,131,194,204,211,74,40,185,80,42,183,40,92,186,230,229,118,202,212,214,83,18,17,76,61,146,160,29,30,56,157,173,106,204,194,135,214,192,203,165,98,21,71,68,51,45,4,144,24,23,77,146,91,205,50,187,201,200,18,91,106,182,90,91,181,85,84,17,206,203,36,148,171,140,92,40,39,193,189,244,159,158,28,247,246,161,236,3,196,54,68,104,193,168,8,117,228,31,189,193,55,98,97,99,126,47,100,166,79,218,155,154,26,209,49,131,135,136,150,47,126,217,223,52,53,45,51,134,211,170,140,67,69,108,43,106,91,230,119,120,226,130,247,63,53,52,238,20,242,46,70,156,78,62,96,46,53,63,143,34,227,173,155,133,123,117,111,44,125,19,236,134,51,216,206,205,154,153,22,39,37,167,200,201,208,36,142,100,57,212,202,20,60,99,28,158,157,35,226,113,160,159,27,204,202,210,113,225,46,43,202,204,62,76,77,137,123,116,41,38,72,203,129,142,64,98,240,49,102,64,41,73,74,212,216,207,42,74,184,169,170,211,170,149,176,105,66,69,122,6,168,123,147,187,96,77,90,65,55,107,89,90,180,101,100,120,63,105,104,93,137,227,15,86,85,129,102,49,14,87,86,55,8,9,100,47,121,145,23,22,88,89,179,6,122,196,88,95,96,138,172,136,215,58,172,115,48,219,42,80,81,195,3,51,43,146,61,171,175,199,81,82,38,53,46,225,144,163,110,246,33,7,52,65,66,229,228,117,34,127,234,107,108,69,109,108,151,48,64,235,62,78,191,129,209,126,111,35,143,163,161,246,117,123,50,222,65,52,19,125,141,221,55,65,3,195,197,25,7,33,220,237,44,70,71,139,122,193,245,247,130,33,71,21,162,153,158,159,170,169,150,188,174,196,216,186,92,144,160,161,2,97,167,141,125,241,164,167,37,72,38,12,145,159,160,38,82,13,63,68,71,226,35,111,158,153,154,101,50,205,206,92,165,209,198,217,165,167,97,220,115,218,133,112,243,239,238,241,214,135,169,190,173,133,171,208,32,125,44,237,86,87,178,85,86,179,84,85,180,83,84,181,201,83,182,137,93,132,76,62,183,61,76,184,57,61,185,212,57,186,214,207,187,34,143,156,79,239,237,123,137,177,44,1,4,201,194,32,64,102,129,213,215,138,59,166,219,242,99,97,2,94,141,75,59,235,24,110,228,25,130,226,23,24,229,22,23,230,26,22,231,112,26,232,189,190,243,221,56,190,28,56,221,27,28,222,29,27,223,30,29,224,247,30,225,238,79,20,166,59,75,60,75,240,147,177,215,20,79,166,187,147,213,112,233,244,233,128,245,128,114,188,114,217,174,131,115,220,217,198,236,198,131,134,177,132,58,143,35,124,110,163,7,228,110,25,356,389,368,11,302,267,452,350,349,302,303,269,357,343,277,452,453,357,333,332,297,175,152,377,384,398,382,347,348,330,303,304,270,9,336,337,278,279,360,418,262,431,304,408,409,310,415,407,270,409,410,450,348,347,422,430,434,313,314,17,306,307,375,387,388,260,286,414,398,335,406,418,364,367,416,423,358,327,251,284,298,281,5,4,373,374,253,307,320,321,425,427,411,421,313,18,321,405,406,320,404,405,315,16,17,426,425,266,377,400,369,322,391,269,417,465,464,386,257,258,466,260,388,456,399,419,284,332,333,417,285,8,346,340,261,413,441,285,327,460,328,355,371,329,392,439,438,382,341,256,429,420,360,364,394,379,277,343,437,443,444,283,275,440,363,431,262,369,297,338,337,273,375,321,450,451,349,446,342,467,293,334,282,458,461,462,276,353,383,308,324,325,276,300,293,372,345,447,382,398,362,352,345,340,274,1,19,456,248,281,436,427,425,381,256,252,269,391,393,200,199,428,266,330,329,287,273,422,250,462,328,258,286,384,265,353,342,387,259,257,424,431,430,342,353,276,273,335,424,292,325,307,366,447,345,271,303,302,423,266,371,294,455,460,279,278,294,271,272,304,432,434,427,272,407,408,394,430,431,395,369,400,334,333,299,351,417,168,352,280,411,325,319,320,295,296,336,319,403,404,330,348,349,293,298,333,323,454,447,15,16,315,358,429,279,14,15,316,285,336,9,329,349,350,374,380,252,318,402,403,6,197,419,318,319,325,367,364,365,435,367,397,344,438,439,272,271,311,195,5,281,273,287,291,396,428,199,311,271,268,283,444,445,373,254,339,263,466,249,282,334,296,449,347,346,264,447,454,336,296,299,338,10,151,278,439,455,292,407,415,358,371,355,340,345,372,390,249,466,346,347,280,442,443,282,19,94,370,441,442,295,248,419,197,263,255,359,440,275,274,300,383,368,351,412,465,263,467,466,301,368,389,380,374,386,395,378,379,412,351,419,436,426,322,373,390,388,2,164,393,370,462,461,164,0,267,302,11,12,374,373,387,268,12,13,293,300,301,446,261,340,385,384,381,330,266,425,426,423,391,429,355,437,391,327,326,440,457,438,341,382,362,459,457,461,434,430,394,414,463,362,396,369,262,354,461,457,316,403,402,315,404,403,314,405,404,313,406,405,421,418,406,366,401,361,306,408,407,291,409,408,287,410,409,432,436,410,434,416,411,264,368,383,309,438,457,352,376,401,274,275,4,421,428,262,294,327,358,433,416,367,289,455,439,462,370,326,2,326,370,305,460,455,254,449,448,255,261,446,253,450,449,252,451,450,256,452,451,341,453,452,413,464,463,441,413,414,258,442,441,257,443,442,259,444,443,260,445,444,467,342,445,459,458,250,289,392,290,290,328,460,376,433,435,250,290,392,411,416,433,341,463,464,453,464,465,357,465,412,343,412,399,360,363,440,437,399,456,420,456,363,401,435,288,372,383,353,339,255,249,448,261,255,133,243,190,133,155,112,33,246,247,33,130,25,398,384,286,362,398,414,362,463,341,263,359,467,263,249,255,466,467,260,75,60,166,238,239,79,162,127,139,72,11,37,121,232,120,73,72,39,114,128,47,233,232,128,103,104,67,152,175,148,173,157,155,119,118,101,74,73,40,107,9,108,49,48,131,32,194,211,184,74,185,191,80,183,185,40,186,119,230,118,210,202,214,84,83,17,77,76,146,161,160,30,190,56,173,182,106,194,138,135,192,129,203,98,54,21,68,5,51,4,145,144,23,90,77,91,207,205,187,83,201,18,181,91,182,180,90,181,16,85,17,205,206,36,176,148,140,165,92,39,245,193,244,27,159,28,30,247,161,174,236,196,103,54,104,55,193,8,111,117,31,221,189,55,240,98,99,142,126,100,219,166,218,112,155,26,198,209,131,169,135,150,114,47,217,224,223,53,220,45,134,32,211,140,109,67,108,146,43,91,231,230,120,113,226,247,105,63,52,241,238,242,124,46,156,95,78,96,70,46,63,116,143,227,116,123,111,1,44,19,3,236,51,207,216,205,26,154,22,165,39,167,199,200,208,101,36,100,43,57,202,242,20,99,56,28,157,124,35,113,29,160,27,211,204,210,124,113,46,106,43,204,96,62,77,227,137,116,73,41,72,36,203,142,235,64,240,48,49,64,42,41,74,214,212,207,183,42,184,210,169,211,140,170,176,104,105,69,193,122,168,50,123,187,89,96,90,66,65,107,179,89,180,119,101,120,68,63,104,234,93,227,16,15,85,209,129,49,15,14,86,107,55,9,120,100,121,153,145,22,178,88,179,197,6,196,89,88,96,135,138,136,138,215,172,218,115,219,41,42,81,5,195,51,57,43,61,208,171,199,41,81,38,224,53,225,24,144,110,105,52,66,118,229,117,227,34,234,66,107,69,10,109,151,219,48,235,183,62,191,142,129,126,116,111,143,7,163,246,118,117,50,223,222,52,94,19,141,222,221,65,196,3,197,45,220,44,156,70,139,188,122,245,139,71,162,145,153,159,149,170,150,122,188,196,206,216,92,163,144,161,164,2,167,242,141,241,0,164,37,11,72,12,144,145,160,12,38,13,70,63,71,31,226,111,157,158,154,36,101,205,203,206,165,126,209,217,98,165,97,237,220,218,237,239,241,210,214,169,140,171,32,241,125,237,179,86,178,180,85,179,181,84,180,182,83,181,194,201,182,177,137,132,184,76,183,185,61,184,186,57,185,216,212,186,192,214,187,139,34,156,218,79,237,147,123,177,45,44,4,208,201,32,98,64,129,192,213,138,235,59,219,141,242,97,97,2,141,240,75,235,229,24,228,31,25,226,230,23,229,231,22,230,232,26,231,233,112,232,244,189,243,189,221,190,222,28,221,223,27,222,224,29,223,225,30,224,113,247,225,99,60,240,213,147,215,60,20,166,192,187,213,243,112,244,244,233,245,245,128,188,188,114,174,134,131,220,174,217,236,236,198,134,215,177,58,156,143,124,25,110,7,31,228,25,264,356,368,0,11,267,451,452,349,267,302,269,350,357,277,350,452,357,299,333,297,396,175,377,381,384,382,280,347,330,269,303,270,151,9,337,344,278,360,424,418,431,270,304,409,272,310,407,322,270,410,449,450,347,432,422,434,18,313,17,291,306,375,259,387,260,424,335,418,434,364,416,391,423,327,301,251,298,275,281,4,254,373,253,375,307,321,280,425,411,200,421,18,335,321,406,321,320,405,314,315,17,423,426,266,396,377,369,270,322,269,413,417,464,385,386,258,248,456,419,298,284,333,168,417,8,448,346,261,417,413,285,326,327,328,277,355,329,309,392,438,381,382,256,279,429,360,365,364,379,355,277,437,282,443,283,281,275,363,395,431,369,299,297,337,335,273,321,348,450,349,359,446,467,283,293,282,250,458,462,300,276,383,292,308,325,283,276,293,264,372,447,346,352,340,354,274,19,363,456,281,426,436,425,380,381,252,267,269,393,421,200,428,371,266,329,432,287,422,290,250,328,385,258,384,446,265,342,386,387,257,422,424,430,445,342,276,422,273,424,306,292,307,352,366,345,268,271,302,358,423,371,327,294,460,331,279,294,303,271,304,436,432,427,304,272,408,395,394,431,378,395,400,296,334,299,6,351,168,376,352,411,307,325,320,285,295,336,320,319,404,329,330,349,334,293,333,366,323,447,316,15,315,331,358,279,317,14,316,8,285,9,277,329,350,253,374,252,319,318,403,351,6,419,324,318,325,397,367,365,288,435,397,278,344,439,310,272,311,248,195,281,375,273,291,175,396,199,312,311,268,276,283,445,390,373,339,295,282,296,448,449,346,356,264,454,337,336,299,337,338,151,294,278,455,308,292,415,429,358,355,265,340,372,388,390,466,352,346,280,295,442,282,354,19,370,285,441,295,195,248,197,457,440,274,301,300,368,417,351,465,251,301,389,385,380,386,394,395,379,399,412,419,410,436,322,387,373,388,326,2,393,354,370,461,393,164,267,268,302,12,386,374,387,312,268,13,298,293,301,265,446,340,380,385,381,280,330,425,322,426,391,420,429,437,393,391,326,344,440,438,458,459,461,364,434,394,428,396,262,274,354,457,317,316,402,316,315,403,315,314,404,314,313,405,313,421,406,323,366,361,292,306,407,306,291,408,291,287,409,287,432,410,427,434,411,372,264,383,459,309,457,366,352,401,1,274,4,418,421,262,331,294,358,435,433,367,392,289,439,328,462,326,94,2,370,289,305,455,339,254,448,359,255,446,254,253,449,253,252,450,252,256,451,256,341,452,414,413,463,286,441,414,286,258,441,258,257,442,257,259,443,259,260,444,260,467,445,309,459,250,305,289,290,305,290,460,401,376,435,309,250,392,376,411,433,453,341,464,357,453,465,343,357,412,437,343,399,344,360,440,420,437,456,360,420,363,361,401,288,265,372,353,390,339,249,339,448,255]},function(t,e,n){var r=n(9),i=n(3),a=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(t.exports=function(t,e){return a[t]||(a[t]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:n(34)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(t,e,n){var r=n(17),i=n(8),a=n(36);t.exports=function(t){return function(e,n,o){var s,u=r(e),c=i(u.length),l=a(o,c);if(t&&n!=n){for(;c>l;)if((s=u[l++])!=s)return!0}else for(;c>l;l++)if((t||l in u)&&u[l]===n)return t||l||0;return!t&&-1}}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var r=n(27);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,e,n){var r=n(7)("iterator"),i=!1;try{var a=[7][r]();a.return=function(){i=!0},Array.from(a,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!i)return!1;var n=!1;try{var a=[7],o=a[r]();o.next=function(){return{done:n=!0}},a[r]=function(){return o},t(a)}catch(t){}return n}},function(t,e,n){"use strict";var r=n(5);t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){"use strict";var r=n(51),i=RegExp.prototype.exec;t.exports=function(t,e){var n=t.exec;if("function"==typeof n){var a=n.call(t,e);if("object"!=typeof a)throw new TypeError("RegExp exec method returned something other than an Object or null");return a}if("RegExp"!==r(t))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(t,e)}},function(t,e,n){"use strict";n(118);var r=n(13),i=n(16),a=n(4),o=n(28),s=n(7),u=n(87),c=s("species"),l=!a((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),h=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();t.exports=function(t,e,n){var p=s(t),f=!a((function(){var e={};return e[p]=function(){return 7},7!=""[t](e)})),d=f?!a((function(){var e=!1,n=/a/;return n.exec=function(){return e=!0,null},"split"===t&&(n.constructor={},n.constructor[c]=function(){return n}),n[p](""),!e})):void 0;if(!f||!d||"replace"===t&&!l||"split"===t&&!h){var m=/./[p],v=n(o,p,""[t],(function(t,e,n,r,i){return e.exec===u?f&&!i?{done:!0,value:m.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}})),g=v[0],y=v[1];r(String.prototype,t,g),i(RegExp.prototype,p,2==e?function(t,e){return y.call(t,this,e)}:function(t){return y.call(t,this)})}}},function(t,e,n){var r=n(20),i=n(113),a=n(82),o=n(5),s=n(8),u=n(84),c={},l={};(e=t.exports=function(t,e,n,h,p){var f,d,m,v,g=p?function(){return t}:u(t),y=r(n,h,e?2:1),x=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(a(g)){for(f=s(t.length);f>x;x++)if((v=e?y(o(d=t[x])[0],d[1]):y(t[x]))===c||v===l)return v}else for(m=g.call(t);!(d=m.next()).done;)if((v=i(m,y,d.value,e))===c||v===l)return v}).BREAK=c,e.RETURN=l},function(t,e,n){var r=n(3).navigator;t.exports=r&&r.userAgent||""},function(t,e,n){"use strict";var r=n(3),i=n(1),a=n(13),o=n(47),s=n(31),u=n(62),c=n(46),l=n(6),h=n(4),p=n(58),f=n(42),d=n(73);t.exports=function(t,e,n,m,v,g){var y=r[t],x=y,b=v?"set":"add",w=x&&x.prototype,_={},S=function(t){var e=w[t];a(w,t,"delete"==t||"has"==t?function(t){return!(g&&!l(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return g&&!l(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof x&&(g||w.forEach&&!h((function(){(new x).entries().next()})))){var M=new x,E=M[b](g?{}:-0,1)!=M,T=h((function(){M.has(1)})),C=p((function(t){new x(t)})),A=!g&&h((function(){for(var t=new x,e=5;e--;)t[b](e,e);return!t.has(-0)}));C||((x=e((function(e,n){c(e,x,t);var r=d(new y,e,x);return null!=n&&u(n,v,r[b],r),r}))).prototype=w,w.constructor=x),(T||A)&&(S("delete"),S("has"),v&&S("get")),(A||E)&&S(b),g&&w.clear&&delete w.clear}else x=m.getConstructor(e,t,v,b),o(x.prototype,n),s.NEED=!0;return f(x,t),_[t]=x,i(i.G+i.W+i.F*(x!=y),_),g||m.setStrong(x,t,v),x}},function(t,e,n){for(var r,i=n(3),a=n(16),o=n(33),s=o("typed_array"),u=o("view"),c=!(!i.ArrayBuffer||!i.DataView),l=c,h=0,p="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");h<9;)(r=i[p[h++]])?(a(r.prototype,s,!0),a(r.prototype,u,!0)):l=!1;t.exports={ABV:c,CONSTR:l,TYPED:s,VIEW:u}},function(t,e,n){var r=n(6),i=n(3).document,a=r(i)&&r(i.createElement);t.exports=function(t){return a?i.createElement(t):{}}},function(t,e,n){e.f=n(7)},function(t,e,n){var r=n(54)("keys"),i=n(33);t.exports=function(t){return r[t]||(r[t]=i(t))}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var r=n(3).document;t.exports=r&&r.documentElement},function(t,e,n){var r=n(6),i=n(5),a=function(t,e){if(i(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{(r=n(20)(Function.call,n(23).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return a(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:a}},function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,e,n){var r=n(6),i=n(71).set;t.exports=function(t,e,n){var a,o=e.constructor;return o!==n&&"function"==typeof o&&(a=o.prototype)!==n.prototype&&r(a)&&i&&i(t,a),t}},function(t,e,n){"use strict";var r=n(22),i=n(28);t.exports=function(t){var e=String(i(this)),n="",a=r(t);if(a<0||a==1/0)throw RangeError("Count can't be negative");for(;a>0;(a>>>=1)&&(e+=e))1&a&&(n+=e);return n}},function(t,e){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,e){var n=Math.expm1;t.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:n},function(t,e,n){var r=n(22),i=n(28);t.exports=function(t){return function(e,n){var a,o,s=String(i(e)),u=r(n),c=s.length;return u<0||u>=c?t?"":void 0:(a=s.charCodeAt(u))<55296||a>56319||u+1===c||(o=s.charCodeAt(u+1))<56320||o>57343?t?s.charAt(u):a:t?s.slice(u,u+2):o-56320+(a-55296<<10)+65536}}},function(t,e,n){"use strict";var r=n(34),i=n(1),a=n(13),o=n(16),s=n(44),u=n(112),c=n(42),l=n(39),h=n(7)("iterator"),p=!([].keys&&"next"in[].keys()),f=function(){return this};t.exports=function(t,e,n,d,m,v,g){u(n,e,d);var y,x,b,w=function(t){if(!p&&t in E)return E[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},_=e+" Iterator",S="values"==m,M=!1,E=t.prototype,T=E[h]||E["@@iterator"]||m&&E[m],C=T||w(m),A=m?S?w("entries"):C:void 0,N="Array"==e&&E.entries||T;if(N&&(b=l(N.call(new t)))!==Object.prototype&&b.next&&(c(b,_,!0),r||"function"==typeof b[h]||o(b,h,f)),S&&T&&"values"!==T.name&&(M=!0,C=function(){return T.call(this)}),r&&!g||!p&&!M&&E[h]||o(E,h,C),s[e]=C,s[_]=f,m)if(y={values:S?C:w("values"),keys:v?C:w("keys"),entries:A},g)for(x in y)x in E||a(E,x,y[x]);else i(i.P+i.F*(p||M),e,y);return y}},function(t,e,n){var r=n(80),i=n(28);t.exports=function(t,e,n){if(r(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(t))}},function(t,e,n){var r=n(6),i=n(27),a=n(7)("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[a])?!!e:"RegExp"==i(t))}},function(t,e,n){var r=n(7)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[r]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e,n){var r=n(44),i=n(7)("iterator"),a=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||a[i]===t)}},function(t,e,n){"use strict";var r=n(11),i=n(32);t.exports=function(t,e,n){e in t?r.f(t,e,i(0,n)):t[e]=n}},function(t,e,n){var r=n(51),i=n(7)("iterator"),a=n(44);t.exports=n(9).getIteratorMethod=function(t){if(null!=t)return t[i]||t["@@iterator"]||a[r(t)]}},function(t,e,n){"use strict";var r=n(12),i=n(36),a=n(8);t.exports=function(t){for(var e=r(this),n=a(e.length),o=arguments.length,s=i(o>1?arguments[1]:void 0,n),u=o>2?arguments[2]:void 0,c=void 0===u?n:i(u,n);c>s;)e[s++]=t;return e}},function(t,e,n){"use strict";var r=n(40),i=n(117),a=n(44),o=n(17);t.exports=n(78)(Array,"Array",(function(t,e){this._t=o(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])}),"values"),a.Arguments=a.Array,r("keys"),r("values"),r("entries")},function(t,e,n){"use strict";var r,i,a=n(59),o=RegExp.prototype.exec,s=String.prototype.replace,u=o,c=(r=/a/,i=/b*/g,o.call(r,"a"),o.call(i,"a"),0!==r.lastIndex||0!==i.lastIndex),l=void 0!==/()??/.exec("")[1];(c||l)&&(u=function(t){var e,n,r,i,u=this;return l&&(n=new RegExp("^"+u.source+"$(?!\\s)",a.call(u))),c&&(e=u.lastIndex),r=o.call(u,t),c&&r&&(u.lastIndex=u.global?r.index+r[0].length:e),l&&r&&r.length>1&&s.call(r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r}),t.exports=u},function(t,e,n){"use strict";var r=n(77)(!0);t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},function(t,e,n){var r,i,a,o=n(20),s=n(106),u=n(70),c=n(66),l=n(3),h=l.process,p=l.setImmediate,f=l.clearImmediate,d=l.MessageChannel,m=l.Dispatch,v=0,g={},y=function(){var t=+this;if(g.hasOwnProperty(t)){var e=g[t];delete g[t],e()}},x=function(t){y.call(t.data)};p&&f||(p=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return g[++v]=function(){s("function"==typeof t?t:Function(t),e)},r(v),v},f=function(t){delete g[t]},"process"==n(27)(h)?r=function(t){h.nextTick(o(y,t,1))}:m&&m.now?r=function(t){m.now(o(y,t,1))}:d?(a=(i=new d).port2,i.port1.onmessage=x,r=o(a.postMessage,a,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(r=function(t){l.postMessage(t+"","*")},l.addEventListener("message",x,!1)):r="onreadystatechange"in c("script")?function(t){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),y.call(t)}}:function(t){setTimeout(o(y,t,1),0)}),t.exports={set:p,clear:f}},function(t,e,n){"use strict";var r=n(3),i=n(10),a=n(34),o=n(65),s=n(16),u=n(47),c=n(4),l=n(46),h=n(22),p=n(8),f=n(125),d=n(38).f,m=n(11).f,v=n(85),g=n(42),y=r.ArrayBuffer,x=r.DataView,b=r.Math,w=r.RangeError,_=r.Infinity,S=y,M=b.abs,E=b.pow,T=b.floor,C=b.log,A=b.LN2,N=i?"_b":"buffer",I=i?"_l":"byteLength",R=i?"_o":"byteOffset";function O(t,e,n){var r,i,a,o=new Array(n),s=8*n-e-1,u=(1<<s)-1,c=u>>1,l=23===e?E(2,-24)-E(2,-77):0,h=0,p=t<0||0===t&&1/t<0?1:0;for((t=M(t))!=t||t===_?(i=t!=t?1:0,r=u):(r=T(C(t)/A),t*(a=E(2,-r))<1&&(r--,a*=2),(t+=r+c>=1?l/a:l*E(2,1-c))*a>=2&&(r++,a/=2),r+c>=u?(i=0,r=u):r+c>=1?(i=(t*a-1)*E(2,e),r+=c):(i=t*E(2,c-1)*E(2,e),r=0));e>=8;o[h++]=255&i,i/=256,e-=8);for(r=r<<e|i,s+=e;s>0;o[h++]=255&r,r/=256,s-=8);return o[--h]|=128*p,o}function k(t,e,n){var r,i=8*n-e-1,a=(1<<i)-1,o=a>>1,s=i-7,u=n-1,c=t[u--],l=127&c;for(c>>=7;s>0;l=256*l+t[u],u--,s-=8);for(r=l&(1<<-s)-1,l>>=-s,s+=e;s>0;r=256*r+t[u],u--,s-=8);if(0===l)l=1-o;else{if(l===a)return r?NaN:c?-_:_;r+=E(2,e),l-=o}return(c?-1:1)*r*E(2,l-e)}function L(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function D(t){return[255&t]}function P(t){return[255&t,t>>8&255]}function F(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function B(t){return O(t,52,8)}function z(t){return O(t,23,4)}function U(t,e,n){m(t.prototype,e,{get:function(){return this[n]}})}function j(t,e,n,r){var i=f(+n);if(i+e>t[I])throw w("Wrong index!");var a=t[N]._b,o=i+t[R],s=a.slice(o,o+e);return r?s:s.reverse()}function W(t,e,n,r,i,a){var o=f(+n);if(o+e>t[I])throw w("Wrong index!");for(var s=t[N]._b,u=o+t[R],c=r(+i),l=0;l<e;l++)s[u+l]=c[a?l:e-l-1]}if(o.ABV){if(!c((function(){y(1)}))||!c((function(){new y(-1)}))||c((function(){return new y,new y(1.5),new y(NaN),"ArrayBuffer"!=y.name}))){for(var V,H=(y=function(t){return l(this,y),new S(f(t))}).prototype=S.prototype,G=d(S),q=0;G.length>q;)(V=G[q++])in y||s(y,V,S[V]);a||(H.constructor=y)}var X=new x(new y(2)),$=x.prototype.setInt8;X.setInt8(0,2147483648),X.setInt8(1,2147483649),!X.getInt8(0)&&X.getInt8(1)||u(x.prototype,{setInt8:function(t,e){$.call(this,t,e<<24>>24)},setUint8:function(t,e){$.call(this,t,e<<24>>24)}},!0)}else y=function(t){l(this,y,"ArrayBuffer");var e=f(t);this._b=v.call(new Array(e),0),this[I]=e},x=function(t,e,n){l(this,x,"DataView"),l(t,y,"DataView");var r=t[I],i=h(e);if(i<0||i>r)throw w("Wrong offset!");if(i+(n=void 0===n?r-i:p(n))>r)throw w("Wrong length!");this[N]=t,this[R]=i,this[I]=n},i&&(U(y,"byteLength","_l"),U(x,"buffer","_b"),U(x,"byteLength","_l"),U(x,"byteOffset","_o")),u(x.prototype,{getInt8:function(t){return j(this,1,t)[0]<<24>>24},getUint8:function(t){return j(this,1,t)[0]},getInt16:function(t){var e=j(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=j(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return L(j(this,4,t,arguments[1]))},getUint32:function(t){return L(j(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return k(j(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return k(j(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){W(this,1,t,D,e)},setUint8:function(t,e){W(this,1,t,D,e)},setInt16:function(t,e){W(this,2,t,P,e,arguments[2])},setUint16:function(t,e){W(this,2,t,P,e,arguments[2])},setInt32:function(t,e){W(this,4,t,F,e,arguments[2])},setUint32:function(t,e){W(this,4,t,F,e,arguments[2])},setFloat32:function(t,e){W(this,4,t,z,e,arguments[2])},setFloat64:function(t,e){W(this,8,t,B,e,arguments[2])}});g(y,"ArrayBuffer"),g(x,"DataView"),s(x.prototype,o.VIEW,!0),e.ArrayBuffer=y,e.DataView=x},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){t.exports=!n(130)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(t,e){var n,r,i=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(t){n=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(t){r=o}}();var u,c=[],l=!1,h=-1;function p(){l&&u&&(l=!1,u.length?c=u.concat(c):h=-1,c.length&&f())}function f(){if(!l){var t=s(p);l=!0;for(var e=c.length;e;){for(u=c,c=[];++h<e;)u&&u[h].run();h=-1,e=c.length}u=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function m(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new d(t,e)),1!==c.length||l||s(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){t.exports=function(){"use strict";var t=navigator.userAgent,e=navigator.platform,n=/gecko\/\d/i.test(t),r=/MSIE \d/.test(t),i=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(t),a=/Edge\/(\d+)/.exec(t),o=r||i||a,s=o&&(r?document.documentMode||6:+(a||i)[1]),u=!a&&/WebKit\//.test(t),c=u&&/Qt\/\d+\.\d+/.test(t),l=!a&&/Chrome\//.test(t),h=/Opera\//.test(t),p=/Apple Computer/.test(navigator.vendor),f=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(t),d=/PhantomJS/.test(t),m=!a&&/AppleWebKit/.test(t)&&/Mobile\/\w+/.test(t),v=/Android/.test(t),g=m||v||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(t),y=m||/Mac/.test(e),x=/\bCrOS\b/.test(t),b=/win/i.test(e),w=h&&t.match(/Version\/(\d*\.\d*)/);w&&(w=Number(w[1])),w&&w>=15&&(h=!1,u=!0);var _=y&&(c||h&&(null==w||w<12.11)),S=n||o&&s>=9;function M(t){return new RegExp("(^|\\s)"+t+"(?:$|\\s)\\s*")}var E,T=function(t,e){var n=t.className,r=M(e).exec(n);if(r){var i=n.slice(r.index+r[0].length);t.className=n.slice(0,r.index)+(i?r[1]+i:"")}};function C(t){for(var e=t.childNodes.length;e>0;--e)t.removeChild(t.firstChild);return t}function A(t,e){return C(t).appendChild(e)}function N(t,e,n,r){var i=document.createElement(t);if(n&&(i.className=n),r&&(i.style.cssText=r),"string"==typeof e)i.appendChild(document.createTextNode(e));else if(e)for(var a=0;a<e.length;++a)i.appendChild(e[a]);return i}function I(t,e,n,r){var i=N(t,e,n,r);return i.setAttribute("role","presentation"),i}function R(t,e){if(3==e.nodeType&&(e=e.parentNode),t.contains)return t.contains(e);do{if(11==e.nodeType&&(e=e.host),e==t)return!0}while(e=e.parentNode)}function O(){var t;try{t=document.activeElement}catch(e){t=document.body||null}for(;t&&t.shadowRoot&&t.shadowRoot.activeElement;)t=t.shadowRoot.activeElement;return t}function k(t,e){var n=t.className;M(e).test(n)||(t.className+=(n?" ":"")+e)}function L(t,e){for(var n=t.split(" "),r=0;r<n.length;r++)n[r]&&!M(n[r]).test(e)&&(e+=" "+n[r]);return e}E=document.createRange?function(t,e,n,r){var i=document.createRange();return i.setEnd(r||t,n),i.setStart(t,e),i}:function(t,e,n){var r=document.body.createTextRange();try{r.moveToElementText(t.parentNode)}catch(t){return r}return r.collapse(!0),r.moveEnd("character",n),r.moveStart("character",e),r};var D=function(t){t.select()};function P(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e)}}function F(t,e,n){for(var r in e||(e={}),t)!t.hasOwnProperty(r)||!1===n&&e.hasOwnProperty(r)||(e[r]=t[r]);return e}function B(t,e,n,r,i){null==e&&-1==(e=t.search(/[^\s\u00a0]/))&&(e=t.length);for(var a=r||0,o=i||0;;){var s=t.indexOf("\t",a);if(s<0||s>=e)return o+(e-a);o+=s-a,o+=n-o%n,a=s+1}}m?D=function(t){t.selectionStart=0,t.selectionEnd=t.value.length}:o&&(D=function(t){try{t.select()}catch(t){}});var z=function(){this.id=null,this.f=null,this.time=0,this.handler=P(this.onTimeout,this)};function U(t,e){for(var n=0;n<t.length;++n)if(t[n]==e)return n;return-1}z.prototype.onTimeout=function(t){t.id=0,t.time<=+new Date?t.f():setTimeout(t.handler,t.time-+new Date)},z.prototype.set=function(t,e){this.f=e;var n=+new Date+t;(!this.id||n<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,t),this.time=n)};var j={toString:function(){return"CodeMirror.Pass"}},W={scroll:!1},V={origin:"*mouse"},H={origin:"+move"};function G(t,e,n){for(var r=0,i=0;;){var a=t.indexOf("\t",r);-1==a&&(a=t.length);var o=a-r;if(a==t.length||i+o>=e)return r+Math.min(o,e-i);if(i+=a-r,r=a+1,(i+=n-i%n)>=e)return r}}var q=[""];function X(t){for(;q.length<=t;)q.push($(q)+" ");return q[t]}function $(t){return t[t.length-1]}function Y(t,e){for(var n=[],r=0;r<t.length;r++)n[r]=e(t[r],r);return n}function K(){}function J(t,e){var n;return Object.create?n=Object.create(t):(K.prototype=t,n=new K),e&&F(e,n),n}var Z=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function Q(t){return/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||Z.test(t))}function tt(t,e){return e?!!(e.source.indexOf("\\w")>-1&&Q(t))||e.test(t):Q(t)}function et(t){for(var e in t)if(t.hasOwnProperty(e)&&t[e])return!1;return!0}var nt=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function rt(t){return t.charCodeAt(0)>=768&&nt.test(t)}function it(t,e,n){for(;(n<0?e>0:e<t.length)&&rt(t.charAt(e));)e+=n;return e}function at(t,e,n){for(var r=e>n?-1:1;;){if(e==n)return e;var i=(e+n)/2,a=r<0?Math.ceil(i):Math.floor(i);if(a==e)return t(a)?e:n;t(a)?n=a:e=a+r}}var ot=null;function st(t,e,n){var r;ot=null;for(var i=0;i<t.length;++i){var a=t[i];if(a.from<e&&a.to>e)return i;a.to==e&&(a.from!=a.to&&"before"==n?r=i:ot=i),a.from==e&&(a.from!=a.to&&"before"!=n?r=i:ot=i)}return null!=r?r:ot}var ut=function(){var t=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,e=/[stwN]/,n=/[LRr]/,r=/[Lb1n]/,i=/[1n]/;function a(t,e,n){this.level=t,this.from=e,this.to=n}return function(o,s){var u="ltr"==s?"L":"R";if(0==o.length||"ltr"==s&&!t.test(o))return!1;for(var c,l=o.length,h=[],p=0;p<l;++p)h.push((c=o.charCodeAt(p))<=247?"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN".charAt(c):1424<=c&&c<=1524?"R":1536<=c&&c<=1785?"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111".charAt(c-1536):1774<=c&&c<=2220?"r":8192<=c&&c<=8203?"w":8204==c?"b":"L");for(var f=0,d=u;f<l;++f){var m=h[f];"m"==m?h[f]=d:d=m}for(var v=0,g=u;v<l;++v){var y=h[v];"1"==y&&"r"==g?h[v]="n":n.test(y)&&(g=y,"r"==y&&(h[v]="R"))}for(var x=1,b=h[0];x<l-1;++x){var w=h[x];"+"==w&&"1"==b&&"1"==h[x+1]?h[x]="1":","!=w||b!=h[x+1]||"1"!=b&&"n"!=b||(h[x]=b),b=w}for(var _=0;_<l;++_){var S=h[_];if(","==S)h[_]="N";else if("%"==S){var M=void 0;for(M=_+1;M<l&&"%"==h[M];++M);for(var E=_&&"!"==h[_-1]||M<l&&"1"==h[M]?"1":"N",T=_;T<M;++T)h[T]=E;_=M-1}}for(var C=0,A=u;C<l;++C){var N=h[C];"L"==A&&"1"==N?h[C]="L":n.test(N)&&(A=N)}for(var I=0;I<l;++I)if(e.test(h[I])){var R=void 0;for(R=I+1;R<l&&e.test(h[R]);++R);for(var O="L"==(I?h[I-1]:u),k=O==("L"==(R<l?h[R]:u))?O?"L":"R":u,L=I;L<R;++L)h[L]=k;I=R-1}for(var D,P=[],F=0;F<l;)if(r.test(h[F])){var B=F;for(++F;F<l&&r.test(h[F]);++F);P.push(new a(0,B,F))}else{var z=F,U=P.length,j="rtl"==s?1:0;for(++F;F<l&&"L"!=h[F];++F);for(var W=z;W<F;)if(i.test(h[W])){z<W&&(P.splice(U,0,new a(1,z,W)),U+=j);var V=W;for(++W;W<F&&i.test(h[W]);++W);P.splice(U,0,new a(2,V,W)),U+=j,z=W}else++W;z<F&&P.splice(U,0,new a(1,z,F))}return"ltr"==s&&(1==P[0].level&&(D=o.match(/^\s+/))&&(P[0].from=D[0].length,P.unshift(new a(0,0,D[0].length))),1==$(P).level&&(D=o.match(/\s+$/))&&($(P).to-=D[0].length,P.push(new a(0,l-D[0].length,l)))),"rtl"==s?P.reverse():P}}();function ct(t,e){var n=t.order;return null==n&&(n=t.order=ut(t.text,e)),n}var lt=[],ht=function(t,e,n){if(t.addEventListener)t.addEventListener(e,n,!1);else if(t.attachEvent)t.attachEvent("on"+e,n);else{var r=t._handlers||(t._handlers={});r[e]=(r[e]||lt).concat(n)}};function pt(t,e){return t._handlers&&t._handlers[e]||lt}function ft(t,e,n){if(t.removeEventListener)t.removeEventListener(e,n,!1);else if(t.detachEvent)t.detachEvent("on"+e,n);else{var r=t._handlers,i=r&&r[e];if(i){var a=U(i,n);a>-1&&(r[e]=i.slice(0,a).concat(i.slice(a+1)))}}}function dt(t,e){var n=pt(t,e);if(n.length)for(var r=Array.prototype.slice.call(arguments,2),i=0;i<n.length;++i)n[i].apply(null,r)}function mt(t,e,n){return"string"==typeof e&&(e={type:e,preventDefault:function(){this.defaultPrevented=!0}}),dt(t,n||e.type,t,e),wt(e)||e.codemirrorIgnore}function vt(t){var e=t._handlers&&t._handlers.cursorActivity;if(e)for(var n=t.curOp.cursorActivityHandlers||(t.curOp.cursorActivityHandlers=[]),r=0;r<e.length;++r)-1==U(n,e[r])&&n.push(e[r])}function gt(t,e){return pt(t,e).length>0}function yt(t){t.prototype.on=function(t,e){ht(this,t,e)},t.prototype.off=function(t,e){ft(this,t,e)}}function xt(t){t.preventDefault?t.preventDefault():t.returnValue=!1}function bt(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}function wt(t){return null!=t.defaultPrevented?t.defaultPrevented:0==t.returnValue}function _t(t){xt(t),bt(t)}function St(t){return t.target||t.srcElement}function Mt(t){var e=t.which;return null==e&&(1&t.button?e=1:2&t.button?e=3:4&t.button&&(e=2)),y&&t.ctrlKey&&1==e&&(e=3),e}var Et,Tt,Ct=function(){if(o&&s<9)return!1;var t=N("div");return"draggable"in t||"dragDrop"in t}();function At(t){if(null==Et){var e=N("span","​");A(t,N("span",[e,document.createTextNode("x")])),0!=t.firstChild.offsetHeight&&(Et=e.offsetWidth<=1&&e.offsetHeight>2&&!(o&&s<8))}var n=Et?N("span","​"):N("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return n.setAttribute("cm-text",""),n}function Nt(t){if(null!=Tt)return Tt;var e=A(t,document.createTextNode("AخA")),n=E(e,0,1).getBoundingClientRect(),r=E(e,1,2).getBoundingClientRect();return C(t),!(!n||n.left==n.right)&&(Tt=r.right-n.right<3)}var It,Rt=3!="\n\nb".split(/\n/).length?function(t){for(var e=0,n=[],r=t.length;e<=r;){var i=t.indexOf("\n",e);-1==i&&(i=t.length);var a=t.slice(e,"\r"==t.charAt(i-1)?i-1:i),o=a.indexOf("\r");-1!=o?(n.push(a.slice(0,o)),e+=o+1):(n.push(a),e=i+1)}return n}:function(t){return t.split(/\r\n?|\n/)},Ot=window.getSelection?function(t){try{return t.selectionStart!=t.selectionEnd}catch(t){return!1}}:function(t){var e;try{e=t.ownerDocument.selection.createRange()}catch(t){}return!(!e||e.parentElement()!=t)&&0!=e.compareEndPoints("StartToEnd",e)},kt="oncopy"in(It=N("div"))||(It.setAttribute("oncopy","return;"),"function"==typeof It.oncopy),Lt=null,Dt={},Pt={};function Ft(t,e){arguments.length>2&&(e.dependencies=Array.prototype.slice.call(arguments,2)),Dt[t]=e}function Bt(t){if("string"==typeof t&&Pt.hasOwnProperty(t))t=Pt[t];else if(t&&"string"==typeof t.name&&Pt.hasOwnProperty(t.name)){var e=Pt[t.name];"string"==typeof e&&(e={name:e}),(t=J(e,t)).name=e.name}else{if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return Bt("application/xml");if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+json$/.test(t))return Bt("application/json")}return"string"==typeof t?{name:t}:t||{name:"null"}}function zt(t,e){e=Bt(e);var n=Dt[e.name];if(!n)return zt(t,"text/plain");var r=n(t,e);if(Ut.hasOwnProperty(e.name)){var i=Ut[e.name];for(var a in i)i.hasOwnProperty(a)&&(r.hasOwnProperty(a)&&(r["_"+a]=r[a]),r[a]=i[a])}if(r.name=e.name,e.helperType&&(r.helperType=e.helperType),e.modeProps)for(var o in e.modeProps)r[o]=e.modeProps[o];return r}var Ut={};function jt(t,e){F(e,Ut.hasOwnProperty(t)?Ut[t]:Ut[t]={})}function Wt(t,e){if(!0===e)return e;if(t.copyState)return t.copyState(e);var n={};for(var r in e){var i=e[r];i instanceof Array&&(i=i.concat([])),n[r]=i}return n}function Vt(t,e){for(var n;t.innerMode&&(n=t.innerMode(e))&&n.mode!=t;)e=n.state,t=n.mode;return n||{mode:t,state:e}}function Ht(t,e,n){return!t.startState||t.startState(e,n)}var Gt=function(t,e,n){this.pos=this.start=0,this.string=t,this.tabSize=e||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=n};function qt(t,e){if((e-=t.first)<0||e>=t.size)throw new Error("There is no line "+(e+t.first)+" in the document.");for(var n=t;!n.lines;)for(var r=0;;++r){var i=n.children[r],a=i.chunkSize();if(e<a){n=i;break}e-=a}return n.lines[e]}function Xt(t,e,n){var r=[],i=e.line;return t.iter(e.line,n.line+1,(function(t){var a=t.text;i==n.line&&(a=a.slice(0,n.ch)),i==e.line&&(a=a.slice(e.ch)),r.push(a),++i})),r}function $t(t,e,n){var r=[];return t.iter(e,n,(function(t){r.push(t.text)})),r}function Yt(t,e){var n=e-t.height;if(n)for(var r=t;r;r=r.parent)r.height+=n}function Kt(t){if(null==t.parent)return null;for(var e=t.parent,n=U(e.lines,t),r=e.parent;r;e=r,r=r.parent)for(var i=0;r.children[i]!=e;++i)n+=r.children[i].chunkSize();return n+e.first}function Jt(t,e){var n=t.first;t:do{for(var r=0;r<t.children.length;++r){var i=t.children[r],a=i.height;if(e<a){t=i;continue t}e-=a,n+=i.chunkSize()}return n}while(!t.lines);for(var o=0;o<t.lines.length;++o){var s=t.lines[o].height;if(e<s)break;e-=s}return n+o}function Zt(t,e){return e>=t.first&&e<t.first+t.size}function Qt(t,e){return String(t.lineNumberFormatter(e+t.firstLineNumber))}function te(t,e,n){if(void 0===n&&(n=null),!(this instanceof te))return new te(t,e,n);this.line=t,this.ch=e,this.sticky=n}function ee(t,e){return t.line-e.line||t.ch-e.ch}function ne(t,e){return t.sticky==e.sticky&&0==ee(t,e)}function re(t){return te(t.line,t.ch)}function ie(t,e){return ee(t,e)<0?e:t}function ae(t,e){return ee(t,e)<0?t:e}function oe(t,e){return Math.max(t.first,Math.min(e,t.first+t.size-1))}function se(t,e){if(e.line<t.first)return te(t.first,0);var n=t.first+t.size-1;return e.line>n?te(n,qt(t,n).text.length):function(t,e){var n=t.ch;return null==n||n>e?te(t.line,e):n<0?te(t.line,0):t}(e,qt(t,e.line).text.length)}function ue(t,e){for(var n=[],r=0;r<e.length;r++)n[r]=se(t,e[r]);return n}Gt.prototype.eol=function(){return this.pos>=this.string.length},Gt.prototype.sol=function(){return this.pos==this.lineStart},Gt.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},Gt.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},Gt.prototype.eat=function(t){var e=this.string.charAt(this.pos);if("string"==typeof t?e==t:e&&(t.test?t.test(e):t(e)))return++this.pos,e},Gt.prototype.eatWhile=function(t){for(var e=this.pos;this.eat(t););return this.pos>e},Gt.prototype.eatSpace=function(){for(var t=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>t},Gt.prototype.skipToEnd=function(){this.pos=this.string.length},Gt.prototype.skipTo=function(t){var e=this.string.indexOf(t,this.pos);if(e>-1)return this.pos=e,!0},Gt.prototype.backUp=function(t){this.pos-=t},Gt.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=B(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?B(this.string,this.lineStart,this.tabSize):0)},Gt.prototype.indentation=function(){return B(this.string,null,this.tabSize)-(this.lineStart?B(this.string,this.lineStart,this.tabSize):0)},Gt.prototype.match=function(t,e,n){if("string"!=typeof t){var r=this.string.slice(this.pos).match(t);return r&&r.index>0?null:(r&&!1!==e&&(this.pos+=r[0].length),r)}var i=function(t){return n?t.toLowerCase():t};if(i(this.string.substr(this.pos,t.length))==i(t))return!1!==e&&(this.pos+=t.length),!0},Gt.prototype.current=function(){return this.string.slice(this.start,this.pos)},Gt.prototype.hideFirstChars=function(t,e){this.lineStart+=t;try{return e()}finally{this.lineStart-=t}},Gt.prototype.lookAhead=function(t){var e=this.lineOracle;return e&&e.lookAhead(t)},Gt.prototype.baseToken=function(){var t=this.lineOracle;return t&&t.baseToken(this.pos)};var ce=function(t,e){this.state=t,this.lookAhead=e},le=function(t,e,n,r){this.state=e,this.doc=t,this.line=n,this.maxLookAhead=r||0,this.baseTokens=null,this.baseTokenPos=1};function he(t,e,n,r){var i=[t.state.modeGen],a={};be(t,e.text,t.doc.mode,n,(function(t,e){return i.push(t,e)}),a,r);for(var o=n.state,s=function(r){n.baseTokens=i;var s=t.state.overlays[r],u=1,c=0;n.state=!0,be(t,e.text,s.mode,n,(function(t,e){for(var n=u;c<t;){var r=i[u];r>t&&i.splice(u,1,t,i[u+1],r),u+=2,c=Math.min(t,r)}if(e)if(s.opaque)i.splice(n,u-n,t,"overlay "+e),u=n+2;else for(;n<u;n+=2){var a=i[n+1];i[n+1]=(a?a+" ":"")+"overlay "+e}}),a),n.state=o,n.baseTokens=null,n.baseTokenPos=1},u=0;u<t.state.overlays.length;++u)s(u);return{styles:i,classes:a.bgClass||a.textClass?a:null}}function pe(t,e,n){if(!e.styles||e.styles[0]!=t.state.modeGen){var r=fe(t,Kt(e)),i=e.text.length>t.options.maxHighlightLength&&Wt(t.doc.mode,r.state),a=he(t,e,r);i&&(r.state=i),e.stateAfter=r.save(!i),e.styles=a.styles,a.classes?e.styleClasses=a.classes:e.styleClasses&&(e.styleClasses=null),n===t.doc.highlightFrontier&&(t.doc.modeFrontier=Math.max(t.doc.modeFrontier,++t.doc.highlightFrontier))}return e.styles}function fe(t,e,n){var r=t.doc,i=t.display;if(!r.mode.startState)return new le(r,!0,e);var a=function(t,e,n){for(var r,i,a=t.doc,o=n?-1:e-(t.doc.mode.innerMode?1e3:100),s=e;s>o;--s){if(s<=a.first)return a.first;var u=qt(a,s-1),c=u.stateAfter;if(c&&(!n||s+(c instanceof ce?c.lookAhead:0)<=a.modeFrontier))return s;var l=B(u.text,null,t.options.tabSize);(null==i||r>l)&&(i=s-1,r=l)}return i}(t,e,n),o=a>r.first&&qt(r,a-1).stateAfter,s=o?le.fromSaved(r,o,a):new le(r,Ht(r.mode),a);return r.iter(a,e,(function(n){de(t,n.text,s);var r=s.line;n.stateAfter=r==e-1||r%5==0||r>=i.viewFrom&&r<i.viewTo?s.save():null,s.nextLine()})),n&&(r.modeFrontier=s.line),s}function de(t,e,n,r){var i=t.doc.mode,a=new Gt(e,t.options.tabSize,n);for(a.start=a.pos=r||0,""==e&&me(i,n.state);!a.eol();)ve(i,a,n.state),a.start=a.pos}function me(t,e){if(t.blankLine)return t.blankLine(e);if(t.innerMode){var n=Vt(t,e);return n.mode.blankLine?n.mode.blankLine(n.state):void 0}}function ve(t,e,n,r){for(var i=0;i<10;i++){r&&(r[0]=Vt(t,n).mode);var a=t.token(e,n);if(e.pos>e.start)return a}throw new Error("Mode "+t.name+" failed to advance stream.")}le.prototype.lookAhead=function(t){var e=this.doc.getLine(this.line+t);return null!=e&&t>this.maxLookAhead&&(this.maxLookAhead=t),e},le.prototype.baseToken=function(t){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=t;)this.baseTokenPos+=2;var e=this.baseTokens[this.baseTokenPos+1];return{type:e&&e.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-t}},le.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},le.fromSaved=function(t,e,n){return e instanceof ce?new le(t,Wt(t.mode,e.state),n,e.lookAhead):new le(t,Wt(t.mode,e),n)},le.prototype.save=function(t){var e=!1!==t?Wt(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new ce(e,this.maxLookAhead):e};var ge=function(t,e,n){this.start=t.start,this.end=t.pos,this.string=t.current(),this.type=e||null,this.state=n};function ye(t,e,n,r){var i,a,o=t.doc,s=o.mode,u=qt(o,(e=se(o,e)).line),c=fe(t,e.line,n),l=new Gt(u.text,t.options.tabSize,c);for(r&&(a=[]);(r||l.pos<e.ch)&&!l.eol();)l.start=l.pos,i=ve(s,l,c.state),r&&a.push(new ge(l,i,Wt(o.mode,c.state)));return r?a:new ge(l,i,c.state)}function xe(t,e){if(t)for(;;){var n=t.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!n)break;t=t.slice(0,n.index)+t.slice(n.index+n[0].length);var r=n[1]?"bgClass":"textClass";null==e[r]?e[r]=n[2]:new RegExp("(?:^|s)"+n[2]+"(?:$|s)").test(e[r])||(e[r]+=" "+n[2])}return t}function be(t,e,n,r,i,a,o){var s=n.flattenSpans;null==s&&(s=t.options.flattenSpans);var u,c=0,l=null,h=new Gt(e,t.options.tabSize,r),p=t.options.addModeClass&&[null];for(""==e&&xe(me(n,r.state),a);!h.eol();){if(h.pos>t.options.maxHighlightLength?(s=!1,o&&de(t,e,r,h.pos),h.pos=e.length,u=null):u=xe(ve(n,h,r.state,p),a),p){var f=p[0].name;f&&(u="m-"+(u?f+" "+u:f))}if(!s||l!=u){for(;c<h.start;)i(c=Math.min(h.start,c+5e3),l);l=u}h.start=h.pos}for(;c<h.pos;){var d=Math.min(h.pos,c+5e3);i(d,l),c=d}}var we=!1,_e=!1;function Se(t,e,n){this.marker=t,this.from=e,this.to=n}function Me(t,e){if(t)for(var n=0;n<t.length;++n){var r=t[n];if(r.marker==e)return r}}function Ee(t,e){for(var n,r=0;r<t.length;++r)t[r]!=e&&(n||(n=[])).push(t[r]);return n}function Te(t,e){if(e.full)return null;var n=Zt(t,e.from.line)&&qt(t,e.from.line).markedSpans,r=Zt(t,e.to.line)&&qt(t,e.to.line).markedSpans;if(!n&&!r)return null;var i=e.from.ch,a=e.to.ch,o=0==ee(e.from,e.to),s=function(t,e,n){var r;if(t)for(var i=0;i<t.length;++i){var a=t[i],o=a.marker;if(null==a.from||(o.inclusiveLeft?a.from<=e:a.from<e)||a.from==e&&"bookmark"==o.type&&(!n||!a.marker.insertLeft)){var s=null==a.to||(o.inclusiveRight?a.to>=e:a.to>e);(r||(r=[])).push(new Se(o,a.from,s?null:a.to))}}return r}(n,i,o),u=function(t,e,n){var r;if(t)for(var i=0;i<t.length;++i){var a=t[i],o=a.marker;if(null==a.to||(o.inclusiveRight?a.to>=e:a.to>e)||a.from==e&&"bookmark"==o.type&&(!n||a.marker.insertLeft)){var s=null==a.from||(o.inclusiveLeft?a.from<=e:a.from<e);(r||(r=[])).push(new Se(o,s?null:a.from-e,null==a.to?null:a.to-e))}}return r}(r,a,o),c=1==e.text.length,l=$(e.text).length+(c?i:0);if(s)for(var h=0;h<s.length;++h){var p=s[h];if(null==p.to){var f=Me(u,p.marker);f?c&&(p.to=null==f.to?null:f.to+l):p.to=i}}if(u)for(var d=0;d<u.length;++d){var m=u[d];null!=m.to&&(m.to+=l),null==m.from?Me(s,m.marker)||(m.from=l,c&&(s||(s=[])).push(m)):(m.from+=l,c&&(s||(s=[])).push(m))}s&&(s=Ce(s)),u&&u!=s&&(u=Ce(u));var v=[s];if(!c){var g,y=e.text.length-2;if(y>0&&s)for(var x=0;x<s.length;++x)null==s[x].to&&(g||(g=[])).push(new Se(s[x].marker,null,null));for(var b=0;b<y;++b)v.push(g);v.push(u)}return v}function Ce(t){for(var e=0;e<t.length;++e){var n=t[e];null!=n.from&&n.from==n.to&&!1!==n.marker.clearWhenEmpty&&t.splice(e--,1)}return t.length?t:null}function Ae(t){var e=t.markedSpans;if(e){for(var n=0;n<e.length;++n)e[n].marker.detachLine(t);t.markedSpans=null}}function Ne(t,e){if(e){for(var n=0;n<e.length;++n)e[n].marker.attachLine(t);t.markedSpans=e}}function Ie(t){return t.inclusiveLeft?-1:0}function Re(t){return t.inclusiveRight?1:0}function Oe(t,e){var n=t.lines.length-e.lines.length;if(0!=n)return n;var r=t.find(),i=e.find(),a=ee(r.from,i.from)||Ie(t)-Ie(e);if(a)return-a;var o=ee(r.to,i.to)||Re(t)-Re(e);return o||e.id-t.id}function ke(t,e){var n,r=_e&&t.markedSpans;if(r)for(var i=void 0,a=0;a<r.length;++a)(i=r[a]).marker.collapsed&&null==(e?i.from:i.to)&&(!n||Oe(n,i.marker)<0)&&(n=i.marker);return n}function Le(t){return ke(t,!0)}function De(t){return ke(t,!1)}function Pe(t,e){var n,r=_e&&t.markedSpans;if(r)for(var i=0;i<r.length;++i){var a=r[i];a.marker.collapsed&&(null==a.from||a.from<e)&&(null==a.to||a.to>e)&&(!n||Oe(n,a.marker)<0)&&(n=a.marker)}return n}function Fe(t,e,n,r,i){var a=qt(t,e),o=_e&&a.markedSpans;if(o)for(var s=0;s<o.length;++s){var u=o[s];if(u.marker.collapsed){var c=u.marker.find(0),l=ee(c.from,n)||Ie(u.marker)-Ie(i),h=ee(c.to,r)||Re(u.marker)-Re(i);if(!(l>=0&&h<=0||l<=0&&h>=0)&&(l<=0&&(u.marker.inclusiveRight&&i.inclusiveLeft?ee(c.to,n)>=0:ee(c.to,n)>0)||l>=0&&(u.marker.inclusiveRight&&i.inclusiveLeft?ee(c.from,r)<=0:ee(c.from,r)<0)))return!0}}}function Be(t){for(var e;e=Le(t);)t=e.find(-1,!0).line;return t}function ze(t,e){var n=qt(t,e),r=Be(n);return n==r?e:Kt(r)}function Ue(t,e){if(e>t.lastLine())return e;var n,r=qt(t,e);if(!je(t,r))return e;for(;n=De(r);)r=n.find(1,!0).line;return Kt(r)+1}function je(t,e){var n=_e&&e.markedSpans;if(n)for(var r=void 0,i=0;i<n.length;++i)if((r=n[i]).marker.collapsed){if(null==r.from)return!0;if(!r.marker.widgetNode&&0==r.from&&r.marker.inclusiveLeft&&We(t,e,r))return!0}}function We(t,e,n){if(null==n.to){var r=n.marker.find(1,!0);return We(t,r.line,Me(r.line.markedSpans,n.marker))}if(n.marker.inclusiveRight&&n.to==e.text.length)return!0;for(var i=void 0,a=0;a<e.markedSpans.length;++a)if((i=e.markedSpans[a]).marker.collapsed&&!i.marker.widgetNode&&i.from==n.to&&(null==i.to||i.to!=n.from)&&(i.marker.inclusiveLeft||n.marker.inclusiveRight)&&We(t,e,i))return!0}function Ve(t){for(var e=0,n=(t=Be(t)).parent,r=0;r<n.lines.length;++r){var i=n.lines[r];if(i==t)break;e+=i.height}for(var a=n.parent;a;a=(n=a).parent)for(var o=0;o<a.children.length;++o){var s=a.children[o];if(s==n)break;e+=s.height}return e}function He(t){if(0==t.height)return 0;for(var e,n=t.text.length,r=t;e=Le(r);){var i=e.find(0,!0);r=i.from.line,n+=i.from.ch-i.to.ch}for(r=t;e=De(r);){var a=e.find(0,!0);n-=r.text.length-a.from.ch,n+=(r=a.to.line).text.length-a.to.ch}return n}function Ge(t){var e=t.display,n=t.doc;e.maxLine=qt(n,n.first),e.maxLineLength=He(e.maxLine),e.maxLineChanged=!0,n.iter((function(t){var n=He(t);n>e.maxLineLength&&(e.maxLineLength=n,e.maxLine=t)}))}var qe=function(t,e,n){this.text=t,Ne(this,e),this.height=n?n(this):1};function Xe(t){t.parent=null,Ae(t)}qe.prototype.lineNo=function(){return Kt(this)},yt(qe);var $e={},Ye={};function Ke(t,e){if(!t||/^\s*$/.test(t))return null;var n=e.addModeClass?Ye:$e;return n[t]||(n[t]=t.replace(/\S+/g,"cm-$&"))}function Je(t,e){var n=I("span",null,null,u?"padding-right: .1px":null),r={pre:I("pre",[n],"CodeMirror-line"),content:n,col:0,pos:0,cm:t,trailingSpace:!1,splitSpaces:t.getOption("lineWrapping")};e.measure={};for(var i=0;i<=(e.rest?e.rest.length:0);i++){var a=i?e.rest[i-1]:e.line,o=void 0;r.pos=0,r.addToken=Qe,Nt(t.display.measure)&&(o=ct(a,t.doc.direction))&&(r.addToken=tn(r.addToken,o)),r.map=[],nn(a,r,pe(t,a,e!=t.display.externalMeasured&&Kt(a))),a.styleClasses&&(a.styleClasses.bgClass&&(r.bgClass=L(a.styleClasses.bgClass,r.bgClass||"")),a.styleClasses.textClass&&(r.textClass=L(a.styleClasses.textClass,r.textClass||""))),0==r.map.length&&r.map.push(0,0,r.content.appendChild(At(t.display.measure))),0==i?(e.measure.map=r.map,e.measure.cache={}):((e.measure.maps||(e.measure.maps=[])).push(r.map),(e.measure.caches||(e.measure.caches=[])).push({}))}if(u){var s=r.content.lastChild;(/\bcm-tab\b/.test(s.className)||s.querySelector&&s.querySelector(".cm-tab"))&&(r.content.className="cm-tab-wrap-hack")}return dt(t,"renderLine",t,e.line,r.pre),r.pre.className&&(r.textClass=L(r.pre.className,r.textClass||"")),r}function Ze(t){var e=N("span","•","cm-invalidchar");return e.title="\\u"+t.charCodeAt(0).toString(16),e.setAttribute("aria-label",e.title),e}function Qe(t,e,n,r,i,a,u){if(e){var c,l=t.splitSpaces?function(t,e){if(t.length>1&&!/  /.test(t))return t;for(var n=e,r="",i=0;i<t.length;i++){var a=t.charAt(i);" "!=a||!n||i!=t.length-1&&32!=t.charCodeAt(i+1)||(a=" "),r+=a,n=" "==a}return r}(e,t.trailingSpace):e,h=t.cm.state.specialChars,p=!1;if(h.test(e)){c=document.createDocumentFragment();for(var f=0;;){h.lastIndex=f;var d=h.exec(e),m=d?d.index-f:e.length-f;if(m){var v=document.createTextNode(l.slice(f,f+m));o&&s<9?c.appendChild(N("span",[v])):c.appendChild(v),t.map.push(t.pos,t.pos+m,v),t.col+=m,t.pos+=m}if(!d)break;f+=m+1;var g=void 0;if("\t"==d[0]){var y=t.cm.options.tabSize,x=y-t.col%y;(g=c.appendChild(N("span",X(x),"cm-tab"))).setAttribute("role","presentation"),g.setAttribute("cm-text","\t"),t.col+=x}else"\r"==d[0]||"\n"==d[0]?((g=c.appendChild(N("span","\r"==d[0]?"␍":"␤","cm-invalidchar"))).setAttribute("cm-text",d[0]),t.col+=1):((g=t.cm.options.specialCharPlaceholder(d[0])).setAttribute("cm-text",d[0]),o&&s<9?c.appendChild(N("span",[g])):c.appendChild(g),t.col+=1);t.map.push(t.pos,t.pos+1,g),t.pos++}}else t.col+=e.length,c=document.createTextNode(l),t.map.push(t.pos,t.pos+e.length,c),o&&s<9&&(p=!0),t.pos+=e.length;if(t.trailingSpace=32==l.charCodeAt(e.length-1),n||r||i||p||a){var b=n||"";r&&(b+=r),i&&(b+=i);var w=N("span",[c],b,a);if(u)for(var _ in u)u.hasOwnProperty(_)&&"style"!=_&&"class"!=_&&w.setAttribute(_,u[_]);return t.content.appendChild(w)}t.content.appendChild(c)}}function tn(t,e){return function(n,r,i,a,o,s,u){i=i?i+" cm-force-border":"cm-force-border";for(var c=n.pos,l=c+r.length;;){for(var h=void 0,p=0;p<e.length&&!((h=e[p]).to>c&&h.from<=c);p++);if(h.to>=l)return t(n,r,i,a,o,s,u);t(n,r.slice(0,h.to-c),i,a,null,s,u),a=null,r=r.slice(h.to-c),c=h.to}}}function en(t,e,n,r){var i=!r&&n.widgetNode;i&&t.map.push(t.pos,t.pos+e,i),!r&&t.cm.display.input.needsContentAttribute&&(i||(i=t.content.appendChild(document.createElement("span"))),i.setAttribute("cm-marker",n.id)),i&&(t.cm.display.input.setUneditable(i),t.content.appendChild(i)),t.pos+=e,t.trailingSpace=!1}function nn(t,e,n){var r=t.markedSpans,i=t.text,a=0;if(r)for(var o,s,u,c,l,h,p,f=i.length,d=0,m=1,v="",g=0;;){if(g==d){u=c=l=s="",p=null,h=null,g=1/0;for(var y=[],x=void 0,b=0;b<r.length;++b){var w=r[b],_=w.marker;if("bookmark"==_.type&&w.from==d&&_.widgetNode)y.push(_);else if(w.from<=d&&(null==w.to||w.to>d||_.collapsed&&w.to==d&&w.from==d)){if(null!=w.to&&w.to!=d&&g>w.to&&(g=w.to,c=""),_.className&&(u+=" "+_.className),_.css&&(s=(s?s+";":"")+_.css),_.startStyle&&w.from==d&&(l+=" "+_.startStyle),_.endStyle&&w.to==g&&(x||(x=[])).push(_.endStyle,w.to),_.title&&((p||(p={})).title=_.title),_.attributes)for(var S in _.attributes)(p||(p={}))[S]=_.attributes[S];_.collapsed&&(!h||Oe(h.marker,_)<0)&&(h=w)}else w.from>d&&g>w.from&&(g=w.from)}if(x)for(var M=0;M<x.length;M+=2)x[M+1]==g&&(c+=" "+x[M]);if(!h||h.from==d)for(var E=0;E<y.length;++E)en(e,0,y[E]);if(h&&(h.from||0)==d){if(en(e,(null==h.to?f+1:h.to)-d,h.marker,null==h.from),null==h.to)return;h.to==d&&(h=!1)}}if(d>=f)break;for(var T=Math.min(f,g);;){if(v){var C=d+v.length;if(!h){var A=C>T?v.slice(0,T-d):v;e.addToken(e,A,o?o+u:u,l,d+A.length==g?c:"",s,p)}if(C>=T){v=v.slice(T-d),d=T;break}d=C,l=""}v=i.slice(a,a=n[m++]),o=Ke(n[m++],e.cm.options)}}else for(var N=1;N<n.length;N+=2)e.addToken(e,i.slice(a,a=n[N]),Ke(n[N+1],e.cm.options))}function rn(t,e,n){this.line=e,this.rest=function(t){for(var e,n;e=De(t);)t=e.find(1,!0).line,(n||(n=[])).push(t);return n}(e),this.size=this.rest?Kt($(this.rest))-n+1:1,this.node=this.text=null,this.hidden=je(t,e)}function an(t,e,n){for(var r,i=[],a=e;a<n;a=r){var o=new rn(t.doc,qt(t.doc,a),a);r=a+o.size,i.push(o)}return i}var on=null,sn=null;function un(t,e){var n=pt(t,e);if(n.length){var r,i=Array.prototype.slice.call(arguments,2);on?r=on.delayedCallbacks:sn?r=sn:(r=sn=[],setTimeout(cn,0));for(var a=function(t){r.push((function(){return n[t].apply(null,i)}))},o=0;o<n.length;++o)a(o)}}function cn(){var t=sn;sn=null;for(var e=0;e<t.length;++e)t[e]()}function ln(t,e,n,r){for(var i=0;i<e.changes.length;i++){var a=e.changes[i];"text"==a?fn(t,e):"gutter"==a?mn(t,e,n,r):"class"==a?dn(t,e):"widget"==a&&vn(t,e,r)}e.changes=null}function hn(t){return t.node==t.text&&(t.node=N("div",null,null,"position: relative"),t.text.parentNode&&t.text.parentNode.replaceChild(t.node,t.text),t.node.appendChild(t.text),o&&s<8&&(t.node.style.zIndex=2)),t.node}function pn(t,e){var n=t.display.externalMeasured;return n&&n.line==e.line?(t.display.externalMeasured=null,e.measure=n.measure,n.built):Je(t,e)}function fn(t,e){var n=e.text.className,r=pn(t,e);e.text==e.node&&(e.node=r.pre),e.text.parentNode.replaceChild(r.pre,e.text),e.text=r.pre,r.bgClass!=e.bgClass||r.textClass!=e.textClass?(e.bgClass=r.bgClass,e.textClass=r.textClass,dn(t,e)):n&&(e.text.className=n)}function dn(t,e){!function(t,e){var n=e.bgClass?e.bgClass+" "+(e.line.bgClass||""):e.line.bgClass;if(n&&(n+=" CodeMirror-linebackground"),e.background)n?e.background.className=n:(e.background.parentNode.removeChild(e.background),e.background=null);else if(n){var r=hn(e);e.background=r.insertBefore(N("div",null,n),r.firstChild),t.display.input.setUneditable(e.background)}}(t,e),e.line.wrapClass?hn(e).className=e.line.wrapClass:e.node!=e.text&&(e.node.className="");var n=e.textClass?e.textClass+" "+(e.line.textClass||""):e.line.textClass;e.text.className=n||""}function mn(t,e,n,r){if(e.gutter&&(e.node.removeChild(e.gutter),e.gutter=null),e.gutterBackground&&(e.node.removeChild(e.gutterBackground),e.gutterBackground=null),e.line.gutterClass){var i=hn(e);e.gutterBackground=N("div",null,"CodeMirror-gutter-background "+e.line.gutterClass,"left: "+(t.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px; width: "+r.gutterTotalWidth+"px"),t.display.input.setUneditable(e.gutterBackground),i.insertBefore(e.gutterBackground,e.text)}var a=e.line.gutterMarkers;if(t.options.lineNumbers||a){var o=hn(e),s=e.gutter=N("div",null,"CodeMirror-gutter-wrapper","left: "+(t.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px");if(t.display.input.setUneditable(s),o.insertBefore(s,e.text),e.line.gutterClass&&(s.className+=" "+e.line.gutterClass),!t.options.lineNumbers||a&&a["CodeMirror-linenumbers"]||(e.lineNumber=s.appendChild(N("div",Qt(t.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+r.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+t.display.lineNumInnerWidth+"px"))),a)for(var u=0;u<t.display.gutterSpecs.length;++u){var c=t.display.gutterSpecs[u].className,l=a.hasOwnProperty(c)&&a[c];l&&s.appendChild(N("div",[l],"CodeMirror-gutter-elt","left: "+r.gutterLeft[c]+"px; width: "+r.gutterWidth[c]+"px"))}}}function vn(t,e,n){e.alignable&&(e.alignable=null);for(var r=M("CodeMirror-linewidget"),i=e.node.firstChild,a=void 0;i;i=a)a=i.nextSibling,r.test(i.className)&&e.node.removeChild(i);yn(t,e,n)}function gn(t,e,n,r){var i=pn(t,e);return e.text=e.node=i.pre,i.bgClass&&(e.bgClass=i.bgClass),i.textClass&&(e.textClass=i.textClass),dn(t,e),mn(t,e,n,r),yn(t,e,r),e.node}function yn(t,e,n){if(xn(t,e.line,e,n,!0),e.rest)for(var r=0;r<e.rest.length;r++)xn(t,e.rest[r],e,n,!1)}function xn(t,e,n,r,i){if(e.widgets)for(var a=hn(n),o=0,s=e.widgets;o<s.length;++o){var u=s[o],c=N("div",[u.node],"CodeMirror-linewidget"+(u.className?" "+u.className:""));u.handleMouseEvents||c.setAttribute("cm-ignore-events","true"),bn(u,c,n,r),t.display.input.setUneditable(c),i&&u.above?a.insertBefore(c,n.gutter||n.text):a.appendChild(c),un(u,"redraw")}}function bn(t,e,n,r){if(t.noHScroll){(n.alignable||(n.alignable=[])).push(e);var i=r.wrapperWidth;e.style.left=r.fixedPos+"px",t.coverGutter||(i-=r.gutterTotalWidth,e.style.paddingLeft=r.gutterTotalWidth+"px"),e.style.width=i+"px"}t.coverGutter&&(e.style.zIndex=5,e.style.position="relative",t.noHScroll||(e.style.marginLeft=-r.gutterTotalWidth+"px"))}function wn(t){if(null!=t.height)return t.height;var e=t.doc.cm;if(!e)return 0;if(!R(document.body,t.node)){var n="position: relative;";t.coverGutter&&(n+="margin-left: -"+e.display.gutters.offsetWidth+"px;"),t.noHScroll&&(n+="width: "+e.display.wrapper.clientWidth+"px;"),A(e.display.measure,N("div",[t.node],null,n))}return t.height=t.node.parentNode.offsetHeight}function _n(t,e){for(var n=St(e);n!=t.wrapper;n=n.parentNode)if(!n||1==n.nodeType&&"true"==n.getAttribute("cm-ignore-events")||n.parentNode==t.sizer&&n!=t.mover)return!0}function Sn(t){return t.lineSpace.offsetTop}function Mn(t){return t.mover.offsetHeight-t.lineSpace.offsetHeight}function En(t){if(t.cachedPaddingH)return t.cachedPaddingH;var e=A(t.measure,N("pre","x","CodeMirror-line-like")),n=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,r={left:parseInt(n.paddingLeft),right:parseInt(n.paddingRight)};return isNaN(r.left)||isNaN(r.right)||(t.cachedPaddingH=r),r}function Tn(t){return 30-t.display.nativeBarWidth}function Cn(t){return t.display.scroller.clientWidth-Tn(t)-t.display.barWidth}function An(t){return t.display.scroller.clientHeight-Tn(t)-t.display.barHeight}function Nn(t,e,n){if(t.line==e)return{map:t.measure.map,cache:t.measure.cache};for(var r=0;r<t.rest.length;r++)if(t.rest[r]==e)return{map:t.measure.maps[r],cache:t.measure.caches[r]};for(var i=0;i<t.rest.length;i++)if(Kt(t.rest[i])>n)return{map:t.measure.maps[i],cache:t.measure.caches[i],before:!0}}function In(t,e,n,r){return kn(t,On(t,e),n,r)}function Rn(t,e){if(e>=t.display.viewFrom&&e<t.display.viewTo)return t.display.view[lr(t,e)];var n=t.display.externalMeasured;return n&&e>=n.lineN&&e<n.lineN+n.size?n:void 0}function On(t,e){var n=Kt(e),r=Rn(t,n);r&&!r.text?r=null:r&&r.changes&&(ln(t,r,n,ar(t)),t.curOp.forceUpdate=!0),r||(r=function(t,e){var n=Kt(e=Be(e)),r=t.display.externalMeasured=new rn(t.doc,e,n);r.lineN=n;var i=r.built=Je(t,r);return r.text=i.pre,A(t.display.lineMeasure,i.pre),r}(t,e));var i=Nn(r,e,n);return{line:e,view:r,rect:null,map:i.map,cache:i.cache,before:i.before,hasHeights:!1}}function kn(t,e,n,r,i){e.before&&(n=-1);var a,u=n+(r||"");return e.cache.hasOwnProperty(u)?a=e.cache[u]:(e.rect||(e.rect=e.view.text.getBoundingClientRect()),e.hasHeights||(function(t,e,n){var r=t.options.lineWrapping,i=r&&Cn(t);if(!e.measure.heights||r&&e.measure.width!=i){var a=e.measure.heights=[];if(r){e.measure.width=i;for(var o=e.text.firstChild.getClientRects(),s=0;s<o.length-1;s++){var u=o[s],c=o[s+1];Math.abs(u.bottom-c.bottom)>2&&a.push((u.bottom+c.top)/2-n.top)}}a.push(n.bottom-n.top)}}(t,e.view,e.rect),e.hasHeights=!0),(a=function(t,e,n,r){var i,a=Pn(e.map,n,r),u=a.node,c=a.start,l=a.end,h=a.collapse;if(3==u.nodeType){for(var p=0;p<4;p++){for(;c&&rt(e.line.text.charAt(a.coverStart+c));)--c;for(;a.coverStart+l<a.coverEnd&&rt(e.line.text.charAt(a.coverStart+l));)++l;if((i=o&&s<9&&0==c&&l==a.coverEnd-a.coverStart?u.parentNode.getBoundingClientRect():Fn(E(u,c,l).getClientRects(),r)).left||i.right||0==c)break;l=c,c-=1,h="right"}o&&s<11&&(i=function(t,e){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!function(t){if(null!=Lt)return Lt;var e=A(t,N("span","x")),n=e.getBoundingClientRect(),r=E(e,0,1).getBoundingClientRect();return Lt=Math.abs(n.left-r.left)>1}(t))return e;var n=screen.logicalXDPI/screen.deviceXDPI,r=screen.logicalYDPI/screen.deviceYDPI;return{left:e.left*n,right:e.right*n,top:e.top*r,bottom:e.bottom*r}}(t.display.measure,i))}else{var f;c>0&&(h=r="right"),i=t.options.lineWrapping&&(f=u.getClientRects()).length>1?f["right"==r?f.length-1:0]:u.getBoundingClientRect()}if(o&&s<9&&!c&&(!i||!i.left&&!i.right)){var d=u.parentNode.getClientRects()[0];i=d?{left:d.left,right:d.left+ir(t.display),top:d.top,bottom:d.bottom}:Dn}for(var m=i.top-e.rect.top,v=i.bottom-e.rect.top,g=(m+v)/2,y=e.view.measure.heights,x=0;x<y.length-1&&!(g<y[x]);x++);var b=x?y[x-1]:0,w=y[x],_={left:("right"==h?i.right:i.left)-e.rect.left,right:("left"==h?i.left:i.right)-e.rect.left,top:b,bottom:w};return i.left||i.right||(_.bogus=!0),t.options.singleCursorHeightPerLine||(_.rtop=m,_.rbottom=v),_}(t,e,n,r)).bogus||(e.cache[u]=a)),{left:a.left,right:a.right,top:i?a.rtop:a.top,bottom:i?a.rbottom:a.bottom}}var Ln,Dn={left:0,right:0,top:0,bottom:0};function Pn(t,e,n){for(var r,i,a,o,s,u,c=0;c<t.length;c+=3)if(s=t[c],u=t[c+1],e<s?(i=0,a=1,o="left"):e<u?a=1+(i=e-s):(c==t.length-3||e==u&&t[c+3]>e)&&(i=(a=u-s)-1,e>=u&&(o="right")),null!=i){if(r=t[c+2],s==u&&n==(r.insertLeft?"left":"right")&&(o=n),"left"==n&&0==i)for(;c&&t[c-2]==t[c-3]&&t[c-1].insertLeft;)r=t[2+(c-=3)],o="left";if("right"==n&&i==u-s)for(;c<t.length-3&&t[c+3]==t[c+4]&&!t[c+5].insertLeft;)r=t[(c+=3)+2],o="right";break}return{node:r,start:i,end:a,collapse:o,coverStart:s,coverEnd:u}}function Fn(t,e){var n=Dn;if("left"==e)for(var r=0;r<t.length&&(n=t[r]).left==n.right;r++);else for(var i=t.length-1;i>=0&&(n=t[i]).left==n.right;i--);return n}function Bn(t){if(t.measure&&(t.measure.cache={},t.measure.heights=null,t.rest))for(var e=0;e<t.rest.length;e++)t.measure.caches[e]={}}function zn(t){t.display.externalMeasure=null,C(t.display.lineMeasure);for(var e=0;e<t.display.view.length;e++)Bn(t.display.view[e])}function Un(t){zn(t),t.display.cachedCharWidth=t.display.cachedTextHeight=t.display.cachedPaddingH=null,t.options.lineWrapping||(t.display.maxLineChanged=!0),t.display.lineNumChars=null}function jn(){return l&&v?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function Wn(){return l&&v?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function Vn(t){var e=0;if(t.widgets)for(var n=0;n<t.widgets.length;++n)t.widgets[n].above&&(e+=wn(t.widgets[n]));return e}function Hn(t,e,n,r,i){if(!i){var a=Vn(e);n.top+=a,n.bottom+=a}if("line"==r)return n;r||(r="local");var o=Ve(e);if("local"==r?o+=Sn(t.display):o-=t.display.viewOffset,"page"==r||"window"==r){var s=t.display.lineSpace.getBoundingClientRect();o+=s.top+("window"==r?0:Wn());var u=s.left+("window"==r?0:jn());n.left+=u,n.right+=u}return n.top+=o,n.bottom+=o,n}function Gn(t,e,n){if("div"==n)return e;var r=e.left,i=e.top;if("page"==n)r-=jn(),i-=Wn();else if("local"==n||!n){var a=t.display.sizer.getBoundingClientRect();r+=a.left,i+=a.top}var o=t.display.lineSpace.getBoundingClientRect();return{left:r-o.left,top:i-o.top}}function qn(t,e,n,r,i){return r||(r=qt(t.doc,e.line)),Hn(t,r,In(t,r,e.ch,i),n)}function Xn(t,e,n,r,i,a){function o(e,o){var s=kn(t,i,e,o?"right":"left",a);return o?s.left=s.right:s.right=s.left,Hn(t,r,s,n)}r=r||qt(t.doc,e.line),i||(i=On(t,r));var s=ct(r,t.doc.direction),u=e.ch,c=e.sticky;if(u>=r.text.length?(u=r.text.length,c="before"):u<=0&&(u=0,c="after"),!s)return o("before"==c?u-1:u,"before"==c);function l(t,e,n){return o(n?t-1:t,1==s[e].level!=n)}var h=st(s,u,c),p=ot,f=l(u,h,"before"==c);return null!=p&&(f.other=l(u,p,"before"!=c)),f}function $n(t,e){var n=0;e=se(t.doc,e),t.options.lineWrapping||(n=ir(t.display)*e.ch);var r=qt(t.doc,e.line),i=Ve(r)+Sn(t.display);return{left:n,right:n,top:i,bottom:i+r.height}}function Yn(t,e,n,r,i){var a=te(t,e,n);return a.xRel=i,r&&(a.outside=r),a}function Kn(t,e,n){var r=t.doc;if((n+=t.display.viewOffset)<0)return Yn(r.first,0,null,-1,-1);var i=Jt(r,n),a=r.first+r.size-1;if(i>a)return Yn(r.first+r.size-1,qt(r,a).text.length,null,1,1);e<0&&(e=0);for(var o=qt(r,i);;){var s=tr(t,o,i,e,n),u=Pe(o,s.ch+(s.xRel>0||s.outside>0?1:0));if(!u)return s;var c=u.find(1);if(c.line==i)return c;o=qt(r,i=c.line)}}function Jn(t,e,n,r){r-=Vn(e);var i=e.text.length,a=at((function(e){return kn(t,n,e-1).bottom<=r}),i,0);return{begin:a,end:i=at((function(e){return kn(t,n,e).top>r}),a,i)}}function Zn(t,e,n,r){return n||(n=On(t,e)),Jn(t,e,n,Hn(t,e,kn(t,n,r),"line").top)}function Qn(t,e,n,r){return!(t.bottom<=n)&&(t.top>n||(r?t.left:t.right)>e)}function tr(t,e,n,r,i){i-=Ve(e);var a=On(t,e),o=Vn(e),s=0,u=e.text.length,c=!0,l=ct(e,t.doc.direction);if(l){var h=(t.options.lineWrapping?nr:er)(t,e,n,a,l,r,i);s=(c=1!=h.level)?h.from:h.to-1,u=c?h.to:h.from-1}var p,f,d=null,m=null,v=at((function(e){var n=kn(t,a,e);return n.top+=o,n.bottom+=o,!!Qn(n,r,i,!1)&&(n.top<=i&&n.left<=r&&(d=e,m=n),!0)}),s,u),g=!1;if(m){var y=r-m.left<m.right-r,x=y==c;v=d+(x?0:1),f=x?"after":"before",p=y?m.left:m.right}else{c||v!=u&&v!=s||v++,f=0==v?"after":v==e.text.length?"before":kn(t,a,v-(c?1:0)).bottom+o<=i==c?"after":"before";var b=Xn(t,te(n,v,f),"line",e,a);p=b.left,g=i<b.top?-1:i>=b.bottom?1:0}return Yn(n,v=it(e.text,v,1),f,g,r-p)}function er(t,e,n,r,i,a,o){var s=at((function(s){var u=i[s],c=1!=u.level;return Qn(Xn(t,te(n,c?u.to:u.from,c?"before":"after"),"line",e,r),a,o,!0)}),0,i.length-1),u=i[s];if(s>0){var c=1!=u.level,l=Xn(t,te(n,c?u.from:u.to,c?"after":"before"),"line",e,r);Qn(l,a,o,!0)&&l.top>o&&(u=i[s-1])}return u}function nr(t,e,n,r,i,a,o){var s=Jn(t,e,r,o),u=s.begin,c=s.end;/\s/.test(e.text.charAt(c-1))&&c--;for(var l=null,h=null,p=0;p<i.length;p++){var f=i[p];if(!(f.from>=c||f.to<=u)){var d=kn(t,r,1!=f.level?Math.min(c,f.to)-1:Math.max(u,f.from)).right,m=d<a?a-d+1e9:d-a;(!l||h>m)&&(l=f,h=m)}}return l||(l=i[i.length-1]),l.from<u&&(l={from:u,to:l.to,level:l.level}),l.to>c&&(l={from:l.from,to:c,level:l.level}),l}function rr(t){if(null!=t.cachedTextHeight)return t.cachedTextHeight;if(null==Ln){Ln=N("pre",null,"CodeMirror-line-like");for(var e=0;e<49;++e)Ln.appendChild(document.createTextNode("x")),Ln.appendChild(N("br"));Ln.appendChild(document.createTextNode("x"))}A(t.measure,Ln);var n=Ln.offsetHeight/50;return n>3&&(t.cachedTextHeight=n),C(t.measure),n||1}function ir(t){if(null!=t.cachedCharWidth)return t.cachedCharWidth;var e=N("span","xxxxxxxxxx"),n=N("pre",[e],"CodeMirror-line-like");A(t.measure,n);var r=e.getBoundingClientRect(),i=(r.right-r.left)/10;return i>2&&(t.cachedCharWidth=i),i||10}function ar(t){for(var e=t.display,n={},r={},i=e.gutters.clientLeft,a=e.gutters.firstChild,o=0;a;a=a.nextSibling,++o){var s=t.display.gutterSpecs[o].className;n[s]=a.offsetLeft+a.clientLeft+i,r[s]=a.clientWidth}return{fixedPos:or(e),gutterTotalWidth:e.gutters.offsetWidth,gutterLeft:n,gutterWidth:r,wrapperWidth:e.wrapper.clientWidth}}function or(t){return t.scroller.getBoundingClientRect().left-t.sizer.getBoundingClientRect().left}function sr(t){var e=rr(t.display),n=t.options.lineWrapping,r=n&&Math.max(5,t.display.scroller.clientWidth/ir(t.display)-3);return function(i){if(je(t.doc,i))return 0;var a=0;if(i.widgets)for(var o=0;o<i.widgets.length;o++)i.widgets[o].height&&(a+=i.widgets[o].height);return n?a+(Math.ceil(i.text.length/r)||1)*e:a+e}}function ur(t){var e=t.doc,n=sr(t);e.iter((function(t){var e=n(t);e!=t.height&&Yt(t,e)}))}function cr(t,e,n,r){var i=t.display;if(!n&&"true"==St(e).getAttribute("cm-not-content"))return null;var a,o,s=i.lineSpace.getBoundingClientRect();try{a=e.clientX-s.left,o=e.clientY-s.top}catch(e){return null}var u,c=Kn(t,a,o);if(r&&c.xRel>0&&(u=qt(t.doc,c.line).text).length==c.ch){var l=B(u,u.length,t.options.tabSize)-u.length;c=te(c.line,Math.max(0,Math.round((a-En(t.display).left)/ir(t.display))-l))}return c}function lr(t,e){if(e>=t.display.viewTo)return null;if((e-=t.display.viewFrom)<0)return null;for(var n=t.display.view,r=0;r<n.length;r++)if((e-=n[r].size)<0)return r}function hr(t,e,n,r){null==e&&(e=t.doc.first),null==n&&(n=t.doc.first+t.doc.size),r||(r=0);var i=t.display;if(r&&n<i.viewTo&&(null==i.updateLineNumbers||i.updateLineNumbers>e)&&(i.updateLineNumbers=e),t.curOp.viewChanged=!0,e>=i.viewTo)_e&&ze(t.doc,e)<i.viewTo&&fr(t);else if(n<=i.viewFrom)_e&&Ue(t.doc,n+r)>i.viewFrom?fr(t):(i.viewFrom+=r,i.viewTo+=r);else if(e<=i.viewFrom&&n>=i.viewTo)fr(t);else if(e<=i.viewFrom){var a=dr(t,n,n+r,1);a?(i.view=i.view.slice(a.index),i.viewFrom=a.lineN,i.viewTo+=r):fr(t)}else if(n>=i.viewTo){var o=dr(t,e,e,-1);o?(i.view=i.view.slice(0,o.index),i.viewTo=o.lineN):fr(t)}else{var s=dr(t,e,e,-1),u=dr(t,n,n+r,1);s&&u?(i.view=i.view.slice(0,s.index).concat(an(t,s.lineN,u.lineN)).concat(i.view.slice(u.index)),i.viewTo+=r):fr(t)}var c=i.externalMeasured;c&&(n<c.lineN?c.lineN+=r:e<c.lineN+c.size&&(i.externalMeasured=null))}function pr(t,e,n){t.curOp.viewChanged=!0;var r=t.display,i=t.display.externalMeasured;if(i&&e>=i.lineN&&e<i.lineN+i.size&&(r.externalMeasured=null),!(e<r.viewFrom||e>=r.viewTo)){var a=r.view[lr(t,e)];if(null!=a.node){var o=a.changes||(a.changes=[]);-1==U(o,n)&&o.push(n)}}}function fr(t){t.display.viewFrom=t.display.viewTo=t.doc.first,t.display.view=[],t.display.viewOffset=0}function dr(t,e,n,r){var i,a=lr(t,e),o=t.display.view;if(!_e||n==t.doc.first+t.doc.size)return{index:a,lineN:n};for(var s=t.display.viewFrom,u=0;u<a;u++)s+=o[u].size;if(s!=e){if(r>0){if(a==o.length-1)return null;i=s+o[a].size-e,a++}else i=s-e;e+=i,n+=i}for(;ze(t.doc,n)!=n;){if(a==(r<0?0:o.length-1))return null;n+=r*o[a-(r<0?1:0)].size,a+=r}return{index:a,lineN:n}}function mr(t){for(var e=t.display.view,n=0,r=0;r<e.length;r++){var i=e[r];i.hidden||i.node&&!i.changes||++n}return n}function vr(t){t.display.input.showSelection(t.display.input.prepareSelection())}function gr(t,e){void 0===e&&(e=!0);for(var n=t.doc,r={},i=r.cursors=document.createDocumentFragment(),a=r.selection=document.createDocumentFragment(),o=0;o<n.sel.ranges.length;o++)if(e||o!=n.sel.primIndex){var s=n.sel.ranges[o];if(!(s.from().line>=t.display.viewTo||s.to().line<t.display.viewFrom)){var u=s.empty();(u||t.options.showCursorWhenSelecting)&&yr(t,s.head,i),u||br(t,s,a)}}return r}function yr(t,e,n){var r=Xn(t,e,"div",null,null,!t.options.singleCursorHeightPerLine),i=n.appendChild(N("div"," ","CodeMirror-cursor"));if(i.style.left=r.left+"px",i.style.top=r.top+"px",i.style.height=Math.max(0,r.bottom-r.top)*t.options.cursorHeight+"px",r.other){var a=n.appendChild(N("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));a.style.display="",a.style.left=r.other.left+"px",a.style.top=r.other.top+"px",a.style.height=.85*(r.other.bottom-r.other.top)+"px"}}function xr(t,e){return t.top-e.top||t.left-e.left}function br(t,e,n){var r=t.display,i=t.doc,a=document.createDocumentFragment(),o=En(t.display),s=o.left,u=Math.max(r.sizerWidth,Cn(t)-r.sizer.offsetLeft)-o.right,c="ltr"==i.direction;function l(t,e,n,r){e<0&&(e=0),e=Math.round(e),r=Math.round(r),a.appendChild(N("div",null,"CodeMirror-selected","position: absolute; left: "+t+"px;\n                             top: "+e+"px; width: "+(null==n?u-t:n)+"px;\n                             height: "+(r-e)+"px"))}function h(e,n,r){var a,o,h=qt(i,e),p=h.text.length;function f(n,r){return qn(t,te(e,n),"div",h,r)}function d(e,n,r){var i=Zn(t,h,null,e),a="ltr"==n==("after"==r)?"left":"right";return f("after"==r?i.begin:i.end-(/\s/.test(h.text.charAt(i.end-1))?2:1),a)[a]}var m=ct(h,i.direction);return function(t,e,n,r){if(!t)return r(e,n,"ltr",0);for(var i=!1,a=0;a<t.length;++a){var o=t[a];(o.from<n&&o.to>e||e==n&&o.to==e)&&(r(Math.max(o.from,e),Math.min(o.to,n),1==o.level?"rtl":"ltr",a),i=!0)}i||r(e,n,"ltr")}(m,n||0,null==r?p:r,(function(t,e,i,h){var v="ltr"==i,g=f(t,v?"left":"right"),y=f(e-1,v?"right":"left"),x=null==n&&0==t,b=null==r&&e==p,w=0==h,_=!m||h==m.length-1;if(y.top-g.top<=3){var S=(c?b:x)&&_,M=(c?x:b)&&w?s:(v?g:y).left,E=S?u:(v?y:g).right;l(M,g.top,E-M,g.bottom)}else{var T,C,A,N;v?(T=c&&x&&w?s:g.left,C=c?u:d(t,i,"before"),A=c?s:d(e,i,"after"),N=c&&b&&_?u:y.right):(T=c?d(t,i,"before"):s,C=!c&&x&&w?u:g.right,A=!c&&b&&_?s:y.left,N=c?d(e,i,"after"):u),l(T,g.top,C-T,g.bottom),g.bottom<y.top&&l(s,g.bottom,null,y.top),l(A,y.top,N-A,y.bottom)}(!a||xr(g,a)<0)&&(a=g),xr(y,a)<0&&(a=y),(!o||xr(g,o)<0)&&(o=g),xr(y,o)<0&&(o=y)})),{start:a,end:o}}var p=e.from(),f=e.to();if(p.line==f.line)h(p.line,p.ch,f.ch);else{var d=qt(i,p.line),m=qt(i,f.line),v=Be(d)==Be(m),g=h(p.line,p.ch,v?d.text.length+1:null).end,y=h(f.line,v?0:null,f.ch).start;v&&(g.top<y.top-2?(l(g.right,g.top,null,g.bottom),l(s,y.top,y.left,y.bottom)):l(g.right,g.top,y.left-g.right,g.bottom)),g.bottom<y.top&&l(s,g.bottom,null,y.top)}n.appendChild(a)}function wr(t){if(t.state.focused){var e=t.display;clearInterval(e.blinker);var n=!0;e.cursorDiv.style.visibility="",t.options.cursorBlinkRate>0?e.blinker=setInterval((function(){return e.cursorDiv.style.visibility=(n=!n)?"":"hidden"}),t.options.cursorBlinkRate):t.options.cursorBlinkRate<0&&(e.cursorDiv.style.visibility="hidden")}}function _r(t){t.state.focused||(t.display.input.focus(),Mr(t))}function Sr(t){t.state.delayingBlurEvent=!0,setTimeout((function(){t.state.delayingBlurEvent&&(t.state.delayingBlurEvent=!1,Er(t))}),100)}function Mr(t,e){t.state.delayingBlurEvent&&(t.state.delayingBlurEvent=!1),"nocursor"!=t.options.readOnly&&(t.state.focused||(dt(t,"focus",t,e),t.state.focused=!0,k(t.display.wrapper,"CodeMirror-focused"),t.curOp||t.display.selForContextMenu==t.doc.sel||(t.display.input.reset(),u&&setTimeout((function(){return t.display.input.reset(!0)}),20)),t.display.input.receivedFocus()),wr(t))}function Er(t,e){t.state.delayingBlurEvent||(t.state.focused&&(dt(t,"blur",t,e),t.state.focused=!1,T(t.display.wrapper,"CodeMirror-focused")),clearInterval(t.display.blinker),setTimeout((function(){t.state.focused||(t.display.shift=!1)}),150))}function Tr(t){for(var e=t.display,n=e.lineDiv.offsetTop,r=0;r<e.view.length;r++){var i=e.view[r],a=t.options.lineWrapping,u=void 0,c=0;if(!i.hidden){if(o&&s<8){var l=i.node.offsetTop+i.node.offsetHeight;u=l-n,n=l}else{var h=i.node.getBoundingClientRect();u=h.bottom-h.top,!a&&i.text.firstChild&&(c=i.text.firstChild.getBoundingClientRect().right-h.left-1)}var p=i.line.height-u;if((p>.005||p<-.005)&&(Yt(i.line,u),Cr(i.line),i.rest))for(var f=0;f<i.rest.length;f++)Cr(i.rest[f]);if(c>t.display.sizerWidth){var d=Math.ceil(c/ir(t.display));d>t.display.maxLineLength&&(t.display.maxLineLength=d,t.display.maxLine=i.line,t.display.maxLineChanged=!0)}}}}function Cr(t){if(t.widgets)for(var e=0;e<t.widgets.length;++e){var n=t.widgets[e],r=n.node.parentNode;r&&(n.height=r.offsetHeight)}}function Ar(t,e,n){var r=n&&null!=n.top?Math.max(0,n.top):t.scroller.scrollTop;r=Math.floor(r-Sn(t));var i=n&&null!=n.bottom?n.bottom:r+t.wrapper.clientHeight,a=Jt(e,r),o=Jt(e,i);if(n&&n.ensure){var s=n.ensure.from.line,u=n.ensure.to.line;s<a?(a=s,o=Jt(e,Ve(qt(e,s))+t.wrapper.clientHeight)):Math.min(u,e.lastLine())>=o&&(a=Jt(e,Ve(qt(e,u))-t.wrapper.clientHeight),o=u)}return{from:a,to:Math.max(o,a+1)}}function Nr(t,e){var n=t.display,r=rr(t.display);e.top<0&&(e.top=0);var i=t.curOp&&null!=t.curOp.scrollTop?t.curOp.scrollTop:n.scroller.scrollTop,a=An(t),o={};e.bottom-e.top>a&&(e.bottom=e.top+a);var s=t.doc.height+Mn(n),u=e.top<r,c=e.bottom>s-r;if(e.top<i)o.scrollTop=u?0:e.top;else if(e.bottom>i+a){var l=Math.min(e.top,(c?s:e.bottom)-a);l!=i&&(o.scrollTop=l)}var h=t.curOp&&null!=t.curOp.scrollLeft?t.curOp.scrollLeft:n.scroller.scrollLeft,p=Cn(t)-(t.options.fixedGutter?n.gutters.offsetWidth:0),f=e.right-e.left>p;return f&&(e.right=e.left+p),e.left<10?o.scrollLeft=0:e.left<h?o.scrollLeft=Math.max(0,e.left-(f?0:10)):e.right>p+h-3&&(o.scrollLeft=e.right+(f?0:10)-p),o}function Ir(t,e){null!=e&&(kr(t),t.curOp.scrollTop=(null==t.curOp.scrollTop?t.doc.scrollTop:t.curOp.scrollTop)+e)}function Rr(t){kr(t);var e=t.getCursor();t.curOp.scrollToPos={from:e,to:e,margin:t.options.cursorScrollMargin}}function Or(t,e,n){null==e&&null==n||kr(t),null!=e&&(t.curOp.scrollLeft=e),null!=n&&(t.curOp.scrollTop=n)}function kr(t){var e=t.curOp.scrollToPos;e&&(t.curOp.scrollToPos=null,Lr(t,$n(t,e.from),$n(t,e.to),e.margin))}function Lr(t,e,n,r){var i=Nr(t,{left:Math.min(e.left,n.left),top:Math.min(e.top,n.top)-r,right:Math.max(e.right,n.right),bottom:Math.max(e.bottom,n.bottom)+r});Or(t,i.scrollLeft,i.scrollTop)}function Dr(t,e){Math.abs(t.doc.scrollTop-e)<2||(n||ui(t,{top:e}),Pr(t,e,!0),n&&ui(t),ri(t,100))}function Pr(t,e,n){e=Math.max(0,Math.min(t.display.scroller.scrollHeight-t.display.scroller.clientHeight,e)),(t.display.scroller.scrollTop!=e||n)&&(t.doc.scrollTop=e,t.display.scrollbars.setScrollTop(e),t.display.scroller.scrollTop!=e&&(t.display.scroller.scrollTop=e))}function Fr(t,e,n,r){e=Math.max(0,Math.min(e,t.display.scroller.scrollWidth-t.display.scroller.clientWidth)),(n?e==t.doc.scrollLeft:Math.abs(t.doc.scrollLeft-e)<2)&&!r||(t.doc.scrollLeft=e,hi(t),t.display.scroller.scrollLeft!=e&&(t.display.scroller.scrollLeft=e),t.display.scrollbars.setScrollLeft(e))}function Br(t){var e=t.display,n=e.gutters.offsetWidth,r=Math.round(t.doc.height+Mn(t.display));return{clientHeight:e.scroller.clientHeight,viewHeight:e.wrapper.clientHeight,scrollWidth:e.scroller.scrollWidth,clientWidth:e.scroller.clientWidth,viewWidth:e.wrapper.clientWidth,barLeft:t.options.fixedGutter?n:0,docHeight:r,scrollHeight:r+Tn(t)+e.barHeight,nativeBarWidth:e.nativeBarWidth,gutterWidth:n}}var zr=function(t,e,n){this.cm=n;var r=this.vert=N("div",[N("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),i=this.horiz=N("div",[N("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");r.tabIndex=i.tabIndex=-1,t(r),t(i),ht(r,"scroll",(function(){r.clientHeight&&e(r.scrollTop,"vertical")})),ht(i,"scroll",(function(){i.clientWidth&&e(i.scrollLeft,"horizontal")})),this.checkedZeroWidth=!1,o&&s<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};zr.prototype.update=function(t){var e=t.scrollWidth>t.clientWidth+1,n=t.scrollHeight>t.clientHeight+1,r=t.nativeBarWidth;if(n){this.vert.style.display="block",this.vert.style.bottom=e?r+"px":"0";var i=t.viewHeight-(e?r:0);this.vert.firstChild.style.height=Math.max(0,t.scrollHeight-t.clientHeight+i)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(e){this.horiz.style.display="block",this.horiz.style.right=n?r+"px":"0",this.horiz.style.left=t.barLeft+"px";var a=t.viewWidth-t.barLeft-(n?r:0);this.horiz.firstChild.style.width=Math.max(0,t.scrollWidth-t.clientWidth+a)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&t.clientHeight>0&&(0==r&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:n?r:0,bottom:e?r:0}},zr.prototype.setScrollLeft=function(t){this.horiz.scrollLeft!=t&&(this.horiz.scrollLeft=t),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},zr.prototype.setScrollTop=function(t){this.vert.scrollTop!=t&&(this.vert.scrollTop=t),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},zr.prototype.zeroWidthHack=function(){var t=y&&!f?"12px":"18px";this.horiz.style.height=this.vert.style.width=t,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new z,this.disableVert=new z},zr.prototype.enableZeroWidthBar=function(t,e,n){t.style.pointerEvents="auto",e.set(1e3,(function r(){var i=t.getBoundingClientRect();("vert"==n?document.elementFromPoint(i.right-1,(i.top+i.bottom)/2):document.elementFromPoint((i.right+i.left)/2,i.bottom-1))!=t?t.style.pointerEvents="none":e.set(1e3,r)}))},zr.prototype.clear=function(){var t=this.horiz.parentNode;t.removeChild(this.horiz),t.removeChild(this.vert)};var Ur=function(){};function jr(t,e){e||(e=Br(t));var n=t.display.barWidth,r=t.display.barHeight;Wr(t,e);for(var i=0;i<4&&n!=t.display.barWidth||r!=t.display.barHeight;i++)n!=t.display.barWidth&&t.options.lineWrapping&&Tr(t),Wr(t,Br(t)),n=t.display.barWidth,r=t.display.barHeight}function Wr(t,e){var n=t.display,r=n.scrollbars.update(e);n.sizer.style.paddingRight=(n.barWidth=r.right)+"px",n.sizer.style.paddingBottom=(n.barHeight=r.bottom)+"px",n.heightForcer.style.borderBottom=r.bottom+"px solid transparent",r.right&&r.bottom?(n.scrollbarFiller.style.display="block",n.scrollbarFiller.style.height=r.bottom+"px",n.scrollbarFiller.style.width=r.right+"px"):n.scrollbarFiller.style.display="",r.bottom&&t.options.coverGutterNextToScrollbar&&t.options.fixedGutter?(n.gutterFiller.style.display="block",n.gutterFiller.style.height=r.bottom+"px",n.gutterFiller.style.width=e.gutterWidth+"px"):n.gutterFiller.style.display=""}Ur.prototype.update=function(){return{bottom:0,right:0}},Ur.prototype.setScrollLeft=function(){},Ur.prototype.setScrollTop=function(){},Ur.prototype.clear=function(){};var Vr={native:zr,null:Ur};function Hr(t){t.display.scrollbars&&(t.display.scrollbars.clear(),t.display.scrollbars.addClass&&T(t.display.wrapper,t.display.scrollbars.addClass)),t.display.scrollbars=new Vr[t.options.scrollbarStyle]((function(e){t.display.wrapper.insertBefore(e,t.display.scrollbarFiller),ht(e,"mousedown",(function(){t.state.focused&&setTimeout((function(){return t.display.input.focus()}),0)})),e.setAttribute("cm-not-content","true")}),(function(e,n){"horizontal"==n?Fr(t,e):Dr(t,e)}),t),t.display.scrollbars.addClass&&k(t.display.wrapper,t.display.scrollbars.addClass)}var Gr=0;function qr(t){var e;t.curOp={cm:t,viewChanged:!1,startHeight:t.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Gr},e=t.curOp,on?on.ops.push(e):e.ownsGroup=on={ops:[e],delayedCallbacks:[]}}function Xr(t){var e=t.curOp;e&&function(t,e){var n=t.ownsGroup;if(n)try{!function(t){var e=t.delayedCallbacks,n=0;do{for(;n<e.length;n++)e[n].call(null);for(var r=0;r<t.ops.length;r++){var i=t.ops[r];if(i.cursorActivityHandlers)for(;i.cursorActivityCalled<i.cursorActivityHandlers.length;)i.cursorActivityHandlers[i.cursorActivityCalled++].call(null,i.cm)}}while(n<e.length)}(n)}finally{on=null,e(n)}}(e,(function(t){for(var e=0;e<t.ops.length;e++)t.ops[e].cm.curOp=null;!function(t){for(var e=t.ops,n=0;n<e.length;n++)$r(e[n]);for(var r=0;r<e.length;r++)Yr(e[r]);for(var i=0;i<e.length;i++)Kr(e[i]);for(var a=0;a<e.length;a++)Jr(e[a]);for(var o=0;o<e.length;o++)Zr(e[o])}(t)}))}function $r(t){var e=t.cm,n=e.display;!function(t){var e=t.display;!e.scrollbarsClipped&&e.scroller.offsetWidth&&(e.nativeBarWidth=e.scroller.offsetWidth-e.scroller.clientWidth,e.heightForcer.style.height=Tn(t)+"px",e.sizer.style.marginBottom=-e.nativeBarWidth+"px",e.sizer.style.borderRightWidth=Tn(t)+"px",e.scrollbarsClipped=!0)}(e),t.updateMaxLine&&Ge(e),t.mustUpdate=t.viewChanged||t.forceUpdate||null!=t.scrollTop||t.scrollToPos&&(t.scrollToPos.from.line<n.viewFrom||t.scrollToPos.to.line>=n.viewTo)||n.maxLineChanged&&e.options.lineWrapping,t.update=t.mustUpdate&&new ai(e,t.mustUpdate&&{top:t.scrollTop,ensure:t.scrollToPos},t.forceUpdate)}function Yr(t){t.updatedDisplay=t.mustUpdate&&oi(t.cm,t.update)}function Kr(t){var e=t.cm,n=e.display;t.updatedDisplay&&Tr(e),t.barMeasure=Br(e),n.maxLineChanged&&!e.options.lineWrapping&&(t.adjustWidthTo=In(e,n.maxLine,n.maxLine.text.length).left+3,e.display.sizerWidth=t.adjustWidthTo,t.barMeasure.scrollWidth=Math.max(n.scroller.clientWidth,n.sizer.offsetLeft+t.adjustWidthTo+Tn(e)+e.display.barWidth),t.maxScrollLeft=Math.max(0,n.sizer.offsetLeft+t.adjustWidthTo-Cn(e))),(t.updatedDisplay||t.selectionChanged)&&(t.preparedSelection=n.input.prepareSelection())}function Jr(t){var e=t.cm;null!=t.adjustWidthTo&&(e.display.sizer.style.minWidth=t.adjustWidthTo+"px",t.maxScrollLeft<e.doc.scrollLeft&&Fr(e,Math.min(e.display.scroller.scrollLeft,t.maxScrollLeft),!0),e.display.maxLineChanged=!1);var n=t.focus&&t.focus==O();t.preparedSelection&&e.display.input.showSelection(t.preparedSelection,n),(t.updatedDisplay||t.startHeight!=e.doc.height)&&jr(e,t.barMeasure),t.updatedDisplay&&li(e,t.barMeasure),t.selectionChanged&&wr(e),e.state.focused&&t.updateInput&&e.display.input.reset(t.typing),n&&_r(t.cm)}function Zr(t){var e=t.cm,n=e.display,r=e.doc;t.updatedDisplay&&si(e,t.update),null==n.wheelStartX||null==t.scrollTop&&null==t.scrollLeft&&!t.scrollToPos||(n.wheelStartX=n.wheelStartY=null),null!=t.scrollTop&&Pr(e,t.scrollTop,t.forceScroll),null!=t.scrollLeft&&Fr(e,t.scrollLeft,!0,!0),t.scrollToPos&&function(t,e){if(!mt(t,"scrollCursorIntoView")){var n=t.display,r=n.sizer.getBoundingClientRect(),i=null;if(e.top+r.top<0?i=!0:e.bottom+r.top>(window.innerHeight||document.documentElement.clientHeight)&&(i=!1),null!=i&&!d){var a=N("div","​",null,"position: absolute;\n                         top: "+(e.top-n.viewOffset-Sn(t.display))+"px;\n                         height: "+(e.bottom-e.top+Tn(t)+n.barHeight)+"px;\n                         left: "+e.left+"px; width: "+Math.max(2,e.right-e.left)+"px;");t.display.lineSpace.appendChild(a),a.scrollIntoView(i),t.display.lineSpace.removeChild(a)}}}(e,function(t,e,n,r){var i;null==r&&(r=0),t.options.lineWrapping||e!=n||(n="before"==(e=e.ch?te(e.line,"before"==e.sticky?e.ch-1:e.ch,"after"):e).sticky?te(e.line,e.ch+1,"before"):e);for(var a=0;a<5;a++){var o=!1,s=Xn(t,e),u=n&&n!=e?Xn(t,n):s,c=Nr(t,i={left:Math.min(s.left,u.left),top:Math.min(s.top,u.top)-r,right:Math.max(s.left,u.left),bottom:Math.max(s.bottom,u.bottom)+r}),l=t.doc.scrollTop,h=t.doc.scrollLeft;if(null!=c.scrollTop&&(Dr(t,c.scrollTop),Math.abs(t.doc.scrollTop-l)>1&&(o=!0)),null!=c.scrollLeft&&(Fr(t,c.scrollLeft),Math.abs(t.doc.scrollLeft-h)>1&&(o=!0)),!o)break}return i}(e,se(r,t.scrollToPos.from),se(r,t.scrollToPos.to),t.scrollToPos.margin));var i=t.maybeHiddenMarkers,a=t.maybeUnhiddenMarkers;if(i)for(var o=0;o<i.length;++o)i[o].lines.length||dt(i[o],"hide");if(a)for(var s=0;s<a.length;++s)a[s].lines.length&&dt(a[s],"unhide");n.wrapper.offsetHeight&&(r.scrollTop=e.display.scroller.scrollTop),t.changeObjs&&dt(e,"changes",e,t.changeObjs),t.update&&t.update.finish()}function Qr(t,e){if(t.curOp)return e();qr(t);try{return e()}finally{Xr(t)}}function ti(t,e){return function(){if(t.curOp)return e.apply(t,arguments);qr(t);try{return e.apply(t,arguments)}finally{Xr(t)}}}function ei(t){return function(){if(this.curOp)return t.apply(this,arguments);qr(this);try{return t.apply(this,arguments)}finally{Xr(this)}}}function ni(t){return function(){var e=this.cm;if(!e||e.curOp)return t.apply(this,arguments);qr(e);try{return t.apply(this,arguments)}finally{Xr(e)}}}function ri(t,e){t.doc.highlightFrontier<t.display.viewTo&&t.state.highlight.set(e,P(ii,t))}function ii(t){var e=t.doc;if(!(e.highlightFrontier>=t.display.viewTo)){var n=+new Date+t.options.workTime,r=fe(t,e.highlightFrontier),i=[];e.iter(r.line,Math.min(e.first+e.size,t.display.viewTo+500),(function(a){if(r.line>=t.display.viewFrom){var o=a.styles,s=a.text.length>t.options.maxHighlightLength?Wt(e.mode,r.state):null,u=he(t,a,r,!0);s&&(r.state=s),a.styles=u.styles;var c=a.styleClasses,l=u.classes;l?a.styleClasses=l:c&&(a.styleClasses=null);for(var h=!o||o.length!=a.styles.length||c!=l&&(!c||!l||c.bgClass!=l.bgClass||c.textClass!=l.textClass),p=0;!h&&p<o.length;++p)h=o[p]!=a.styles[p];h&&i.push(r.line),a.stateAfter=r.save(),r.nextLine()}else a.text.length<=t.options.maxHighlightLength&&de(t,a.text,r),a.stateAfter=r.line%5==0?r.save():null,r.nextLine();if(+new Date>n)return ri(t,t.options.workDelay),!0})),e.highlightFrontier=r.line,e.modeFrontier=Math.max(e.modeFrontier,r.line),i.length&&Qr(t,(function(){for(var e=0;e<i.length;e++)pr(t,i[e],"text")}))}}var ai=function(t,e,n){var r=t.display;this.viewport=e,this.visible=Ar(r,t.doc,e),this.editorIsHidden=!r.wrapper.offsetWidth,this.wrapperHeight=r.wrapper.clientHeight,this.wrapperWidth=r.wrapper.clientWidth,this.oldDisplayWidth=Cn(t),this.force=n,this.dims=ar(t),this.events=[]};function oi(t,e){var n=t.display,r=t.doc;if(e.editorIsHidden)return fr(t),!1;if(!e.force&&e.visible.from>=n.viewFrom&&e.visible.to<=n.viewTo&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo)&&n.renderedView==n.view&&0==mr(t))return!1;pi(t)&&(fr(t),e.dims=ar(t));var i=r.first+r.size,a=Math.max(e.visible.from-t.options.viewportMargin,r.first),o=Math.min(i,e.visible.to+t.options.viewportMargin);n.viewFrom<a&&a-n.viewFrom<20&&(a=Math.max(r.first,n.viewFrom)),n.viewTo>o&&n.viewTo-o<20&&(o=Math.min(i,n.viewTo)),_e&&(a=ze(t.doc,a),o=Ue(t.doc,o));var s=a!=n.viewFrom||o!=n.viewTo||n.lastWrapHeight!=e.wrapperHeight||n.lastWrapWidth!=e.wrapperWidth;!function(t,e,n){var r=t.display;0==r.view.length||e>=r.viewTo||n<=r.viewFrom?(r.view=an(t,e,n),r.viewFrom=e):(r.viewFrom>e?r.view=an(t,e,r.viewFrom).concat(r.view):r.viewFrom<e&&(r.view=r.view.slice(lr(t,e))),r.viewFrom=e,r.viewTo<n?r.view=r.view.concat(an(t,r.viewTo,n)):r.viewTo>n&&(r.view=r.view.slice(0,lr(t,n)))),r.viewTo=n}(t,a,o),n.viewOffset=Ve(qt(t.doc,n.viewFrom)),t.display.mover.style.top=n.viewOffset+"px";var c=mr(t);if(!s&&0==c&&!e.force&&n.renderedView==n.view&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo))return!1;var l=function(t){if(t.hasFocus())return null;var e=O();if(!e||!R(t.display.lineDiv,e))return null;var n={activeElt:e};if(window.getSelection){var r=window.getSelection();r.anchorNode&&r.extend&&R(t.display.lineDiv,r.anchorNode)&&(n.anchorNode=r.anchorNode,n.anchorOffset=r.anchorOffset,n.focusNode=r.focusNode,n.focusOffset=r.focusOffset)}return n}(t);return c>4&&(n.lineDiv.style.display="none"),function(t,e,n){var r=t.display,i=t.options.lineNumbers,a=r.lineDiv,o=a.firstChild;function s(e){var n=e.nextSibling;return u&&y&&t.display.currentWheelTarget==e?e.style.display="none":e.parentNode.removeChild(e),n}for(var c=r.view,l=r.viewFrom,h=0;h<c.length;h++){var p=c[h];if(p.hidden);else if(p.node&&p.node.parentNode==a){for(;o!=p.node;)o=s(o);var f=i&&null!=e&&e<=l&&p.lineNumber;p.changes&&(U(p.changes,"gutter")>-1&&(f=!1),ln(t,p,l,n)),f&&(C(p.lineNumber),p.lineNumber.appendChild(document.createTextNode(Qt(t.options,l)))),o=p.node.nextSibling}else{var d=gn(t,p,l,n);a.insertBefore(d,o)}l+=p.size}for(;o;)o=s(o)}(t,n.updateLineNumbers,e.dims),c>4&&(n.lineDiv.style.display=""),n.renderedView=n.view,function(t){if(t&&t.activeElt&&t.activeElt!=O()&&(t.activeElt.focus(),t.anchorNode&&R(document.body,t.anchorNode)&&R(document.body,t.focusNode))){var e=window.getSelection(),n=document.createRange();n.setEnd(t.anchorNode,t.anchorOffset),n.collapse(!1),e.removeAllRanges(),e.addRange(n),e.extend(t.focusNode,t.focusOffset)}}(l),C(n.cursorDiv),C(n.selectionDiv),n.gutters.style.height=n.sizer.style.minHeight=0,s&&(n.lastWrapHeight=e.wrapperHeight,n.lastWrapWidth=e.wrapperWidth,ri(t,400)),n.updateLineNumbers=null,!0}function si(t,e){for(var n=e.viewport,r=!0;;r=!1){if(r&&t.options.lineWrapping&&e.oldDisplayWidth!=Cn(t))r&&(e.visible=Ar(t.display,t.doc,n));else if(n&&null!=n.top&&(n={top:Math.min(t.doc.height+Mn(t.display)-An(t),n.top)}),e.visible=Ar(t.display,t.doc,n),e.visible.from>=t.display.viewFrom&&e.visible.to<=t.display.viewTo)break;if(!oi(t,e))break;Tr(t);var i=Br(t);vr(t),jr(t,i),li(t,i),e.force=!1}e.signal(t,"update",t),t.display.viewFrom==t.display.reportedViewFrom&&t.display.viewTo==t.display.reportedViewTo||(e.signal(t,"viewportChange",t,t.display.viewFrom,t.display.viewTo),t.display.reportedViewFrom=t.display.viewFrom,t.display.reportedViewTo=t.display.viewTo)}function ui(t,e){var n=new ai(t,e);if(oi(t,n)){Tr(t),si(t,n);var r=Br(t);vr(t),jr(t,r),li(t,r),n.finish()}}function ci(t){var e=t.gutters.offsetWidth;t.sizer.style.marginLeft=e+"px"}function li(t,e){t.display.sizer.style.minHeight=e.docHeight+"px",t.display.heightForcer.style.top=e.docHeight+"px",t.display.gutters.style.height=e.docHeight+t.display.barHeight+Tn(t)+"px"}function hi(t){var e=t.display,n=e.view;if(e.alignWidgets||e.gutters.firstChild&&t.options.fixedGutter){for(var r=or(e)-e.scroller.scrollLeft+t.doc.scrollLeft,i=e.gutters.offsetWidth,a=r+"px",o=0;o<n.length;o++)if(!n[o].hidden){t.options.fixedGutter&&(n[o].gutter&&(n[o].gutter.style.left=a),n[o].gutterBackground&&(n[o].gutterBackground.style.left=a));var s=n[o].alignable;if(s)for(var u=0;u<s.length;u++)s[u].style.left=a}t.options.fixedGutter&&(e.gutters.style.left=r+i+"px")}}function pi(t){if(!t.options.lineNumbers)return!1;var e=t.doc,n=Qt(t.options,e.first+e.size-1),r=t.display;if(n.length!=r.lineNumChars){var i=r.measure.appendChild(N("div",[N("div",n)],"CodeMirror-linenumber CodeMirror-gutter-elt")),a=i.firstChild.offsetWidth,o=i.offsetWidth-a;return r.lineGutter.style.width="",r.lineNumInnerWidth=Math.max(a,r.lineGutter.offsetWidth-o)+1,r.lineNumWidth=r.lineNumInnerWidth+o,r.lineNumChars=r.lineNumInnerWidth?n.length:-1,r.lineGutter.style.width=r.lineNumWidth+"px",ci(t.display),!0}return!1}function fi(t,e){for(var n=[],r=!1,i=0;i<t.length;i++){var a=t[i],o=null;if("string"!=typeof a&&(o=a.style,a=a.className),"CodeMirror-linenumbers"==a){if(!e)continue;r=!0}n.push({className:a,style:o})}return e&&!r&&n.push({className:"CodeMirror-linenumbers",style:null}),n}function di(t){var e=t.gutters,n=t.gutterSpecs;C(e),t.lineGutter=null;for(var r=0;r<n.length;++r){var i=n[r],a=i.className,o=i.style,s=e.appendChild(N("div",null,"CodeMirror-gutter "+a));o&&(s.style.cssText=o),"CodeMirror-linenumbers"==a&&(t.lineGutter=s,s.style.width=(t.lineNumWidth||1)+"px")}e.style.display=n.length?"":"none",ci(t)}function mi(t){di(t.display),hr(t),hi(t)}function vi(t,e,r,i){var a=this;this.input=r,a.scrollbarFiller=N("div",null,"CodeMirror-scrollbar-filler"),a.scrollbarFiller.setAttribute("cm-not-content","true"),a.gutterFiller=N("div",null,"CodeMirror-gutter-filler"),a.gutterFiller.setAttribute("cm-not-content","true"),a.lineDiv=I("div",null,"CodeMirror-code"),a.selectionDiv=N("div",null,null,"position: relative; z-index: 1"),a.cursorDiv=N("div",null,"CodeMirror-cursors"),a.measure=N("div",null,"CodeMirror-measure"),a.lineMeasure=N("div",null,"CodeMirror-measure"),a.lineSpace=I("div",[a.measure,a.lineMeasure,a.selectionDiv,a.cursorDiv,a.lineDiv],null,"position: relative; outline: none");var c=I("div",[a.lineSpace],"CodeMirror-lines");a.mover=N("div",[c],null,"position: relative"),a.sizer=N("div",[a.mover],"CodeMirror-sizer"),a.sizerWidth=null,a.heightForcer=N("div",null,null,"position: absolute; height: 30px; width: 1px;"),a.gutters=N("div",null,"CodeMirror-gutters"),a.lineGutter=null,a.scroller=N("div",[a.sizer,a.heightForcer,a.gutters],"CodeMirror-scroll"),a.scroller.setAttribute("tabIndex","-1"),a.wrapper=N("div",[a.scrollbarFiller,a.gutterFiller,a.scroller],"CodeMirror"),o&&s<8&&(a.gutters.style.zIndex=-1,a.scroller.style.paddingRight=0),u||n&&g||(a.scroller.draggable=!0),t&&(t.appendChild?t.appendChild(a.wrapper):t(a.wrapper)),a.viewFrom=a.viewTo=e.first,a.reportedViewFrom=a.reportedViewTo=e.first,a.view=[],a.renderedView=null,a.externalMeasured=null,a.viewOffset=0,a.lastWrapHeight=a.lastWrapWidth=0,a.updateLineNumbers=null,a.nativeBarWidth=a.barHeight=a.barWidth=0,a.scrollbarsClipped=!1,a.lineNumWidth=a.lineNumInnerWidth=a.lineNumChars=null,a.alignWidgets=!1,a.cachedCharWidth=a.cachedTextHeight=a.cachedPaddingH=null,a.maxLine=null,a.maxLineLength=0,a.maxLineChanged=!1,a.wheelDX=a.wheelDY=a.wheelStartX=a.wheelStartY=null,a.shift=!1,a.selForContextMenu=null,a.activeTouch=null,a.gutterSpecs=fi(i.gutters,i.lineNumbers),di(a),r.init(a)}ai.prototype.signal=function(t,e){gt(t,e)&&this.events.push(arguments)},ai.prototype.finish=function(){for(var t=0;t<this.events.length;t++)dt.apply(null,this.events[t])};var gi=0,yi=null;function xi(t){var e=t.wheelDeltaX,n=t.wheelDeltaY;return null==e&&t.detail&&t.axis==t.HORIZONTAL_AXIS&&(e=t.detail),null==n&&t.detail&&t.axis==t.VERTICAL_AXIS?n=t.detail:null==n&&(n=t.wheelDelta),{x:e,y:n}}function bi(t){var e=xi(t);return e.x*=yi,e.y*=yi,e}function wi(t,e){var r=xi(e),i=r.x,a=r.y,o=t.display,s=o.scroller,c=s.scrollWidth>s.clientWidth,l=s.scrollHeight>s.clientHeight;if(i&&c||a&&l){if(a&&y&&u)t:for(var p=e.target,f=o.view;p!=s;p=p.parentNode)for(var d=0;d<f.length;d++)if(f[d].node==p){t.display.currentWheelTarget=p;break t}if(i&&!n&&!h&&null!=yi)return a&&l&&Dr(t,Math.max(0,s.scrollTop+a*yi)),Fr(t,Math.max(0,s.scrollLeft+i*yi)),(!a||a&&l)&&xt(e),void(o.wheelStartX=null);if(a&&null!=yi){var m=a*yi,v=t.doc.scrollTop,g=v+o.wrapper.clientHeight;m<0?v=Math.max(0,v+m-50):g=Math.min(t.doc.height,g+m+50),ui(t,{top:v,bottom:g})}gi<20&&(null==o.wheelStartX?(o.wheelStartX=s.scrollLeft,o.wheelStartY=s.scrollTop,o.wheelDX=i,o.wheelDY=a,setTimeout((function(){if(null!=o.wheelStartX){var t=s.scrollLeft-o.wheelStartX,e=s.scrollTop-o.wheelStartY,n=e&&o.wheelDY&&e/o.wheelDY||t&&o.wheelDX&&t/o.wheelDX;o.wheelStartX=o.wheelStartY=null,n&&(yi=(yi*gi+n)/(gi+1),++gi)}}),200)):(o.wheelDX+=i,o.wheelDY+=a))}}o?yi=-.53:n?yi=15:l?yi=-.7:p&&(yi=-1/3);var _i=function(t,e){this.ranges=t,this.primIndex=e};_i.prototype.primary=function(){return this.ranges[this.primIndex]},_i.prototype.equals=function(t){if(t==this)return!0;if(t.primIndex!=this.primIndex||t.ranges.length!=this.ranges.length)return!1;for(var e=0;e<this.ranges.length;e++){var n=this.ranges[e],r=t.ranges[e];if(!ne(n.anchor,r.anchor)||!ne(n.head,r.head))return!1}return!0},_i.prototype.deepCopy=function(){for(var t=[],e=0;e<this.ranges.length;e++)t[e]=new Si(re(this.ranges[e].anchor),re(this.ranges[e].head));return new _i(t,this.primIndex)},_i.prototype.somethingSelected=function(){for(var t=0;t<this.ranges.length;t++)if(!this.ranges[t].empty())return!0;return!1},_i.prototype.contains=function(t,e){e||(e=t);for(var n=0;n<this.ranges.length;n++){var r=this.ranges[n];if(ee(e,r.from())>=0&&ee(t,r.to())<=0)return n}return-1};var Si=function(t,e){this.anchor=t,this.head=e};function Mi(t,e,n){var r=t&&t.options.selectionsMayTouch,i=e[n];e.sort((function(t,e){return ee(t.from(),e.from())})),n=U(e,i);for(var a=1;a<e.length;a++){var o=e[a],s=e[a-1],u=ee(s.to(),o.from());if(r&&!o.empty()?u>0:u>=0){var c=ae(s.from(),o.from()),l=ie(s.to(),o.to()),h=s.empty()?o.from()==o.head:s.from()==s.head;a<=n&&--n,e.splice(--a,2,new Si(h?l:c,h?c:l))}}return new _i(e,n)}function Ei(t,e){return new _i([new Si(t,e||t)],0)}function Ti(t){return t.text?te(t.from.line+t.text.length-1,$(t.text).length+(1==t.text.length?t.from.ch:0)):t.to}function Ci(t,e){if(ee(t,e.from)<0)return t;if(ee(t,e.to)<=0)return Ti(e);var n=t.line+e.text.length-(e.to.line-e.from.line)-1,r=t.ch;return t.line==e.to.line&&(r+=Ti(e).ch-e.to.ch),te(n,r)}function Ai(t,e){for(var n=[],r=0;r<t.sel.ranges.length;r++){var i=t.sel.ranges[r];n.push(new Si(Ci(i.anchor,e),Ci(i.head,e)))}return Mi(t.cm,n,t.sel.primIndex)}function Ni(t,e,n){return t.line==e.line?te(n.line,t.ch-e.ch+n.ch):te(n.line+(t.line-e.line),t.ch)}function Ii(t){t.doc.mode=zt(t.options,t.doc.modeOption),Ri(t)}function Ri(t){t.doc.iter((function(t){t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null)})),t.doc.modeFrontier=t.doc.highlightFrontier=t.doc.first,ri(t,100),t.state.modeGen++,t.curOp&&hr(t)}function Oi(t,e){return 0==e.from.ch&&0==e.to.ch&&""==$(e.text)&&(!t.cm||t.cm.options.wholeLineUpdateBefore)}function ki(t,e,n,r){function i(t){return n?n[t]:null}function a(t,n,i){!function(t,e,n,r){t.text=e,t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null),null!=t.order&&(t.order=null),Ae(t),Ne(t,n);var i=r?r(t):1;i!=t.height&&Yt(t,i)}(t,n,i,r),un(t,"change",t,e)}function o(t,e){for(var n=[],a=t;a<e;++a)n.push(new qe(c[a],i(a),r));return n}var s=e.from,u=e.to,c=e.text,l=qt(t,s.line),h=qt(t,u.line),p=$(c),f=i(c.length-1),d=u.line-s.line;if(e.full)t.insert(0,o(0,c.length)),t.remove(c.length,t.size-c.length);else if(Oi(t,e)){var m=o(0,c.length-1);a(h,h.text,f),d&&t.remove(s.line,d),m.length&&t.insert(s.line,m)}else if(l==h)if(1==c.length)a(l,l.text.slice(0,s.ch)+p+l.text.slice(u.ch),f);else{var v=o(1,c.length-1);v.push(new qe(p+l.text.slice(u.ch),f,r)),a(l,l.text.slice(0,s.ch)+c[0],i(0)),t.insert(s.line+1,v)}else if(1==c.length)a(l,l.text.slice(0,s.ch)+c[0]+h.text.slice(u.ch),i(0)),t.remove(s.line+1,d);else{a(l,l.text.slice(0,s.ch)+c[0],i(0)),a(h,p+h.text.slice(u.ch),f);var g=o(1,c.length-1);d>1&&t.remove(s.line+1,d-1),t.insert(s.line+1,g)}un(t,"change",t,e)}function Li(t,e,n){!function t(r,i,a){if(r.linked)for(var o=0;o<r.linked.length;++o){var s=r.linked[o];if(s.doc!=i){var u=a&&s.sharedHist;n&&!u||(e(s.doc,u),t(s.doc,r,u))}}}(t,null,!0)}function Di(t,e){if(e.cm)throw new Error("This document is already in use.");t.doc=e,e.cm=t,ur(t),Ii(t),Pi(t),t.options.lineWrapping||Ge(t),t.options.mode=e.modeOption,hr(t)}function Pi(t){("rtl"==t.doc.direction?k:T)(t.display.lineDiv,"CodeMirror-rtl")}function Fi(t){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=t||1}function Bi(t,e){var n={from:re(e.from),to:Ti(e),text:Xt(t,e.from,e.to)};return Vi(t,n,e.from.line,e.to.line+1),Li(t,(function(t){return Vi(t,n,e.from.line,e.to.line+1)}),!0),n}function zi(t){for(;t.length&&$(t).ranges;)t.pop()}function Ui(t,e,n,r){var i=t.history;i.undone.length=0;var a,o,s=+new Date;if((i.lastOp==r||i.lastOrigin==e.origin&&e.origin&&("+"==e.origin.charAt(0)&&i.lastModTime>s-(t.cm?t.cm.options.historyEventDelay:500)||"*"==e.origin.charAt(0)))&&(a=function(t,e){return e?(zi(t.done),$(t.done)):t.done.length&&!$(t.done).ranges?$(t.done):t.done.length>1&&!t.done[t.done.length-2].ranges?(t.done.pop(),$(t.done)):void 0}(i,i.lastOp==r)))o=$(a.changes),0==ee(e.from,e.to)&&0==ee(e.from,o.to)?o.to=Ti(e):a.changes.push(Bi(t,e));else{var u=$(i.done);for(u&&u.ranges||Wi(t.sel,i.done),a={changes:[Bi(t,e)],generation:i.generation},i.done.push(a);i.done.length>i.undoDepth;)i.done.shift(),i.done[0].ranges||i.done.shift()}i.done.push(n),i.generation=++i.maxGeneration,i.lastModTime=i.lastSelTime=s,i.lastOp=i.lastSelOp=r,i.lastOrigin=i.lastSelOrigin=e.origin,o||dt(t,"historyAdded")}function ji(t,e,n,r){var i=t.history,a=r&&r.origin;n==i.lastSelOp||a&&i.lastSelOrigin==a&&(i.lastModTime==i.lastSelTime&&i.lastOrigin==a||function(t,e,n,r){var i=e.charAt(0);return"*"==i||"+"==i&&n.ranges.length==r.ranges.length&&n.somethingSelected()==r.somethingSelected()&&new Date-t.history.lastSelTime<=(t.cm?t.cm.options.historyEventDelay:500)}(t,a,$(i.done),e))?i.done[i.done.length-1]=e:Wi(e,i.done),i.lastSelTime=+new Date,i.lastSelOrigin=a,i.lastSelOp=n,r&&!1!==r.clearRedo&&zi(i.undone)}function Wi(t,e){var n=$(e);n&&n.ranges&&n.equals(t)||e.push(t)}function Vi(t,e,n,r){var i=e["spans_"+t.id],a=0;t.iter(Math.max(t.first,n),Math.min(t.first+t.size,r),(function(n){n.markedSpans&&((i||(i=e["spans_"+t.id]={}))[a]=n.markedSpans),++a}))}function Hi(t){if(!t)return null;for(var e,n=0;n<t.length;++n)t[n].marker.explicitlyCleared?e||(e=t.slice(0,n)):e&&e.push(t[n]);return e?e.length?e:null:t}function Gi(t,e){var n=function(t,e){var n=e["spans_"+t.id];if(!n)return null;for(var r=[],i=0;i<e.text.length;++i)r.push(Hi(n[i]));return r}(t,e),r=Te(t,e);if(!n)return r;if(!r)return n;for(var i=0;i<n.length;++i){var a=n[i],o=r[i];if(a&&o)t:for(var s=0;s<o.length;++s){for(var u=o[s],c=0;c<a.length;++c)if(a[c].marker==u.marker)continue t;a.push(u)}else o&&(n[i]=o)}return n}function qi(t,e,n){for(var r=[],i=0;i<t.length;++i){var a=t[i];if(a.ranges)r.push(n?_i.prototype.deepCopy.call(a):a);else{var o=a.changes,s=[];r.push({changes:s});for(var u=0;u<o.length;++u){var c=o[u],l=void 0;if(s.push({from:c.from,to:c.to,text:c.text}),e)for(var h in c)(l=h.match(/^spans_(\d+)$/))&&U(e,Number(l[1]))>-1&&($(s)[h]=c[h],delete c[h])}}}return r}function Xi(t,e,n,r){if(r){var i=t.anchor;if(n){var a=ee(e,i)<0;a!=ee(n,i)<0?(i=e,e=n):a!=ee(e,n)<0&&(e=n)}return new Si(i,e)}return new Si(n||e,e)}function $i(t,e,n,r,i){null==i&&(i=t.cm&&(t.cm.display.shift||t.extend)),Qi(t,new _i([Xi(t.sel.primary(),e,n,i)],0),r)}function Yi(t,e,n){for(var r=[],i=t.cm&&(t.cm.display.shift||t.extend),a=0;a<t.sel.ranges.length;a++)r[a]=Xi(t.sel.ranges[a],e[a],null,i);Qi(t,Mi(t.cm,r,t.sel.primIndex),n)}function Ki(t,e,n,r){var i=t.sel.ranges.slice(0);i[e]=n,Qi(t,Mi(t.cm,i,t.sel.primIndex),r)}function Ji(t,e,n,r){Qi(t,Ei(e,n),r)}function Zi(t,e,n){var r=t.history.done,i=$(r);i&&i.ranges?(r[r.length-1]=e,ta(t,e,n)):Qi(t,e,n)}function Qi(t,e,n){ta(t,e,n),ji(t,t.sel,t.cm?t.cm.curOp.id:NaN,n)}function ta(t,e,n){(gt(t,"beforeSelectionChange")||t.cm&&gt(t.cm,"beforeSelectionChange"))&&(e=function(t,e,n){var r={ranges:e.ranges,update:function(e){this.ranges=[];for(var n=0;n<e.length;n++)this.ranges[n]=new Si(se(t,e[n].anchor),se(t,e[n].head))},origin:n&&n.origin};return dt(t,"beforeSelectionChange",t,r),t.cm&&dt(t.cm,"beforeSelectionChange",t.cm,r),r.ranges!=e.ranges?Mi(t.cm,r.ranges,r.ranges.length-1):e}(t,e,n));var r=n&&n.bias||(ee(e.primary().head,t.sel.primary().head)<0?-1:1);ea(t,ra(t,e,r,!0)),n&&!1===n.scroll||!t.cm||Rr(t.cm)}function ea(t,e){e.equals(t.sel)||(t.sel=e,t.cm&&(t.cm.curOp.updateInput=1,t.cm.curOp.selectionChanged=!0,vt(t.cm)),un(t,"cursorActivity",t))}function na(t){ea(t,ra(t,t.sel,null,!1))}function ra(t,e,n,r){for(var i,a=0;a<e.ranges.length;a++){var o=e.ranges[a],s=e.ranges.length==t.sel.ranges.length&&t.sel.ranges[a],u=aa(t,o.anchor,s&&s.anchor,n,r),c=aa(t,o.head,s&&s.head,n,r);(i||u!=o.anchor||c!=o.head)&&(i||(i=e.ranges.slice(0,a)),i[a]=new Si(u,c))}return i?Mi(t.cm,i,e.primIndex):e}function ia(t,e,n,r,i){var a=qt(t,e.line);if(a.markedSpans)for(var o=0;o<a.markedSpans.length;++o){var s=a.markedSpans[o],u=s.marker,c="selectLeft"in u?!u.selectLeft:u.inclusiveLeft,l="selectRight"in u?!u.selectRight:u.inclusiveRight;if((null==s.from||(c?s.from<=e.ch:s.from<e.ch))&&(null==s.to||(l?s.to>=e.ch:s.to>e.ch))){if(i&&(dt(u,"beforeCursorEnter"),u.explicitlyCleared)){if(a.markedSpans){--o;continue}break}if(!u.atomic)continue;if(n){var h=u.find(r<0?1:-1),p=void 0;if((r<0?l:c)&&(h=oa(t,h,-r,h&&h.line==e.line?a:null)),h&&h.line==e.line&&(p=ee(h,n))&&(r<0?p<0:p>0))return ia(t,h,e,r,i)}var f=u.find(r<0?-1:1);return(r<0?c:l)&&(f=oa(t,f,r,f.line==e.line?a:null)),f?ia(t,f,e,r,i):null}}return e}function aa(t,e,n,r,i){var a=r||1,o=ia(t,e,n,a,i)||!i&&ia(t,e,n,a,!0)||ia(t,e,n,-a,i)||!i&&ia(t,e,n,-a,!0);return o||(t.cantEdit=!0,te(t.first,0))}function oa(t,e,n,r){return n<0&&0==e.ch?e.line>t.first?se(t,te(e.line-1)):null:n>0&&e.ch==(r||qt(t,e.line)).text.length?e.line<t.first+t.size-1?te(e.line+1,0):null:new te(e.line,e.ch+n)}function sa(t){t.setSelection(te(t.firstLine(),0),te(t.lastLine()),W)}function ua(t,e,n){var r={canceled:!1,from:e.from,to:e.to,text:e.text,origin:e.origin,cancel:function(){return r.canceled=!0}};return n&&(r.update=function(e,n,i,a){e&&(r.from=se(t,e)),n&&(r.to=se(t,n)),i&&(r.text=i),void 0!==a&&(r.origin=a)}),dt(t,"beforeChange",t,r),t.cm&&dt(t.cm,"beforeChange",t.cm,r),r.canceled?(t.cm&&(t.cm.curOp.updateInput=2),null):{from:r.from,to:r.to,text:r.text,origin:r.origin}}function ca(t,e,n){if(t.cm){if(!t.cm.curOp)return ti(t.cm,ca)(t,e,n);if(t.cm.state.suppressEdits)return}if(!(gt(t,"beforeChange")||t.cm&&gt(t.cm,"beforeChange"))||(e=ua(t,e,!0))){var r=we&&!n&&function(t,e,n){var r=null;if(t.iter(e.line,n.line+1,(function(t){if(t.markedSpans)for(var e=0;e<t.markedSpans.length;++e){var n=t.markedSpans[e].marker;!n.readOnly||r&&-1!=U(r,n)||(r||(r=[])).push(n)}})),!r)return null;for(var i=[{from:e,to:n}],a=0;a<r.length;++a)for(var o=r[a],s=o.find(0),u=0;u<i.length;++u){var c=i[u];if(!(ee(c.to,s.from)<0||ee(c.from,s.to)>0)){var l=[u,1],h=ee(c.from,s.from),p=ee(c.to,s.to);(h<0||!o.inclusiveLeft&&!h)&&l.push({from:c.from,to:s.from}),(p>0||!o.inclusiveRight&&!p)&&l.push({from:s.to,to:c.to}),i.splice.apply(i,l),u+=l.length-3}}return i}(t,e.from,e.to);if(r)for(var i=r.length-1;i>=0;--i)la(t,{from:r[i].from,to:r[i].to,text:i?[""]:e.text,origin:e.origin});else la(t,e)}}function la(t,e){if(1!=e.text.length||""!=e.text[0]||0!=ee(e.from,e.to)){var n=Ai(t,e);Ui(t,e,n,t.cm?t.cm.curOp.id:NaN),fa(t,e,n,Te(t,e));var r=[];Li(t,(function(t,n){n||-1!=U(r,t.history)||(ga(t.history,e),r.push(t.history)),fa(t,e,null,Te(t,e))}))}}function ha(t,e,n){var r=t.cm&&t.cm.state.suppressEdits;if(!r||n){for(var i,a=t.history,o=t.sel,s="undo"==e?a.done:a.undone,u="undo"==e?a.undone:a.done,c=0;c<s.length&&(i=s[c],n?!i.ranges||i.equals(t.sel):i.ranges);c++);if(c!=s.length){for(a.lastOrigin=a.lastSelOrigin=null;;){if(!(i=s.pop()).ranges){if(r)return void s.push(i);break}if(Wi(i,u),n&&!i.equals(t.sel))return void Qi(t,i,{clearRedo:!1});o=i}var l=[];Wi(o,u),u.push({changes:l,generation:a.generation}),a.generation=i.generation||++a.maxGeneration;for(var h=gt(t,"beforeChange")||t.cm&&gt(t.cm,"beforeChange"),p=function(n){var r=i.changes[n];if(r.origin=e,h&&!ua(t,r,!1))return s.length=0,{};l.push(Bi(t,r));var a=n?Ai(t,r):$(s);fa(t,r,a,Gi(t,r)),!n&&t.cm&&t.cm.scrollIntoView({from:r.from,to:Ti(r)});var o=[];Li(t,(function(t,e){e||-1!=U(o,t.history)||(ga(t.history,r),o.push(t.history)),fa(t,r,null,Gi(t,r))}))},f=i.changes.length-1;f>=0;--f){var d=p(f);if(d)return d.v}}}}function pa(t,e){if(0!=e&&(t.first+=e,t.sel=new _i(Y(t.sel.ranges,(function(t){return new Si(te(t.anchor.line+e,t.anchor.ch),te(t.head.line+e,t.head.ch))})),t.sel.primIndex),t.cm)){hr(t.cm,t.first,t.first-e,e);for(var n=t.cm.display,r=n.viewFrom;r<n.viewTo;r++)pr(t.cm,r,"gutter")}}function fa(t,e,n,r){if(t.cm&&!t.cm.curOp)return ti(t.cm,fa)(t,e,n,r);if(e.to.line<t.first)pa(t,e.text.length-1-(e.to.line-e.from.line));else if(!(e.from.line>t.lastLine())){if(e.from.line<t.first){var i=e.text.length-1-(t.first-e.from.line);pa(t,i),e={from:te(t.first,0),to:te(e.to.line+i,e.to.ch),text:[$(e.text)],origin:e.origin}}var a=t.lastLine();e.to.line>a&&(e={from:e.from,to:te(a,qt(t,a).text.length),text:[e.text[0]],origin:e.origin}),e.removed=Xt(t,e.from,e.to),n||(n=Ai(t,e)),t.cm?function(t,e,n){var r=t.doc,i=t.display,a=e.from,o=e.to,s=!1,u=a.line;t.options.lineWrapping||(u=Kt(Be(qt(r,a.line))),r.iter(u,o.line+1,(function(t){if(t==i.maxLine)return s=!0,!0}))),r.sel.contains(e.from,e.to)>-1&&vt(t),ki(r,e,n,sr(t)),t.options.lineWrapping||(r.iter(u,a.line+e.text.length,(function(t){var e=He(t);e>i.maxLineLength&&(i.maxLine=t,i.maxLineLength=e,i.maxLineChanged=!0,s=!1)})),s&&(t.curOp.updateMaxLine=!0)),function(t,e){if(t.modeFrontier=Math.min(t.modeFrontier,e),!(t.highlightFrontier<e-10)){for(var n=t.first,r=e-1;r>n;r--){var i=qt(t,r).stateAfter;if(i&&(!(i instanceof ce)||r+i.lookAhead<e)){n=r+1;break}}t.highlightFrontier=Math.min(t.highlightFrontier,n)}}(r,a.line),ri(t,400);var c=e.text.length-(o.line-a.line)-1;e.full?hr(t):a.line!=o.line||1!=e.text.length||Oi(t.doc,e)?hr(t,a.line,o.line+1,c):pr(t,a.line,"text");var l=gt(t,"changes"),h=gt(t,"change");if(h||l){var p={from:a,to:o,text:e.text,removed:e.removed,origin:e.origin};h&&un(t,"change",t,p),l&&(t.curOp.changeObjs||(t.curOp.changeObjs=[])).push(p)}t.display.selForContextMenu=null}(t.cm,e,r):ki(t,e,r),ta(t,n,W),t.cantEdit&&aa(t,te(t.firstLine(),0))&&(t.cantEdit=!1)}}function da(t,e,n,r,i){var a;r||(r=n),ee(r,n)<0&&(n=(a=[r,n])[0],r=a[1]),"string"==typeof e&&(e=t.splitLines(e)),ca(t,{from:n,to:r,text:e,origin:i})}function ma(t,e,n,r){n<t.line?t.line+=r:e<t.line&&(t.line=e,t.ch=0)}function va(t,e,n,r){for(var i=0;i<t.length;++i){var a=t[i],o=!0;if(a.ranges){a.copied||((a=t[i]=a.deepCopy()).copied=!0);for(var s=0;s<a.ranges.length;s++)ma(a.ranges[s].anchor,e,n,r),ma(a.ranges[s].head,e,n,r)}else{for(var u=0;u<a.changes.length;++u){var c=a.changes[u];if(n<c.from.line)c.from=te(c.from.line+r,c.from.ch),c.to=te(c.to.line+r,c.to.ch);else if(e<=c.to.line){o=!1;break}}o||(t.splice(0,i+1),i=0)}}}function ga(t,e){var n=e.from.line,r=e.to.line,i=e.text.length-(r-n)-1;va(t.done,n,r,i),va(t.undone,n,r,i)}function ya(t,e,n,r){var i=e,a=e;return"number"==typeof e?a=qt(t,oe(t,e)):i=Kt(e),null==i?null:(r(a,i)&&t.cm&&pr(t.cm,i,n),a)}function xa(t){this.lines=t,this.parent=null;for(var e=0,n=0;n<t.length;++n)t[n].parent=this,e+=t[n].height;this.height=e}function ba(t){this.children=t;for(var e=0,n=0,r=0;r<t.length;++r){var i=t[r];e+=i.chunkSize(),n+=i.height,i.parent=this}this.size=e,this.height=n,this.parent=null}Si.prototype.from=function(){return ae(this.anchor,this.head)},Si.prototype.to=function(){return ie(this.anchor,this.head)},Si.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch},xa.prototype={chunkSize:function(){return this.lines.length},removeInner:function(t,e){for(var n=t,r=t+e;n<r;++n){var i=this.lines[n];this.height-=i.height,Xe(i),un(i,"delete")}this.lines.splice(t,e)},collapse:function(t){t.push.apply(t,this.lines)},insertInner:function(t,e,n){this.height+=n,this.lines=this.lines.slice(0,t).concat(e).concat(this.lines.slice(t));for(var r=0;r<e.length;++r)e[r].parent=this},iterN:function(t,e,n){for(var r=t+e;t<r;++t)if(n(this.lines[t]))return!0}},ba.prototype={chunkSize:function(){return this.size},removeInner:function(t,e){this.size-=e;for(var n=0;n<this.children.length;++n){var r=this.children[n],i=r.chunkSize();if(t<i){var a=Math.min(e,i-t),o=r.height;if(r.removeInner(t,a),this.height-=o-r.height,i==a&&(this.children.splice(n--,1),r.parent=null),0==(e-=a))break;t=0}else t-=i}if(this.size-e<25&&(this.children.length>1||!(this.children[0]instanceof xa))){var s=[];this.collapse(s),this.children=[new xa(s)],this.children[0].parent=this}},collapse:function(t){for(var e=0;e<this.children.length;++e)this.children[e].collapse(t)},insertInner:function(t,e,n){this.size+=e.length,this.height+=n;for(var r=0;r<this.children.length;++r){var i=this.children[r],a=i.chunkSize();if(t<=a){if(i.insertInner(t,e,n),i.lines&&i.lines.length>50){for(var o=i.lines.length%25+25,s=o;s<i.lines.length;){var u=new xa(i.lines.slice(s,s+=25));i.height-=u.height,this.children.splice(++r,0,u),u.parent=this}i.lines=i.lines.slice(0,o),this.maybeSpill()}break}t-=a}},maybeSpill:function(){if(!(this.children.length<=10)){var t=this;do{var e=new ba(t.children.splice(t.children.length-5,5));if(t.parent){t.size-=e.size,t.height-=e.height;var n=U(t.parent.children,t);t.parent.children.splice(n+1,0,e)}else{var r=new ba(t.children);r.parent=t,t.children=[r,e],t=r}e.parent=t.parent}while(t.children.length>10);t.parent.maybeSpill()}},iterN:function(t,e,n){for(var r=0;r<this.children.length;++r){var i=this.children[r],a=i.chunkSize();if(t<a){var o=Math.min(e,a-t);if(i.iterN(t,o,n))return!0;if(0==(e-=o))break;t=0}else t-=a}}};var wa=function(t,e,n){if(n)for(var r in n)n.hasOwnProperty(r)&&(this[r]=n[r]);this.doc=t,this.node=e};function _a(t,e,n){Ve(e)<(t.curOp&&t.curOp.scrollTop||t.doc.scrollTop)&&Ir(t,n)}wa.prototype.clear=function(){var t=this.doc.cm,e=this.line.widgets,n=this.line,r=Kt(n);if(null!=r&&e){for(var i=0;i<e.length;++i)e[i]==this&&e.splice(i--,1);e.length||(n.widgets=null);var a=wn(this);Yt(n,Math.max(0,n.height-a)),t&&(Qr(t,(function(){_a(t,n,-a),pr(t,r,"widget")})),un(t,"lineWidgetCleared",t,this,r))}},wa.prototype.changed=function(){var t=this,e=this.height,n=this.doc.cm,r=this.line;this.height=null;var i=wn(this)-e;i&&(je(this.doc,r)||Yt(r,r.height+i),n&&Qr(n,(function(){n.curOp.forceUpdate=!0,_a(n,r,i),un(n,"lineWidgetChanged",n,t,Kt(r))})))},yt(wa);var Sa=0,Ma=function(t,e){this.lines=[],this.type=e,this.doc=t,this.id=++Sa};function Ea(t,e,n,r,i){if(r&&r.shared)return function(t,e,n,r,i){(r=F(r)).shared=!1;var a=[Ea(t,e,n,r,i)],o=a[0],s=r.widgetNode;return Li(t,(function(t){s&&(r.widgetNode=s.cloneNode(!0)),a.push(Ea(t,se(t,e),se(t,n),r,i));for(var u=0;u<t.linked.length;++u)if(t.linked[u].isParent)return;o=$(a)})),new Ta(a,o)}(t,e,n,r,i);if(t.cm&&!t.cm.curOp)return ti(t.cm,Ea)(t,e,n,r,i);var a=new Ma(t,i),o=ee(e,n);if(r&&F(r,a,!1),o>0||0==o&&!1!==a.clearWhenEmpty)return a;if(a.replacedWith&&(a.collapsed=!0,a.widgetNode=I("span",[a.replacedWith],"CodeMirror-widget"),r.handleMouseEvents||a.widgetNode.setAttribute("cm-ignore-events","true"),r.insertLeft&&(a.widgetNode.insertLeft=!0)),a.collapsed){if(Fe(t,e.line,e,n,a)||e.line!=n.line&&Fe(t,n.line,e,n,a))throw new Error("Inserting collapsed marker partially overlapping an existing one");_e=!0}a.addToHistory&&Ui(t,{from:e,to:n,origin:"markText"},t.sel,NaN);var s,u=e.line,c=t.cm;if(t.iter(u,n.line+1,(function(t){c&&a.collapsed&&!c.options.lineWrapping&&Be(t)==c.display.maxLine&&(s=!0),a.collapsed&&u!=e.line&&Yt(t,0),function(t,e){t.markedSpans=t.markedSpans?t.markedSpans.concat([e]):[e],e.marker.attachLine(t)}(t,new Se(a,u==e.line?e.ch:null,u==n.line?n.ch:null)),++u})),a.collapsed&&t.iter(e.line,n.line+1,(function(e){je(t,e)&&Yt(e,0)})),a.clearOnEnter&&ht(a,"beforeCursorEnter",(function(){return a.clear()})),a.readOnly&&(we=!0,(t.history.done.length||t.history.undone.length)&&t.clearHistory()),a.collapsed&&(a.id=++Sa,a.atomic=!0),c){if(s&&(c.curOp.updateMaxLine=!0),a.collapsed)hr(c,e.line,n.line+1);else if(a.className||a.startStyle||a.endStyle||a.css||a.attributes||a.title)for(var l=e.line;l<=n.line;l++)pr(c,l,"text");a.atomic&&na(c.doc),un(c,"markerAdded",c,a)}return a}Ma.prototype.clear=function(){if(!this.explicitlyCleared){var t=this.doc.cm,e=t&&!t.curOp;if(e&&qr(t),gt(this,"clear")){var n=this.find();n&&un(this,"clear",n.from,n.to)}for(var r=null,i=null,a=0;a<this.lines.length;++a){var o=this.lines[a],s=Me(o.markedSpans,this);t&&!this.collapsed?pr(t,Kt(o),"text"):t&&(null!=s.to&&(i=Kt(o)),null!=s.from&&(r=Kt(o))),o.markedSpans=Ee(o.markedSpans,s),null==s.from&&this.collapsed&&!je(this.doc,o)&&t&&Yt(o,rr(t.display))}if(t&&this.collapsed&&!t.options.lineWrapping)for(var u=0;u<this.lines.length;++u){var c=Be(this.lines[u]),l=He(c);l>t.display.maxLineLength&&(t.display.maxLine=c,t.display.maxLineLength=l,t.display.maxLineChanged=!0)}null!=r&&t&&this.collapsed&&hr(t,r,i+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,t&&na(t.doc)),t&&un(t,"markerCleared",t,this,r,i),e&&Xr(t),this.parent&&this.parent.clear()}},Ma.prototype.find=function(t,e){var n,r;null==t&&"bookmark"==this.type&&(t=1);for(var i=0;i<this.lines.length;++i){var a=this.lines[i],o=Me(a.markedSpans,this);if(null!=o.from&&(n=te(e?a:Kt(a),o.from),-1==t))return n;if(null!=o.to&&(r=te(e?a:Kt(a),o.to),1==t))return r}return n&&{from:n,to:r}},Ma.prototype.changed=function(){var t=this,e=this.find(-1,!0),n=this,r=this.doc.cm;e&&r&&Qr(r,(function(){var i=e.line,a=Kt(e.line),o=Rn(r,a);if(o&&(Bn(o),r.curOp.selectionChanged=r.curOp.forceUpdate=!0),r.curOp.updateMaxLine=!0,!je(n.doc,i)&&null!=n.height){var s=n.height;n.height=null;var u=wn(n)-s;u&&Yt(i,i.height+u)}un(r,"markerChanged",r,t)}))},Ma.prototype.attachLine=function(t){if(!this.lines.length&&this.doc.cm){var e=this.doc.cm.curOp;e.maybeHiddenMarkers&&-1!=U(e.maybeHiddenMarkers,this)||(e.maybeUnhiddenMarkers||(e.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(t)},Ma.prototype.detachLine=function(t){if(this.lines.splice(U(this.lines,t),1),!this.lines.length&&this.doc.cm){var e=this.doc.cm.curOp;(e.maybeHiddenMarkers||(e.maybeHiddenMarkers=[])).push(this)}},yt(Ma);var Ta=function(t,e){this.markers=t,this.primary=e;for(var n=0;n<t.length;++n)t[n].parent=this};function Ca(t){return t.findMarks(te(t.first,0),t.clipPos(te(t.lastLine())),(function(t){return t.parent}))}function Aa(t){for(var e=function(e){var n=t[e],r=[n.primary.doc];Li(n.primary.doc,(function(t){return r.push(t)}));for(var i=0;i<n.markers.length;i++){var a=n.markers[i];-1==U(r,a.doc)&&(a.parent=null,n.markers.splice(i--,1))}},n=0;n<t.length;n++)e(n)}Ta.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var t=0;t<this.markers.length;++t)this.markers[t].clear();un(this,"clear")}},Ta.prototype.find=function(t,e){return this.primary.find(t,e)},yt(Ta);var Na=0,Ia=function(t,e,n,r,i){if(!(this instanceof Ia))return new Ia(t,e,n,r,i);null==n&&(n=0),ba.call(this,[new xa([new qe("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=n;var a=te(n,0);this.sel=Ei(a),this.history=new Fi(null),this.id=++Na,this.modeOption=e,this.lineSep=r,this.direction="rtl"==i?"rtl":"ltr",this.extend=!1,"string"==typeof t&&(t=this.splitLines(t)),ki(this,{from:a,to:a,text:t}),Qi(this,Ei(a),W)};Ia.prototype=J(ba.prototype,{constructor:Ia,iter:function(t,e,n){n?this.iterN(t-this.first,e-t,n):this.iterN(this.first,this.first+this.size,t)},insert:function(t,e){for(var n=0,r=0;r<e.length;++r)n+=e[r].height;this.insertInner(t-this.first,e,n)},remove:function(t,e){this.removeInner(t-this.first,e)},getValue:function(t){var e=$t(this,this.first,this.first+this.size);return!1===t?e:e.join(t||this.lineSeparator())},setValue:ni((function(t){var e=te(this.first,0),n=this.first+this.size-1;ca(this,{from:e,to:te(n,qt(this,n).text.length),text:this.splitLines(t),origin:"setValue",full:!0},!0),this.cm&&Or(this.cm,0,0),Qi(this,Ei(e),W)})),replaceRange:function(t,e,n,r){da(this,t,e=se(this,e),n=n?se(this,n):e,r)},getRange:function(t,e,n){var r=Xt(this,se(this,t),se(this,e));return!1===n?r:r.join(n||this.lineSeparator())},getLine:function(t){var e=this.getLineHandle(t);return e&&e.text},getLineHandle:function(t){if(Zt(this,t))return qt(this,t)},getLineNumber:function(t){return Kt(t)},getLineHandleVisualStart:function(t){return"number"==typeof t&&(t=qt(this,t)),Be(t)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(t){return se(this,t)},getCursor:function(t){var e=this.sel.primary();return null==t||"head"==t?e.head:"anchor"==t?e.anchor:"end"==t||"to"==t||!1===t?e.to():e.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:ni((function(t,e,n){Ji(this,se(this,"number"==typeof t?te(t,e||0):t),null,n)})),setSelection:ni((function(t,e,n){Ji(this,se(this,t),se(this,e||t),n)})),extendSelection:ni((function(t,e,n){$i(this,se(this,t),e&&se(this,e),n)})),extendSelections:ni((function(t,e){Yi(this,ue(this,t),e)})),extendSelectionsBy:ni((function(t,e){Yi(this,ue(this,Y(this.sel.ranges,t)),e)})),setSelections:ni((function(t,e,n){if(t.length){for(var r=[],i=0;i<t.length;i++)r[i]=new Si(se(this,t[i].anchor),se(this,t[i].head));null==e&&(e=Math.min(t.length-1,this.sel.primIndex)),Qi(this,Mi(this.cm,r,e),n)}})),addSelection:ni((function(t,e,n){var r=this.sel.ranges.slice(0);r.push(new Si(se(this,t),se(this,e||t))),Qi(this,Mi(this.cm,r,r.length-1),n)})),getSelection:function(t){for(var e,n=this.sel.ranges,r=0;r<n.length;r++){var i=Xt(this,n[r].from(),n[r].to());e=e?e.concat(i):i}return!1===t?e:e.join(t||this.lineSeparator())},getSelections:function(t){for(var e=[],n=this.sel.ranges,r=0;r<n.length;r++){var i=Xt(this,n[r].from(),n[r].to());!1!==t&&(i=i.join(t||this.lineSeparator())),e[r]=i}return e},replaceSelection:function(t,e,n){for(var r=[],i=0;i<this.sel.ranges.length;i++)r[i]=t;this.replaceSelections(r,e,n||"+input")},replaceSelections:ni((function(t,e,n){for(var r=[],i=this.sel,a=0;a<i.ranges.length;a++){var o=i.ranges[a];r[a]={from:o.from(),to:o.to(),text:this.splitLines(t[a]),origin:n}}for(var s=e&&"end"!=e&&function(t,e,n){for(var r=[],i=te(t.first,0),a=i,o=0;o<e.length;o++){var s=e[o],u=Ni(s.from,i,a),c=Ni(Ti(s),i,a);if(i=s.to,a=c,"around"==n){var l=t.sel.ranges[o],h=ee(l.head,l.anchor)<0;r[o]=new Si(h?c:u,h?u:c)}else r[o]=new Si(u,u)}return new _i(r,t.sel.primIndex)}(this,r,e),u=r.length-1;u>=0;u--)ca(this,r[u]);s?Zi(this,s):this.cm&&Rr(this.cm)})),undo:ni((function(){ha(this,"undo")})),redo:ni((function(){ha(this,"redo")})),undoSelection:ni((function(){ha(this,"undo",!0)})),redoSelection:ni((function(){ha(this,"redo",!0)})),setExtending:function(t){this.extend=t},getExtending:function(){return this.extend},historySize:function(){for(var t=this.history,e=0,n=0,r=0;r<t.done.length;r++)t.done[r].ranges||++e;for(var i=0;i<t.undone.length;i++)t.undone[i].ranges||++n;return{undo:e,redo:n}},clearHistory:function(){var t=this;this.history=new Fi(this.history.maxGeneration),Li(this,(function(e){return e.history=t.history}),!0)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(t){return t&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(t){return this.history.generation==(t||this.cleanGeneration)},getHistory:function(){return{done:qi(this.history.done),undone:qi(this.history.undone)}},setHistory:function(t){var e=this.history=new Fi(this.history.maxGeneration);e.done=qi(t.done.slice(0),null,!0),e.undone=qi(t.undone.slice(0),null,!0)},setGutterMarker:ni((function(t,e,n){return ya(this,t,"gutter",(function(t){var r=t.gutterMarkers||(t.gutterMarkers={});return r[e]=n,!n&&et(r)&&(t.gutterMarkers=null),!0}))})),clearGutter:ni((function(t){var e=this;this.iter((function(n){n.gutterMarkers&&n.gutterMarkers[t]&&ya(e,n,"gutter",(function(){return n.gutterMarkers[t]=null,et(n.gutterMarkers)&&(n.gutterMarkers=null),!0}))}))})),lineInfo:function(t){var e;if("number"==typeof t){if(!Zt(this,t))return null;if(e=t,!(t=qt(this,t)))return null}else if(null==(e=Kt(t)))return null;return{line:e,handle:t,text:t.text,gutterMarkers:t.gutterMarkers,textClass:t.textClass,bgClass:t.bgClass,wrapClass:t.wrapClass,widgets:t.widgets}},addLineClass:ni((function(t,e,n){return ya(this,t,"gutter"==e?"gutter":"class",(function(t){var r="text"==e?"textClass":"background"==e?"bgClass":"gutter"==e?"gutterClass":"wrapClass";if(t[r]){if(M(n).test(t[r]))return!1;t[r]+=" "+n}else t[r]=n;return!0}))})),removeLineClass:ni((function(t,e,n){return ya(this,t,"gutter"==e?"gutter":"class",(function(t){var r="text"==e?"textClass":"background"==e?"bgClass":"gutter"==e?"gutterClass":"wrapClass",i=t[r];if(!i)return!1;if(null==n)t[r]=null;else{var a=i.match(M(n));if(!a)return!1;var o=a.index+a[0].length;t[r]=i.slice(0,a.index)+(a.index&&o!=i.length?" ":"")+i.slice(o)||null}return!0}))})),addLineWidget:ni((function(t,e,n){return function(t,e,n,r){var i=new wa(t,n,r),a=t.cm;return a&&i.noHScroll&&(a.display.alignWidgets=!0),ya(t,e,"widget",(function(e){var n=e.widgets||(e.widgets=[]);if(null==i.insertAt?n.push(i):n.splice(Math.min(n.length-1,Math.max(0,i.insertAt)),0,i),i.line=e,a&&!je(t,e)){var r=Ve(e)<t.scrollTop;Yt(e,e.height+wn(i)),r&&Ir(a,i.height),a.curOp.forceUpdate=!0}return!0})),a&&un(a,"lineWidgetAdded",a,i,"number"==typeof e?e:Kt(e)),i}(this,t,e,n)})),removeLineWidget:function(t){t.clear()},markText:function(t,e,n){return Ea(this,se(this,t),se(this,e),n,n&&n.type||"range")},setBookmark:function(t,e){var n={replacedWith:e&&(null==e.nodeType?e.widget:e),insertLeft:e&&e.insertLeft,clearWhenEmpty:!1,shared:e&&e.shared,handleMouseEvents:e&&e.handleMouseEvents};return Ea(this,t=se(this,t),t,n,"bookmark")},findMarksAt:function(t){var e=[],n=qt(this,(t=se(this,t)).line).markedSpans;if(n)for(var r=0;r<n.length;++r){var i=n[r];(null==i.from||i.from<=t.ch)&&(null==i.to||i.to>=t.ch)&&e.push(i.marker.parent||i.marker)}return e},findMarks:function(t,e,n){t=se(this,t),e=se(this,e);var r=[],i=t.line;return this.iter(t.line,e.line+1,(function(a){var o=a.markedSpans;if(o)for(var s=0;s<o.length;s++){var u=o[s];null!=u.to&&i==t.line&&t.ch>=u.to||null==u.from&&i!=t.line||null!=u.from&&i==e.line&&u.from>=e.ch||n&&!n(u.marker)||r.push(u.marker.parent||u.marker)}++i})),r},getAllMarks:function(){var t=[];return this.iter((function(e){var n=e.markedSpans;if(n)for(var r=0;r<n.length;++r)null!=n[r].from&&t.push(n[r].marker)})),t},posFromIndex:function(t){var e,n=this.first,r=this.lineSeparator().length;return this.iter((function(i){var a=i.text.length+r;if(a>t)return e=t,!0;t-=a,++n})),se(this,te(n,e))},indexFromPos:function(t){var e=(t=se(this,t)).ch;if(t.line<this.first||t.ch<0)return 0;var n=this.lineSeparator().length;return this.iter(this.first,t.line,(function(t){e+=t.text.length+n})),e},copy:function(t){var e=new Ia($t(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return e.scrollTop=this.scrollTop,e.scrollLeft=this.scrollLeft,e.sel=this.sel,e.extend=!1,t&&(e.history.undoDepth=this.history.undoDepth,e.setHistory(this.getHistory())),e},linkedDoc:function(t){t||(t={});var e=this.first,n=this.first+this.size;null!=t.from&&t.from>e&&(e=t.from),null!=t.to&&t.to<n&&(n=t.to);var r=new Ia($t(this,e,n),t.mode||this.modeOption,e,this.lineSep,this.direction);return t.sharedHist&&(r.history=this.history),(this.linked||(this.linked=[])).push({doc:r,sharedHist:t.sharedHist}),r.linked=[{doc:this,isParent:!0,sharedHist:t.sharedHist}],function(t,e){for(var n=0;n<e.length;n++){var r=e[n],i=r.find(),a=t.clipPos(i.from),o=t.clipPos(i.to);if(ee(a,o)){var s=Ea(t,a,o,r.primary,r.primary.type);r.markers.push(s),s.parent=r}}}(r,Ca(this)),r},unlinkDoc:function(t){if(t instanceof Co&&(t=t.doc),this.linked)for(var e=0;e<this.linked.length;++e)if(this.linked[e].doc==t){this.linked.splice(e,1),t.unlinkDoc(this),Aa(Ca(this));break}if(t.history==this.history){var n=[t.id];Li(t,(function(t){return n.push(t.id)}),!0),t.history=new Fi(null),t.history.done=qi(this.history.done,n),t.history.undone=qi(this.history.undone,n)}},iterLinkedDocs:function(t){Li(this,t)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(t){return this.lineSep?t.split(this.lineSep):Rt(t)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:ni((function(t){var e;"rtl"!=t&&(t="ltr"),t!=this.direction&&(this.direction=t,this.iter((function(t){return t.order=null})),this.cm&&Qr(e=this.cm,(function(){Pi(e),hr(e)})))}))}),Ia.prototype.eachLine=Ia.prototype.iter;var Ra=0;function Oa(t){var e=this;if(ka(e),!mt(e,t)&&!_n(e.display,t)){xt(t),o&&(Ra=+new Date);var n=cr(e,t,!0),r=t.dataTransfer.files;if(n&&!e.isReadOnly())if(r&&r.length&&window.FileReader&&window.File)for(var i=r.length,a=Array(i),s=0,u=function(){++s==i&&ti(e,(function(){var t={from:n=se(e.doc,n),to:n,text:e.doc.splitLines(a.filter((function(t){return null!=t})).join(e.doc.lineSeparator())),origin:"paste"};ca(e.doc,t),Zi(e.doc,Ei(se(e.doc,n),se(e.doc,Ti(t))))}))()},c=function(t,n){if(e.options.allowDropFileTypes&&-1==U(e.options.allowDropFileTypes,t.type))u();else{var r=new FileReader;r.onerror=function(){return u()},r.onload=function(){var t=r.result;/[\x00-\x08\x0e-\x1f]{2}/.test(t)||(a[n]=t),u()},r.readAsText(t)}},l=0;l<r.length;l++)c(r[l],l);else{if(e.state.draggingText&&e.doc.sel.contains(n)>-1)return e.state.draggingText(t),void setTimeout((function(){return e.display.input.focus()}),20);try{var h=t.dataTransfer.getData("Text");if(h){var p;if(e.state.draggingText&&!e.state.draggingText.copy&&(p=e.listSelections()),ta(e.doc,Ei(n,n)),p)for(var f=0;f<p.length;++f)da(e.doc,"",p[f].anchor,p[f].head,"drag");e.replaceSelection(h,"around","paste"),e.display.input.focus()}}catch(t){}}}}function ka(t){t.display.dragCursor&&(t.display.lineSpace.removeChild(t.display.dragCursor),t.display.dragCursor=null)}function La(t){if(document.getElementsByClassName){for(var e=document.getElementsByClassName("CodeMirror"),n=[],r=0;r<e.length;r++){var i=e[r].CodeMirror;i&&n.push(i)}n.length&&n[0].operation((function(){for(var e=0;e<n.length;e++)t(n[e])}))}}var Da=!1;function Pa(){var t;Da||(ht(window,"resize",(function(){null==t&&(t=setTimeout((function(){t=null,La(Fa)}),100))})),ht(window,"blur",(function(){return La(Er)})),Da=!0)}function Fa(t){var e=t.display;e.cachedCharWidth=e.cachedTextHeight=e.cachedPaddingH=null,e.scrollbarsClipped=!1,t.setSize()}for(var Ba={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},za=0;za<10;za++)Ba[za+48]=Ba[za+96]=String(za);for(var Ua=65;Ua<=90;Ua++)Ba[Ua]=String.fromCharCode(Ua);for(var ja=1;ja<=12;ja++)Ba[ja+111]=Ba[ja+63235]="F"+ja;var Wa={};function Va(t){var e,n,r,i,a=t.split(/-(?!$)/);t=a[a.length-1];for(var o=0;o<a.length-1;o++){var s=a[o];if(/^(cmd|meta|m)$/i.test(s))i=!0;else if(/^a(lt)?$/i.test(s))e=!0;else if(/^(c|ctrl|control)$/i.test(s))n=!0;else{if(!/^s(hift)?$/i.test(s))throw new Error("Unrecognized modifier name: "+s);r=!0}}return e&&(t="Alt-"+t),n&&(t="Ctrl-"+t),i&&(t="Cmd-"+t),r&&(t="Shift-"+t),t}function Ha(t){var e={};for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];if(/^(name|fallthrough|(de|at)tach)$/.test(n))continue;if("..."==r){delete t[n];continue}for(var i=Y(n.split(" "),Va),a=0;a<i.length;a++){var o=void 0,s=void 0;a==i.length-1?(s=i.join(" "),o=r):(s=i.slice(0,a+1).join(" "),o="...");var u=e[s];if(u){if(u!=o)throw new Error("Inconsistent bindings for "+s)}else e[s]=o}delete t[n]}for(var c in e)t[c]=e[c];return t}function Ga(t,e,n,r){var i=(e=Ya(e)).call?e.call(t,r):e[t];if(!1===i)return"nothing";if("..."===i)return"multi";if(null!=i&&n(i))return"handled";if(e.fallthrough){if("[object Array]"!=Object.prototype.toString.call(e.fallthrough))return Ga(t,e.fallthrough,n,r);for(var a=0;a<e.fallthrough.length;a++){var o=Ga(t,e.fallthrough[a],n,r);if(o)return o}}}function qa(t){var e="string"==typeof t?t:Ba[t.keyCode];return"Ctrl"==e||"Alt"==e||"Shift"==e||"Mod"==e}function Xa(t,e,n){var r=t;return e.altKey&&"Alt"!=r&&(t="Alt-"+t),(_?e.metaKey:e.ctrlKey)&&"Ctrl"!=r&&(t="Ctrl-"+t),(_?e.ctrlKey:e.metaKey)&&"Cmd"!=r&&(t="Cmd-"+t),!n&&e.shiftKey&&"Shift"!=r&&(t="Shift-"+t),t}function $a(t,e){if(h&&34==t.keyCode&&t.char)return!1;var n=Ba[t.keyCode];return null!=n&&!t.altGraphKey&&(3==t.keyCode&&t.code&&(n=t.code),Xa(n,t,e))}function Ya(t){return"string"==typeof t?Wa[t]:t}function Ka(t,e){for(var n=t.doc.sel.ranges,r=[],i=0;i<n.length;i++){for(var a=e(n[i]);r.length&&ee(a.from,$(r).to)<=0;){var o=r.pop();if(ee(o.from,a.from)<0){a.from=o.from;break}}r.push(a)}Qr(t,(function(){for(var e=r.length-1;e>=0;e--)da(t.doc,"",r[e].from,r[e].to,"+delete");Rr(t)}))}function Ja(t,e,n){var r=it(t.text,e+n,n);return r<0||r>t.text.length?null:r}function Za(t,e,n){var r=Ja(t,e.ch,n);return null==r?null:new te(e.line,r,n<0?"after":"before")}function Qa(t,e,n,r,i){if(t){"rtl"==e.doc.direction&&(i=-i);var a=ct(n,e.doc.direction);if(a){var o,s=i<0?$(a):a[0],u=i<0==(1==s.level)?"after":"before";if(s.level>0||"rtl"==e.doc.direction){var c=On(e,n);o=i<0?n.text.length-1:0;var l=kn(e,c,o).top;o=at((function(t){return kn(e,c,t).top==l}),i<0==(1==s.level)?s.from:s.to-1,o),"before"==u&&(o=Ja(n,o,1))}else o=i<0?s.to:s.from;return new te(r,o,u)}}return new te(r,i<0?n.text.length:0,i<0?"before":"after")}Wa.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},Wa.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},Wa.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},Wa.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},Wa.default=y?Wa.macDefault:Wa.pcDefault;var to={selectAll:sa,singleSelection:function(t){return t.setSelection(t.getCursor("anchor"),t.getCursor("head"),W)},killLine:function(t){return Ka(t,(function(e){if(e.empty()){var n=qt(t.doc,e.head.line).text.length;return e.head.ch==n&&e.head.line<t.lastLine()?{from:e.head,to:te(e.head.line+1,0)}:{from:e.head,to:te(e.head.line,n)}}return{from:e.from(),to:e.to()}}))},deleteLine:function(t){return Ka(t,(function(e){return{from:te(e.from().line,0),to:se(t.doc,te(e.to().line+1,0))}}))},delLineLeft:function(t){return Ka(t,(function(t){return{from:te(t.from().line,0),to:t.from()}}))},delWrappedLineLeft:function(t){return Ka(t,(function(e){var n=t.charCoords(e.head,"div").top+5;return{from:t.coordsChar({left:0,top:n},"div"),to:e.from()}}))},delWrappedLineRight:function(t){return Ka(t,(function(e){var n=t.charCoords(e.head,"div").top+5,r=t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:n},"div");return{from:e.from(),to:r}}))},undo:function(t){return t.undo()},redo:function(t){return t.redo()},undoSelection:function(t){return t.undoSelection()},redoSelection:function(t){return t.redoSelection()},goDocStart:function(t){return t.extendSelection(te(t.firstLine(),0))},goDocEnd:function(t){return t.extendSelection(te(t.lastLine()))},goLineStart:function(t){return t.extendSelectionsBy((function(e){return eo(t,e.head.line)}),{origin:"+move",bias:1})},goLineStartSmart:function(t){return t.extendSelectionsBy((function(e){return no(t,e.head)}),{origin:"+move",bias:1})},goLineEnd:function(t){return t.extendSelectionsBy((function(e){return function(t,e){var n=qt(t.doc,e),r=function(t){for(var e;e=De(t);)t=e.find(1,!0).line;return t}(n);return r!=n&&(e=Kt(r)),Qa(!0,t,n,e,-1)}(t,e.head.line)}),{origin:"+move",bias:-1})},goLineRight:function(t){return t.extendSelectionsBy((function(e){var n=t.cursorCoords(e.head,"div").top+5;return t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:n},"div")}),H)},goLineLeft:function(t){return t.extendSelectionsBy((function(e){var n=t.cursorCoords(e.head,"div").top+5;return t.coordsChar({left:0,top:n},"div")}),H)},goLineLeftSmart:function(t){return t.extendSelectionsBy((function(e){var n=t.cursorCoords(e.head,"div").top+5,r=t.coordsChar({left:0,top:n},"div");return r.ch<t.getLine(r.line).search(/\S/)?no(t,e.head):r}),H)},goLineUp:function(t){return t.moveV(-1,"line")},goLineDown:function(t){return t.moveV(1,"line")},goPageUp:function(t){return t.moveV(-1,"page")},goPageDown:function(t){return t.moveV(1,"page")},goCharLeft:function(t){return t.moveH(-1,"char")},goCharRight:function(t){return t.moveH(1,"char")},goColumnLeft:function(t){return t.moveH(-1,"column")},goColumnRight:function(t){return t.moveH(1,"column")},goWordLeft:function(t){return t.moveH(-1,"word")},goGroupRight:function(t){return t.moveH(1,"group")},goGroupLeft:function(t){return t.moveH(-1,"group")},goWordRight:function(t){return t.moveH(1,"word")},delCharBefore:function(t){return t.deleteH(-1,"char")},delCharAfter:function(t){return t.deleteH(1,"char")},delWordBefore:function(t){return t.deleteH(-1,"word")},delWordAfter:function(t){return t.deleteH(1,"word")},delGroupBefore:function(t){return t.deleteH(-1,"group")},delGroupAfter:function(t){return t.deleteH(1,"group")},indentAuto:function(t){return t.indentSelection("smart")},indentMore:function(t){return t.indentSelection("add")},indentLess:function(t){return t.indentSelection("subtract")},insertTab:function(t){return t.replaceSelection("\t")},insertSoftTab:function(t){for(var e=[],n=t.listSelections(),r=t.options.tabSize,i=0;i<n.length;i++){var a=n[i].from(),o=B(t.getLine(a.line),a.ch,r);e.push(X(r-o%r))}t.replaceSelections(e)},defaultTab:function(t){t.somethingSelected()?t.indentSelection("add"):t.execCommand("insertTab")},transposeChars:function(t){return Qr(t,(function(){for(var e=t.listSelections(),n=[],r=0;r<e.length;r++)if(e[r].empty()){var i=e[r].head,a=qt(t.doc,i.line).text;if(a)if(i.ch==a.length&&(i=new te(i.line,i.ch-1)),i.ch>0)i=new te(i.line,i.ch+1),t.replaceRange(a.charAt(i.ch-1)+a.charAt(i.ch-2),te(i.line,i.ch-2),i,"+transpose");else if(i.line>t.doc.first){var o=qt(t.doc,i.line-1).text;o&&(i=new te(i.line,1),t.replaceRange(a.charAt(0)+t.doc.lineSeparator()+o.charAt(o.length-1),te(i.line-1,o.length-1),i,"+transpose"))}n.push(new Si(i,i))}t.setSelections(n)}))},newlineAndIndent:function(t){return Qr(t,(function(){for(var e=t.listSelections(),n=e.length-1;n>=0;n--)t.replaceRange(t.doc.lineSeparator(),e[n].anchor,e[n].head,"+input");e=t.listSelections();for(var r=0;r<e.length;r++)t.indentLine(e[r].from().line,null,!0);Rr(t)}))},openLine:function(t){return t.replaceSelection("\n","start")},toggleOverwrite:function(t){return t.toggleOverwrite()}};function eo(t,e){var n=qt(t.doc,e),r=Be(n);return r!=n&&(e=Kt(r)),Qa(!0,t,r,e,1)}function no(t,e){var n=eo(t,e.line),r=qt(t.doc,n.line),i=ct(r,t.doc.direction);if(!i||0==i[0].level){var a=Math.max(n.ch,r.text.search(/\S/)),o=e.line==n.line&&e.ch<=a&&e.ch;return te(n.line,o?0:a,n.sticky)}return n}function ro(t,e,n){if("string"==typeof e&&!(e=to[e]))return!1;t.display.input.ensurePolled();var r=t.display.shift,i=!1;try{t.isReadOnly()&&(t.state.suppressEdits=!0),n&&(t.display.shift=!1),i=e(t)!=j}finally{t.display.shift=r,t.state.suppressEdits=!1}return i}var io=new z;function ao(t,e,n,r){var i=t.state.keySeq;if(i){if(qa(e))return"handled";if(/\'$/.test(e)?t.state.keySeq=null:io.set(50,(function(){t.state.keySeq==i&&(t.state.keySeq=null,t.display.input.reset())})),oo(t,i+" "+e,n,r))return!0}return oo(t,e,n,r)}function oo(t,e,n,r){var i=function(t,e,n){for(var r=0;r<t.state.keyMaps.length;r++){var i=Ga(e,t.state.keyMaps[r],n,t);if(i)return i}return t.options.extraKeys&&Ga(e,t.options.extraKeys,n,t)||Ga(e,t.options.keyMap,n,t)}(t,e,r);return"multi"==i&&(t.state.keySeq=e),"handled"==i&&un(t,"keyHandled",t,e,n),"handled"!=i&&"multi"!=i||(xt(n),wr(t)),!!i}function so(t,e){var n=$a(e,!0);return!!n&&(e.shiftKey&&!t.state.keySeq?ao(t,"Shift-"+n,e,(function(e){return ro(t,e,!0)}))||ao(t,n,e,(function(e){if("string"==typeof e?/^go[A-Z]/.test(e):e.motion)return ro(t,e)})):ao(t,n,e,(function(e){return ro(t,e)})))}var uo=null;function co(t){var e=this;if(e.curOp.focus=O(),!mt(e,t)){o&&s<11&&27==t.keyCode&&(t.returnValue=!1);var r=t.keyCode;e.display.shift=16==r||t.shiftKey;var i=so(e,t);h&&(uo=i?r:null,i||88!=r||kt||!(y?t.metaKey:t.ctrlKey)||e.replaceSelection("",null,"cut")),n&&!y&&!i&&46==r&&t.shiftKey&&!t.ctrlKey&&document.execCommand&&document.execCommand("cut"),18!=r||/\bCodeMirror-crosshair\b/.test(e.display.lineDiv.className)||function(t){var e=t.display.lineDiv;function n(t){18!=t.keyCode&&t.altKey||(T(e,"CodeMirror-crosshair"),ft(document,"keyup",n),ft(document,"mouseover",n))}k(e,"CodeMirror-crosshair"),ht(document,"keyup",n),ht(document,"mouseover",n)}(e)}}function lo(t){16==t.keyCode&&(this.doc.sel.shift=!1),mt(this,t)}function ho(t){var e=this;if(!(_n(e.display,t)||mt(e,t)||t.ctrlKey&&!t.altKey||y&&t.metaKey)){var n=t.keyCode,r=t.charCode;if(h&&n==uo)return uo=null,void xt(t);if(!h||t.which&&!(t.which<10)||!so(e,t)){var i=String.fromCharCode(null==r?n:r);"\b"!=i&&(function(t,e,n){return ao(t,"'"+n+"'",e,(function(e){return ro(t,e,!0)}))}(e,t,i)||e.display.input.onKeyPress(t))}}}var po,fo,mo=function(t,e,n){this.time=t,this.pos=e,this.button=n};function vo(t){var e=this,n=e.display;if(!(mt(e,t)||n.activeTouch&&n.input.supportsTouch()))if(n.input.ensurePolled(),n.shift=t.shiftKey,_n(n,t))u||(n.scroller.draggable=!1,setTimeout((function(){return n.scroller.draggable=!0}),100));else if(!xo(e,t)){var r=cr(e,t),i=Mt(t),a=r?function(t,e){var n=+new Date;return fo&&fo.compare(n,t,e)?(po=fo=null,"triple"):po&&po.compare(n,t,e)?(fo=new mo(n,t,e),po=null,"double"):(po=new mo(n,t,e),fo=null,"single")}(r,i):"single";window.focus(),1==i&&e.state.selectingText&&e.state.selectingText(t),r&&function(t,e,n,r,i){var a="Click";return"double"==r?a="Double"+a:"triple"==r&&(a="Triple"+a),ao(t,Xa(a=(1==e?"Left":2==e?"Middle":"Right")+a,i),i,(function(e){if("string"==typeof e&&(e=to[e]),!e)return!1;var r=!1;try{t.isReadOnly()&&(t.state.suppressEdits=!0),r=e(t,n)!=j}finally{t.state.suppressEdits=!1}return r}))}(e,i,r,a,t)||(1==i?r?function(t,e,n,r){o?setTimeout(P(_r,t),0):t.curOp.focus=O();var i,a=function(t,e,n){var r=t.getOption("configureMouse"),i=r?r(t,e,n):{};if(null==i.unit){var a=x?n.shiftKey&&n.metaKey:n.altKey;i.unit=a?"rectangle":"single"==e?"char":"double"==e?"word":"line"}return(null==i.extend||t.doc.extend)&&(i.extend=t.doc.extend||n.shiftKey),null==i.addNew&&(i.addNew=y?n.metaKey:n.ctrlKey),null==i.moveOnDrag&&(i.moveOnDrag=!(y?n.altKey:n.ctrlKey)),i}(t,n,r),c=t.doc.sel;t.options.dragDrop&&Ct&&!t.isReadOnly()&&"single"==n&&(i=c.contains(e))>-1&&(ee((i=c.ranges[i]).from(),e)<0||e.xRel>0)&&(ee(i.to(),e)>0||e.xRel<0)?function(t,e,n,r){var i=t.display,a=!1,c=ti(t,(function(e){u&&(i.scroller.draggable=!1),t.state.draggingText=!1,ft(i.wrapper.ownerDocument,"mouseup",c),ft(i.wrapper.ownerDocument,"mousemove",l),ft(i.scroller,"dragstart",h),ft(i.scroller,"drop",c),a||(xt(e),r.addNew||$i(t.doc,n,null,null,r.extend),u||o&&9==s?setTimeout((function(){i.wrapper.ownerDocument.body.focus(),i.input.focus()}),20):i.input.focus())})),l=function(t){a=a||Math.abs(e.clientX-t.clientX)+Math.abs(e.clientY-t.clientY)>=10},h=function(){return a=!0};u&&(i.scroller.draggable=!0),t.state.draggingText=c,c.copy=!r.moveOnDrag,i.scroller.dragDrop&&i.scroller.dragDrop(),ht(i.wrapper.ownerDocument,"mouseup",c),ht(i.wrapper.ownerDocument,"mousemove",l),ht(i.scroller,"dragstart",h),ht(i.scroller,"drop",c),Sr(t),setTimeout((function(){return i.input.focus()}),20)}(t,r,e,a):function(t,e,n,r){var i=t.display,a=t.doc;xt(e);var o,s,u=a.sel,c=u.ranges;if(r.addNew&&!r.extend?(s=a.sel.contains(n),o=s>-1?c[s]:new Si(n,n)):(o=a.sel.primary(),s=a.sel.primIndex),"rectangle"==r.unit)r.addNew||(o=new Si(n,n)),n=cr(t,e,!0,!0),s=-1;else{var l=go(t,n,r.unit);o=r.extend?Xi(o,l.anchor,l.head,r.extend):l}r.addNew?-1==s?(s=c.length,Qi(a,Mi(t,c.concat([o]),s),{scroll:!1,origin:"*mouse"})):c.length>1&&c[s].empty()&&"char"==r.unit&&!r.extend?(Qi(a,Mi(t,c.slice(0,s).concat(c.slice(s+1)),0),{scroll:!1,origin:"*mouse"}),u=a.sel):Ki(a,s,o,V):(s=0,Qi(a,new _i([o],0),V),u=a.sel);var h=n;function p(e){if(0!=ee(h,e))if(h=e,"rectangle"==r.unit){for(var i=[],c=t.options.tabSize,l=B(qt(a,n.line).text,n.ch,c),p=B(qt(a,e.line).text,e.ch,c),f=Math.min(l,p),d=Math.max(l,p),m=Math.min(n.line,e.line),v=Math.min(t.lastLine(),Math.max(n.line,e.line));m<=v;m++){var g=qt(a,m).text,y=G(g,f,c);f==d?i.push(new Si(te(m,y),te(m,y))):g.length>y&&i.push(new Si(te(m,y),te(m,G(g,d,c))))}i.length||i.push(new Si(n,n)),Qi(a,Mi(t,u.ranges.slice(0,s).concat(i),s),{origin:"*mouse",scroll:!1}),t.scrollIntoView(e)}else{var x,b=o,w=go(t,e,r.unit),_=b.anchor;ee(w.anchor,_)>0?(x=w.head,_=ae(b.from(),w.anchor)):(x=w.anchor,_=ie(b.to(),w.head));var S=u.ranges.slice(0);S[s]=function(t,e){var n=e.anchor,r=e.head,i=qt(t.doc,n.line);if(0==ee(n,r)&&n.sticky==r.sticky)return e;var a=ct(i);if(!a)return e;var o=st(a,n.ch,n.sticky),s=a[o];if(s.from!=n.ch&&s.to!=n.ch)return e;var u,c=o+(s.from==n.ch==(1!=s.level)?0:1);if(0==c||c==a.length)return e;if(r.line!=n.line)u=(r.line-n.line)*("ltr"==t.doc.direction?1:-1)>0;else{var l=st(a,r.ch,r.sticky),h=l-o||(r.ch-n.ch)*(1==s.level?-1:1);u=l==c-1||l==c?h<0:h>0}var p=a[c+(u?-1:0)],f=u==(1==p.level),d=f?p.from:p.to,m=f?"after":"before";return n.ch==d&&n.sticky==m?e:new Si(new te(n.line,d,m),r)}(t,new Si(se(a,_),x)),Qi(a,Mi(t,S,s),V)}}var f=i.wrapper.getBoundingClientRect(),d=0;function m(e){t.state.selectingText=!1,d=1/0,e&&(xt(e),i.input.focus()),ft(i.wrapper.ownerDocument,"mousemove",v),ft(i.wrapper.ownerDocument,"mouseup",g),a.history.lastSelOrigin=null}var v=ti(t,(function(e){0!==e.buttons&&Mt(e)?function e(n){var o=++d,s=cr(t,n,!0,"rectangle"==r.unit);if(s)if(0!=ee(s,h)){t.curOp.focus=O(),p(s);var u=Ar(i,a);(s.line>=u.to||s.line<u.from)&&setTimeout(ti(t,(function(){d==o&&e(n)})),150)}else{var c=n.clientY<f.top?-20:n.clientY>f.bottom?20:0;c&&setTimeout(ti(t,(function(){d==o&&(i.scroller.scrollTop+=c,e(n))})),50)}}(e):m(e)})),g=ti(t,m);t.state.selectingText=g,ht(i.wrapper.ownerDocument,"mousemove",v),ht(i.wrapper.ownerDocument,"mouseup",g)}(t,r,e,a)}(e,r,a,t):St(t)==n.scroller&&xt(t):2==i?(r&&$i(e.doc,r),setTimeout((function(){return n.input.focus()}),20)):3==i&&(S?e.display.input.onContextMenu(t):Sr(e)))}}function go(t,e,n){if("char"==n)return new Si(e,e);if("word"==n)return t.findWordAt(e);if("line"==n)return new Si(te(e.line,0),se(t.doc,te(e.line+1,0)));var r=n(t,e);return new Si(r.from,r.to)}function yo(t,e,n,r){var i,a;if(e.touches)i=e.touches[0].clientX,a=e.touches[0].clientY;else try{i=e.clientX,a=e.clientY}catch(e){return!1}if(i>=Math.floor(t.display.gutters.getBoundingClientRect().right))return!1;r&&xt(e);var o=t.display,s=o.lineDiv.getBoundingClientRect();if(a>s.bottom||!gt(t,n))return wt(e);a-=s.top-o.viewOffset;for(var u=0;u<t.display.gutterSpecs.length;++u){var c=o.gutters.childNodes[u];if(c&&c.getBoundingClientRect().right>=i)return dt(t,n,t,Jt(t.doc,a),t.display.gutterSpecs[u].className,e),wt(e)}}function xo(t,e){return yo(t,e,"gutterClick",!0)}function bo(t,e){_n(t.display,e)||function(t,e){return!!gt(t,"gutterContextMenu")&&yo(t,e,"gutterContextMenu",!1)}(t,e)||mt(t,e,"contextmenu")||S||t.display.input.onContextMenu(e)}function wo(t){t.display.wrapper.className=t.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+t.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Un(t)}mo.prototype.compare=function(t,e,n){return this.time+400>t&&0==ee(e,this.pos)&&n==this.button};var _o={toString:function(){return"CodeMirror.Init"}},So={},Mo={};function Eo(t,e,n){if(!e!=!(n&&n!=_o)){var r=t.display.dragFunctions,i=e?ht:ft;i(t.display.scroller,"dragstart",r.start),i(t.display.scroller,"dragenter",r.enter),i(t.display.scroller,"dragover",r.over),i(t.display.scroller,"dragleave",r.leave),i(t.display.scroller,"drop",r.drop)}}function To(t){t.options.lineWrapping?(k(t.display.wrapper,"CodeMirror-wrap"),t.display.sizer.style.minWidth="",t.display.sizerWidth=null):(T(t.display.wrapper,"CodeMirror-wrap"),Ge(t)),ur(t),hr(t),Un(t),setTimeout((function(){return jr(t)}),100)}function Co(t,e){var n=this;if(!(this instanceof Co))return new Co(t,e);this.options=e=e?F(e):{},F(So,e,!1);var r=e.value;"string"==typeof r?r=new Ia(r,e.mode,null,e.lineSeparator,e.direction):e.mode&&(r.modeOption=e.mode),this.doc=r;var i=new Co.inputStyles[e.inputStyle](this),a=this.display=new vi(t,r,i,e);for(var c in a.wrapper.CodeMirror=this,wo(this),e.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),Hr(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new z,keySeq:null,specialChars:null},e.autofocus&&!g&&a.input.focus(),o&&s<11&&setTimeout((function(){return n.display.input.reset(!0)}),20),function(t){var e=t.display;ht(e.scroller,"mousedown",ti(t,vo)),ht(e.scroller,"dblclick",o&&s<11?ti(t,(function(e){if(!mt(t,e)){var n=cr(t,e);if(n&&!xo(t,e)&&!_n(t.display,e)){xt(e);var r=t.findWordAt(n);$i(t.doc,r.anchor,r.head)}}})):function(e){return mt(t,e)||xt(e)}),ht(e.scroller,"contextmenu",(function(e){return bo(t,e)})),ht(e.input.getField(),"contextmenu",(function(n){e.scroller.contains(n.target)||bo(t,n)}));var n,r={end:0};function i(){e.activeTouch&&(n=setTimeout((function(){return e.activeTouch=null}),1e3),(r=e.activeTouch).end=+new Date)}function a(t,e){if(null==e.left)return!0;var n=e.left-t.left,r=e.top-t.top;return n*n+r*r>400}ht(e.scroller,"touchstart",(function(i){if(!mt(t,i)&&!function(t){if(1!=t.touches.length)return!1;var e=t.touches[0];return e.radiusX<=1&&e.radiusY<=1}(i)&&!xo(t,i)){e.input.ensurePolled(),clearTimeout(n);var a=+new Date;e.activeTouch={start:a,moved:!1,prev:a-r.end<=300?r:null},1==i.touches.length&&(e.activeTouch.left=i.touches[0].pageX,e.activeTouch.top=i.touches[0].pageY)}})),ht(e.scroller,"touchmove",(function(){e.activeTouch&&(e.activeTouch.moved=!0)})),ht(e.scroller,"touchend",(function(n){var r=e.activeTouch;if(r&&!_n(e,n)&&null!=r.left&&!r.moved&&new Date-r.start<300){var o,s=t.coordsChar(e.activeTouch,"page");o=!r.prev||a(r,r.prev)?new Si(s,s):!r.prev.prev||a(r,r.prev.prev)?t.findWordAt(s):new Si(te(s.line,0),se(t.doc,te(s.line+1,0))),t.setSelection(o.anchor,o.head),t.focus(),xt(n)}i()})),ht(e.scroller,"touchcancel",i),ht(e.scroller,"scroll",(function(){e.scroller.clientHeight&&(Dr(t,e.scroller.scrollTop),Fr(t,e.scroller.scrollLeft,!0),dt(t,"scroll",t))})),ht(e.scroller,"mousewheel",(function(e){return wi(t,e)})),ht(e.scroller,"DOMMouseScroll",(function(e){return wi(t,e)})),ht(e.wrapper,"scroll",(function(){return e.wrapper.scrollTop=e.wrapper.scrollLeft=0})),e.dragFunctions={enter:function(e){mt(t,e)||_t(e)},over:function(e){mt(t,e)||(function(t,e){var n=cr(t,e);if(n){var r=document.createDocumentFragment();yr(t,n,r),t.display.dragCursor||(t.display.dragCursor=N("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),t.display.lineSpace.insertBefore(t.display.dragCursor,t.display.cursorDiv)),A(t.display.dragCursor,r)}}(t,e),_t(e))},start:function(e){return function(t,e){if(o&&(!t.state.draggingText||+new Date-Ra<100))_t(e);else if(!mt(t,e)&&!_n(t.display,e)&&(e.dataTransfer.setData("Text",t.getSelection()),e.dataTransfer.effectAllowed="copyMove",e.dataTransfer.setDragImage&&!p)){var n=N("img",null,null,"position: fixed; left: 0; top: 0;");n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",h&&(n.width=n.height=1,t.display.wrapper.appendChild(n),n._top=n.offsetTop),e.dataTransfer.setDragImage(n,0,0),h&&n.parentNode.removeChild(n)}}(t,e)},drop:ti(t,Oa),leave:function(e){mt(t,e)||ka(t)}};var u=e.input.getField();ht(u,"keyup",(function(e){return lo.call(t,e)})),ht(u,"keydown",ti(t,co)),ht(u,"keypress",ti(t,ho)),ht(u,"focus",(function(e){return Mr(t,e)})),ht(u,"blur",(function(e){return Er(t,e)}))}(this),Pa(),qr(this),this.curOp.forceUpdate=!0,Di(this,r),e.autofocus&&!g||this.hasFocus()?setTimeout(P(Mr,this),20):Er(this),Mo)Mo.hasOwnProperty(c)&&Mo[c](this,e[c],_o);pi(this),e.finishInit&&e.finishInit(this);for(var l=0;l<Ao.length;++l)Ao[l](this);Xr(this),u&&e.lineWrapping&&"optimizelegibility"==getComputedStyle(a.lineDiv).textRendering&&(a.lineDiv.style.textRendering="auto")}Co.defaults=So,Co.optionHandlers=Mo;var Ao=[];function No(t,e,n,r){var i,a=t.doc;null==n&&(n="add"),"smart"==n&&(a.mode.indent?i=fe(t,e).state:n="prev");var o=t.options.tabSize,s=qt(a,e),u=B(s.text,null,o);s.stateAfter&&(s.stateAfter=null);var c,l=s.text.match(/^\s*/)[0];if(r||/\S/.test(s.text)){if("smart"==n&&((c=a.mode.indent(i,s.text.slice(l.length),s.text))==j||c>150)){if(!r)return;n="prev"}}else c=0,n="not";"prev"==n?c=e>a.first?B(qt(a,e-1).text,null,o):0:"add"==n?c=u+t.options.indentUnit:"subtract"==n?c=u-t.options.indentUnit:"number"==typeof n&&(c=u+n),c=Math.max(0,c);var h="",p=0;if(t.options.indentWithTabs)for(var f=Math.floor(c/o);f;--f)p+=o,h+="\t";if(p<c&&(h+=X(c-p)),h!=l)return da(a,h,te(e,0),te(e,l.length),"+input"),s.stateAfter=null,!0;for(var d=0;d<a.sel.ranges.length;d++){var m=a.sel.ranges[d];if(m.head.line==e&&m.head.ch<l.length){var v=te(e,l.length);Ki(a,d,new Si(v,v));break}}}Co.defineInitHook=function(t){return Ao.push(t)};var Io=null;function Ro(t){Io=t}function Oo(t,e,n,r,i){var a=t.doc;t.display.shift=!1,r||(r=a.sel);var o=+new Date-200,s="paste"==i||t.state.pasteIncoming>o,u=Rt(e),c=null;if(s&&r.ranges.length>1)if(Io&&Io.text.join("\n")==e){if(r.ranges.length%Io.text.length==0){c=[];for(var l=0;l<Io.text.length;l++)c.push(a.splitLines(Io.text[l]))}}else u.length==r.ranges.length&&t.options.pasteLinesPerSelection&&(c=Y(u,(function(t){return[t]})));for(var h=t.curOp.updateInput,p=r.ranges.length-1;p>=0;p--){var f=r.ranges[p],d=f.from(),m=f.to();f.empty()&&(n&&n>0?d=te(d.line,d.ch-n):t.state.overwrite&&!s?m=te(m.line,Math.min(qt(a,m.line).text.length,m.ch+$(u).length)):s&&Io&&Io.lineWise&&Io.text.join("\n")==e&&(d=m=te(d.line,0)));var v={from:d,to:m,text:c?c[p%c.length]:u,origin:i||(s?"paste":t.state.cutIncoming>o?"cut":"+input")};ca(t.doc,v),un(t,"inputRead",t,v)}e&&!s&&Lo(t,e),Rr(t),t.curOp.updateInput<2&&(t.curOp.updateInput=h),t.curOp.typing=!0,t.state.pasteIncoming=t.state.cutIncoming=-1}function ko(t,e){var n=t.clipboardData&&t.clipboardData.getData("Text");if(n)return t.preventDefault(),e.isReadOnly()||e.options.disableInput||Qr(e,(function(){return Oo(e,n,0,null,"paste")})),!0}function Lo(t,e){if(t.options.electricChars&&t.options.smartIndent)for(var n=t.doc.sel,r=n.ranges.length-1;r>=0;r--){var i=n.ranges[r];if(!(i.head.ch>100||r&&n.ranges[r-1].head.line==i.head.line)){var a=t.getModeAt(i.head),o=!1;if(a.electricChars){for(var s=0;s<a.electricChars.length;s++)if(e.indexOf(a.electricChars.charAt(s))>-1){o=No(t,i.head.line,"smart");break}}else a.electricInput&&a.electricInput.test(qt(t.doc,i.head.line).text.slice(0,i.head.ch))&&(o=No(t,i.head.line,"smart"));o&&un(t,"electricInput",t,i.head.line)}}}function Do(t){for(var e=[],n=[],r=0;r<t.doc.sel.ranges.length;r++){var i=t.doc.sel.ranges[r].head.line,a={anchor:te(i,0),head:te(i+1,0)};n.push(a),e.push(t.getRange(a.anchor,a.head))}return{text:e,ranges:n}}function Po(t,e,n,r){t.setAttribute("autocorrect",n?"":"off"),t.setAttribute("autocapitalize",r?"":"off"),t.setAttribute("spellcheck",!!e)}function Fo(){var t=N("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none"),e=N("div",[t],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return u?t.style.width="1000px":t.setAttribute("wrap","off"),m&&(t.style.border="1px solid black"),Po(t),e}function Bo(t,e,n,r,i){var a=e,o=n,s=qt(t,e.line),u=i&&"rtl"==t.direction?-n:n;function c(r){var a,o;if(null==(a=i?function(t,e,n,r){var i=ct(e,t.doc.direction);if(!i)return Za(e,n,r);n.ch>=e.text.length?(n.ch=e.text.length,n.sticky="before"):n.ch<=0&&(n.ch=0,n.sticky="after");var a=st(i,n.ch,n.sticky),o=i[a];if("ltr"==t.doc.direction&&o.level%2==0&&(r>0?o.to>n.ch:o.from<n.ch))return Za(e,n,r);var s,u=function(t,n){return Ja(e,t instanceof te?t.ch:t,n)},c=function(n){return t.options.lineWrapping?(s=s||On(t,e),Zn(t,e,s,n)):{begin:0,end:e.text.length}},l=c("before"==n.sticky?u(n,-1):n.ch);if("rtl"==t.doc.direction||1==o.level){var h=1==o.level==r<0,p=u(n,h?1:-1);if(null!=p&&(h?p<=o.to&&p<=l.end:p>=o.from&&p>=l.begin)){var f=h?"before":"after";return new te(n.line,p,f)}}var d=function(t,e,r){for(var a=function(t,e){return e?new te(n.line,u(t,1),"before"):new te(n.line,t,"after")};t>=0&&t<i.length;t+=e){var o=i[t],s=e>0==(1!=o.level),c=s?r.begin:u(r.end,-1);if(o.from<=c&&c<o.to)return a(c,s);if(c=s?o.from:u(o.to,-1),r.begin<=c&&c<r.end)return a(c,s)}},m=d(a+r,r,l);if(m)return m;var v=r>0?l.end:u(l.begin,-1);return null==v||r>0&&v==e.text.length||!(m=d(r>0?0:i.length-1,r,c(v)))?null:m}(t.cm,s,e,n):Za(s,e,n))){if(r||(o=e.line+u)<t.first||o>=t.first+t.size||(e=new te(o,e.ch,e.sticky),!(s=qt(t,o))))return!1;e=Qa(i,t.cm,s,e.line,u)}else e=a;return!0}if("char"==r)c();else if("column"==r)c(!0);else if("word"==r||"group"==r)for(var l=null,h="group"==r,p=t.cm&&t.cm.getHelper(e,"wordChars"),f=!0;!(n<0)||c(!f);f=!1){var d=s.text.charAt(e.ch)||"\n",m=tt(d,p)?"w":h&&"\n"==d?"n":!h||/\s/.test(d)?null:"p";if(!h||f||m||(m="s"),l&&l!=m){n<0&&(n=1,c(),e.sticky="after");break}if(m&&(l=m),n>0&&!c(!f))break}var v=aa(t,e,a,o,!0);return ne(a,v)&&(v.hitSide=!0),v}function zo(t,e,n,r){var i,a,o=t.doc,s=e.left;if("page"==r){var u=Math.min(t.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),c=Math.max(u-.5*rr(t.display),3);i=(n>0?e.bottom:e.top)+n*c}else"line"==r&&(i=n>0?e.bottom+3:e.top-3);for(;(a=Kn(t,s,i)).outside;){if(n<0?i<=0:i>=o.height){a.hitSide=!0;break}i+=5*n}return a}var Uo=function(t){this.cm=t,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new z,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};function jo(t,e){var n=Rn(t,e.line);if(!n||n.hidden)return null;var r=qt(t.doc,e.line),i=Nn(n,r,e.line),a=ct(r,t.doc.direction),o="left";a&&(o=st(a,e.ch)%2?"right":"left");var s=Pn(i.map,e.ch,o);return s.offset="right"==s.collapse?s.end:s.start,s}function Wo(t,e){return e&&(t.bad=!0),t}function Vo(t,e,n){var r;if(e==t.display.lineDiv){if(!(r=t.display.lineDiv.childNodes[n]))return Wo(t.clipPos(te(t.display.viewTo-1)),!0);e=null,n=0}else for(r=e;;r=r.parentNode){if(!r||r==t.display.lineDiv)return null;if(r.parentNode&&r.parentNode==t.display.lineDiv)break}for(var i=0;i<t.display.view.length;i++){var a=t.display.view[i];if(a.node==r)return Ho(a,e,n)}}function Ho(t,e,n){var r=t.text.firstChild,i=!1;if(!e||!R(r,e))return Wo(te(Kt(t.line),0),!0);if(e==r&&(i=!0,e=r.childNodes[n],n=0,!e)){var a=t.rest?$(t.rest):t.line;return Wo(te(Kt(a),a.text.length),i)}var o=3==e.nodeType?e:null,s=e;for(o||1!=e.childNodes.length||3!=e.firstChild.nodeType||(o=e.firstChild,n&&(n=o.nodeValue.length));s.parentNode!=r;)s=s.parentNode;var u=t.measure,c=u.maps;function l(e,n,r){for(var i=-1;i<(c?c.length:0);i++)for(var a=i<0?u.map:c[i],o=0;o<a.length;o+=3){var s=a[o+2];if(s==e||s==n){var l=Kt(i<0?t.line:t.rest[i]),h=a[o]+r;return(r<0||s!=e)&&(h=a[o+(r?1:0)]),te(l,h)}}}var h=l(o,s,n);if(h)return Wo(h,i);for(var p=s.nextSibling,f=o?o.nodeValue.length-n:0;p;p=p.nextSibling){if(h=l(p,p.firstChild,0))return Wo(te(h.line,h.ch-f),i);f+=p.textContent.length}for(var d=s.previousSibling,m=n;d;d=d.previousSibling){if(h=l(d,d.firstChild,-1))return Wo(te(h.line,h.ch+m),i);m+=d.textContent.length}}Uo.prototype.init=function(t){var e=this,n=this,r=n.cm,i=n.div=t.lineDiv;function a(t){if(!mt(r,t)){if(r.somethingSelected())Ro({lineWise:!1,text:r.getSelections()}),"cut"==t.type&&r.replaceSelection("",null,"cut");else{if(!r.options.lineWiseCopyCut)return;var e=Do(r);Ro({lineWise:!0,text:e.text}),"cut"==t.type&&r.operation((function(){r.setSelections(e.ranges,0,W),r.replaceSelection("",null,"cut")}))}if(t.clipboardData){t.clipboardData.clearData();var a=Io.text.join("\n");if(t.clipboardData.setData("Text",a),t.clipboardData.getData("Text")==a)return void t.preventDefault()}var o=Fo(),s=o.firstChild;r.display.lineSpace.insertBefore(o,r.display.lineSpace.firstChild),s.value=Io.text.join("\n");var u=document.activeElement;D(s),setTimeout((function(){r.display.lineSpace.removeChild(o),u.focus(),u==i&&n.showPrimarySelection()}),50)}}Po(i,r.options.spellcheck,r.options.autocorrect,r.options.autocapitalize),ht(i,"paste",(function(t){mt(r,t)||ko(t,r)||s<=11&&setTimeout(ti(r,(function(){return e.updateFromDOM()})),20)})),ht(i,"compositionstart",(function(t){e.composing={data:t.data,done:!1}})),ht(i,"compositionupdate",(function(t){e.composing||(e.composing={data:t.data,done:!1})})),ht(i,"compositionend",(function(t){e.composing&&(t.data!=e.composing.data&&e.readFromDOMSoon(),e.composing.done=!0)})),ht(i,"touchstart",(function(){return n.forceCompositionEnd()})),ht(i,"input",(function(){e.composing||e.readFromDOMSoon()})),ht(i,"copy",a),ht(i,"cut",a)},Uo.prototype.screenReaderLabelChanged=function(t){t?this.div.setAttribute("aria-label",t):this.div.removeAttribute("aria-label")},Uo.prototype.prepareSelection=function(){var t=gr(this.cm,!1);return t.focus=document.activeElement==this.div,t},Uo.prototype.showSelection=function(t,e){t&&this.cm.display.view.length&&((t.focus||e)&&this.showPrimarySelection(),this.showMultipleSelections(t))},Uo.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},Uo.prototype.showPrimarySelection=function(){var t=this.getSelection(),e=this.cm,r=e.doc.sel.primary(),i=r.from(),a=r.to();if(e.display.viewTo==e.display.viewFrom||i.line>=e.display.viewTo||a.line<e.display.viewFrom)t.removeAllRanges();else{var o=Vo(e,t.anchorNode,t.anchorOffset),s=Vo(e,t.focusNode,t.focusOffset);if(!o||o.bad||!s||s.bad||0!=ee(ae(o,s),i)||0!=ee(ie(o,s),a)){var u=e.display.view,c=i.line>=e.display.viewFrom&&jo(e,i)||{node:u[0].measure.map[2],offset:0},l=a.line<e.display.viewTo&&jo(e,a);if(!l){var h=u[u.length-1].measure,p=h.maps?h.maps[h.maps.length-1]:h.map;l={node:p[p.length-1],offset:p[p.length-2]-p[p.length-3]}}if(c&&l){var f,d=t.rangeCount&&t.getRangeAt(0);try{f=E(c.node,c.offset,l.offset,l.node)}catch(t){}f&&(!n&&e.state.focused?(t.collapse(c.node,c.offset),f.collapsed||(t.removeAllRanges(),t.addRange(f))):(t.removeAllRanges(),t.addRange(f)),d&&null==t.anchorNode?t.addRange(d):n&&this.startGracePeriod()),this.rememberSelection()}else t.removeAllRanges()}}},Uo.prototype.startGracePeriod=function(){var t=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout((function(){t.gracePeriod=!1,t.selectionChanged()&&t.cm.operation((function(){return t.cm.curOp.selectionChanged=!0}))}),20)},Uo.prototype.showMultipleSelections=function(t){A(this.cm.display.cursorDiv,t.cursors),A(this.cm.display.selectionDiv,t.selection)},Uo.prototype.rememberSelection=function(){var t=this.getSelection();this.lastAnchorNode=t.anchorNode,this.lastAnchorOffset=t.anchorOffset,this.lastFocusNode=t.focusNode,this.lastFocusOffset=t.focusOffset},Uo.prototype.selectionInEditor=function(){var t=this.getSelection();if(!t.rangeCount)return!1;var e=t.getRangeAt(0).commonAncestorContainer;return R(this.div,e)},Uo.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()&&document.activeElement==this.div||this.showSelection(this.prepareSelection(),!0),this.div.focus())},Uo.prototype.blur=function(){this.div.blur()},Uo.prototype.getField=function(){return this.div},Uo.prototype.supportsTouch=function(){return!0},Uo.prototype.receivedFocus=function(){var t=this;this.selectionInEditor()?this.pollSelection():Qr(this.cm,(function(){return t.cm.curOp.selectionChanged=!0})),this.polling.set(this.cm.options.pollInterval,(function e(){t.cm.state.focused&&(t.pollSelection(),t.polling.set(t.cm.options.pollInterval,e))}))},Uo.prototype.selectionChanged=function(){var t=this.getSelection();return t.anchorNode!=this.lastAnchorNode||t.anchorOffset!=this.lastAnchorOffset||t.focusNode!=this.lastFocusNode||t.focusOffset!=this.lastFocusOffset},Uo.prototype.pollSelection=function(){if(null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()){var t=this.getSelection(),e=this.cm;if(v&&l&&this.cm.display.gutterSpecs.length&&function(t){for(var e=t;e;e=e.parentNode)if(/CodeMirror-gutter-wrapper/.test(e.className))return!0;return!1}(t.anchorNode))return this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),void this.focus();if(!this.composing){this.rememberSelection();var n=Vo(e,t.anchorNode,t.anchorOffset),r=Vo(e,t.focusNode,t.focusOffset);n&&r&&Qr(e,(function(){Qi(e.doc,Ei(n,r),W),(n.bad||r.bad)&&(e.curOp.selectionChanged=!0)}))}}},Uo.prototype.pollContent=function(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var t,e,n,r=this.cm,i=r.display,a=r.doc.sel.primary(),o=a.from(),s=a.to();if(0==o.ch&&o.line>r.firstLine()&&(o=te(o.line-1,qt(r.doc,o.line-1).length)),s.ch==qt(r.doc,s.line).text.length&&s.line<r.lastLine()&&(s=te(s.line+1,0)),o.line<i.viewFrom||s.line>i.viewTo-1)return!1;o.line==i.viewFrom||0==(t=lr(r,o.line))?(e=Kt(i.view[0].line),n=i.view[0].node):(e=Kt(i.view[t].line),n=i.view[t-1].node.nextSibling);var u,c,l=lr(r,s.line);if(l==i.view.length-1?(u=i.viewTo-1,c=i.lineDiv.lastChild):(u=Kt(i.view[l+1].line)-1,c=i.view[l+1].node.previousSibling),!n)return!1;for(var h=r.doc.splitLines(function(t,e,n,r,i){var a="",o=!1,s=t.doc.lineSeparator(),u=!1;function c(){o&&(a+=s,u&&(a+=s),o=u=!1)}function l(t){t&&(c(),a+=t)}function h(e){if(1==e.nodeType){var n=e.getAttribute("cm-text");if(n)return void l(n);var a,p=e.getAttribute("cm-marker");if(p){var f=t.findMarks(te(r,0),te(i+1,0),(v=+p,function(t){return t.id==v}));return void(f.length&&(a=f[0].find(0))&&l(Xt(t.doc,a.from,a.to).join(s)))}if("false"==e.getAttribute("contenteditable"))return;var d=/^(pre|div|p|li|table|br)$/i.test(e.nodeName);if(!/^br$/i.test(e.nodeName)&&0==e.textContent.length)return;d&&c();for(var m=0;m<e.childNodes.length;m++)h(e.childNodes[m]);/^(pre|p)$/i.test(e.nodeName)&&(u=!0),d&&(o=!0)}else 3==e.nodeType&&l(e.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "));var v}for(;h(e),e!=n;)e=e.nextSibling,u=!1;return a}(r,n,c,e,u)),p=Xt(r.doc,te(e,0),te(u,qt(r.doc,u).text.length));h.length>1&&p.length>1;)if($(h)==$(p))h.pop(),p.pop(),u--;else{if(h[0]!=p[0])break;h.shift(),p.shift(),e++}for(var f=0,d=0,m=h[0],v=p[0],g=Math.min(m.length,v.length);f<g&&m.charCodeAt(f)==v.charCodeAt(f);)++f;for(var y=$(h),x=$(p),b=Math.min(y.length-(1==h.length?f:0),x.length-(1==p.length?f:0));d<b&&y.charCodeAt(y.length-d-1)==x.charCodeAt(x.length-d-1);)++d;if(1==h.length&&1==p.length&&e==o.line)for(;f&&f>o.ch&&y.charCodeAt(y.length-d-1)==x.charCodeAt(x.length-d-1);)f--,d++;h[h.length-1]=y.slice(0,y.length-d).replace(/^\u200b+/,""),h[0]=h[0].slice(f).replace(/\u200b+$/,"");var w=te(e,f),_=te(u,p.length?$(p).length-d:0);return h.length>1||h[0]||ee(w,_)?(da(r.doc,h,w,_,"+input"),!0):void 0},Uo.prototype.ensurePolled=function(){this.forceCompositionEnd()},Uo.prototype.reset=function(){this.forceCompositionEnd()},Uo.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},Uo.prototype.readFromDOMSoon=function(){var t=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout((function(){if(t.readDOMTimeout=null,t.composing){if(!t.composing.done)return;t.composing=null}t.updateFromDOM()}),80))},Uo.prototype.updateFromDOM=function(){var t=this;!this.cm.isReadOnly()&&this.pollContent()||Qr(this.cm,(function(){return hr(t.cm)}))},Uo.prototype.setUneditable=function(t){t.contentEditable="false"},Uo.prototype.onKeyPress=function(t){0==t.charCode||this.composing||(t.preventDefault(),this.cm.isReadOnly()||ti(this.cm,Oo)(this.cm,String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),0))},Uo.prototype.readOnlyChanged=function(t){this.div.contentEditable=String("nocursor"!=t)},Uo.prototype.onContextMenu=function(){},Uo.prototype.resetPosition=function(){},Uo.prototype.needsContentAttribute=!0;var Go=function(t){this.cm=t,this.prevInput="",this.pollingFast=!1,this.polling=new z,this.hasSelection=!1,this.composing=null};Go.prototype.init=function(t){var e=this,n=this,r=this.cm;this.createField(t);var i=this.textarea;function a(t){if(!mt(r,t)){if(r.somethingSelected())Ro({lineWise:!1,text:r.getSelections()});else{if(!r.options.lineWiseCopyCut)return;var e=Do(r);Ro({lineWise:!0,text:e.text}),"cut"==t.type?r.setSelections(e.ranges,null,W):(n.prevInput="",i.value=e.text.join("\n"),D(i))}"cut"==t.type&&(r.state.cutIncoming=+new Date)}}t.wrapper.insertBefore(this.wrapper,t.wrapper.firstChild),m&&(i.style.width="0px"),ht(i,"input",(function(){o&&s>=9&&e.hasSelection&&(e.hasSelection=null),n.poll()})),ht(i,"paste",(function(t){mt(r,t)||ko(t,r)||(r.state.pasteIncoming=+new Date,n.fastPoll())})),ht(i,"cut",a),ht(i,"copy",a),ht(t.scroller,"paste",(function(e){if(!_n(t,e)&&!mt(r,e)){if(!i.dispatchEvent)return r.state.pasteIncoming=+new Date,void n.focus();var a=new Event("paste");a.clipboardData=e.clipboardData,i.dispatchEvent(a)}})),ht(t.lineSpace,"selectstart",(function(e){_n(t,e)||xt(e)})),ht(i,"compositionstart",(function(){var t=r.getCursor("from");n.composing&&n.composing.range.clear(),n.composing={start:t,range:r.markText(t,r.getCursor("to"),{className:"CodeMirror-composing"})}})),ht(i,"compositionend",(function(){n.composing&&(n.poll(),n.composing.range.clear(),n.composing=null)}))},Go.prototype.createField=function(t){this.wrapper=Fo(),this.textarea=this.wrapper.firstChild},Go.prototype.screenReaderLabelChanged=function(t){t?this.textarea.setAttribute("aria-label",t):this.textarea.removeAttribute("aria-label")},Go.prototype.prepareSelection=function(){var t=this.cm,e=t.display,n=t.doc,r=gr(t);if(t.options.moveInputWithCursor){var i=Xn(t,n.sel.primary().head,"div"),a=e.wrapper.getBoundingClientRect(),o=e.lineDiv.getBoundingClientRect();r.teTop=Math.max(0,Math.min(e.wrapper.clientHeight-10,i.top+o.top-a.top)),r.teLeft=Math.max(0,Math.min(e.wrapper.clientWidth-10,i.left+o.left-a.left))}return r},Go.prototype.showSelection=function(t){var e=this.cm.display;A(e.cursorDiv,t.cursors),A(e.selectionDiv,t.selection),null!=t.teTop&&(this.wrapper.style.top=t.teTop+"px",this.wrapper.style.left=t.teLeft+"px")},Go.prototype.reset=function(t){if(!this.contextMenuPending&&!this.composing){var e=this.cm;if(e.somethingSelected()){this.prevInput="";var n=e.getSelection();this.textarea.value=n,e.state.focused&&D(this.textarea),o&&s>=9&&(this.hasSelection=n)}else t||(this.prevInput=this.textarea.value="",o&&s>=9&&(this.hasSelection=null))}},Go.prototype.getField=function(){return this.textarea},Go.prototype.supportsTouch=function(){return!1},Go.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!g||O()!=this.textarea))try{this.textarea.focus()}catch(t){}},Go.prototype.blur=function(){this.textarea.blur()},Go.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},Go.prototype.receivedFocus=function(){this.slowPoll()},Go.prototype.slowPoll=function(){var t=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,(function(){t.poll(),t.cm.state.focused&&t.slowPoll()}))},Go.prototype.fastPoll=function(){var t=!1,e=this;e.pollingFast=!0,e.polling.set(20,(function n(){e.poll()||t?(e.pollingFast=!1,e.slowPoll()):(t=!0,e.polling.set(60,n))}))},Go.prototype.poll=function(){var t=this,e=this.cm,n=this.textarea,r=this.prevInput;if(this.contextMenuPending||!e.state.focused||Ot(n)&&!r&&!this.composing||e.isReadOnly()||e.options.disableInput||e.state.keySeq)return!1;var i=n.value;if(i==r&&!e.somethingSelected())return!1;if(o&&s>=9&&this.hasSelection===i||y&&/[\uf700-\uf7ff]/.test(i))return e.display.input.reset(),!1;if(e.doc.sel==e.display.selForContextMenu){var a=i.charCodeAt(0);if(8203!=a||r||(r="​"),8666==a)return this.reset(),this.cm.execCommand("undo")}for(var u=0,c=Math.min(r.length,i.length);u<c&&r.charCodeAt(u)==i.charCodeAt(u);)++u;return Qr(e,(function(){Oo(e,i.slice(u),r.length-u,null,t.composing?"*compose":null),i.length>1e3||i.indexOf("\n")>-1?n.value=t.prevInput="":t.prevInput=i,t.composing&&(t.composing.range.clear(),t.composing.range=e.markText(t.composing.start,e.getCursor("to"),{className:"CodeMirror-composing"}))})),!0},Go.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},Go.prototype.onKeyPress=function(){o&&s>=9&&(this.hasSelection=null),this.fastPoll()},Go.prototype.onContextMenu=function(t){var e=this,n=e.cm,r=n.display,i=e.textarea;e.contextMenuPending&&e.contextMenuPending();var a=cr(n,t),c=r.scroller.scrollTop;if(a&&!h){n.options.resetSelectionOnContextMenu&&-1==n.doc.sel.contains(a)&&ti(n,Qi)(n.doc,Ei(a),W);var l,p=i.style.cssText,f=e.wrapper.style.cssText,d=e.wrapper.offsetParent.getBoundingClientRect();if(e.wrapper.style.cssText="position: static",i.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(t.clientY-d.top-5)+"px; left: "+(t.clientX-d.left-5)+"px;\n      z-index: 1000; background: "+(o?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",u&&(l=window.scrollY),r.input.focus(),u&&window.scrollTo(null,l),r.input.reset(),n.somethingSelected()||(i.value=e.prevInput=" "),e.contextMenuPending=g,r.selForContextMenu=n.doc.sel,clearTimeout(r.detectingSelectAll),o&&s>=9&&v(),S){_t(t);var m=function(){ft(window,"mouseup",m),setTimeout(g,20)};ht(window,"mouseup",m)}else setTimeout(g,50)}function v(){if(null!=i.selectionStart){var t=n.somethingSelected(),a="​"+(t?i.value:"");i.value="⇚",i.value=a,e.prevInput=t?"":"​",i.selectionStart=1,i.selectionEnd=a.length,r.selForContextMenu=n.doc.sel}}function g(){if(e.contextMenuPending==g&&(e.contextMenuPending=!1,e.wrapper.style.cssText=f,i.style.cssText=p,o&&s<9&&r.scrollbars.setScrollTop(r.scroller.scrollTop=c),null!=i.selectionStart)){(!o||o&&s<9)&&v();var t=0,a=function(){r.selForContextMenu==n.doc.sel&&0==i.selectionStart&&i.selectionEnd>0&&"​"==e.prevInput?ti(n,sa)(n):t++<10?r.detectingSelectAll=setTimeout(a,500):(r.selForContextMenu=null,r.input.reset())};r.detectingSelectAll=setTimeout(a,200)}}},Go.prototype.readOnlyChanged=function(t){t||this.reset(),this.textarea.disabled="nocursor"==t},Go.prototype.setUneditable=function(){},Go.prototype.needsContentAttribute=!1,function(t){var e=t.optionHandlers;function n(n,r,i,a){t.defaults[n]=r,i&&(e[n]=a?function(t,e,n){n!=_o&&i(t,e,n)}:i)}t.defineOption=n,t.Init=_o,n("value","",(function(t,e){return t.setValue(e)}),!0),n("mode",null,(function(t,e){t.doc.modeOption=e,Ii(t)}),!0),n("indentUnit",2,Ii,!0),n("indentWithTabs",!1),n("smartIndent",!0),n("tabSize",4,(function(t){Ri(t),Un(t),hr(t)}),!0),n("lineSeparator",null,(function(t,e){if(t.doc.lineSep=e,e){var n=[],r=t.doc.first;t.doc.iter((function(t){for(var i=0;;){var a=t.text.indexOf(e,i);if(-1==a)break;i=a+e.length,n.push(te(r,a))}r++}));for(var i=n.length-1;i>=0;i--)da(t.doc,e,n[i],te(n[i].line,n[i].ch+e.length))}})),n("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b-\u200f\u2028\u2029\ufeff\ufff9-\ufffc]/g,(function(t,e,n){t.state.specialChars=new RegExp(e.source+(e.test("\t")?"":"|\t"),"g"),n!=_o&&t.refresh()})),n("specialCharPlaceholder",Ze,(function(t){return t.refresh()}),!0),n("electricChars",!0),n("inputStyle",g?"contenteditable":"textarea",(function(){throw new Error("inputStyle can not (yet) be changed in a running editor")}),!0),n("spellcheck",!1,(function(t,e){return t.getInputField().spellcheck=e}),!0),n("autocorrect",!1,(function(t,e){return t.getInputField().autocorrect=e}),!0),n("autocapitalize",!1,(function(t,e){return t.getInputField().autocapitalize=e}),!0),n("rtlMoveVisually",!b),n("wholeLineUpdateBefore",!0),n("theme","default",(function(t){wo(t),mi(t)}),!0),n("keyMap","default",(function(t,e,n){var r=Ya(e),i=n!=_o&&Ya(n);i&&i.detach&&i.detach(t,r),r.attach&&r.attach(t,i||null)})),n("extraKeys",null),n("configureMouse",null),n("lineWrapping",!1,To,!0),n("gutters",[],(function(t,e){t.display.gutterSpecs=fi(e,t.options.lineNumbers),mi(t)}),!0),n("fixedGutter",!0,(function(t,e){t.display.gutters.style.left=e?or(t.display)+"px":"0",t.refresh()}),!0),n("coverGutterNextToScrollbar",!1,(function(t){return jr(t)}),!0),n("scrollbarStyle","native",(function(t){Hr(t),jr(t),t.display.scrollbars.setScrollTop(t.doc.scrollTop),t.display.scrollbars.setScrollLeft(t.doc.scrollLeft)}),!0),n("lineNumbers",!1,(function(t,e){t.display.gutterSpecs=fi(t.options.gutters,e),mi(t)}),!0),n("firstLineNumber",1,mi,!0),n("lineNumberFormatter",(function(t){return t}),mi,!0),n("showCursorWhenSelecting",!1,vr,!0),n("resetSelectionOnContextMenu",!0),n("lineWiseCopyCut",!0),n("pasteLinesPerSelection",!0),n("selectionsMayTouch",!1),n("readOnly",!1,(function(t,e){"nocursor"==e&&(Er(t),t.display.input.blur()),t.display.input.readOnlyChanged(e)})),n("screenReaderLabel",null,(function(t,e){e=""===e?null:e,t.display.input.screenReaderLabelChanged(e)})),n("disableInput",!1,(function(t,e){e||t.display.input.reset()}),!0),n("dragDrop",!0,Eo),n("allowDropFileTypes",null),n("cursorBlinkRate",530),n("cursorScrollMargin",0),n("cursorHeight",1,vr,!0),n("singleCursorHeightPerLine",!0,vr,!0),n("workTime",100),n("workDelay",100),n("flattenSpans",!0,Ri,!0),n("addModeClass",!1,Ri,!0),n("pollInterval",100),n("undoDepth",200,(function(t,e){return t.doc.history.undoDepth=e})),n("historyEventDelay",1250),n("viewportMargin",10,(function(t){return t.refresh()}),!0),n("maxHighlightLength",1e4,Ri,!0),n("moveInputWithCursor",!0,(function(t,e){e||t.display.input.resetPosition()})),n("tabindex",null,(function(t,e){return t.display.input.getField().tabIndex=e||""})),n("autofocus",null),n("direction","ltr",(function(t,e){return t.doc.setDirection(e)}),!0),n("phrases",null)}(Co),function(t){var e=t.optionHandlers,n=t.helpers={};t.prototype={constructor:t,focus:function(){window.focus(),this.display.input.focus()},setOption:function(t,n){var r=this.options,i=r[t];r[t]==n&&"mode"!=t||(r[t]=n,e.hasOwnProperty(t)&&ti(this,e[t])(this,n,i),dt(this,"optionChange",this,t))},getOption:function(t){return this.options[t]},getDoc:function(){return this.doc},addKeyMap:function(t,e){this.state.keyMaps[e?"push":"unshift"](Ya(t))},removeKeyMap:function(t){for(var e=this.state.keyMaps,n=0;n<e.length;++n)if(e[n]==t||e[n].name==t)return e.splice(n,1),!0},addOverlay:ei((function(e,n){var r=e.token?e:t.getMode(this.options,e);if(r.startState)throw new Error("Overlays may not be stateful.");!function(t,e,n){for(var r=0,i=n(e);r<t.length&&n(t[r])<=i;)r++;t.splice(r,0,e)}(this.state.overlays,{mode:r,modeSpec:e,opaque:n&&n.opaque,priority:n&&n.priority||0},(function(t){return t.priority})),this.state.modeGen++,hr(this)})),removeOverlay:ei((function(t){for(var e=this.state.overlays,n=0;n<e.length;++n){var r=e[n].modeSpec;if(r==t||"string"==typeof t&&r.name==t)return e.splice(n,1),this.state.modeGen++,void hr(this)}})),indentLine:ei((function(t,e,n){"string"!=typeof e&&"number"!=typeof e&&(e=null==e?this.options.smartIndent?"smart":"prev":e?"add":"subtract"),Zt(this.doc,t)&&No(this,t,e,n)})),indentSelection:ei((function(t){for(var e=this.doc.sel.ranges,n=-1,r=0;r<e.length;r++){var i=e[r];if(i.empty())i.head.line>n&&(No(this,i.head.line,t,!0),n=i.head.line,r==this.doc.sel.primIndex&&Rr(this));else{var a=i.from(),o=i.to(),s=Math.max(n,a.line);n=Math.min(this.lastLine(),o.line-(o.ch?0:1))+1;for(var u=s;u<n;++u)No(this,u,t);var c=this.doc.sel.ranges;0==a.ch&&e.length==c.length&&c[r].from().ch>0&&Ki(this.doc,r,new Si(a,c[r].to()),W)}}})),getTokenAt:function(t,e){return ye(this,t,e)},getLineTokens:function(t,e){return ye(this,te(t),e,!0)},getTokenTypeAt:function(t){t=se(this.doc,t);var e,n=pe(this,qt(this.doc,t.line)),r=0,i=(n.length-1)/2,a=t.ch;if(0==a)e=n[2];else for(;;){var o=r+i>>1;if((o?n[2*o-1]:0)>=a)i=o;else{if(!(n[2*o+1]<a)){e=n[2*o+2];break}r=o+1}}var s=e?e.indexOf("overlay "):-1;return s<0?e:0==s?null:e.slice(0,s-1)},getModeAt:function(e){var n=this.doc.mode;return n.innerMode?t.innerMode(n,this.getTokenAt(e).state).mode:n},getHelper:function(t,e){return this.getHelpers(t,e)[0]},getHelpers:function(t,e){var r=[];if(!n.hasOwnProperty(e))return r;var i=n[e],a=this.getModeAt(t);if("string"==typeof a[e])i[a[e]]&&r.push(i[a[e]]);else if(a[e])for(var o=0;o<a[e].length;o++){var s=i[a[e][o]];s&&r.push(s)}else a.helperType&&i[a.helperType]?r.push(i[a.helperType]):i[a.name]&&r.push(i[a.name]);for(var u=0;u<i._global.length;u++){var c=i._global[u];c.pred(a,this)&&-1==U(r,c.val)&&r.push(c.val)}return r},getStateAfter:function(t,e){var n=this.doc;return fe(this,(t=oe(n,null==t?n.first+n.size-1:t))+1,e).state},cursorCoords:function(t,e){var n=this.doc.sel.primary();return Xn(this,null==t?n.head:"object"==typeof t?se(this.doc,t):t?n.from():n.to(),e||"page")},charCoords:function(t,e){return qn(this,se(this.doc,t),e||"page")},coordsChar:function(t,e){return Kn(this,(t=Gn(this,t,e||"page")).left,t.top)},lineAtHeight:function(t,e){return t=Gn(this,{top:t,left:0},e||"page").top,Jt(this.doc,t+this.display.viewOffset)},heightAtLine:function(t,e,n){var r,i=!1;if("number"==typeof t){var a=this.doc.first+this.doc.size-1;t<this.doc.first?t=this.doc.first:t>a&&(t=a,i=!0),r=qt(this.doc,t)}else r=t;return Hn(this,r,{top:0,left:0},e||"page",n||i).top+(i?this.doc.height-Ve(r):0)},defaultTextHeight:function(){return rr(this.display)},defaultCharWidth:function(){return ir(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(t,e,n,r,i){var a,o,s,u=this.display,c=(t=Xn(this,se(this.doc,t))).bottom,l=t.left;if(e.style.position="absolute",e.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(e),u.sizer.appendChild(e),"over"==r)c=t.top;else if("above"==r||"near"==r){var h=Math.max(u.wrapper.clientHeight,this.doc.height),p=Math.max(u.sizer.clientWidth,u.lineSpace.clientWidth);("above"==r||t.bottom+e.offsetHeight>h)&&t.top>e.offsetHeight?c=t.top-e.offsetHeight:t.bottom+e.offsetHeight<=h&&(c=t.bottom),l+e.offsetWidth>p&&(l=p-e.offsetWidth)}e.style.top=c+"px",e.style.left=e.style.right="","right"==i?(l=u.sizer.clientWidth-e.offsetWidth,e.style.right="0px"):("left"==i?l=0:"middle"==i&&(l=(u.sizer.clientWidth-e.offsetWidth)/2),e.style.left=l+"px"),n&&(a=this,o={left:l,top:c,right:l+e.offsetWidth,bottom:c+e.offsetHeight},null!=(s=Nr(a,o)).scrollTop&&Dr(a,s.scrollTop),null!=s.scrollLeft&&Fr(a,s.scrollLeft))},triggerOnKeyDown:ei(co),triggerOnKeyPress:ei(ho),triggerOnKeyUp:lo,triggerOnMouseDown:ei(vo),execCommand:function(t){if(to.hasOwnProperty(t))return to[t].call(null,this)},triggerElectric:ei((function(t){Lo(this,t)})),findPosH:function(t,e,n,r){var i=1;e<0&&(i=-1,e=-e);for(var a=se(this.doc,t),o=0;o<e&&!(a=Bo(this.doc,a,i,n,r)).hitSide;++o);return a},moveH:ei((function(t,e){var n=this;this.extendSelectionsBy((function(r){return n.display.shift||n.doc.extend||r.empty()?Bo(n.doc,r.head,t,e,n.options.rtlMoveVisually):t<0?r.from():r.to()}),H)})),deleteH:ei((function(t,e){var n=this.doc.sel,r=this.doc;n.somethingSelected()?r.replaceSelection("",null,"+delete"):Ka(this,(function(n){var i=Bo(r,n.head,t,e,!1);return t<0?{from:i,to:n.head}:{from:n.head,to:i}}))})),findPosV:function(t,e,n,r){var i=1,a=r;e<0&&(i=-1,e=-e);for(var o=se(this.doc,t),s=0;s<e;++s){var u=Xn(this,o,"div");if(null==a?a=u.left:u.left=a,(o=zo(this,u,i,n)).hitSide)break}return o},moveV:ei((function(t,e){var n=this,r=this.doc,i=[],a=!this.display.shift&&!r.extend&&r.sel.somethingSelected();if(r.extendSelectionsBy((function(o){if(a)return t<0?o.from():o.to();var s=Xn(n,o.head,"div");null!=o.goalColumn&&(s.left=o.goalColumn),i.push(s.left);var u=zo(n,s,t,e);return"page"==e&&o==r.sel.primary()&&Ir(n,qn(n,u,"div").top-s.top),u}),H),i.length)for(var o=0;o<r.sel.ranges.length;o++)r.sel.ranges[o].goalColumn=i[o]})),findWordAt:function(t){var e=qt(this.doc,t.line).text,n=t.ch,r=t.ch;if(e){var i=this.getHelper(t,"wordChars");"before"!=t.sticky&&r!=e.length||!n?++r:--n;for(var a=e.charAt(n),o=tt(a,i)?function(t){return tt(t,i)}:/\s/.test(a)?function(t){return/\s/.test(t)}:function(t){return!/\s/.test(t)&&!tt(t)};n>0&&o(e.charAt(n-1));)--n;for(;r<e.length&&o(e.charAt(r));)++r}return new Si(te(t.line,n),te(t.line,r))},toggleOverwrite:function(t){null!=t&&t==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?k(this.display.cursorDiv,"CodeMirror-overwrite"):T(this.display.cursorDiv,"CodeMirror-overwrite"),dt(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==O()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:ei((function(t,e){Or(this,t,e)})),getScrollInfo:function(){var t=this.display.scroller;return{left:t.scrollLeft,top:t.scrollTop,height:t.scrollHeight-Tn(this)-this.display.barHeight,width:t.scrollWidth-Tn(this)-this.display.barWidth,clientHeight:An(this),clientWidth:Cn(this)}},scrollIntoView:ei((function(t,e){null==t?(t={from:this.doc.sel.primary().head,to:null},null==e&&(e=this.options.cursorScrollMargin)):"number"==typeof t?t={from:te(t,0),to:null}:null==t.from&&(t={from:t,to:null}),t.to||(t.to=t.from),t.margin=e||0,null!=t.from.line?function(t,e){kr(t),t.curOp.scrollToPos=e}(this,t):Lr(this,t.from,t.to,t.margin)})),setSize:ei((function(t,e){var n=this,r=function(t){return"number"==typeof t||/^\d+$/.test(String(t))?t+"px":t};null!=t&&(this.display.wrapper.style.width=r(t)),null!=e&&(this.display.wrapper.style.height=r(e)),this.options.lineWrapping&&zn(this);var i=this.display.viewFrom;this.doc.iter(i,this.display.viewTo,(function(t){if(t.widgets)for(var e=0;e<t.widgets.length;e++)if(t.widgets[e].noHScroll){pr(n,i,"widget");break}++i})),this.curOp.forceUpdate=!0,dt(this,"refresh",this)})),operation:function(t){return Qr(this,t)},startOperation:function(){return qr(this)},endOperation:function(){return Xr(this)},refresh:ei((function(){var t=this.display.cachedTextHeight;hr(this),this.curOp.forceUpdate=!0,Un(this),Or(this,this.doc.scrollLeft,this.doc.scrollTop),ci(this.display),(null==t||Math.abs(t-rr(this.display))>.5||this.options.lineWrapping)&&ur(this),dt(this,"refresh",this)})),swapDoc:ei((function(t){var e=this.doc;return e.cm=null,this.state.selectingText&&this.state.selectingText(),Di(this,t),Un(this),this.display.input.reset(),Or(this,t.scrollLeft,t.scrollTop),this.curOp.forceScroll=!0,un(this,"swapDoc",this,e),e})),phrase:function(t){var e=this.options.phrases;return e&&Object.prototype.hasOwnProperty.call(e,t)?e[t]:t},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},yt(t),t.registerHelper=function(e,r,i){n.hasOwnProperty(e)||(n[e]=t[e]={_global:[]}),n[e][r]=i},t.registerGlobalHelper=function(e,r,i,a){t.registerHelper(e,r,a),n[e]._global.push({pred:i,val:a})}}(Co);var qo="iter insert remove copy getEditor constructor".split(" ");for(var Xo in Ia.prototype)Ia.prototype.hasOwnProperty(Xo)&&U(qo,Xo)<0&&(Co.prototype[Xo]=function(t){return function(){return t.apply(this.doc,arguments)}}(Ia.prototype[Xo]));return yt(Ia),Co.inputStyles={textarea:Go,contenteditable:Uo},Co.defineMode=function(t){Co.defaults.mode||"null"==t||(Co.defaults.mode=t),Ft.apply(this,arguments)},Co.defineMIME=function(t,e){Pt[t]=e},Co.defineMode("null",(function(){return{token:function(t){return t.skipToEnd()}}})),Co.defineMIME("text/plain","null"),Co.defineExtension=function(t,e){Co.prototype[t]=e},Co.defineDocExtension=function(t,e){Ia.prototype[t]=e},Co.fromTextArea=function(t,e){if((e=e?F(e):{}).value=t.value,!e.tabindex&&t.tabIndex&&(e.tabindex=t.tabIndex),!e.placeholder&&t.placeholder&&(e.placeholder=t.placeholder),null==e.autofocus){var n=O();e.autofocus=n==t||null!=t.getAttribute("autofocus")&&n==document.body}function r(){t.value=s.getValue()}var i;if(t.form&&(ht(t.form,"submit",r),!e.leaveSubmitMethodAlone)){var a=t.form;i=a.submit;try{var o=a.submit=function(){r(),a.submit=i,a.submit(),a.submit=o}}catch(t){}}e.finishInit=function(n){n.save=r,n.getTextArea=function(){return t},n.toTextArea=function(){n.toTextArea=isNaN,r(),t.parentNode.removeChild(n.getWrapperElement()),t.style.display="",t.form&&(ft(t.form,"submit",r),e.leaveSubmitMethodAlone||"function"!=typeof t.form.submit||(t.form.submit=i))}},t.style.display="none";var s=Co((function(e){return t.parentNode.insertBefore(e,t.nextSibling)}),e);return s},function(t){t.off=ft,t.on=ht,t.wheelEventPixels=bi,t.Doc=Ia,t.splitLines=Rt,t.countColumn=B,t.findColumn=G,t.isWordChar=Q,t.Pass=j,t.signal=dt,t.Line=qe,t.changeEnd=Ti,t.scrollbarModel=Vr,t.Pos=te,t.cmpPos=ee,t.modes=Dt,t.mimeModes=Pt,t.resolveMode=Bt,t.getMode=zt,t.modeExtensions=Ut,t.extendMode=jt,t.copyState=Wt,t.startState=Ht,t.innerMode=Vt,t.commands=to,t.keyMap=Wa,t.keyName=$a,t.isModifierKey=qa,t.lookupKey=Ga,t.normalizeKeyMap=Ha,t.StringStream=Gt,t.SharedTextMarker=Ta,t.TextMarker=Ma,t.LineWidget=wa,t.e_preventDefault=xt,t.e_stopPropagation=bt,t.e_stop=_t,t.addClass=k,t.contains=R,t.rmClass=T,t.keyNames=Ba}(Co),Co.version="5.53.2",Co}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(2);const i={uniforms:{u_time:{value:0},u_resolution:{value:new r.s},u_amp:{value:1}},defines:{PI:Math.PI,HALF_PI:.5*Math.PI},side:r.c,wireframe:!1,vertexShader:"\nvarying vec2 vUv;\nuniform float u_time;\nuniform float u_amp;\n\nvoid main() {\n  vUv = uv;\n  vec3 newPosition = position + vec3(0., 0., sin(u_time + position.x)*u_amp);\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( newPosition, 1.0 );\n}\n",fragmentShader:"\nvarying vec2 vUv;\nuniform vec2 u_resolution;\nuniform float u_time;\nvoid main(){\n  // vec2 st = gl_FragCoord.xy/u_resolution;\n  vec2 st = vUv;\n  vec3 color = vec3(st.y);\n  gl_FragColor = vec4(color,1.0);\n}\n"},a=new r.p(i)},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return at}));var r,i,a,o=n(0),s=function(){return(s=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}u((r=r.apply(t,e||[])).next())}))}function c(t,e){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}(a=r||(r={}))[a.DT_INVALID=0]="DT_INVALID",a[a.DT_FLOAT=1]="DT_FLOAT",a[a.DT_DOUBLE=2]="DT_DOUBLE",a[a.DT_INT32=3]="DT_INT32",a[a.DT_UINT8=4]="DT_UINT8",a[a.DT_INT16=5]="DT_INT16",a[a.DT_INT8=6]="DT_INT8",a[a.DT_STRING=7]="DT_STRING",a[a.DT_COMPLEX64=8]="DT_COMPLEX64",a[a.DT_INT64=9]="DT_INT64",a[a.DT_BOOL=10]="DT_BOOL",a[a.DT_QINT8=11]="DT_QINT8",a[a.DT_QUINT8=12]="DT_QUINT8",a[a.DT_QINT32=13]="DT_QINT32",a[a.DT_BFLOAT16=14]="DT_BFLOAT16",a[a.DT_FLOAT_REF=101]="DT_FLOAT_REF",a[a.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",a[a.DT_INT32_REF=103]="DT_INT32_REF",a[a.DT_UINT8_REF=104]="DT_UINT8_REF",a[a.DT_INT16_REF=105]="DT_INT16_REF",a[a.DT_INT8_REF=106]="DT_INT8_REF",a[a.DT_STRING_REF=107]="DT_STRING_REF",a[a.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",a[a.DT_INT64_REF=109]="DT_INT64_REF",a[a.DT_BOOL_REF=110]="DT_BOOL_REF",a[a.DT_QINT8_REF=111]="DT_QINT8_REF",a[a.DT_QUINT8_REF=112]="DT_QUINT8_REF",a[a.DT_QINT32_REF=113]="DT_QINT32_REF",a[a.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",function(t){!function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"}(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))}(i||(i={}));var l={};function h(t){return l[t]}function p(t,e,n,r){var i=e.inputParams[t];if(i&&void 0!==i.inputIndexStart){var a=i.inputIndexStart,o=0===i.inputIndexEnd?void 0:void 0===i.inputIndexEnd?a+1:i.inputIndexEnd;if("tensor"===i.type)return f(e.inputNames[i.inputIndexStart],n,r);if("tensors"===i.type)return e.inputNames.slice(a,o).map((function(t){return f(t,n,r)}));var s=Array.prototype.slice.call(f(e.inputNames.slice(a)[0],n,r).dataSync());return"number"===i.type?s[0]:s}var u=e.attrParams[t];return u&&u.value}function f(t,e,n){var r=v(t),i=r[0],a=r[1],o=n.currentContextIds.find((function(t){return!!e[m(i,t)]}));return void 0!==o?e[m(i,o)][a]:void 0}function d(t,e){var n=v(t),r=n[0],i=n[1];return[m(r,e&&e.currentContextId),i]}function m(t,e){return e?t+"-"+e:t}function v(t){var e=t.lastIndexOf(":");return-1===e?[t,0]:[t.substring(0,e),Number(t.substring(e+1))]}function g(t,e){for(var n=[],r=0;r<t.length;r+=e)n.push(t.slice(r,r+e));return n}var y=Object.freeze({json:[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),x=Object.freeze({json:[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),b=Object.freeze({json:[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"}]}]}),w=Object.freeze({json:[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]}]}),_=Object.freeze({json:[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}]}),S=Object.freeze({json:[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),M=Object.freeze({json:[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}]}),E=Object.freeze({json:[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}]}),T=Object.freeze({json:[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}]}),C=Object.freeze({json:[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),A=Object.freeze({json:[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),N=Object.freeze({json:[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}]}),I=Object.freeze({json:[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]}]}),R=Object.freeze({json:[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}]}),O=Object.freeze({json:[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}]}),k=Object.freeze({json:[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]}]}),L=function(){function t(){var t=[y,x,b,w,_,S,M,C,T,E,A,N,I,R,O,k],e=[].concat.apply([],t.map((function(t){return t.json})));this.opMappers=e.reduce((function(t,e){return t[e.tfOpName]=e,t}),{})}return Object.defineProperty(t,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),t.prototype.transformGraph=function(t,e){var n=this;void 0===e&&(e={});var r=[],i=[],a=t.node.reduce((function(t,e){return t[e.name]=n.mapNode(e),e.op.startsWith("Placeholder")&&r.push(t[e.name]),"Const"===e.op&&i.push(t[e.name]),t}),{}),o=[],s=[],u={},c={};null!=e&&(u=this.mapSignatureEntries(e.inputs),c=this.mapSignatureEntries(e.outputs));var l=Object.keys(a);return l.forEach((function(t){var e=a[t];e.inputNames.forEach((function(t){var n=d(t)[0];e.inputs.push(a[n]),a[n].children.push(e)}))})),0===Object.keys(c).length?l.forEach((function(t){var e=a[t];0===e.children.length&&s.push(e)})):Object.keys(c).forEach((function(t){var e=d(t)[0],n=a[e];null!=n&&(n.signatureKey=c[t],s.push(n))})),Object.keys(u).length>0?Object.keys(u).forEach((function(t){var e=d(t)[0],n=a[e];n&&(n.signatureKey=u[t],o.push(n))})):o=r,{nodes:a,inputs:o,outputs:s,weights:i,placeholders:r,signature:e}},t.prototype.mapSignatureEntries=function(t){return Object.keys(t||{}).reduce((function(e,n){return e[t[n].name]=n,e}),{})},t.prototype.mapNode=function(t){var e=h(t.op)||this.opMappers[t.op]||{};null==t.attr&&(t.attr={});var n={name:t.name,op:t.op,category:e.category,inputNames:(t.input||[]).map((function(t){return t.startsWith("^")?t.substr(1):t})),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr};return null!=e.inputs&&(n.inputParams=e.inputs.reduce((function(t,e){return t[e.name]={type:e.type,inputIndexStart:e.start,inputIndexEnd:e.end},t}),{})),null!=e.attrs&&(n.attrParams=e.attrs.reduce((function(e,n){var r=n.type,i=void 0;switch(n.type){case"string":void 0===(i=P(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=P(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":void 0===(i=G(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=G(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":void 0===(i=B(t.attr,n.tfName,n.defaultValue||0))&&n.tfDeprecatedName&&(i=B(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":void 0===(i=H(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=H(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":void 0===(i=F(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=F(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":void 0===(i=X(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=X(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":void 0===(i=V(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=V(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":void 0===(i=q(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=q(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":void 0===(i=U(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=U(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":void 0===(i=j(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=j(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: "+n.type+" for op: "+t.op)}return e[n.name]={value:i,type:r},e}),{})),n},t}();function D(e,n){var r=Array.isArray(e)?String.fromCharCode.apply(null,e):function(e){var n=Object(o.Q)().global;if(void 0!==n.atob)return n.atob(e);if(void 0!==t)return new t(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(e);return n?r:r.toLowerCase()}function P(t,e,n,r){void 0===r&&(r=!1);var i=t[e];return null!=i?D(i.s,r):n}function F(t,e,n){var r=t[e];return r?r.b:n}function B(t,e,n){var r=t[e]||{},i=null!=r.i?r.i:null!=r.f?r.f:n;return"number"==typeof i?i:parseInt(i,10)}function z(t){switch("string"==typeof t&&(t=r[t]),t){case r.DT_FLOAT:return"float32";case r.DT_INT32:case r.DT_INT64:case r.DT_INT8:case r.DT_UINT8:return"int32";case r.DT_BOOL:return"bool";case r.DT_DOUBLE:return"float32";case r.DT_STRING:return"string";default:return null}}function U(t,e,n){var r=t[e];return r&&r.type?z(r.type):n}function j(t,e,n){var r=t[e];return r&&r.list&&r.list.type?r.list.type.map((function(t){return z(t)})):n}function W(t){if(!t.unknownRank)return null!=t.dim?t.dim.map((function(t){return"number"==typeof t.size?t.size:parseInt(t.size,10)})):[]}function V(t,e,n){var r=t[e];return r&&r.shape?W(r.shape):n}function H(t,e,n){var r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((function(t){return"number"==typeof t?t:parseInt(t,10)})):n}function G(t,e,n,r){void 0===r&&(r=!1);var i=t[e];return i&&i.list&&i.list.s?i.list.s.map((function(t){return D(t,r)})):n}function q(t,e,n){var r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map((function(t){return W(t)})):n}function X(t,e,n){var r=t[e];return r&&r.list&&r.list.b?r.list.b:n}var $=function(){function t(t,e,n){var r=this;this.node=t,this.tensorMap=e,this.context=n,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map((function(t){return r.getInput(t)})),null!=t.rawAttrs&&(this.attrs=Object.keys(t.rawAttrs).reduce((function(t,e){return t[e]=r.getAttr(e),t}),{}))}return t.prototype.getInput=function(t){return f(t,this.tensorMap,this.context)},t.prototype.getAttr=function(t,e){var n=this.node.rawAttrs[t];if(null!=n.tensor)return f(t,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return B(this.node.rawAttrs,t,e);if(null!=n.s)return P(this.node.rawAttrs,t,e);if(null!=n.b)return F(this.node.rawAttrs,t,e);if(null!=n.shape)return V(this.node.rawAttrs,t,e);if(null!=n.type)return U(this.node.rawAttrs,t,e);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return H(this.node.rawAttrs,t,e);if(null!=n.list.s)return G(this.node.rawAttrs,t,e);if(null!=n.list.shape)return q(this.node.rawAttrs,t,e);if(null!=n.list.b)return X(this.node.rawAttrs,t,e);if(null!=n.list.type)return j(this.node.rawAttrs,t,e)}return e},t}(),Y=function(){function t(e,n,r,i,a,o,s){this.name=e,this.dtype=n,this.maxSize=r,this.elementShape=i,this.identicalElementShapes=a,this.dynamicSize=o,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.id=t.nextId++}return Object.defineProperty(t.prototype,"closed",{get:function(){return this.closed_},enumerable:!0,configurable:!0}),t.prototype.clearAndClose=function(){this.tensors.forEach((function(t){return t.tensor.dispose()})),this.tensors=[],this.closed_=!0},t.prototype.size=function(){return this.tensors.length},t.prototype.read=function(t){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(t<0||t>=this.tensors.length)throw new Error("Tried to read from index "+t+", but array size is: "+this.tensors.length);var e=this.tensors[t];if(e.cleared)throw new Error("TensorArray "+this.name+": Could not read index "+t+" twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor},t.prototype.readMany=function(t){var e=this;return t.map((function(t){return e.read(t)}))},t.prototype.write=function(t,e){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error("Tried to write to index "+t+", but array is not resizeable and size is: "+this.maxSize);var n=this.tensors[t]||{};if(e.dtype!==this.dtype)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+",\n          because the value dtype is "+e.dtype+", but TensorArray dtype is "+this.dtype+".");if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=e.shape),this.assertShapesMatchAllowUndefinedSize(this.elementShape,e.shape,"TensorArray "+this.name+": Could not write to TensorArray index "+t+"."),n&&n.read)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+", because it has already been read.");if(n&&n.written)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+", because it has already been written.");n.tensor=e,n.written=!0,this.tensors[t]=n},t.prototype.writeMany=function(t,e){var n=this;if(t.length!==e.length)throw new Error("TensorArray "+this.name+": could not write multiple tensors,because the index size: "+t.length+" is not the same as tensors size: "+e.length+".");t.forEach((function(t,r){return n.write(t,e[r])}))},t.prototype.gather=function(t,e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but gather requested dtype "+e);if(!t){t=[];for(var n=0;n<this.size();n++)t.push(n)}if(0===t.length)return Object(o.Ec)([],[0].concat(this.elementShape));var r=this.readMany(t);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Object(o.yc)(r,0)},t.prototype.concat=function(t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but concat requested dtype "+t);if(0===this.size())return Object(o.Ec)([],[0].concat(this.elementShape));for(var e=[],n=0;n<this.size();n++)e.push(n);var r=this.readMany(e);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,r[0].shape,"TensorArray shape mismatch: tensor array shape ("+this.elementShape+") vs first tensor shape ("+r[0].shape+")"),Object(o.C)(r,0)},t.prototype.scatter=function(t,e){if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+e.dtype);if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: "+t.length+" vs. "+e.shape[0]);var n=Math.max.apply(Math,t);if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size ("+n+"  vs. "+this.maxSize+")");this.writeMany(t,Object(o.Mc)(e,0))},t.prototype.split=function(t,e){var n=this;if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+e.dtype);var r=0,i=t.map((function(t){return r+=t}));if(r!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        "+r+", and tensor's shape is: "+e.shape);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths ("+this.maxSize+" vs. "+t.length+"), and the TensorArray is not marked as dynamically resizeable");var a=0===r?0:e.size/r,s=[];Object(o.Hc)((function(){e=e.reshape([1,r,a]);for(var u=0;u<t.length;++u){var c=[0,0===u?0:i[u-1],0],l=[1,t[u],a];s[u]=Object(o.nc)(e,c,l).reshape(n.elementShape)}return s}));for(var u=[],c=0;c<t.length;c++)u[c]=c;this.writeMany(u,s)},t.prototype.assertShapesMatchAllowUndefinedSize=function(t,e,n){void 0===n&&(n=""),o.Nc.assert(this.shapesEqualAllowUndefinedSize(t,e),(function(){return n+" Shapes "+t+" and "+e+" must match"}))},t.prototype.shapesEqualAllowUndefinedSize=function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(-1!==t[n]&&-1!==e[n]&&t[n]!==e[n])return!1;return!0},t.nextId=0,t}();function K(t,e,n){var r=function(t,e,n){switch(t.category){case"arithmetic":return Object(o.Hc)((function(){return function(t,e,n){switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[Object(o.g)(p("a",t,e,n),p("b",t,e,n))];case"AddN":return[Object(o.h)(p("tensors",t,e,n))];case"FloorMod":case"Mod":return[Object(o.Fb)(p("a",t,e,n),p("b",t,e,n))];case"Mul":return[Object(o.Gb)(p("a",t,e,n),p("b",t,e,n))];case"RealDiv":case"Div":return[Object(o.M)(p("a",t,e,n),p("b",t,e,n))];case"DivNoNan":return[Object(o.N)(p("a",t,e,n),p("b",t,e,n))];case"FloorDiv":return[Object(o.Z)(p("a",t,e,n),p("b",t,e,n))];case"Sub":return[Object(o.Ac)(p("a",t,e,n),p("b",t,e,n))];case"Minimum":return[Object(o.Eb)(p("a",t,e,n),p("b",t,e,n))];case"Maximum":return[Object(o.Bb)(p("a",t,e,n),p("b",t,e,n))];case"Pow":return[Object(o.Ob)(p("a",t,e,n),p("b",t,e,n))];case"SquaredDifference":return[Object(o.wc)(p("a",t,e,n),p("b",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"basic_math":return Object(o.Hc)((function(){return function(t,e,n){switch(t.op){case"Abs":case"ComplexAbs":return[Object(o.d)(p("x",t,e,n))];case"Acos":return[Object(o.e)(p("x",t,e,n))];case"Acosh":return[Object(o.f)(p("x",t,e,n))];case"Asin":return[Object(o.m)(p("x",t,e,n))];case"Asinh":return[Object(o.n)(p("x",t,e,n))];case"Atan":return[Object(o.o)(p("x",t,e,n))];case"Atan2":return[Object(o.p)(p("x",t,e,n),p("y",t,e,n))];case"Atanh":return[Object(o.q)(p("x",t,e,n))];case"Ceil":return[Object(o.z)(p("x",t,e,n))];case"Complex":return[Object(o.B)(p("real",t,e,n),p("imag",t,e,n))];case"Cos":return[Object(o.I)(p("x",t,e,n))];case"Cosh":return[Object(o.J)(p("x",t,e,n))];case"Elu":return[Object(o.O)(p("x",t,e,n))];case"Erf":return[Object(o.S)(p("x",t,e,n))];case"Exp":return[Object(o.T)(p("x",t,e,n))];case"Expm1":return[Object(o.V)(p("x",t,e,n))];case"Floor":return[Object(o.Y)(p("x",t,e,n))];case"Log":return[Object(o.qb)(p("x",t,e,n))];case"Log1p":return[Object(o.rb)(p("x",t,e,n))];case"Imag":return[Object(o.hb)(p("x",t,e,n))];case"Neg":return[Object(o.Ib)(p("x",t,e,n))];case"Reciprocal":return[Object(o.Ub)(p("x",t,e,n))];case"Real":return[Object(o.Tb)(p("x",t,e,n))];case"Relu":return[Object(o.Xb)(p("x",t,e,n))];case"Round":return[Object(o.bc)(p("x",t,e,n))];case"Selu":return[Object(o.gc)(p("x",t,e,n))];case"Sigmoid":return[Object(o.jc)(p("x",t,e,n))];case"Sin":return[Object(o.lc)(p("x",t,e,n))];case"Sign":return[Object(o.kc)(p("x",t,e,n))];case"Sinh":return[Object(o.mc)(p("x",t,e,n))];case"Softplus":return[Object(o.qc)(p("x",t,e,n))];case"Sqrt":return[Object(o.uc)(p("x",t,e,n))];case"Square":return[Object(o.vc)(p("x",t,e,n))];case"Tanh":return[Object(o.Dc)(p("x",t,e,n))];case"Tan":return[Object(o.Cc)(p("x",t,e,n))];case"Relu6":case"ClipByValue":return[Object(o.A)(p("x",t,e,n),p("clipValueMin",t,e,n),p("clipValueMax",t,e,n))];case"Rsqrt":return[Object(o.cc)(f(t.inputNames[0],e,n))];case"Prod":return[Object(o.Qb)(p("x",t,e,n),p("axes",t,e,n))];case"LeakyRelu":return[Object(o.lb)(p("x",t,e,n),p("alpha",t,e,n))];case"Prelu":return[Object(o.Pb)(p("x",t,e,n),p("alpha",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"control":return function(t,e,n){return u(void 0,void 0,void 0,(function(){var r,i,a,s,u,l,h,d,m,v,g,y,x,b,w,_,S,M,E,T,C,A,N,I,R,O,k,L,D,P,F,B,z,U,j;return c(this,(function(c){switch(c.label){case 0:switch(t.op){case"LoopCond":return[3,1];case"Switch":return[3,2];case"Merge":return[3,4];case"Enter":return[3,5];case"Exit":return[3,6];case"NextIteration":return[3,7];case"TensorArrayV3":return[3,8];case"TensorArrayWriteV3":return[3,9];case"TensorArrayReadV3":return[3,10];case"TensorArrayGatherV3":return[3,11];case"TensorArrayScatterV3":return[3,12];case"TensorArrayConcatV3":return[3,13];case"TensorArraySplitV3":return[3,14];case"TensorArraySizeV3":return[3,15];case"TensorArrayCloseV3":return[3,16]}return[3,17];case 1:return[2,[p("pred",t,e,n).clone()]];case 2:return r=p("pred",t,e,n),i=p("data",t,e,n),[4,r.data()];case 3:return[2,c.sent()[0]?[void 0,i.clone()]:[i.clone(),void 0]];case 4:return[2,(a=t.inputNames.find((function(t){return void 0!==f(t,e,n)})))?[f(a,e,n).clone()]:void 0];case 5:return s=p("frameName",t,e,n),u=p("tensor",t,e,n),n.enterFrame(s),[2,[u.clone()]];case 6:return l=p("tensor",t,e,n),n.exitFrame(),[2,[l.clone()]];case 7:return h=p("tensor",t,e,n),n.nextIteration(),[2,[h.clone()]];case 8:return d=p("size",t,e,n),m=p("dtype",t,e,n),v=p("elementShape",t,e,n),g=p("dynamicSize",t,e,n),y=p("clearAfterRead",t,e,n),x=p("identicalElementShapes",t,e,n),b=p("name",t,e,n),w=new Y(b,m,d,v,x,g,y),n.addTensorArray(w),[2,[Object(o.dc)(w.id),Object(o.dc)(1)]];case 9:return _=p("tensorArrayId",t,e,n),S=p("index",t,e,n),M=p("tensor",t,e,n),n.getTensorArray(_).write(S,M),[2,[Object(o.dc)(1)]];case 10:return E=p("tensorArrayId",t,e,n),T=p("index",t,e,n),[2,[n.getTensorArray(E).read(T)]];case 11:return C=p("tensorArrayId",t,e,n),A=p("indices",t,e,n),N=p("dtype",t,e,n),[2,[n.getTensorArray(C).gather(A,N)]];case 12:return I=p("tensorArrayId",t,e,n),R=p("indices",t,e,n),O=p("tensor",t,e,n),n.getTensorArray(I).scatter(R,O),[2,[Object(o.dc)(1)]];case 13:return k=p("tensorArrayId",t,e,n),L=n.getTensorArray(k),D=p("dtype",t,e,n),[2,[L.concat(D)]];case 14:return P=p("tensorArrayId",t,e,n),F=p("tensor",t,e,n),B=p("lengths",t,e,n),n.getTensorArray(P).split(B,F),[2,[Object(o.dc)(1)]];case 15:return z=p("tensorArrayId",t,e,n),U=n.getTensorArray(z),[2,[Object(o.dc)(U.size(),"int32")]];case 16:return j=p("tensorArrayId",t,e,n),n.getTensorArray(j).clearAndClose(),[2,[Object(o.dc)(0)]];case 17:throw TypeError("Node type "+t.op+" is not implemented")}}))}))}(t,e,n);case"convolution":return Object(o.Hc)((function(){return function(t,e,n){switch(t.op){case"Conv1D":var r=p("stride",t,e,n),i=p("pad",t,e,n),a=p("dataFormat",t,e,n).toUpperCase(),s=p("dilation",t,e,n);return[Object(o.E)(p("x",t,e,n),p("filter",t,e,n),r,i,a,s)];case"Conv2D":r=p("strides",t,e,n),i=p("pad",t,e,n),a=p("dataFormat",t,e,n).toUpperCase();var u=p("dilations",t,e,n);return[Object(o.F)(p("x",t,e,n),p("filter",t,e,n),[r[1],r[2]],i,a,[u[1],u[2]])];case"_FusedConv2D":case"FusedDepthwiseConv2dNative":var c=p("fusedOps",t,e,n),l=c[0],h=c[1],f="biasadd"===l,d="prelu"===h,m="fusedbatchnorm"===l,v=p("numArgs",t,e,n);if(f){if(d&&2!==v)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!d&&1!==v)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(m)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported.");r=p("strides",t,e,n),i=p("pad",t,e,n),a=p("dataFormat",t,e,n).toUpperCase(),u=p("dilations",t,e,n);var g=p("args",t,e,n),y=g[0],x=g[1];return[("_FusedConv2D"===t.op?o.ab.conv2d:o.ab.depthwiseConv2d)({x:p("x",t,e,n),filter:p("filter",t,e,n),strides:[r[1],r[2]],pad:i,dataFormat:a,dilations:[u[1],u[2]],bias:y,activation:h,preluActivationWeights:x})];case"Conv2DBackpropInput":case"Conv2dTranspose":var b=p("outputShape",t,e,n);return r=p("strides",t,e,n),i=p("pad",t,e,n),[Object(o.G)(p("x",t,e,n),p("filter",t,e,n),b,[r[1],r[2]],i)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":return r=p("strides",t,e,n),i=p("pad",t,e,n),u=p("dilations",t,e,n),a=p("dataFormat",t,e,n).toUpperCase(),[Object(o.L)(p("input",t,e,n),p("filter",t,e,n),[r[1],r[2]],i,a,[u[1],u[2]])];case"Conv3D":return r=p("strides",t,e,n),i=p("pad",t,e,n),a=p("dataFormat",t,e,n).toUpperCase(),u=p("dilations",t,e,n),[Object(o.H)(p("x",t,e,n),p("filter",t,e,n),[r[1],r[2],r[3]],i,a,[u[1],u[2],u[3]])];case"AvgPool":r=p("strides",t,e,n),i=p("pad",t,e,n);var w=p("kernelSize",t,e,n);return[Object(o.r)(p("x",t,e,n),[w[1],w[2]],[r[1],r[2]],i)];case"MaxPool":return r=p("strides",t,e,n),i=p("pad",t,e,n),w=p("kernelSize",t,e,n),[Object(o.yb)(p("x",t,e,n),[w[1],w[2]],[r[1],r[2]],i)];case"MaxPoolWithArgmax":r=p("strides",t,e,n),i=p("pad",t,e,n),w=p("kernelSize",t,e,n);var _=p("includeBatchInIndex",t,e,n),S=Object(o.Ab)(p("x",t,e,n),[w[1],w[2]],[r[1],r[2]],i,_);return[S.result,S.indexes];case"AvgPool3D":return r=p("strides",t,e,n),i=p("pad",t,e,n),w=p("kernelSize",t,e,n),[Object(o.s)(p("x",t,e,n),[w[1],w[2],w[3]],[r[1],r[2],r[3]],i)];case"MaxPool3D":return r=p("strides",t,e,n),i=p("pad",t,e,n),w=p("kernelSize",t,e,n),[Object(o.zb)(p("x",t,e,n),[w[1],w[2],w[3]],[r[1],r[2],r[3]],i)];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"creation":return Object(o.Hc)((function(){return function(t,e,n){switch(t.op){case"Fill":var r=p("shape",t,e,n),i=p("dtype",t,e,n),a=p("value",t,e,n);return[Object(o.X)(r,a,i)];case"LinSpace":var s=p("start",t,e,n),u=p("stop",t,e,n),c=p("num",t,e,n);return[Object(o.ob)(s,u,c)];case"Multinomial":var l=p("logits",t,e,n),h=p("numSamples",t,e,n),f=p("seed",t,e,n);return[Object(o.Hb)(l,h,f)];case"OneHot":var d=p("indices",t,e,n),m=p("depth",t,e,n),v=p("onValue",t,e,n),g=p("offValue",t,e,n);return[Object(o.Kb)(d,m,v,g)];case"Ones":return[Object(o.Lb)(p("shape",t,e,n),p("dtype",t,e,n))];case"OnesLike":return[Object(o.Mb)(p("x",t,e,n))];case"RandomUniform":return[Object(o.Rb)(p("shape",t,e,n),p("minval",t,e,n),p("maxval",t,e,n),p("dtype",t,e,n))];case"Range":s=p("start",t,e,n);var y=p("stop",t,e,n),x=p("step",t,e,n);return[Object(o.Sb)(s,y,x,p("dtype",t,e,n))];case"TruncatedNormal":r=p("shape",t,e,n);var b=p("mean",t,e,n),w=p("stdDev",t,e,n);return f=p("seed",t,e,n),[Object(o.Lc)(r,b,w,p("dtype",t,e,n),f)];case"Zeros":return[Object(o.Qc)(p("shape",t,e,n),p("dtype",t,e,n))];case"ZerosLike":return[Object(o.Rc)(p("x",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"dynamic":return function(t,e,n){return u(void 0,void 0,void 0,(function(){var r,i,a,s,u,l,h,f;return c(this,(function(c){switch(c.label){case 0:switch(t.op){case"NonMaxSuppressionV5":case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":return[3,1];case"Where":return[3,5];case"ListDiff":return[3,7]}return[3,8];case 1:return r=p("boxes",t,e,n),i=p("scores",t,e,n),a=p("maxOutputSize",t,e,n),s=p("iouThreshold",t,e,n),u=p("scoreThreshold",t,e,n),"NonMaxSuppressionV5"!==t.op?[3,3]:(l=p("softNmsSigma",t,e,n),[4,o.ib.nonMaxSuppressionWithScoreAsync(r,i,a,s,u,l)]);case 2:return[2,[(f=c.sent()).selectedIndices,f.selectedScores]];case 3:return[4,o.ib.nonMaxSuppressionAsync(r,i,a,s,u)];case 4:return[2,[c.sent()]];case 5:return h=p("condition",t,e,n).asType("bool"),[4,Object(o.Pc)(h)];case 6:return f=[c.sent()],h.dispose(),[2,f];case 7:return[2,Object(o.ic)(p("x",t,e,n),p("y",t,e,n))];case 8:throw TypeError("Node type "+t.op+" is not implemented")}}))}))}(t,e,n);case"evaluation":return Object(o.Hc)((function(){return function(t,e,n){switch(t.op){case"TopKV2":var r=p("x",t,e,n),i=p("k",t,e,n),a=p("sorted",t,e,n),s=Object(o.Jc)(r,i,a);return[s.values,s.indices];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"image":return Object(o.Hc)((function(){return function(t,e,n){switch(t.op){case"ResizeBilinear":var r=p("images",t,e,n),i=p("size",t,e,n),a=p("alignCorners",t,e,n);return[o.ib.resizeBilinear(r,[i[0],i[1]],a)];case"ResizeNearestNeighbor":return r=p("images",t,e,n),i=p("size",t,e,n),a=p("alignCorners",t,e,n),[o.ib.resizeNearestNeighbor(r,[i[0],i[1]],a)];case"CropAndResize":var s=p("image",t,e,n),u=p("boxes",t,e,n),c=p("boxInd",t,e,n),l=p("cropSize",t,e,n),h=p("method",t,e,n),f=p("extrapolationValue",t,e,n);return[o.ib.cropAndResize(s,u,c,l,h,f)];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"graph":return Object(o.Hc)((function(){return function(t,e,n){switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":var r=p("default",t,e,n);return[f(t.name,e,n)||r];case"Placeholder":return[f(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":return[p("x",t,e,n).clone()];case"IdentityN":return p("x",t,e,n).map((function(t){return t.clone()}));case"Snapshot":return[p("x",t,e,n).clone()];case"Shape":return[Object(o.Fc)(p("x",t,e,n).shape,"int32")];case"ShapeN":return p("x",t,e,n).map((function(t){return Object(o.Fc)(t.shape)}));case"Size":return[Object(o.dc)(p("x",t,e,n).size,"int32")];case"Rank":return[Object(o.dc)(p("x",t,e,n).rank,"int32")];case"NoOp":return[Object(o.dc)(1)];case"Print":var i=p("x",t,e,n),a=p("data",t,e,n),s=p("message",t,e,n),u=p("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(s);for(var c=0;c<a.length;c++)console.log(Array.prototype.slice.call(a[c].dataSync()).slice(0,u));return[i];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"logical":return Object(o.Hc)((function(){return function(t,e,n){switch(t.op){case"Equal":return[Object(o.R)(p("a",t,e,n),p("b",t,e,n))];case"NotEqual":return[Object(o.Jb)(p("a",t,e,n),p("b",t,e,n))];case"Greater":return[Object(o.eb)(p("a",t,e,n),p("b",t,e,n))];case"GreaterEqual":return[Object(o.fb)(p("a",t,e,n),p("b",t,e,n))];case"Less":return[Object(o.mb)(p("a",t,e,n),p("b",t,e,n))];case"LessEqual":return[Object(o.nb)(p("a",t,e,n),p("b",t,e,n))];case"LogicalAnd":return[Object(o.tb)(p("a",t,e,n),p("b",t,e,n))];case"LogicalNot":return[Object(o.ub)(p("a",t,e,n))];case"LogicalOr":return[Object(o.vb)(p("a",t,e,n),p("b",t,e,n))];case"Select":return[Object(o.Oc)(p("condition",t,e,n),p("a",t,e,n),p("b",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"matrices":return Object(o.Hc)((function(){return function(t,e,n){switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[Object(o.wb)(p("a",t,e,n),p("b",t,e,n),p("transposeA",t,e,n),p("transposeB",t,e,n))];case"Transpose":return[Object(o.Kc)(p("x",t,e,n),p("perm",t,e,n))];case"_FusedMatMul":var r=p("fusedOps",t,e,n),i=r[0],a=r[1],s="biasadd"===i,u="prelu"===a,c=p("numArgs",t,e,n);if(s){if(u&&2!==c)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!u&&1!==c)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}var l=p("args",t,e,n),h=l[0],f=l[1];return[o.ab.matMul({a:p("a",t,e,n),b:p("b",t,e,n),transposeA:p("transposeA",t,e,n),transposeB:p("transposeB",t,e,n),bias:h,activation:a,preluActivationWeights:f})];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"normalization":return Object(o.Hc)((function(){return function(t,e,n){switch(t.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[Object(o.u)(p("x",t,e,n),p("mean",t,e,n),p("variance",t,e,n),p("offset",t,e,n),p("scale",t,e,n),p("epsilon",t,e,n))];case"LRN":return[Object(o.pb)(p("x",t,e,n),p("radius",t,e,n),p("bias",t,e,n),p("alpha",t,e,n),p("beta",t,e,n))];case"Softmax":return[Object(o.pc)(p("x",t,e,n))];case"LogSoftmax":return[Object(o.sb)(p("x",t,e,n))];case"SparseToDense":return[Object(o.sc)(p("sparseIndices",t,e,n),p("outputShape",t,e,n),p("sparseValues",t,e,n),p("defaultValue",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"reduction":return Object(o.Hc)((function(){return function(t,e,n){switch(t.op){case"Max":var r=p("axis",t,e,n),i=p("keepDims",t,e,n);return[Object(o.xb)(p("x",t,e,n),r,i)];case"Mean":return r=p("axis",t,e,n),i=p("keepDims",t,e,n),[Object(o.Cb)(p("x",t,e,n),r,i)];case"Min":return r=p("axis",t,e,n),i=p("keepDims",t,e,n),[Object(o.Db)(p("x",t,e,n),r,i)];case"Sum":return r=p("axis",t,e,n),i=p("keepDims",t,e,n),[Object(o.Bc)(p("x",t,e,n),r,i)];case"All":return r=p("axis",t,e,n),i=p("keepDims",t,e,n),[Object(o.i)(p("x",t,e,n),r,i)];case"Any":return r=p("axis",t,e,n),i=p("keepDims",t,e,n),[Object(o.j)(p("x",t,e,n),r,i)];case"ArgMax":return r=p("axis",t,e,n),[Object(o.k)(p("x",t,e,n),r)];case"ArgMin":return r=p("axis",t,e,n),[Object(o.l)(p("x",t,e,n),r)];case"Prod":return r=p("axis",t,e,n),i=p("keepDims",t,e,n),[Object(o.Qb)(p("x",t,e,n),r,i)];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"slice_join":return Object(o.Hc)((function(){return function(t,e,n){switch(t.op){case"ConcatV2":case"Concat":var r=p("n",t,e,n),i=p("axis",t,e,n),a=p("tensors",t,e,n);return a=a.slice(0,r),[Object(o.C)(a,i)];case"GatherV2":case"Gather":i=p("axis",t,e,n);var s=p("x",t,e,n),u=p("indices",t,e,n);return[Object(o.bb)(s,u.asType("int32"),i)];case"ReverseV2":case"Reverse":return i=p("axis",t,e,n),s=p("x",t,e,n),[Object(o.Zb)(s,i)];case"Slice":var c=p("begin",t,e,n),l=p("size",t,e,n);return[Object(o.nc)(p("x",t,e,n),c,l)];case"StridedSlice":c=p("begin",t,e,n);var h=p("end",t,e,n),f=p("strides",t,e,n),d=p("beginMask",t,e,n),m=p("endMask",t,e,n),v=p("ellipsisMask",t,e,n),g=p("newAxisMask",t,e,n),y=p("shrinkAxisMask",t,e,n),x=p("x",t,e,n);if(1===c.length&&x.shape.length>1)for(var b=1;b<x.shape.length;b++)c.push(0),h.push(x.shape[b]),f.push(f[0]);return[Object(o.zc)(x,c,h,f,d,m,v,g,y)];case"Pack":return Object(o.Hc)((function(){var r=p("axis",t,e,n),i=p("tensors",t,e,n),a=i[0].shape,s=i[0].squeeze().shape,u=i.map((function(t){var e=o.Nc.arraysEqual(t.shape,a);if(!e&&!o.Nc.arraysEqual(t.squeeze().shape,s))throw new Error("the input tensors shape does not match");return e?t:t.reshape(a)}));return[Object(o.yc)(u,r)]}));case"Unpack":return Object(o.Hc)((function(){var r=p("axis",t,e,n),i=p("tensor",t,e,n);return Object(o.Mc)(i,r)}));case"Tile":var w=p("reps",t,e,n);return[Object(o.Ic)(p("x",t,e,n),w)];case"Split":case"SplitV":i=p("axis",t,e,n);var _=p("numOrSizeSplits",t,e,n);return Object(o.tc)(p("x",t,e,n),_,i);case"ScatterNd":u=p("indices",t,e,n);var S=p("values",t,e,n),M=p("shape",t,e,n);return[Object(o.ec)(u,S,M)];case"GatherNd":var E=p("x",t,e,n);return u=p("indices",t,e,n),[Object(o.cb)(E,u)];case"SparseToDense":u=p("sparseIndices",t,e,n),M=p("outputShape",t,e,n);var T=p("sparseValues",t,e,n),C=p("defaultValue",t,e,n);return[Object(o.sc)(u,T,M,T.dtype===C.dtype?C:C.asType(T.dtype))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"spectral":return Object(o.Hc)((function(){return function(t,e,n){switch(t.op){case"FFT":return[Object(o.W)(p("x",t,e,n))];case"IFFT":return[Object(o.gb)(p("x",t,e,n))];case"RFFT":return[Object(o.ac)(p("x",t,e,n))];case"IRFFT":return[Object(o.kb)(p("x",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"transformation":return Object(o.Hc)((function(){return function(t,e,n){switch(t.op){case"Cast":return[Object(o.y)(p("x",t,e,n),p("dtype",t,e,n))];case"ExpandDims":var r=p("axis",t,e,n);return[Object(o.U)(p("x",t,e,n),r)];case"Squeeze":return r=p("axis",t,e,n),[Object(o.xc)(p("x",t,e,n),r)];case"Reshape":return[Object(o.Yb)(p("x",t,e,n),p("shape",t,e,n))];case"PadV2":case"Pad":return[Object(o.Nb)(p("x",t,e,n),g(p("padding",t,e,n),2),p("constantValue",t,e,n))];case"SpaceToBatchND":var i=p("blockShape",t,e,n),a=g(p("paddings",t,e,n),2);return[Object(o.rc)(p("x",t,e,n),i,a)];case"BatchToSpaceND":i=p("blockShape",t,e,n);var s=g(p("crops",t,e,n),2);return[Object(o.v)(p("x",t,e,n),i,s)];case"DepthToSpace":var u=p("blockSize",t,e,n),c=p("dataFormat",t,e,n).toUpperCase();return[Object(o.K)(p("x",t,e,n),u,c)];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"custom":var r=h(t.op);if(r&&r.customExecutor)return r.customExecutor(new $(t,e,n));throw TypeError("Custom op "+t.op+" is not registered.");default:throw TypeError("Unknown op '"+t.op+"'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(t,e,n);return r instanceof Promise?r.then((function(t){return[].concat(t)})):[].concat(r)}var J=function(){function t(t,e){this.weightMap=t,this.tensorArrayMap=e,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return t.prototype.newFrame=function(t,e){return{id:t,frameName:e,iterationId:0}},Object.defineProperty(t.prototype,"currentContext",{get:function(){return this.contexts},set:function(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentContextId",{get:function(){return this._currentContextIds[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentContextIds",{get:function(){return this._currentContextIds},enumerable:!0,configurable:!0}),t.prototype.generateCurrentContextIds=function(){for(var t=[],e=0;e<this.contexts.length-1;e++){var n=this.contexts.slice(0,this.contexts.length-e);t.push(this.contextIdforContexts(n))}t.push(""),this._currentContextIds=t},t.prototype.contextIdforContexts=function(t){return t?t.map((function(t){return 0===t.id&&0===t.iterationId?"":t.frameName+"-"+t.iterationId})).join("/"):""},t.prototype.enterFrame=function(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))},t.prototype.exitFrame=function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()},t.prototype.nextIteration=function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))},t.prototype.getWeight=function(t){return this.weightMap[t]},t.prototype.addTensorArray=function(t){this.tensorArrayMap[t.id]=t},t.prototype.getTensorArray=function(t){return this.tensorArrayMap[t]},t}();function Z(t,e,n){for(var r=new Set,i=[],a=null,o=null,s=new Set,u=Object.keys(t).map((function(t){return v(t)[0]})),c=e.slice();c.length>0;){var l=c.pop();(et(l)||nt(l))&&null==a&&(o=(a=l).children.map((function(t){return t.name})).filter((function(t){return r.has(t)}))),r.add(l.name),null==n[l.name]&&-1===u.indexOf(l.name)&&(0!==l.inputs.length?l.inputs.forEach((function(t){s.has(t.name)||(s.add(t.name),c.push(t))})):i.push(l.name))}return{inputs:t,outputs:e,usedNodes:r,missingInputs:i,dynamicNode:a,syncInputs:o}}var Q=["Switch","Merge","Enter","Exit","NextIteration"],tt=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"];function et(t){return Q.indexOf(t.op)>=0}function nt(t){return tt.indexOf(t.op)>=0}var rt=function(){function t(t){this.graph=t,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._outputs=t.outputs,this._inputs=t.inputs,this._signature=t.signature}return Object.defineProperty(t.prototype,"weightMap",{get:function(){return this._weightMap},set:function(t){var e=Object.keys(t).map((function(e){return t[e].map((function(t){return t.id}))}));this.weightIds=[].concat.apply([],e),this._weightMap=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputs",{get:function(){return this._inputs.map((function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputs",{get:function(){return this._outputs.map((function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputNodes",{get:function(){return this._inputs.map((function(t){return t.signatureKey||t.name}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputNodes",{get:function(){return this._outputs.map((function(t){return t.signatureKey||t.name}))},enumerable:!0,configurable:!0}),t.prototype.getCompilationKey=function(t,e){var n=t.map((function(t){return t.name})).sort(),r=e.map((function(t){return t.name})).sort();return n.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)},t.prototype.compile=function(t,e){var n=Z(t,e,this.weightMap),r=n.missingInputs,i=n.dynamicNode,a=n.syncInputs;if(null!=i)throw new Error("This execution contains the node '"+i.name+"', which has the dynamic op '"+i.op+"'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs ["+a+"]");if(r.length>0){var o=e.map((function(t){return t.name})),s=Object.keys(t);throw new Error("Cannot compute the outputs ["+o+"] from the provided inputs ["+s+"]. Missing the following inputs: ["+r+"]")}return function(t,e,n){var r=n.usedNodes,i=n.inputs,a=[];Object.keys(i).map((function(t){return v(t)[0]})).map((function(e){return t.nodes[e]})).forEach((function(t){r.has(t.name)&&a.push(t)})),t.weights.forEach((function(t){r.has(t.name)&&a.push(t)}));for(var o=new Set,s=[];a.length>0;){var u=a.pop();o.add(u.name),e[u.name]||s.push(u),u.children.forEach((function(t){!o.has(t.name)&&r.has(t.name)&&t.inputs.every((function(t){return o.has(t.name)}))&&a.push(t)}))}return s}(this.graph,this.weightMap,n)},t.prototype.execute=function(t,e){var n=this;t=this.mapInputs(t);var r=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e);var i=r.map((function(t){return n.graph.nodes[v(t)[0]]})),a=e.map((function(t){return n.graph.nodes[v(t)[0]]})),u=this.getCompilationKey(i,a),c=this.compiledMap.get(u);null==c&&(c=this.compile(t,a),this.compiledMap.set(u,c));var l={};return Object(o.Hc)((function(){var r=new J(n._weightMap,l),i=s({},n.weightMap);Object.keys(t).forEach((function(e){var n=v(e),r=n[0],a=[];a[n[1]]=t[e],i[r]=a}));for(var a=n.getFrozenTensorIds(i),o={},u=0;u<c.length;u++){var h=c[u];if(!i[h.name]){var p=K(h,i,r);if(p instanceof Promise)throw new Error("The execution of the op '"+h.op+"' returned a promise. Please use model.executeAsync() instead.");i[h.name]=p,n.checkTensorForDisposal(h.name,h,i,r,a,e,o)}}return e.map((function(t){return f(t,i,r)}))}))},t.prototype.getFrozenTensorIds=function(t){var e=[].concat.apply([],Object.keys(t).map((function(e){return t[e]})).map((function(t){return t.map((function(t){return t.id}))})));return new Set(e)},t.prototype.checkTensorForDisposal=function(t,e,n,r,i,a,o){"control"!==e.category&&-1===a.indexOf(t)&&(n[t].forEach((function(t){null!=t&&(o[t.id]=(o[t.id]||0)+e.children.length)})),e.inputs.forEach((function(t){if("control"!==t.category){var e=function(t,e,n){return e[m(t,n.currentContextId)]}(t.name,n,r);null!=e&&e.forEach((function(t){if(t&&!i.has(t.id)){var e=o[t.id];1===e?(t.dispose(),delete o[t.id]):null!=e&&o[t.id]--}}))}})))},t.prototype.executeAsync=function(t,e){return u(this,void 0,void 0,(function(){var n,r,i,a,o,s,u=this;return c(this,(function(c){switch(c.label){case 0:return t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e),n={},r=new J(this._weightMap,n),[4,this.executeWithControlFlow(t,r,e)];case 1:return i=c.sent(),a=e.map((function(t){return f(t,i,r)})),o=new Set(a.map((function(t){return t.id}))),s=new Set(Object.keys(t).map((function(e){return t[e].id}))),Object.keys(i).forEach((function(t){i[t].forEach((function(t){!t||t.isDisposed||o.has(t.id)||s.has(t.id)||-1!==u.weightIds.indexOf(t.id)||t.dispose()}))})),[2,a]}}))}))},t.prototype.executeWithControlFlow=function(t,e,n){return u(this,void 0,void 0,(function(){var r,i,a,o,u,l,h,p,d,m,g,y,x,b,w,_,S=this;return c(this,(function(c){switch(c.label){case 0:r=Object.keys(t),i=r.map((function(t){return S.graph.nodes[v(t)[0]]})),a=n.map((function(t){return S.graph.nodes[v(t)[0]]})),o=Z(t,a,this.weightMap),u=o.usedNodes,l=o.missingInputs,h=o.dynamicNode,p=o.syncInputs,d=i.concat(this.graph.weights).map((function(t){return{node:t,contexts:e.currentContext}})),m=s({},this.weightMap),Object.keys(t).forEach((function(e){var n=v(e),r=n[0],i=[];i[n[1]]=t[e],m[r]=i})),g={},y=this.getFrozenTensorIds(m),x={},c.label=1;case 1:return d.length>0?(b=this.processStack(i,d,e,m,x,y,n,g,u),[4,Promise.all(b)]):[3,3];case 2:return c.sent(),[3,1];case 3:if(null==h&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),(w=a.filter((function(t){return!et(t)&&!f(t.name,m,e)})).map((function(t){return t.name}))).length>0)throw _="",null!=h&&(_="Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs ["+p+"]"),new Error("Cannot compute the outputs ["+w+"] from the provided inputs ["+r+"]. Consider providing the following inputs: ["+l+"]. "+_);return[2,m]}}))}))},t.prototype.processStack=function(t,e,n,r,i,a,o,s,u){for(var c=this,l=[],h=function(){var h=e.pop();n.currentContext=h.contexts;var m="";if("Enter"===h.node.op&&p("isConstant",h.node,r,n)&&(m=d(h.node.name,n)[0]),-1===t.indexOf(h.node)){var v=K(h.node,r,n);m||(m=d(h.node.name,n)[0]);var g=n.currentContext;v instanceof Promise?l.push(v.then((function(t){return r[m]=t,n.currentContext=g,c.checkTensorForDisposal(m,h.node,r,n,a,o,s),c.processChildNodes(h.node,e,n,r,i,u),t}))):(r[m]=v,f.checkTensorForDisposal(m,h.node,r,n,a,o,s),f.processChildNodes(h.node,e,n,r,i,u))}else f.processChildNodes(h.node,e,n,r,i,u)},f=this;e.length>0;)h();return l},t.prototype.processChildNodes=function(t,e,n,r,i,a){t.children.forEach((function(t){var o=d(t.name,n)[0];!i[o]&&a.has(t.name)&&("Merge"===t.op?t.inputNames.some((function(t){return!!f(t,r,n)}))&&(i[o]=!0,e.push({contexts:n.currentContext,node:t})):t.inputNames.every((function(t){return!!f(t,r,n)}))&&(i[o]=!0,e.push({contexts:n.currentContext,node:t})))}))},t.prototype.dispose=function(){var t=this;Object.keys(this.weightMap).forEach((function(e){return t.weightMap[e].forEach((function(t){return t.dispose()}))}))},t.prototype.checkInputShapeAndType=function(t){var e=this;Object.keys(t).forEach((function(n){var r=t[n],i=v(n)[0],a=e.graph.nodes[i];if(a.attrParams.shape&&a.attrParams.shape.value){var s=a.attrParams.shape.value,u=s.length===r.shape.length&&r.shape.every((function(t,e){return-1===s[e]||s[e]===t}));o.Nc.assert(u,(function(){return"The shape of dict['"+a.name+"'] provided in model.execute(dict) must be ["+s+"], but was ["+r.shape+"]"}))}a.attrParams.dtype&&a.attrParams.dtype.value&&o.Nc.assert(r.dtype===a.attrParams.dtype.value,(function(){return"The dtype of dict['"+a.name+"'] provided in model.execute(dict) must be "+a.attrParams.dtype.value+", but was "+r.dtype}))}))},t.prototype.mapInputs=function(t){var e={};for(var n in t)null!=this._signature&&null!=this._signature.inputs&&null!=this._signature.inputs[n]?e[this._signature.inputs[n].name]=t[n]:e[n]=t[n];return e},t.prototype.checkInputs=function(t){var e=this,n=Object.keys(t).filter((function(t){var n=v(t)[0];return null==e.graph.nodes[n]}));if(n.length>0)throw new Error("The dict provided in model.execute(dict) has keys: ["+n+"] that are not part of graph")},t.prototype.mapOutputs=function(t){var e=this;return t.map((function(t){return null!=e._signature&&null!=e._signature.outputs&&null!=e._signature.outputs[t]?e._signature.outputs[t].name:t}),{})},t.prototype.checkOutputs=function(t){var e=this;t.forEach((function(t){var n=v(t)[0];if(!e.graph.nodes[n])throw new Error("The output '"+t+"' is not found in the graph")}))},t}(),it=function(){function t(t,e){void 0===e&&(e={}),this.modelUrl=t,this.loadOptions=e,this.version="n/a",null==e&&(this.loadOptions={})}return Object.defineProperty(t.prototype,"modelVersion",{get:function(){return this.version},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputNodes",{get:function(){return this.executor.inputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputNodes",{get:function(){return this.executor.outputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputs",{get:function(){return this.executor.inputs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputs",{get:function(){return this.executor.outputs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weights",{get:function(){return this.executor.weightMap},enumerable:!0,configurable:!0}),t.prototype.findIOHandler=function(){var t=this.modelUrl;if(null!=t.load)this.handler=t;else if(null!=this.loadOptions.requestInit)this.handler=o.jb.browserHTTPRequest(t,this.loadOptions);else{var e=o.jb.getLoadHandlers(t,this.loadOptions.onProgress);if(0===e.length)e.push(o.jb.browserHTTPRequest(t,this.loadOptions));else if(e.length>1)throw new Error("Found more than one ("+e.length+") load handlers for URL '"+[t]+"'");this.handler=e[0]}},t.prototype.load=function(){return u(this,void 0,void 0,(function(){var t,e,n,r;return c(this,(function(i){switch(i.label){case 0:if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return t=this,[4,this.handler.load()];case 1:return t.artifacts=i.sent(),e=this.artifacts.modelTopology,n={},null!=this.artifacts.userDefinedMetadata&&(n=this.artifacts.userDefinedMetadata.signature),this.version=e.versions.producer+"."+e.versions.minConsumer,r=o.jb.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs),this.executor=new rt(L.Instance.transformGraph(e,n)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),[2,!0]}}))}))},t.prototype.save=function(t,e){return u(this,void 0,void 0,(function(){var e;return c(this,(function(n){if("string"==typeof t){if(0===(e=o.jb.getSaveHandlers(t)).length)throw new Error("Cannot find any save handlers for URL '"+t+"'");if(e.length>1)throw new Error("Found more than one ("+e.length+") save handlers for URL '"+t+"'");t=e[0]}if(null==t.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[2,t.save(this.artifacts)]}))}))},t.prototype.predict=function(t,e){return this.execute(t,this.outputNodes)},t.prototype.normalizeInputs=function(t){if(!(t instanceof o.c||Array.isArray(t)))return t;if((t=Array.isArray(t)?t:[t]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,the graph model has "+this.inputNodes.length+" placeholders, while there are "+t.length+" input tensors.");return this.inputNodes.reduce((function(e,n,r){return e[n]=t[r],e}),{})},t.prototype.normalizeOutputs=function(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]},t.prototype.execute=function(t,e){t=this.normalizeInputs(t),e=this.normalizeOutputs(e);var n=this.executor.execute(t,e);return n.length>1?n:n[0]},t.prototype.executeAsync=function(t,e){return u(this,void 0,void 0,(function(){var n;return c(this,(function(r){switch(r.label){case 0:return t=this.normalizeInputs(t),e=this.normalizeOutputs(e),[4,this.executor.executeAsync(t,e)];case 1:return[2,(n=r.sent()).length>1?n:n[0]]}}))}))},t.prototype.convertTensorMapToTensorsMap=function(t){return Object.keys(t).reduce((function(e,n){return e[n]=[t[n]],e}),{})},t.prototype.dispose=function(){this.executor.dispose()},t}();function at(t,e){return void 0===e&&(e={}),u(this,void 0,void 0,(function(){var n;return c(this,(function(r){switch(r.label){case 0:if(null==t)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");return null==e&&(e={}),e.fromTFHub&&null==t.load&&(t.endsWith("/")||(t+="/"),t+="model.json?tfjs-format=file"),[4,(n=new it(t,e)).load()];case 1:return r.sent(),[2,n]}}))}))}}).call(this,n(132).Buffer)},function(t,e,n){t.exports=!n(10)&&!n(4)((function(){return 7!=Object.defineProperty(n(66)("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var r=n(3),i=n(9),a=n(34),o=n(67),s=n(11).f;t.exports=function(t){var e=i.Symbol||(i.Symbol=a?{}:r.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:o.f(t)})}},function(t,e,n){var r=n(15),i=n(17),a=n(55)(!1),o=n(68)("IE_PROTO");t.exports=function(t,e){var n,s=i(t),u=0,c=[];for(n in s)n!=o&&r(s,n)&&c.push(n);for(;e.length>u;)r(s,n=e[u++])&&(~a(c,n)||c.push(n));return c}},function(t,e,n){var r=n(11),i=n(5),a=n(35);t.exports=n(10)?Object.defineProperties:function(t,e){i(t);for(var n,o=a(e),s=o.length,u=0;s>u;)r.f(t,n=o[u++],e[n]);return t}},function(t,e,n){var r=n(17),i=n(38).f,a={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return o&&"[object Window]"==a.call(t)?function(t){try{return i(t)}catch(t){return o.slice()}}(t):i(r(t))}},function(t,e,n){"use strict";var r=n(10),i=n(35),a=n(56),o=n(50),s=n(12),u=n(49),c=Object.assign;t.exports=!c||n(4)((function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach((function(t){e[t]=t})),7!=c({},t)[n]||Object.keys(c({},e)).join("")!=r}))?function(t,e){for(var n=s(t),c=arguments.length,l=1,h=a.f,p=o.f;c>l;)for(var f,d=u(arguments[l++]),m=h?i(d).concat(h(d)):i(d),v=m.length,g=0;v>g;)f=m[g++],r&&!p.call(d,f)||(n[f]=d[f]);return n}:c},function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,n){"use strict";var r=n(21),i=n(6),a=n(106),o=[].slice,s={},u=function(t,e,n){if(!(e in s)){for(var r=[],i=0;i<e;i++)r[i]="a["+i+"]";s[e]=Function("F,a","return new F("+r.join(",")+")")}return s[e](t,n)};t.exports=Function.bind||function(t){var e=r(this),n=o.call(arguments,1),s=function(){var r=n.concat(o.call(arguments));return this instanceof s?u(e,r.length,r):a(e,r,t)};return i(e.prototype)&&(s.prototype=e.prototype),s}},function(t,e){t.exports=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var r=n(3).parseInt,i=n(43).trim,a=n(72),o=/^[-+]?0[xX]/;t.exports=8!==r(a+"08")||22!==r(a+"0x16")?function(t,e){var n=i(String(t),3);return r(n,e>>>0||(o.test(n)?16:10))}:r},function(t,e,n){var r=n(3).parseFloat,i=n(43).trim;t.exports=1/r(n(72)+"-0")!=-1/0?function(t){var e=i(String(t),3),n=r(e);return 0===n&&"-"==e.charAt(0)?-0:n}:r},function(t,e,n){var r=n(27);t.exports=function(t,e){if("number"!=typeof t&&"Number"!=r(t))throw TypeError(e);return+t}},function(t,e,n){var r=n(6),i=Math.floor;t.exports=function(t){return!r(t)&&isFinite(t)&&i(t)===t}},function(t,e){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,e,n){"use strict";var r=n(37),i=n(32),a=n(42),o={};n(16)(o,n(7)("iterator"),(function(){return this})),t.exports=function(t,e,n){t.prototype=r(o,{next:i(1,n)}),a(t,e+" Iterator")}},function(t,e,n){var r=n(5);t.exports=function(t,e,n,i){try{return i?e(r(n)[0],n[1]):e(n)}catch(e){var a=t.return;throw void 0!==a&&r(a.call(t)),e}}},function(t,e,n){var r=n(241);t.exports=function(t,e){return new(r(t))(e)}},function(t,e,n){var r=n(21),i=n(12),a=n(49),o=n(8);t.exports=function(t,e,n,s,u){r(e);var c=i(t),l=a(c),h=o(c.length),p=u?h-1:0,f=u?-1:1;if(n<2)for(;;){if(p in l){s=l[p],p+=f;break}if(p+=f,u?p<0:h<=p)throw TypeError("Reduce of empty array with no initial value")}for(;u?p>=0:h>p;p+=f)p in l&&(s=e(s,l[p],p,c));return s}},function(t,e,n){"use strict";var r=n(12),i=n(36),a=n(8);t.exports=[].copyWithin||function(t,e){var n=r(this),o=a(n.length),s=i(t,o),u=i(e,o),c=arguments.length>2?arguments[2]:void 0,l=Math.min((void 0===c?o:i(c,o))-u,o-s),h=1;for(u<s&&s<u+l&&(h=-1,u+=l-1,s+=l-1);l-- >0;)u in n?n[s]=n[u]:delete n[s],s+=h,u+=h;return n}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){"use strict";var r=n(87);n(1)({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},function(t,e,n){n(10)&&"g"!=/./g.flags&&n(11).f(RegExp.prototype,"flags",{configurable:!0,get:n(59)})},function(t,e,n){"use strict";var r,i,a,o,s=n(34),u=n(3),c=n(20),l=n(51),h=n(1),p=n(6),f=n(21),d=n(46),m=n(62),v=n(52),g=n(89).set,y=n(261)(),x=n(121),b=n(262),w=n(63),_=n(122),S=u.TypeError,M=u.process,E=M&&M.versions,T=E&&E.v8||"",C=u.Promise,A="process"==l(M),N=function(){},I=i=x.f,R=!!function(){try{var t=C.resolve(1),e=(t.constructor={})[n(7)("species")]=function(t){t(N,N)};return(A||"function"==typeof PromiseRejectionEvent)&&t.then(N)instanceof e&&0!==T.indexOf("6.6")&&-1===w.indexOf("Chrome/66")}catch(t){}}(),O=function(t){var e;return!(!p(t)||"function"!=typeof(e=t.then))&&e},k=function(t,e){if(!t._n){t._n=!0;var n=t._c;y((function(){for(var r=t._v,i=1==t._s,a=0,o=function(e){var n,a,o,s=i?e.ok:e.fail,u=e.resolve,c=e.reject,l=e.domain;try{s?(i||(2==t._h&&P(t),t._h=1),!0===s?n=r:(l&&l.enter(),n=s(r),l&&(l.exit(),o=!0)),n===e.promise?c(S("Promise-chain cycle")):(a=O(n))?a.call(n,u,c):u(n)):c(r)}catch(t){l&&!o&&l.exit(),c(t)}};n.length>a;)o(n[a++]);t._c=[],t._n=!1,e&&!t._h&&L(t)}))}},L=function(t){g.call(u,(function(){var e,n,r,i=t._v,a=D(t);if(a&&(e=b((function(){A?M.emit("unhandledRejection",i,t):(n=u.onunhandledrejection)?n({promise:t,reason:i}):(r=u.console)&&r.error&&r.error("Unhandled promise rejection",i)})),t._h=A||D(t)?2:1),t._a=void 0,a&&e.e)throw e.v}))},D=function(t){return 1!==t._h&&0===(t._a||t._c).length},P=function(t){g.call(u,(function(){var e;A?M.emit("rejectionHandled",t):(e=u.onrejectionhandled)&&e({promise:t,reason:t._v})}))},F=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),k(e,!0))},B=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw S("Promise can't be resolved itself");(e=O(t))?y((function(){var r={_w:n,_d:!1};try{e.call(t,c(B,r,1),c(F,r,1))}catch(t){F.call(r,t)}})):(n._v=t,n._s=1,k(n,!1))}catch(t){F.call({_w:n,_d:!1},t)}}};R||(C=function(t){d(this,C,"Promise","_h"),f(t),r.call(this);try{t(c(B,this,1),c(F,this,1))}catch(t){F.call(this,t)}},(r=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(47)(C.prototype,{then:function(t,e){var n=I(v(this,C));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=A?M.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&k(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),a=function(){var t=new r;this.promise=t,this.resolve=c(B,t,1),this.reject=c(F,t,1)},x.f=I=function(t){return t===C||t===o?new a(t):i(t)}),h(h.G+h.W+h.F*!R,{Promise:C}),n(42)(C,"Promise"),n(45)("Promise"),o=n(9).Promise,h(h.S+h.F*!R,"Promise",{reject:function(t){var e=I(this);return(0,e.reject)(t),e.promise}}),h(h.S+h.F*(s||!R),"Promise",{resolve:function(t){return _(s&&this===o?C:this,t)}}),h(h.S+h.F*!(R&&n(58)((function(t){C.all(t).catch(N)}))),"Promise",{all:function(t){var e=this,n=I(e),r=n.resolve,i=n.reject,a=b((function(){var n=[],a=0,o=1;m(t,!1,(function(t){var s=a++,u=!1;n.push(void 0),o++,e.resolve(t).then((function(t){u||(u=!0,n[s]=t,--o||r(n))}),i)})),--o||r(n)}));return a.e&&i(a.v),n.promise},race:function(t){var e=this,n=I(e),r=n.reject,i=b((function(){m(t,!1,(function(t){e.resolve(t).then(n.resolve,r)}))}));return i.e&&r(i.v),n.promise}})},function(t,e,n){"use strict";var r=n(21);function i(t){var e,n;this.promise=new t((function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r})),this.resolve=r(e),this.reject=r(n)}t.exports.f=function(t){return new i(t)}},function(t,e,n){var r=n(5),i=n(6),a=n(121);t.exports=function(t,e){if(r(t),i(e)&&e.constructor===t)return e;var n=a.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){"use strict";var r=n(11).f,i=n(37),a=n(47),o=n(20),s=n(46),u=n(62),c=n(78),l=n(117),h=n(45),p=n(10),f=n(31).fastKey,d=n(41),m=p?"_s":"size",v=function(t,e){var n,r=f(e);if("F"!==r)return t._i[r];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,c){var l=t((function(t,r){s(t,l,e,"_i"),t._t=e,t._i=i(null),t._f=void 0,t._l=void 0,t[m]=0,null!=r&&u(r,n,t[c],t)}));return a(l.prototype,{clear:function(){for(var t=d(this,e),n=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];t._f=t._l=void 0,t[m]=0},delete:function(t){var n=d(this,e),r=v(n,t);if(r){var i=r.n,a=r.p;delete n._i[r.i],r.r=!0,a&&(a.n=i),i&&(i.p=a),n._f==r&&(n._f=i),n._l==r&&(n._l=a),n[m]--}return!!r},forEach:function(t){d(this,e);for(var n,r=o(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!v(d(this,e),t)}}),p&&r(l.prototype,"size",{get:function(){return d(this,e)[m]}}),l},def:function(t,e,n){var r,i,a=v(t,e);return a?a.v=n:(t._l=a={i:i=f(e,!0),k:e,v:n,p:r=t._l,n:void 0,r:!1},t._f||(t._f=a),r&&(r.n=a),t[m]++,"F"!==i&&(t._i[i]=a)),t},getEntry:v,setStrong:function(t,e,n){c(t,e,(function(t,n){this._t=d(t,e),this._k=n,this._l=void 0}),(function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?l(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,l(1))}),n?"entries":"values",!n,!0),h(e)}}},function(t,e,n){"use strict";var r=n(47),i=n(31).getWeak,a=n(5),o=n(6),s=n(46),u=n(62),c=n(25),l=n(15),h=n(41),p=c(5),f=c(6),d=0,m=function(t){return t._l||(t._l=new v)},v=function(){this.a=[]},g=function(t,e){return p(t.a,(function(t){return t[0]===e}))};v.prototype={get:function(t){var e=g(this,t);if(e)return e[1]},has:function(t){return!!g(this,t)},set:function(t,e){var n=g(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=f(this.a,(function(e){return e[0]===t}));return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,a){var c=t((function(t,r){s(t,c,e,"_i"),t._t=e,t._i=d++,t._l=void 0,null!=r&&u(r,n,t[a],t)}));return r(c.prototype,{delete:function(t){if(!o(t))return!1;var n=i(t);return!0===n?m(h(this,e)).delete(t):n&&l(n,this._i)&&delete n[this._i]},has:function(t){if(!o(t))return!1;var n=i(t);return!0===n?m(h(this,e)).has(t):n&&l(n,this._i)}}),c},def:function(t,e,n){var r=i(a(e),!0);return!0===r?m(t).set(e,n):r[t._i]=n,t},ufstore:m}},function(t,e,n){var r=n(22),i=n(8);t.exports=function(t){if(void 0===t)return 0;var e=r(t),n=i(e);if(e!==n)throw RangeError("Wrong length!");return n}},function(t,e,n){var r=n(38),i=n(56),a=n(5),o=n(3).Reflect;t.exports=o&&o.ownKeys||function(t){var e=r.f(a(t)),n=i.f;return n?e.concat(n(t)):e}},function(t,e,n){var r=n(8),i=n(74),a=n(28);t.exports=function(t,e,n,o){var s=String(a(t)),u=s.length,c=void 0===n?" ":String(n),l=r(e);if(l<=u||""==c)return s;var h=l-u,p=i.call(c,Math.ceil(h/c.length));return p.length>h&&(p=p.slice(0,h)),o?p+s:s+p}},function(t,e,n){var r=n(10),i=n(35),a=n(17),o=n(50).f;t.exports=function(t){return function(e){for(var n,s=a(e),u=i(s),c=u.length,l=0,h=[];c>l;)n=u[l++],r&&!o.call(s,n)||h.push(t?[n,s[n]]:s[n]);return h}}},function(t,e){var n=t.exports={version:"2.6.11"};"number"==typeof __e&&(__e=n)},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function a(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new a(i.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new a(i.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n(342),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(26))},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n(346),i=n(347),a=n(348);function o(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(o()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return c(this,t,e,n)}function c(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=p(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|d(e,n),i=(t=s(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(u.isBuffer(e)){var n=0|f(e.length);return 0===(t=s(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?s(t,0):p(t,e);if("Buffer"===e.type&&a(e.data))return p(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function l(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e){if(l(e),t=s(t,e<0?0:0|f(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function p(t,e){var n=e.length<0?0:0|f(e.length);t=s(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function f(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function d(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return j(t).length;default:if(r)return U(t).length;e=(""+e).toLowerCase(),r=!0}}function m(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return N(this,e,n);case"utf8":case"utf-8":return T(this,e,n);case"ascii":return C(this,e,n);case"latin1":case"binary":return A(this,e,n);case"base64":return E(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function v(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function g(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:y(t,e,n,r,i);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):y(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function y(t,e,n,r,i){var a,o=1,s=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;o=2,s/=2,u/=2,n/=2}function c(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i){var l=-1;for(a=n;a<s;a++)if(c(t,a)===c(e,-1===l?0:a-l)){if(-1===l&&(l=a),a-l+1===u)return l*o}else-1!==l&&(a-=a-l),l=-1}else for(n+u>s&&(n=s-u),a=n;a>=0;a--){for(var h=!0,p=0;p<u;p++)if(c(t,a+p)!==c(e,p)){h=!1;break}if(h)return a}return-1}function x(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var a=e.length;if(a%2!=0)throw new TypeError("Invalid hex string");r>a/2&&(r=a/2);for(var o=0;o<r;++o){var s=parseInt(e.substr(2*o,2),16);if(isNaN(s))return o;t[n+o]=s}return o}function b(t,e,n,r){return W(U(e,t.length-n),t,n,r)}function w(t,e,n,r){return W(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function _(t,e,n,r){return w(t,e,n,r)}function S(t,e,n,r){return W(j(e),t,n,r)}function M(t,e,n,r){return W(function(t,e){for(var n,r,i,a=[],o=0;o<t.length&&!((e-=2)<0);++o)n=t.charCodeAt(o),r=n>>8,i=n%256,a.push(i),a.push(r);return a}(e,t.length-n),t,n,r)}function E(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function T(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var a,o,s,u,c=t[i],l=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=n)switch(h){case 1:c<128&&(l=c);break;case 2:128==(192&(a=t[i+1]))&&(u=(31&c)<<6|63&a)>127&&(l=u);break;case 3:a=t[i+1],o=t[i+2],128==(192&a)&&128==(192&o)&&(u=(15&c)<<12|(63&a)<<6|63&o)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:a=t[i+1],o=t[i+2],s=t[i+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&(u=(15&c)<<18|(63&a)<<12|(63&o)<<6|63&s)>65535&&u<1114112&&(l=u)}null===l?(l=65533,h=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=h}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=4096));return n}(r)}e.Buffer=u,e.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=o(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return c(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,n){return function(t,e,n,r){return l(e),e<=0?s(t,e):void 0!==n?"string"==typeof r?s(t,e).fill(n,r):s(t,e).fill(n):s(t,e)}(null,t,e,n)},u.allocUnsafe=function(t){return h(null,t)},u.allocUnsafeSlow=function(t){return h(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,a=Math.min(n,r);i<a;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!a(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=u.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var o=t[n];if(!u.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},u.byteLength=d,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)v(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)v(this,e,e+3),v(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)v(this,e,e+7),v(this,e+1,e+6),v(this,e+2,e+5),v(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?T(this,0,t):m.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,r,i){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var a=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(e>>>=0),s=Math.min(a,o),c=this.slice(r,i),l=t.slice(e,n),h=0;h<s;++h)if(c[h]!==l[h]){a=c[h],o=l[h];break}return a<o?-1:o<a?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return g(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return g(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return x(this,t,e,n);case"utf8":case"utf-8":return b(this,t,e,n);case"ascii":return w(this,t,e,n);case"latin1":case"binary":return _(this,t,e,n);case"base64":return S(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,e,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function C(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function A(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function N(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",a=e;a<n;++a)i+=z(t[a]);return i}function I(t,e,n){for(var r=t.slice(e,n),i="",a=0;a<r.length;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function R(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function O(t,e,n,r,i,a){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<a)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function k(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,a=Math.min(t.length-n,2);i<a;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function L(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,a=Math.min(t.length-n,4);i<a;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function D(t,e,n,r,i,a){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function P(t,e,n,r,a){return a||D(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function F(t,e,n,r,a){return a||D(t,0,n,8),i.write(t,e,n,r,52,8),n+8}u.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=u.prototype;else{var i=e-t;n=new u(i,void 0);for(var a=0;a<i;++a)n[a]=this[a+t]}return n},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=this[t],i=1,a=0;++a<e&&(i*=256);)r+=this[t+a]*i;return r},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},u.prototype.readUInt8=function(t,e){return e||R(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||R(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||R(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||R(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||R(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=this[t],i=1,a=0;++a<e&&(i*=256);)r+=this[t+a]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=e,i=1,a=this[t+--r];r>0&&(i*=256);)a+=this[t+--r]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*e)),a},u.prototype.readInt8=function(t,e){return e||R(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||R(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){e||R(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return e||R(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||R(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||R(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||R(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||R(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||R(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||O(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,a=0;for(this[e]=255&t;++a<n&&(i*=256);)this[e+a]=t/i&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||O(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,a=1;for(this[e+i]=255&t;--i>=0&&(a*=256);)this[e+i]=t/a&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):k(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):k(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):L(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):L(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);O(this,t,e,n,i-1,-i)}var a=0,o=1,s=0;for(this[e]=255&t;++a<n&&(o*=256);)t<0&&0===s&&0!==this[e+a-1]&&(s=1),this[e+a]=(t/o>>0)-s&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);O(this,t,e,n,i-1,-i)}var a=n-1,o=1,s=0;for(this[e+a]=255&t;--a>=0&&(o*=256);)t<0&&0===s&&0!==this[e+a+1]&&(s=1),this[e+a]=(t/o>>0)-s&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):k(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):k(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):L(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):L(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return P(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return P(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return F(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return F(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,a=r-n;if(this===t&&n<e&&e<r)for(i=a-1;i>=0;--i)t[i+e]=this[i+n];else if(a<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+a),e);return a},u.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var a;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(a=e;a<n;++a)this[a]=t;else{var o=u.isBuffer(t)?t:U(new u(t,r).toString()),s=o.length;for(a=0;a<n-e;++a)this[a+e]=o[a%s]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function z(t){return t<16?"0"+t.toString(16):t.toString(16)}function U(t,e){var n;e=e||1/0;for(var r=t.length,i=null,a=[],o=0;o<r;++o){if((n=t.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&a.push(239,191,189);continue}if(o+1===r){(e-=3)>-1&&a.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;a.push(n)}else if(n<2048){if((e-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function j(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(B,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function W(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(26))},function(t,e,n){"use strict";var r=n(2),i=function(){var t,e,n,i,a=new r.t;function o(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new l,this.unassigned=new l,this.vertices=[]}function s(){this.normal=new r.t,this.midpoint=new r.t,this.area=0,this.constant=0,this.outside=null,this.mark=0,this.edge=null}function u(t,e){this.vertex=t,this.prev=null,this.next=null,this.twin=null,this.face=e}function c(t){this.point=t,this.prev=null,this.next=null,this.face=null}function l(){this.head=null,this.tail=null}return Object.assign(o.prototype,{setFromPoints:function(t){!0!==Array.isArray(t)&&console.error("THREE.ConvexHull: Points parameter is not an array."),t.length<4&&console.error("THREE.ConvexHull: The algorithm needs at least four points."),this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.vertices.push(new c(t[e]));return this.compute(),this},setFromObject:function(t){var e=[];return t.updateMatrixWorld(!0),t.traverse((function(t){var n,i,a,o=t.geometry;if(void 0!==o)if(o.isGeometry){var s=o.vertices;for(n=0,i=s.length;n<i;n++)(a=s[n].clone()).applyMatrix4(t.matrixWorld),e.push(a)}else if(o.isBufferGeometry){var u=o.attributes.position;if(void 0!==u)for(n=0,i=u.count;n<i;n++)(a=new r.t).fromBufferAttribute(u,n).applyMatrix4(t.matrixWorld),e.push(a)}})),this.setFromPoints(e)},containsPoint:function(t){for(var e=this.faces,n=0,r=e.length;n<r;n++){if(e[n].distanceToPoint(t)>this.tolerance)return!1}return!0},intersectRay:function(t,e){for(var n=this.faces,r=-1/0,i=1/0,a=0,o=n.length;a<o;a++){var s=n[a],u=s.distanceToPoint(t.origin),c=s.normal.dot(t.direction);if(u>0&&c>=0)return null;var l=0!==c?-u/c:0;if(!(l<=0)&&(c>0?i=Math.min(l,i):r=Math.max(l,r),r>i))return null}return r!==-1/0?t.at(r,e):t.at(i,e),e},intersectsRay:function(t){return null!==this.intersectRay(t,a)},makeEmpty:function(){return this.faces=[],this.vertices=[],this},addVertexToFace:function(t,e){return t.face=e,null===e.outside?this.assigned.append(t):this.assigned.insertBefore(e.outside,t),e.outside=t,this},removeVertexFromFace:function(t,e){return t===e.outside&&(null!==t.next&&t.next.face===e?e.outside=t.next:e.outside=null),this.assigned.remove(t),this},removeAllVerticesFromFace:function(t){if(null!==t.outside){for(var e=t.outside,n=t.outside;null!==n.next&&n.next.face===t;)n=n.next;return this.assigned.removeSubList(e,n),e.prev=n.next=null,t.outside=null,e}},deleteFaceVertices:function(t,e){var n=this.removeAllVerticesFromFace(t);if(void 0!==n)if(void 0===e)this.unassigned.appendChain(n);else{var r=n;do{var i=r.next;e.distanceToPoint(r.point)>this.tolerance?this.addVertexToFace(r,e):this.unassigned.append(r),r=i}while(null!==r)}return this},resolveUnassignedPoints:function(t){if(!1===this.unassigned.isEmpty()){var e=this.unassigned.first();do{for(var n=e.next,r=this.tolerance,i=null,a=0;a<t.length;a++){var o=t[a];if(0===o.mark){var s=o.distanceToPoint(e.point);if(s>r&&(r=s,i=o),r>1e3*this.tolerance)break}}null!==i&&this.addVertexToFace(e,i),e=n}while(null!==e)}return this},computeExtremes:function(){var t,e,n,i=new r.t,a=new r.t,o=[],s=[];for(t=0;t<3;t++)o[t]=s[t]=this.vertices[0];for(i.copy(this.vertices[0].point),a.copy(this.vertices[0].point),t=0,e=this.vertices.length;t<e;t++){var u=this.vertices[t],c=u.point;for(n=0;n<3;n++)c.getComponent(n)<i.getComponent(n)&&(i.setComponent(n,c.getComponent(n)),o[n]=u);for(n=0;n<3;n++)c.getComponent(n)>a.getComponent(n)&&(a.setComponent(n,c.getComponent(n)),s[n]=u)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(i.x),Math.abs(a.x))+Math.max(Math.abs(i.y),Math.abs(a.y))+Math.max(Math.abs(i.z),Math.abs(a.z))),{min:o,max:s}},computeInitialHull:function(){void 0===t&&(t=new r.g,e=new r.l,n=new r.t);var i,a,o,u,c,l,h,p,f,d=this.vertices,m=this.computeExtremes(),v=m.min,g=m.max,y=0,x=0;for(l=0;l<3;l++)(f=g[l].point.getComponent(l)-v[l].point.getComponent(l))>y&&(y=f,x=l);for(a=v[x],o=g[x],y=0,t.set(a.point,o.point),l=0,h=this.vertices.length;l<h;l++)(i=d[l])!==a&&i!==o&&(t.closestPointToPoint(i.point,!0,n),(f=n.distanceToSquared(i.point))>y&&(y=f,u=i));for(y=-1,e.setFromCoplanarPoints(a.point,o.point,u.point),l=0,h=this.vertices.length;l<h;l++)(i=d[l])!==a&&i!==o&&i!==u&&(f=Math.abs(e.distanceToPoint(i.point)))>y&&(y=f,c=i);var b=[];if(e.distanceToPoint(c.point)<0)for(b.push(s.create(a,o,u),s.create(c,o,a),s.create(c,u,o),s.create(c,a,u)),l=0;l<3;l++)p=(l+1)%3,b[l+1].getEdge(2).setTwin(b[0].getEdge(p)),b[l+1].getEdge(1).setTwin(b[p+1].getEdge(0));else for(b.push(s.create(a,u,o),s.create(c,a,o),s.create(c,o,u),s.create(c,u,a)),l=0;l<3;l++)p=(l+1)%3,b[l+1].getEdge(2).setTwin(b[0].getEdge((3-l)%3)),b[l+1].getEdge(0).setTwin(b[p+1].getEdge(1));for(l=0;l<4;l++)this.faces.push(b[l]);for(l=0,h=d.length;l<h;l++)if((i=d[l])!==a&&i!==o&&i!==u&&i!==c){y=this.tolerance;var w=null;for(p=0;p<4;p++)(f=this.faces[p].distanceToPoint(i.point))>y&&(y=f,w=this.faces[p]);null!==w&&this.addVertexToFace(i,w)}return this},reindexFaces:function(){for(var t=[],e=0;e<this.faces.length;e++){var n=this.faces[e];0===n.mark&&t.push(n)}return this.faces=t,this},nextVertexToAdd:function(){if(!1===this.assigned.isEmpty()){var t,e=0,n=this.assigned.first().face,r=n.outside;do{var i=n.distanceToPoint(r.point);i>e&&(e=i,t=r),r=r.next}while(null!==r&&r.face===n);return t}},computeHorizon:function(t,e,n,r){var i;this.deleteFaceVertices(n),n.mark=1,i=null===e?e=n.getEdge(0):e.next;do{var a=i.twin,o=a.face;0===o.mark&&(o.distanceToPoint(t)>this.tolerance?this.computeHorizon(t,a,o,r):r.push(i)),i=i.next}while(i!==e);return this},addAdjoiningFace:function(t,e){var n=s.create(t,e.tail(),e.head());return this.faces.push(n),n.getEdge(-1).setTwin(e.twin),n.getEdge(0)},addNewFaces:function(t,e){this.newFaces=[];for(var n=null,r=null,i=0;i<e.length;i++){var a=e[i],o=this.addAdjoiningFace(t,a);null===n?n=o:o.next.setTwin(r),this.newFaces.push(o.face),r=o}return n.next.setTwin(r),this},addVertexToHull:function(t){var e=[];return this.unassigned.clear(),this.removeVertexFromFace(t,t.face),this.computeHorizon(t.point,null,t.face,e),this.addNewFaces(t,e),this.resolveUnassignedPoints(this.newFaces),this},cleanup:function(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this},compute:function(){var t;for(this.computeInitialHull();void 0!==(t=this.nextVertexToAdd());)this.addVertexToHull(t);return this.reindexFaces(),this.cleanup(),this}}),Object.assign(s,{create:function(t,e,n){var r=new s,i=new u(t,r),a=new u(e,r),o=new u(n,r);return i.next=o.prev=a,a.next=i.prev=o,o.next=a.prev=i,r.edge=i,r.compute()}}),Object.assign(s.prototype,{getEdge:function(t){for(var e=this.edge;t>0;)e=e.next,t--;for(;t<0;)e=e.prev,t++;return e},compute:function(){void 0===i&&(i=new r.q);var t=this.edge.tail(),e=this.edge.head(),n=this.edge.next.head();return i.set(t.point,e.point,n.point),i.getNormal(this.normal),i.getMidpoint(this.midpoint),this.area=i.getArea(),this.constant=this.normal.dot(this.midpoint),this},distanceToPoint:function(t){return this.normal.dot(t)-this.constant}}),Object.assign(u.prototype,{head:function(){return this.vertex},tail:function(){return this.prev?this.prev.vertex:null},length:function(){var t=this.head(),e=this.tail();return null!==e?e.point.distanceTo(t.point):-1},lengthSquared:function(){var t=this.head(),e=this.tail();return null!==e?e.point.distanceToSquared(t.point):-1},setTwin:function(t){return this.twin=t,t.twin=this,this}}),Object.assign(l.prototype,{first:function(){return this.head},last:function(){return this.tail},clear:function(){return this.head=this.tail=null,this},insertBefore:function(t,e){return e.prev=t.prev,e.next=t,null===e.prev?this.head=e:e.prev.next=e,t.prev=e,this},insertAfter:function(t,e){return e.prev=t,e.next=t.next,null===e.next?this.tail=e:e.next.prev=e,t.next=e,this},append:function(t){return null===this.head?this.head=t:this.tail.next=t,t.prev=this.tail,t.next=null,this.tail=t,this},appendChain:function(t){for(null===this.head?this.head=t:this.tail.next=t,t.prev=this.tail;null!==t.next;)t=t.next;return this.tail=t,this},remove:function(t){return null===t.prev?this.head=t.next:t.prev.next=t.next,null===t.next?this.tail=t.prev:t.next.prev=t.prev,this},removeSubList:function(t,e){return null===t.prev?this.head=e.next:t.prev.next=e.next,null===e.next?this.tail=t.prev:e.next.prev=t.prev,this},isEmpty:function(){return null===this.head}}),o}(),a=function(t){r.f.call(this),this.fromBufferGeometry(new o(t)),this.mergeVertices()};(a.prototype=Object.create(r.f.prototype)).constructor=a;var o=function(t){r.a.call(this);var e=[],n=[];void 0===i&&console.error("THREE.ConvexBufferGeometry: ConvexBufferGeometry relies on ConvexHull");for(var a=(new i).setFromPoints(t).faces,o=0;o<a.length;o++){var s=a[o],u=s.edge;do{var c=u.head().point;e.push(c.x,c.y,c.z),n.push(s.normal.x,s.normal.y,s.normal.z),u=u.next}while(u!==s.edge)}this.setAttribute("position",new r.e(e,3)),this.setAttribute("normal",new r.e(n,3))};o.prototype=Object.create(r.a.prototype),o.prototype.constructor=o},function(t,e,n){t.exports=n(341)},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(18),i=function(t,e,n,i,a){r.a.call(this),this.scene=t,this.camera=e,this.overrideMaterial=n,this.clearColor=i,this.clearAlpha=void 0!==a?a:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1};i.prototype=Object.assign(Object.create(r.a.prototype),{constructor:i,render:function(t,e,n){var r,i,a=t.autoClear;t.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(r=t.getClearColor().getHex(),i=t.getClearAlpha(),t.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&t.clearDepth(),t.setRenderTarget(this.renderToScreen?null:n),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),t.render(this.scene,this.camera),this.clearColor&&t.setClearColor(r,i),this.scene.overrideMaterial=null,t.autoClear=a}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(2);const i={uniforms:{tDiffuse:{value:null},u_time:{value:0},u_resolution:{value:new r.s},u_amp:{value:1}},defines:{PI:Math.PI,HALF_PI:.5*Math.PI},side:r.c,wireframe:!1,vertexShader:"\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",fragmentShader:"\nvarying vec2 vUv;\nuniform sampler2D tDiffuse;\n\nuniform vec2 u_resolution;\nuniform float u_time;\n\nvoid main(){\n  vec2 st = gl_FragCoord.xy/u_resolution;\n  vec4 pass = texture2D(tDiffuse, vUv);\n  vec3 background = vec3(1.0, 0.0, 0.0);\n\n  background = vec3(st.x, st.y, 1.0);\n\n  vec3 color = mix( vec3(pass.r, pass.g, pass.b), background, 1.0-pass.a);\n  gl_FragColor = vec4(color,1.0);\n}\n"},a=new r.p(i)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(2);const i={uniforms:{tDiffuse:{value:null},u_time:{value:0},u_resolution:{value:new r.s},u_amp:{value:1}},defines:{PI:Math.PI,HALF_PI:.5*Math.PI},side:r.c,wireframe:!1,vertexShader:"\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",fragmentShader:"\nvarying vec2 vUv;\nuniform sampler2D tDiffuse;\nuniform vec2 u_resolution;\nuniform float u_time;\n\nvoid main(){\n  vec2 st = gl_FragCoord.xy/u_resolution;\n  vec4 pass = texture2D(tDiffuse, vUv);\n  vec3 color = pass.rgb;\n  gl_FragColor = vec4(vec3(1.0)-color,1.0);\n}\n"},a=new r.p(i)},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r={faceInViewConfidence:1,boundingBox:{topLeft:[[173.06851196289062,151.05906677246094]],bottomRight:[[530.5841064453125,497.38525390625]]},mesh:[[89.054931640625,126.18965148925781,-5.771723747253418],[89.48878479003906,111.98844146728516,-19.152385711669922],[89.63025665283203,114.69213104248047,-7.952518939971924],[86.8283462524414,93.68411254882812,-17.52238655090332],[89.61792755126953,107.26671600341797,-21.41893768310547],[90.005859375,99.8963851928711,-21.237009048461914],[90.98297882080078,79.77373504638672,-14.974285125732422],[61.913246154785156,73.1738052368164,.4377647638320923],[91.44017791748047,63.43256378173828,-14.883930206298828],[91.54270935058594,56.11681365966797,-17.310197830200195],[92.41646575927734,30.877443313598633,-19.842634201049805],[88.93463134765625,128.46377563476562,-4.670099258422852],[88.95787048339844,130.00747680664062,-2.915038585662842],[89.01300048828125,130.47726440429688,-.8985353112220764],[88.87661743164062,131.35177612304688,.7919079661369324],[88.73638153076172,133.63075256347656,.7136856913566589],[88.6205062866211,136.3347625732422,.5818542242050171],[88.59442901611328,138.6674041748047,1.9134308099746704],[88.6728515625,140.6096649169922,6.530219554901123],[89.5050048828125,113.85385131835938,-16.68046760559082],[85.62223815917969,112.54943084716797,-11.140402793884277],[47.22810363769531,46.59907150268555,13.7774658203125],[74.55884552001953,78.3194808959961,-3.338404417037964],[70.29493713378906,78.72000885009766,-2.7120676040649414],[66.08026123046875,78.27571868896484,-1.4701876640319824],[60.663665771484375,74.19058227539062,1.591227412223816],[77.90364074707031,77.1884536743164,-3.1243202686309814],[67.44596099853516,63.60643005371094,-6.553516864776611],[72.37491607666016,64.25131225585938,-6.929609298706055],[63.09939193725586,64.26675415039062,-4.783821105957031],[60.44164276123047,66.06494903564453,-2.932424783706665],[57.460731506347656,76.9811782836914,4.2218780517578125],[75.07791137695312,143.6002655029297,13.584514617919922],[60.253875732421875,71.22456359863281,1.5571523904800415],[46.22798156738281,68.60318756103516,20.92812156677246],[53.013492584228516,71.60765838623047,7.398222923278809],[70.3131332397461,101.04841613769531,-1.4907941818237305],[84.37748718261719,125.24069213867188,-5.188694953918457],[85.2392578125,129.74142456054688,-2.2726454734802246],[79.80647277832031,126.06428527832031,-2.525554895401001],[77.23326110839844,127.04668426513672,.4265775978565216],[81.97472381591797,129.55076599121094,-.8342480659484863],[79.6242904663086,129.41119384765625,1.7393728494644165],[72.21800231933594,131.3857879638672,8.624199867248535],[86.19149017333984,111.66899871826172,-18.745351791381836],[85.74182891845703,107.0611343383789,-20.805999755859375],[54.801456451416016,60.00640869140625,-2.8515512943267822],[78.54601287841797,88.47759246826172,-5.34830379486084],[77.442138671875,107.35016632080078,-9.124465942382812],[77.2507553100586,104.09382629394531,-8.507699966430664],[58.6939811706543,98.1412353515625,3.51145601272583],[86.25041198730469,100.0961685180664,-19.878311157226562],[63.4761962890625,56.022159576416016,-10.730096817016602],[58.29613494873047,57.12236022949219,-7.035983562469482],[50.94441223144531,39.586578369140625,3.998593330383301],[81.6618423461914,61.58133316040039,-13.799996376037598],[76.62554931640625,66.4293441772461,-5.749605655670166],[69.58094024658203,127.36849212646484,8.523624420166016],[52.0644416809082,110.60575103759766,43.36610794067383],[80.22838592529297,110.18501281738281,-7.385328769683838],[83.27442169189453,112.08450317382812,-7.133739471435547],[74.2491226196289,128.7555694580078,7.524161338806152],[76.20523834228516,128.75733947753906,6.18845272064209],[56.184085845947266,53.08472442626953,-6.160211086273193],[77.47303771972656,108.87078094482422,-6.52554178237915],[70.8936538696289,56.967037200927734,-13.119375228881836],[70.16249084472656,52.814422607421875,-14.815312385559082],[67.34044647216797,31.71969223022461,-13.725871086120605],[53.47028732299805,46.57929611206055,-1.992255687713623],[69.20305633544922,42.78998947143555,-14.685680389404297],[52.3745231628418,56.61948013305664,-.1450599730014801],[49.70002746582031,52.204524993896484,6.080130577087402],[84.68077087402344,127.95401763916016,-4.19437313079834],[80.9397201538086,128.29823303222656,-1.8197126388549805],[78.36373138427734,128.3732147216797,.7760484218597412],[81.17520141601562,111.05281829833984,-6.243897438049316],[75.2703857421875,128.9117889404297,6.8056159019470215],[76.41622924804688,130.00160217285156,5.012405872344971],[76.55855560302734,128.35572814941406,6.151870250701904],[81.91841125488281,109.93296813964844,-13.108445167541504],[80.57417297363281,128.9547119140625,2.4063093662261963],[82.9238052368164,129.55714416503906,.8961117267608643],[85.80193328857422,130.0934295654297,-.36642125248908997],[83.85243225097656,140.10324096679688,6.707612991333008],[83.88330841064453,137.94261169433594,2.0838444232940674],[84.17402648925781,135.54141235351562,.9331744313240051],[84.7532730102539,132.90077209472656,1.0534906387329102],[85.25775146484375,131.00546264648438,1.2044521570205688],[79.71984100341797,129.654541015625,3.34256911277771],[79.00650024414062,130.3912811279297,3.051901340484619],[77.9241714477539,131.59814453125,2.895017623901367],[76.97775268554688,132.79605102539062,3.896287441253662],[73.63496398925781,120.71549224853516,.643551230430603],[47.65219497680664,85.7571029663086,42.61039733886719],[89.58653259277344,114.0855484008789,-11.141091346740723],[78.31550598144531,129.1161651611328,4.789862155914307],[77.47000122070312,129.53953552246094,4.756539821624756],[84.57841491699219,114.27533721923828,-6.693995475769043],[78.67337036132812,111.5709457397461,-3.172935724258423],[83.93395233154297,113.27975463867188,-7.034478187561035],[74.5946273803711,90.75202178955078,-3.091539144515991],[67.98797607421875,93.70638275146484,-.8960222601890564],[76.7698974609375,105.71083068847656,-5.8605756759643555],[57.15897750854492,34.47476577758789,-5.522735118865967],[59.54817581176758,43.188411712646484,-8.844557762145996],[61.99993896484375,51.66315460205078,-11.156942367553711],[75.21387481689453,134.4922332763672,7.626204490661621],[80.37322235107422,54.94788360595703,-16.672733306884766],[79.68292999267578,43.77192687988281,-18.01292610168457],[78.70500183105469,30.750017166137695,-18.468080520629883],[62.5748291015625,76.73029327392578,.22258906066417694],[53.17178726196289,79.8100357055664,7.154581546783447],[79.9637222290039,75.9896011352539,-2.9762187004089355],[56.806514739990234,66.97721862792969,.46252575516700745],[81.33381652832031,85.87931823730469,-7.419266700744629],[79.48255157470703,106.73643493652344,-13.429837226867676],[49.056434631347656,81.5252685546875,12.602285385131836],[55.78099060058594,84.6385269165039,4.481276512145996],[60.96821594238281,87.78378295898438,.9963825345039368],[69.00444030761719,87.57803344726562,-.913032054901123],[74.68511199951172,85.714111328125,-2.395080327987671],[78.58445739746094,83.81348419189453,-4.047336578369141],[87.01972198486328,80.65333557128906,-13.159431457519531],[49.73374557495117,92.43718719482422,14.070363998413086],[53.58036804199219,65.0705337524414,2.0322983264923096],[87.39920043945312,113.57673645019531,-16.44799041748047],[78.73954772949219,94.46247100830078,-5.744169235229492],[45.713375091552734,64.57733917236328,33.51588439941406],[81.66432189941406,81.8011703491211,-5.391898155212402],[76.58824920654297,105.11015319824219,-2.131429672241211],[59.06914520263672,70.68272399902344,2.3700873851776123],[79.503173828125,102.6990966796875,-12.684405326843262],[49.05481719970703,97.62574005126953,44.06196212768555],[79.77399444580078,74.10578155517578,-2.5646073818206787],[82.71109008789062,100.97991180419922,-17.063459396362305],[59.62936782836914,128.95957946777344,25.05092430114746],[60.048500061035156,131.438232421875,33.61614227294922],[46.576019287109375,89.48103332519531,28.31153106689453],[55.00115203857422,120.83814239501953,28.547208786010742],[47.66136169433594,59.59865188598633,14.411639213562012],[74.1763916015625,147.05592346191406,17.612096786499023],[87.87824249267578,113.81380462646484,-10.843281745910645],[75.34034729003906,97.4709243774414,-3.320580244064331],[49.693912506103516,71.23668670654297,11.410715103149414],[66.38796997070312,75.7287368774414,-1.7541943788528442],[70.27924346923828,76.2703857421875,-2.749863862991333],[75.2927017211914,130.4895782470703,5.859151840209961],[50.91526412963867,101.82449340820312,17.933759689331055],[80.57852172851562,153.26919555664062,20.413311004638672],[70.06169128417969,144.6354522705078,25.99988555908203],[65.51455688476562,139.21095275878906,29.20186424255371],[91.8982925415039,44.36961364746094,-19.2250919342041],[88.46189880371094,154.70729064941406,19.303442001342773],[73.8798828125,75.8255844116211,-3.1886675357818604],[77.15789794921875,74.84674835205078,-2.9487712383270264],[79.02696990966797,74.38951873779297,-2.427992343902588],[50.7369384765625,62.74702072143555,5.735904216766357],[76.13858795166016,70.44448852539062,-4.487869739532471],[72.26700592041016,68.81092834472656,-5.022618770599365],[68.21881866455078,68.4813003540039,-4.669045448303223],[64.38957214355469,69.05728149414062,-3.400237798690796],[62.27872848510742,70.11327362060547,-1.9615159034729004],[45.496070861816406,54.47982406616211,24.228174209594727],[63.766361236572266,74.56341552734375,-.5487459301948547],[89.45845794677734,118.12397766113281,-6.403785228729248],[76.71456146240234,118.6386489868164,-1.9407410621643066],[80.06694030761719,109.76296997070312,-9.156698226928711],[84.01213836669922,118.42071533203125,-5.692542552947998],[91.32398223876953,71.0627670288086,-13.662650108337402],[64.53822326660156,135.98895263671875,23.00619888305664],[69.2423095703125,141.47645568847656,20.656124114990234],[80.36599731445312,151.6042022705078,14.771096229553223],[55.85946273803711,122.20063781738281,39.21104431152344],[78.62303161621094,72.77344512939453,-3.385601282119751],[83.87261962890625,89.49967956542969,-12.553211212158203],[88.35012817382812,153.03564453125,13.74775505065918],[74.85113525390625,149.57460021972656,22.65628433227539],[48.093170166015625,100.11796569824219,30.540760040283203],[82.192626953125,130.34066772460938,2.1355702877044678],[81.4232177734375,131.65760803222656,1.8891499042510986],[80.54339599609375,133.5967559814453,1.6443722248077393],[79.91077423095703,135.76025390625,2.6223807334899902],[78.98492431640625,137.69451904296875,6.657173156738281],[77.68492126464844,129.06524658203125,4.026978015899658],[76.3822021484375,128.6490478515625,4.0168633460998535],[75.19639587402344,127.6917495727539,3.878803253173828],[71.13111114501953,123.8294906616211,4.194818019866943],[56.14270782470703,107.01744079589844,10.497638702392578],[84.22206115722656,83.00914001464844,-10.107391357421875],[82.57054901123047,70.63520812988281,-6.184993743896484],[80.28876495361328,70.90087127685547,-4.5142974853515625],[78.63153839111328,128.42965698242188,4.399217128753662],[56.31037521362305,116.81745910644531,19.257699966430664],[85.86679077148438,71.26364135742188,-11.050355911254883],[76.96888732910156,140.27334594726562,10.295825004577637],[90.35652160644531,93.23239135742188,-19.073148727416992],[86.81234741210938,87.6443099975586,-15.917254447937012],[90.65791320800781,86.89076232910156,-17.066160202026367],[80.82954406738281,97.34424591064453,-10.609243392944336],[88.35608673095703,149.29676818847656,10.37452220916748],[88.51920318603516,144.544921875,8.725729942321777],[82.62615966796875,143.6407470703125,9.413299560546875],[68.40502166748047,131.53541564941406,11.863387107849121],[73.0828857421875,108.4667739868164,-.3476767838001251],[72.24163055419922,136.2393798828125,11.364847183227539],[64.26612854003906,106.12425994873047,1.562770128250122],[69.59126281738281,113.00459289550781,1.449120044708252],[61.32645797729492,112.8049545288086,6.471096038818359],[81.14519500732422,148.0309600830078,11.377280235290527],[78.65748596191406,99.18505859375,-7.019320487976074],[65.34951782226562,132.97808837890625,16.92328643798828],[70.15591430664062,138.41558837890625,16.03822898864746],[65.48689270019531,126.06084442138672,10.91786003112793],[52.43769836425781,109.55050659179688,21.41824722290039],[60.797847747802734,124.23078155517578,15.018549919128418],[50.64815139770508,110.31202697753906,31.59935188293457],[67.03050231933594,118.77072143554688,4.855043411254883],[81.28197479248047,91.8909683227539,-8.953933715820312],[80.68563079833984,109.22351837158203,-14.028633117675781],[78.53791046142578,109.26091766357422,-9.295390129089355],[82.33988189697266,106.78788757324219,-17.187116622924805],[78.87403869628906,65.33313751220703,-8.201863288879395],[71.82551574707031,61.88962936401367,-8.936037063598633],[65.84967041015625,61.13762283325195,-8.16631031036377],[61.16575241088867,61.77916717529297,-5.993255615234375],[58.160400390625,63.657997131347656,-3.275754690170288],[56.49656295776367,71.2984390258789,4.225242614746094],[45.913970947265625,78.99742889404297,24.898462295532227],[59.61920166015625,79.90644836425781,2.5095982551574707],[63.84909439086914,82.21082305908203,.3487875759601593],[69.51898956298828,82.5594711303711,-1.2676407098770142],[74.74315643310547,81.54012298583984,-2.6287028789520264],[78.46691131591797,80.1444320678711,-3.0890607833862305],[81.08567810058594,78.93816375732422,-3.829049825668335],[46.82326889038086,74.7967300415039,39.218936920166016],[78.81403350830078,110.08915710449219,-7.176603317260742],[83.60173797607422,95.10543823242188,-14.295647621154785],[83.29833984375,110.46192932128906,-16.982494354248047],[85.31307220458984,112.32186889648438,-14.970945358276367],[83.31702423095703,110.68980407714844,-14.99482536315918],[79.83541870117188,111.36746215820312,-5.577889919281006],[86.10639190673828,113.07999420166016,-15.841806411743164],[86.53777313232422,113.3953628540039,-10.97762393951416],[81.2034683227539,74.5118637084961,-3.031883716583252],[83.18216705322266,76.3659896850586,-5.145124435424805],[84.169921875,78.08383178710938,-7.369376182556152],[61.09578323364258,70.82393646240234,-.41674062609672546],[58.898189544677734,67.87110900878906,-.34769970178604126],[93.88619232177734,93.70499420166016,-17.83666229248047],[121.77803039550781,73.21419525146484,-2.004124164581299],[93.68801879882812,112.67391204833984,-11.440197944641113],[139.67181396484375,47.25200271606445,10.134809494018555],[108.37935638427734,78.32365417480469,-4.926597595214844],[112.6679458618164,78.76957702636719,-4.606555461883545],[117.0418472290039,78.47392272949219,-3.655602216720581],[123.16342163085938,74.28951263427734,-1.0081568956375122],[105.10509490966797,77.1216049194336,-4.365277290344238],[116.10668182373047,63.42213439941406,-8.455821990966797],[111.01531982421875,64.10797882080078,-8.416177749633789],[120.650634765625,64.09034729003906,-6.9901041984558105],[123.47206115722656,65.9322509765625,-5.313669681549072],[126.3167724609375,77.36690521240234,1.4769021272659302],[102.68052673339844,144.01795959472656,12.587820053100586],[123.67687225341797,71.20038604736328,-1.0123307704925537],[139.5653076171875,69.43753814697266,17.08921241760254],[131.52589416503906,72.07632446289062,4.308371067047119],[110.6675033569336,101.56844329833984,-3.087123394012451],[93.7975845336914,125.41854095458984,-5.61952018737793],[92.8265151977539,129.9449462890625,-2.605703592300415],[98.516845703125,126.50403594970703,-3.367276191711426],[101.24057006835938,127.63096618652344,-.6771182417869568],[96.2422103881836,129.91009521484375,-1.527513027191162],[98.77693176269531,129.91944885253906,.7969744205474854],[106.34138488769531,132.09181213378906,7.206419944763184],[92.86328125,111.7437744140625,-18.981731414794922],[93.59686279296875,107.1738510131836,-21.083433151245117],[129.79949951171875,59.91814422607422,-5.702087879180908],[103.28998565673828,88.684326171875,-6.358852386474609],[102.62257385253906,107.75142669677734,-10.123950004577637],[103.181884765625,104.48422241210938,-9.54884147644043],[123.03778839111328,98.96839141845703,.9844361543655396],[93.8013916015625,100.19525909423828,-20.198549270629883],[120.40731811523438,55.691749572753906,-12.644633293151855],[126.03047180175781,56.84004211425781,-9.42164134979248],[135.66998291015625,40.06051254272461,.7780323028564453],[101.32807159423828,61.44487380981445,-14.438712120056152],[106.66768646240234,66.32499694824219,-6.947288513183594],[109.42125701904297,128.19979858398438,6.851851463317871],[131.60740661621094,111.77410125732422,39.93059539794922],[99.63980865478516,110.53423309326172,-8.13741397857666],[96.3495864868164,112.34441375732422,-7.526334285736084],[104.3837661743164,129.5421600341797,6.094000816345215],[102.5014419555664,129.45657348632812,4.925115585327148],[128.548583984375,52.89785385131836,-8.711894989013672],[102.68277740478516,109.31348419189453,-7.515427589416504],[112.51119232177734,56.67369079589844,-14.402713775634766],[113.4557113647461,52.583126068115234,-16.211336135864258],[118.15339660644531,31.959598541259766,-15.632973670959473],[132.11868286132812,46.82660675048828,-4.915998458862305],[115.27027130126953,42.78950500488281,-16.3385066986084],[132.67776489257812,56.7065544128418,-3.2785239219665527],[136.19105529785156,52.58128356933594,2.7065072059631348],[93.3692855834961,128.12391662597656,-4.556967735290527],[97.24618530273438,128.71435546875,-2.5974292755126953],[99.99201965332031,128.9362335205078,-.23473325371742249],[98.65431213378906,111.38021087646484,-6.873810291290283],[103.32971954345703,129.6300048828125,5.4681396484375],[101.99398803710938,130.64666748046875,3.903872489929199],[102.22512817382812,128.9897003173828,4.832220077514648],[97.61302947998047,110.18924713134766,-13.801066398620605],[97.94132232666016,129.44644165039062,1.5852315425872803],[95.44385528564453,129.89039611816406,.18933214247226715],[92.38137817382812,130.27069091796875,-.7451195120811462],[93.65667724609375,140.2670135498047,6.37144660949707],[93.3945541381836,138.12841796875,1.7464607954025269],[93.21961975097656,135.70547485351562,.5916262269020081],[92.88651275634766,133.07815551757812,.6797225475311279],[92.61618041992188,131.16412353515625,.8746253848075867],[98.5128402709961,130.0972900390625,2.467329502105713],[99.14161682128906,130.84182739257812,2.20583176612854],[100.07749938964844,132.0755157470703,1.999861478805542],[100.98474884033203,133.3367156982422,2.969301462173462],[105.57890319824219,121.32097625732422,-.690396785736084],[138.01976013183594,86.79922485351562,38.748207092285156],[100.22107696533203,129.6862335205078,3.7274839878082275],[100.98556518554688,130.1329803466797,3.6439754962921143],[94.84324645996094,114.48004913330078,-7.046141624450684],[101.34750366210938,112.03401184082031,-3.974306344985962],[95.61506652832031,113.4701156616211,-7.396814346313477],[107.2100601196289,91.07601165771484,-4.4428911209106445],[113.64984893798828,94.222900390625,-2.7322800159454346],[103.6575927734375,106.09909057617188,-6.909928321838379],[128.95443725585938,34.79903793334961,-8.177628517150879],[125.61666107177734,43.23957061767578,-11.16129207611084],[122.24160766601562,51.40730285644531,-13.225061416625977],[102.94417572021484,135.05284118652344,6.437448978424072],[102.84390258789062,54.77831268310547,-17.435373306274414],[104.30378723144531,43.81816482543945,-18.87225914001465],[106.31791687011719,30.912174224853516,-19.359281539916992],[120.89671325683594,76.92103576660156,-2.161745548248291],[130.63807678222656,80.41517639160156,4.057002544403076],[103.13054656982422,75.97669219970703,-4.063762664794922],[127.48533630371094,67.04229736328125,-2.3107142448425293],[100.57342529296875,86.02056121826172,-8.210302352905273],[100.3420181274414,107.02894592285156,-14.271526336669922],[135.05194091796875,82.31552124023438,9.071538925170898],[127.31817626953125,85.32596588134766,1.5646637678146362],[121.44873046875,88.38236236572266,-1.444227695465088],[113.1641616821289,87.97818756103516,-2.7463700771331787],[107.58496856689453,85.9525146484375,-3.8161683082580566],[103.69419860839844,83.9694595336914,-5.0915327072143555],[94.94142150878906,80.67749786376953,-13.529786109924316],[133.47825622558594,93.41374206542969,10.510080337524414],[131.07000732421875,65.30744934082031,-1.0331487655639648],[91.6125717163086,113.63219451904297,-16.58827781677246],[102.5608901977539,94.70323181152344,-6.772735595703125],[141.1190643310547,65.52788543701172,29.609560012817383],[100.66172790527344,81.84597778320312,-6.222558498382568],[104.05297088623047,105.53653717041016,-3.1839511394500732],[125.07494354248047,70.69706726074219,-.26345908641815186],[100.78704833984375,102.9781723022461,-13.530974388122559],[135.73837280273438,98.71896362304688,40.308677673339844],[103.49703216552734,74.03022003173828,-3.765385627746582],[97.47826385498047,101.13967895507812,-17.672422409057617],[120.9009017944336,129.811279296875,22.460485458374023],[120.92134094238281,132.26727294921875,30.97171401977539],[137.84854125976562,90.4866943359375,24.44916343688965],[126.69876098632812,121.8362045288086,25.47901153564453],[138.2628173828125,60.212730407714844,10.727043151855469],[103.52994537353516,147.51345825195312,16.372371673583984],[91.33110046386719,113.87635803222656,-10.951936721801758],[105.90912628173828,97.85295104980469,-4.577613353729248],[135.14016723632812,71.88645935058594,7.98612117767334],[116.86181640625,75.77165985107422,-3.918605089187622],[112.87037658691406,76.23102569580078,-4.696448802947998],[103.08973693847656,131.13287353515625,4.658698081970215],[131.6878662109375,102.855712890625,14.558646202087402],[96.61158752441406,153.5163116455078,19.72115135192871],[108.70101165771484,145.22119140625,24.24637794494629],[114.19940185546875,139.8957977294922,26.999357223510742],[109.2344970703125,75.74931335449219,-4.815374851226807],[106.05780029296875,74.81554412841797,-4.327030658721924],[104.20451354980469,74.3515853881836,-3.677772283554077],[134.3724822998047,63.127586364746094,2.4866178035736084],[107.16502380371094,70.35758209228516,-5.909609794616699],[111.12367248535156,68.69847869873047,-6.673973083496094],[115.21566772460938,68.35652923583984,-6.551760673522949],[119.15869903564453,68.928466796875,-5.543217182159424],[121.42355346679688,70.04236602783203,-4.262943267822266],[141.46737670898438,55.29999542236328,20.368043899536133],[119.70712280273438,74.60806274414062,-2.9066455364227295],[102.62487030029297,119.10464477539062,-2.9727885723114014],[99.72122955322266,110.1302261352539,-9.85580062866211],[94.9296875,118.60000610351562,-6.134425640106201],[114.96246337890625,136.7334442138672,20.87492561340332],[109.4001693725586,142.05551147460938,18.94097137451172],[96.6453857421875,151.87802124023438,14.0394287109375],[126.542236328125,123.23578643798828,36.094486236572266],[104.65280151367188,72.75566864013672,-4.664144515991211],[97.4369888305664,89.63179779052734,-13.129295349121094],[103.00697326660156,150.03854370117188,21.34419822692871],[135.5844268798828,101.18937683105469,26.860319137573242],[95.83648681640625,130.63888549804688,1.4957607984542847],[96.43431091308594,131.9720916748047,1.2079373598098755],[97.1075210571289,133.93011474609375,.9939720034599304],[97.60787200927734,136.11166381835938,1.957046389579773],[98.79606628417969,138.0584716796875,5.805955410003662],[100.90010833740234,129.66909790039062,2.8432364463806152],[102.17147064208984,129.28173828125,2.6949214935302734],[103.38750457763672,128.37948608398438,2.5169785022735596],[107.91474151611328,124.5724105834961,2.509226083755493],[125.35200500488281,107.94500732421875,7.671667098999023],[97.7138442993164,83.0916976928711,-10.674957275390625],[100.50724029541016,70.57563781738281,-6.8899664878845215],[102.95149230957031,70.8201904296875,-5.547928810119629],[100.087158203125,128.9794921875,3.3069326877593994],[124.87811279296875,117.7708740234375,16.380374908447266],[96.86013793945312,71.2078628540039,-11.403491973876953],[100.87671661376953,140.68515014648438,9.367562294006348],[94.4912338256836,87.71263122558594,-16.24195098876953],[99.97796630859375,97.56461334228516,-11.320963859558105],[94.681396484375,143.84390258789062,8.941465377807617],[110.52981567382812,132.306884765625,10.174334526062012],[107.35437774658203,108.99964904785156,-1.6638107299804688],[106.17288970947266,136.85728454589844,10.023663520812988],[116.47810363769531,106.84890747070312,-.4140018820762634],[110.49154663085938,113.66331481933594,-.17029017210006714],[119.19223022460938,113.61908721923828,4.210831642150879],[95.9156265258789,148.3019561767578,10.756365776062012],[102.25003051757812,99.47122955322266,-7.9504714012146],[113.90139770507812,133.76930236816406,14.981179237365723],[108.34040069580078,139.04026794433594,14.569025993347168],[113.95584106445312,126.88710021972656,8.856818199157715],[129.66851806640625,110.6407470703125,18.18902015686035],[119.28548431396484,125.1171875,12.668798446655273],[132.26356506347656,111.37715148925781,28.132522583007812],[112.69183349609375,119.56668090820312,2.99090838432312],[100.01276397705078,92.06544494628906,-9.69819164276123],[98.8886947631836,109.49353790283203,-14.787826538085938],[101.32917022705078,109.62189483642578,-10.122035026550293],[97.23851776123047,106.97297668457031,-17.774524688720703],[104.27458190917969,65.18982696533203,-9.223087310791016],[111.52862548828125,61.68748474121094,-10.38960075378418],[117.76793670654297,60.87849426269531,-10.038704872131348],[122.73090362548828,61.557403564453125,-8.292969703674316],[126.01435089111328,63.54138946533203,-5.837630271911621],[127.72102355957031,71.51353454589844,1.349062204360962],[139.2412872314453,79.91300201416016,20.93846321105957],[123.68875122070312,80.29885864257812,-.05198252573609352],[119.00945281982422,82.59548950195312,-1.9043240547180176],[113.10311126708984,82.82524108886719,-3.1343984603881836],[107.90892791748047,81.6607894897461,-4.057972431182861],[104.22156524658203,80.21002960205078,-4.165782928466797],[101.64105987548828,78.96903228759766,-4.7713847160339355],[139.5089569091797,75.84208679199219,35.2398567199707],[101.15185546875,110.46572875976562,-8.032480239868164],[97.13822937011719,95.24833679199219,-14.934316635131836],[95.91119384765625,110.61497497558594,-17.488929748535156],[93.8702163696289,112.47052764892578,-15.21498966217041],[95.99942779541016,110.89846801757812,-15.489232063293457],[100.12665557861328,111.759521484375,-6.285254001617432],[92.97445678710938,113.18863677978516,-16.098814010620117],[92.68242645263672,113.50617218017578,-11.179969787597656],[101.93659973144531,74.47428894042969,-4.020853042602539],[99.62765502929688,76.37248229980469,-5.8502068519592285],[98.29678344726562,78.09976196289062,-7.916255950927734],[122.68986511230469,70.76102447509766,-2.8434669971466064],[125.13208770751953,67.78596496582031,-2.8994388580322266]],scaledMesh:[[340.8323974609375,386.5469970703125,-5.771723747253418],[341.9098815917969,360.09564208984375,-19.152385711669922],[342.26123046875,365.131591796875,-7.952518939971924],[335.302734375,326.0018310546875,-17.52238655090332],[342.2305908203125,351.3009033203125,-21.41893768310547],[343.19403076171875,337.5728759765625,-21.237009048461914],[345.6206970214844,300.09222412109375,-14.974285125732422],[273.42633056640625,287.7991027832031,.4377647638320923],[346.75616455078125,269.65496826171875,-14.883930206298828],[347.01080322265625,256.028564453125,-17.310197830200195],[349.1807556152344,209.0174560546875,-19.842634201049805],[340.5336608886719,390.78277587890625,-4.670099258422852],[340.59136962890625,393.6581115722656,-2.915038585662842],[340.728271484375,394.53314208984375,-.8985353112220764],[340.38958740234375,396.1620178222656,.7919079661369324],[340.04132080078125,400.4068603515625,.7136856913566589],[339.7535400390625,405.443359375,.5818542242050171],[339.68878173828125,409.7881774902344,1.9134308099746704],[339.883544921875,413.4058532714844,6.530219554901123],[341.9501647949219,363.5701904296875,-16.68046760559082],[332.307373046875,361.14056396484375,-11.140402793884277],[236.9559326171875,238.30072021484375,13.7774658203125],[304.83154296875,297.38348388671875,-3.338404417037964],[294.2421875,298.1295166015625,-2.7120676040649414],[283.77508544921875,297.302001953125,-1.4701876640319824],[270.322998046875,289.6929626464844,1.591227412223816],[313.1383056640625,295.2768249511719,-3.1243202686309814],[287.1667785644531,269.97882080078125,-6.553516864776611],[299.40777587890625,271.1799621582031,-6.929609298706055],[276.37213134765625,271.208740234375,-4.783821105957031],[269.7716064453125,274.5580749511719,-2.932424783706665],[262.3685607910156,294.8907470703125,4.2218780517578125],[306.1206359863281,418.9761962890625,13.584514617919922],[269.3052978515625,284.1684265136719,1.5571523904800415],[234.47213745117188,279.28582763671875,20.92812156677246],[251.3238983154297,284.8819885253906,7.398222923278809],[294.287353515625,339.7186584472656,-1.4907941818237305],[329.2160339355469,384.7794494628906,-5.188694953918457],[331.3562316894531,393.16253662109375,-2.2726454734802246],[317.86395263671875,386.3134765625,-2.525554895401001],[311.4734191894531,388.143310546875,.4265775978565216],[323.248779296875,392.80743408203125,-.8342480659484863],[317.4115295410156,392.5474853515625,1.7393728494644165],[299.01806640625,396.2253723144531,8.624199867248535],[333.7210998535156,359.50067138671875,-18.745351791381836],[332.6043701171875,350.9179992675781,-20.805999755859375],[255.7642822265625,263.27337646484375,-2.8515512943267822],[314.733642578125,316.3041076660156,-5.34830379486084],[311.9921875,351.45635986328125,-9.124465942382812],[311.5168762207031,345.39105224609375,-8.507699966430664],[265.43133544921875,334.3037109375,3.51145601272583],[333.867431640625,337.94500732421875,-19.878311157226562],[277.30792236328125,255.85226440429688,-10.730096817016602],[264.44329833984375,257.9015197753906,-7.035983562469482],[246.18536376953125,225.23916625976562,3.998593330383301],[322.47174072265625,266.20684814453125,-13.799996376037598],[309.96417236328125,275.23681640625,-5.749605655670166],[292.4689636230469,388.7427062988281,8.523624420166016],[248.96693420410156,357.520263671875,43.36610794067383],[318.91180419921875,356.736572265625,-7.385328769683838],[326.4765625,360.27459716796875,-7.133739471435547],[304.0623474121094,391.3262939453125,7.524161338806152],[308.92034912109375,391.32958984375,6.18845272064209],[259.1980285644531,250.38096618652344,-6.160211086273193],[312.06890869140625,354.2886657714844,-6.52554178237915],[295.72906494140625,257.6122131347656,-13.119375228881836],[293.9132385253906,249.87750244140625,-14.815312385559082],[286.90472412109375,210.5862274169922,-13.725871086120605],[252.45834350585938,238.26388549804688,-1.992255687713623],[291.530517578125,231.2058868408203,-14.685680389404297],[249.7370147705078,256.96484375,-.1450599730014801],[243.09494018554688,248.7415008544922,6.080130577087402],[329.96923828125,389.83331298828125,-4.19437313079834],[320.6783752441406,390.4744567871094,-1.8197126388549805],[314.28094482421875,390.6141357421875,.7760484218597412],[321.26318359375,358.35296630859375,-6.243897438049316],[306.5986328125,391.61724853515625,6.8056159019470215],[309.4443359375,393.64715576171875,5.012405872344971],[309.79779052734375,390.58154296875,6.151870250701904],[323.10894775390625,356.2671203613281,-13.108445167541504],[319.7705383300781,391.69720458984375,2.4063093662261963],[325.6058349609375,392.8193359375,.8961117267608643],[332.7536315917969,393.8182067871094,-.36642125248908997],[327.91204833984375,412.46258544921875,6.707612991333008],[327.98876953125,408.43817138671875,2.0838444232940674],[328.71075439453125,403.9656982421875,.9331744313240051],[330.1492919921875,399.04718017578125,1.0534906387329102],[331.40216064453125,395.5169677734375,1.2044521570205688],[317.6488037109375,393.000732421875,3.34256911277771],[315.87725830078125,394.37298583984375,3.051901340484619],[313.1893005371094,396.62091064453125,2.895017623901367],[310.8388671875,398.8521423339844,3.896287441253662],[302.537109375,376.35076904296875,.643551230430603],[238.0091552734375,311.23687744140625,42.61039733886719],[342.15264892578125,364.00177001953125,-11.141091346740723],[314.1611633300781,391.9979248046875,4.789862155914307],[312.0613708496094,392.7864990234375,4.756539821624756],[329.71502685546875,364.3552551269531,-6.693995475769043],[315.0499267578125,359.3180236816406,-3.172935724258423],[328.114501953125,362.5008544921875,-7.034478187561035],[304.92041015625,320.54046630859375,-3.091539144515991],[288.51287841796875,326.0433044433594,-.8960222601890564],[310.3226623535156,348.40289306640625,-5.8605756759643555],[261.619140625,215.71786499023438,-5.522735118865967],[267.5527038574219,231.947998046875,-8.844557762145996],[273.6416320800781,247.73313903808594,-11.156942367553711],[306.45831298828125,402.011474609375,7.626204490661621],[319.271484375,253.851318359375,-16.672733306884766],[317.5571594238281,233.03485107421875,-18.01292610168457],[315.12847900390625,208.7801055908203,-18.468080520629883],[275.0693664550781,294.4234619140625,.22258906066417694],[251.71701049804688,300.1598205566406,7.154581546783447],[318.2545166015625,293.0438232421875,-2.9762187004089355],[260.74383544921875,276.25726318359375,.46252575516700745],[321.6571044921875,311.46453857421875,-7.419266700744629],[317.05950927734375,350.313232421875,-13.429837226867676],[241.49658203125,303.3546142578125,12.602285385131836],[258.19696044921875,309.1534118652344,4.481276512145996],[271.079345703125,315.0118103027344,.9963825345039368],[291.0372314453125,314.6285705566406,-.913032054901123],[305.1451416015625,311.15679931640625,-2.395080327987671],[314.8291015625,307.61669921875,-4.047336578369141],[335.77801513671875,301.7305603027344,-13.159431457519531],[243.17868041992188,323.6792907714844,14.070363998413086],[252.73171997070312,272.70587158203125,2.0322983264923096],[336.7204284667969,363.05401611328125,-16.44799041748047],[315.21429443359375,327.45159912109375,-5.744169235229492],[233.19412231445312,271.7872314453125,33.51588439941406],[322.4779052734375,303.8685302734375,-5.391898155212402],[309.8715515136719,347.2840881347656,-2.131429672241211],[266.363037109375,283.1591796875,2.3700873851776123],[317.1107177734375,342.793212890625,-12.684405326843262],[241.4925537109375,333.3435363769531,44.06196212768555],[317.7833251953125,289.5350341796875,-2.5646073818206787],[325.07757568359375,339.591064453125,-17.063459396362305],[267.75433349609375,391.706298828125,25.05092430114746],[268.7952575683594,396.32305908203125,33.61614227294922],[235.33648681640625,318.1731262207031,28.31153106689453],[256.2602233886719,376.5792236328125,28.547208786010742],[238.03192138671875,262.5138854980469,14.411639213562012],[303.8817138671875,425.4127197265625,17.612096786499023],[337.9101257324219,363.49560546875,-10.843281745910645],[306.77239990234375,333.05517578125,-3.320580244064331],[243.07974243164062,284.1910095214844,11.410715103149414],[284.53924560546875,292.5579528808594,-1.7541943788528442],[294.20318603515625,293.56683349609375,-2.749863862991333],[306.654052734375,394.55609130859375,5.859151840209961],[246.1129608154297,341.1641845703125,17.933759689331055],[319.7813415527344,436.9856262207031,20.413311004638672],[293.66290283203125,420.9043273925781,25.99988555908203],[282.3701477050781,410.80059814453125,29.20186424255371],[347.89385986328125,234.14810180664062,-19.2250919342041],[339.359619140625,439.66424560546875,19.303442001342773],[303.1453552246094,292.73834228515625,-3.1886675357818604],[311.2862548828125,290.9151611328125,-2.9487712383270264],[315.9281005859375,290.0635070800781,-2.427992343902588],[245.67010498046875,268.3780517578125,5.735904216766357],[308.75482177734375,282.7154541015625,-4.487869739532471],[299.1397705078125,279.6727600097656,-5.022618770599365],[289.0861511230469,279.05877685546875,-4.669045448303223],[279.5762634277344,280.1316223144531,-3.400237798690796],[274.333984375,282.0985107421875,-1.9615159034729004],[232.65444946289062,252.9794921875,24.228174209594727],[278.02850341796875,290.38739013671875,-.5487459301948547],[341.8345947265625,371.5237731933594,-6.403785228729248],[310.18524169921875,372.482421875,-1.9407410621643066],[318.5108337402344,355.9504699707031,-9.156698226928711],[328.3087158203125,372.07647705078125,-5.692542552947998],[346.46759033203125,283.8670654296875,-13.662650108337402],[279.9454345703125,404.79925537109375,23.00619888305664],[291.62799072265625,415.0203552246094,20.656124114990234],[319.2535400390625,433.8843994140625,14.771096229553223],[258.391845703125,379.11700439453125,39.21104431152344],[314.9249267578125,287.05340576171875,-3.385601282119751],[327.96221923828125,318.2078552246094,-12.553211212158203],[339.08203125,436.5506286621094,13.74775505065918],[305.55743408203125,430.1040344238281,22.65628433227539],[239.1043243408203,337.985595703125,30.540760040283203],[323.78997802734375,394.2787170410156,2.1355702877044678],[321.879150390625,396.7316589355469,1.8891499042510986],[319.694091796875,400.3435363769531,1.6443722248077393],[318.12298583984375,404.373291015625,2.6223807334899902],[315.82366943359375,407.97607421875,6.657173156738281],[312.5951232910156,391.9031066894531,4.026978015899658],[309.3598327636719,391.12786865234375,4.0168633460998535],[306.4148864746094,389.34478759765625,3.878803253173828],[296.31878662109375,382.15093994140625,4.194818019866943],[259.09527587890625,350.83660888671875,10.497638702392578],[328.83001708984375,306.1184997558594,-10.107391357421875],[324.728515625,283.0706787109375,-6.184993743896484],[319.0617370605469,283.56549072265625,-4.5142974853515625],[314.946044921875,390.71923828125,4.399217128753662],[259.51165771484375,369.0902404785156,19.257699966430664],[332.9147033691406,284.2412109375,-11.050355911254883],[310.8168640136719,412.7794189453125,10.295825004577637],[344.0649108886719,325.16046142578125,-19.073148727416992],[335.26300048828125,314.75201416015625,-15.917254447937012],[344.81341552734375,313.34844970703125,-17.066160202026367],[320.4047546386719,332.8192138671875,-10.609243392944336],[339.09686279296875,429.5865478515625,10.37452220916748],[339.501953125,420.7357177734375,8.725729942321777],[324.86663818359375,419.05157470703125,9.413299560546875],[289.548583984375,396.5040588378906,11.863387107849121],[301.166015625,353.5361633300781,-.3476767838001251],[299.0767822265625,405.2657165527344,11.364847183227539],[279.26971435546875,349.1729736328125,1.562770128250122],[292.4945983886719,361.98834228515625,1.449120044708252],[271.96905517578125,361.61651611328125,6.471096038818359],[321.18865966796875,427.2288513183594,11.377280235290527],[315.0104675292969,336.2479248046875,-7.019320487976074],[281.96026611328125,399.19122314453125,16.92328643798828],[293.89691162109375,409.31915283203125,16.03822898864746],[282.30145263671875,386.30706787109375,10.91786003112793],[249.89390563964844,355.55474853515625,21.41824722290039],[270.65625,382.89837646484375,15.018549919128418],[245.4495849609375,356.97314453125,31.59935188293457],[286.1349792480469,372.7283935546875,4.855043411254883],[321.52838134765625,322.6618957519531,-8.953933715820312],[320.04736328125,354.9456787109375,-14.028633117675781],[314.7135009765625,355.0153503417969,-9.295390129089355],[324.1556701660156,350.4090576171875,-17.187116622924805],[315.54827880859375,273.19500732421875,-8.201863288879395],[298.0433349609375,266.78106689453125,-8.936037063598633],[283.202392578125,265.38037109375,-8.16631031036377],[271.5699462890625,266.5753173828125,-5.993255615234375],[264.106201171875,270.0748596191406,-3.275754690170288],[259.97406005859375,284.3060302734375,4.225242614746094],[233.6923065185547,298.646240234375,24.898462295532227],[267.7290954589844,300.33941650390625,2.5095982551574707],[278.2340087890625,304.63153076171875,.3487875759601593],[292.31512451171875,305.28094482421875,-1.2676407098770142],[305.2892761230469,303.3822937011719,-2.6287028789520264],[314.53717041015625,300.78265380859375,-3.0890607833862305],[321.0408630371094,298.5358581542969,-3.829049825668335],[235.95053100585938,290.82196044921875,39.218936920166016],[315.3992614746094,356.55804443359375,-7.176603317260742],[327.28948974609375,328.6492004394531,-14.295647621154785],[326.5359802246094,357.25238037109375,-16.982494354248047],[331.53955078125,360.7167053222656,-14.970945358276367],[326.5823974609375,357.67681884765625,-14.99482536315918],[317.93585205078125,358.93902587890625,-5.577889919281006],[333.509765625,362.1287841796875,-15.841806411743164],[334.5810852050781,362.7161865234375,-10.97762393951416],[321.3333740234375,290.2913818359375,-3.031883716583252],[326.2474670410156,293.7449035644531,-5.145124435424805],[328.7005615234375,296.944580078125,-7.369376182556152],[271.39617919921875,283.4222106933594,-.41674062609672546],[265.9384765625,277.9222412109375,-.34769970178604126],[352.830810546875,326.04071044921875,-17.83666229248047],[422.099853515625,287.87432861328125,-2.004124164581299],[352.338623046875,361.3724365234375,-11.440197944641113],[466.53887939453125,239.51687622070312,10.134809494018555],[388.82440185546875,297.3912658691406,-4.926597595214844],[399.47509765625,298.22186279296875,-4.606555461883545],[410.337646484375,297.671142578125,-3.655602216720581],[425.54046630859375,289.8772277832031,-1.0081568956375122],[380.69281005859375,295.1523132324219,-4.365277290344238],[408.01513671875,269.6355285644531,-8.455821990966797],[395.37078857421875,270.9129943847656,-8.416177749633789],[419.29998779296875,270.8801574707031,-6.9901041984558105],[426.3070068359375,274.3109130859375,-5.313669681549072],[433.371826171875,295.6092224121094,1.4769021272659302],[374.67144775390625,419.7541809082031,12.587820053100586],[426.81561279296875,284.1234130859375,-1.0123307704925537],[466.2744140625,280.83990478515625,17.08921241760254],[446.30859375,285.75494384765625,4.308371067047119],[394.50701904296875,340.687255859375,-3.087123394012451],[352.6107482910156,385.1107177734375,-5.61952018737793],[350.1990966796875,393.5416259765625,-2.605703592300415],[364.33099365234375,387.132568359375,-3.367276191711426],[371.0953369140625,389.2315979003906,-.6771182417869568],[358.68194580078125,393.47674560546875,-1.527513027191162],[364.9768981933594,393.494140625,.7969744205474854],[383.76312255859375,397.5404052734375,7.206419944763184],[350.2904052734375,359.63995361328125,-18.981731414794922],[352.11224365234375,351.1279602050781,-21.083433151245117],[442.0211181640625,263.1089782714844,-5.702087879180908],[376.18499755859375,316.68914794921875,-6.358852386474609],[374.52752685546875,352.2037353515625,-10.123950004577637],[375.91656494140625,346.11822509765625,-9.54884147644043],[425.22845458984375,335.8443603515625,.9844361543655396],[352.62017822265625,338.1295471191406,-20.198549270629883],[418.69573974609375,255.23684692382812,-12.644633293151855],[432.6607666015625,257.37567138671875,-9.42164134979248],[456.60040283203125,226.12193298339844,.7780323028564453],[371.3126220703125,265.9526672363281,-14.438712120056152],[384.573486328125,275.0424499511719,-6.947288513183594],[391.4119873046875,390.2911071777344,6.851851463317871],[446.51104736328125,359.6964111328125,39.93059539794922],[367.1198425292969,357.38702392578125,-8.13741397857666],[358.9486083984375,360.7586975097656,-7.526334285736084],[378.90142822265625,392.7913818359375,6.094000816345215],[374.2266845703125,392.6319885253906,4.925115585327148],[438.91448974609375,250.03289794921875,-8.711894989013672],[374.6770324707031,355.1132507324219,-7.515427589416504],[399.0858154296875,257.0657958984375,-14.402713775634766],[401.4315185546875,249.44668579101562,-16.211336135864258],[413.09814453125,211.0330810546875,-15.632973670959473],[447.78076171875,238.7245330810547,-4.915998458862305],[405.93792724609375,231.20498657226562,-16.3385066986084],[449.16925048828125,257.12701416015625,-3.2785239219665527],[457.89447021484375,249.44325256347656,2.7065072059631348],[351.54705810546875,390.1497802734375,-4.556967735290527],[361.17529296875,391.24951171875,-2.5974292755126953],[367.99456787109375,391.66278076171875,-.23473325371742249],[364.67236328125,358.9627685546875,-6.873810291290283],[376.28369140625,392.95501708984375,5.4681396484375],[372.9664306640625,394.84869384765625,3.903872489929199],[373.54046630859375,391.76239013671875,4.832220077514648],[362.08636474609375,356.74444580078125,-13.801066398620605],[362.90167236328125,392.61309814453125,1.5852315425872803],[356.6992492675781,393.4400329589844,.18933214247226715],[349.0936279296875,394.14837646484375,-.7451195120811462],[352.26080322265625,412.76763916015625,6.37144660949707],[351.60980224609375,408.7842712402344,1.7464607954025269],[351.1753845214844,404.271240234375,.5916262269020081],[350.3481140136719,399.3775939941406,.6797225475311279],[349.6767578125,395.8125,.8746253848075867],[364.321044921875,393.82537841796875,2.467329502105713],[365.8825988769531,395.212158203125,2.20583176612854],[368.20684814453125,397.51007080078125,1.999861478805542],[370.4599914550781,399.85919189453125,2.969301462173462],[381.8695068359375,377.4785461425781,-.690396785736084],[462.43603515625,313.177978515625,38.748207092285156],[368.56341552734375,393.05975341796875,3.7274839878082275],[370.4620361328125,393.8918762207031,3.6439754962921143],[355.2076416015625,364.736572265625,-7.046141624450684],[371.36090087890625,360.1805419921875,-3.974306344985962],[357.12445068359375,362.8554382324219,-7.396814346313477],[385.92047119140625,321.1439514160156,-4.4428911209106445],[401.91363525390625,327.00537109375,-2.7322800159454346],[377.09796142578125,349.1260986328125,-6.909928321838379],[439.92242431640625,216.3218536376953,-8.177628517150879],[431.633056640625,232.04327392578125,-11.16129207611084],[423.25115966796875,247.256591796875,-13.225061416625977],[375.3262023925781,403.0556640625,6.437448978424072],[375.0771789550781,253.53546142578125,-17.435373306274414],[378.7027587890625,233.1209716796875,-18.87225914001465],[383.704833984375,209.08213806152344,-19.359281539916992],[419.9111328125,294.77874755859375,-2.161745548248291],[444.10369873046875,301.2869567871094,4.057002544403076],[375.7890625,293.019775390625,-4.063762664794922],[436.27392578125,276.37847900390625,-2.3107142448425293],[369.4384765625,311.72760009765625,-8.210302352905273],[368.86376953125,350.8580322265625,-14.271526336669922],[455.06549072265625,304.8265686035156,9.071538925170898],[435.8587646484375,310.433837890625,1.5646637678146362],[421.28204345703125,316.126708984375,-1.444227695465088],[400.70745849609375,315.3739013671875,-2.7463700771331787],[386.8515625,311.6008605957031,-3.8161683082580566],[377.18890380859375,307.9072265625,-5.0915327072143555],[355.4514465332031,301.77557373046875,-13.529786109924316],[451.15728759765625,325.49822998046875,10.510080337524414],[445.1763916015625,273.14715576171875,-1.0331487655639648],[347.1842956542969,363.1573486328125,-16.58827781677246],[374.37432861328125,327.9000244140625,-6.772735595703125],[470.13311767578125,273.5577392578125,29.609560012817383],[369.65777587890625,303.95196533203125,-6.222558498382568],[378.07989501953125,348.0782775878906,-3.1839511394500732],[430.2877197265625,283.1859130859375,-.26345908641815186],[369.968994140625,343.31304931640625,-13.530974388122559],[456.770263671875,335.3797912597656,40.308677673339844],[376.69921875,289.394287109375,-3.765385627746582],[361.7516784667969,339.8886413574219,-17.672422409057617],[419.92156982421875,393.29266357421875,22.460485458374023],[419.9722900390625,397.86724853515625,30.97171401977539],[462.01080322265625,320.0462646484375,24.44916343688965],[434.32049560546875,378.4382019042969,25.47901153564453],[463.0396728515625,263.65765380859375,10.727043151855469],[376.78094482421875,426.2649230957031,16.372371673583984],[346.4852600097656,363.61212158203125,-10.951936721801758],[382.68963623046875,333.7667236328125,-4.577613353729248],[455.28460693359375,285.4012756347656,7.98612117767334],[409.8905029296875,292.63787841796875,-3.918605089187622],[399.97784423828125,293.4935302734375,-4.696448802947998],[375.68768310546875,395.7542724609375,4.658698081970215],[446.71087646484375,343.0849609375,14.558646202087402],[359.59930419921875,437.4459228515625,19.72115135192871],[389.62322998046875,421.9953308105469,24.24637794494629],[403.2784423828125,412.0762023925781,26.999357223510742],[390.94818115234375,292.59625244140625,-4.815374851226807],[383.058837890625,290.8570251464844,-4.327030658721924],[378.45623779296875,289.99285888671875,-3.677772283554077],[453.3780517578125,269.0869140625,2.4866178035736084],[385.80865478515625,282.5535888671875,-5.909609794616699],[395.639892578125,279.46331787109375,-6.673973083496094],[405.80230712890625,278.8263854980469,-6.551760673522949],[415.59478759765625,279.8916931152344,-5.543217182159424],[421.21954345703125,281.9664306640625,-4.262943267822266],[470.9981689453125,254.5071563720703,20.368043899536133],[416.956787109375,290.4705810546875,-2.9066455364227295],[374.533203125,373.3503723144531,-2.9727885723114014],[367.3220520019531,356.634521484375,-9.85580062866211],[355.42230224609375,372.4104309082031,-6.134425640106201],[405.17352294921875,406.18597412109375,20.87492561340332],[391.359619140625,416.0989074707031,18.94097137451172],[359.6832275390625,434.3944091796875,14.0394287109375],[433.9317626953125,381.04510498046875,36.094486236572266],[379.569580078125,287.020263671875,-4.664144515991211],[361.649169921875,318.45391845703125,-13.129295349121094],[375.482177734375,430.96820068359375,21.34419822692871],[456.387939453125,339.981201171875,26.860319137573242],[357.67431640625,394.83416748046875,1.4957607984542847],[359.1590270996094,397.31744384765625,1.2079373598098755],[360.8309326171875,400.9644775390625,.9939720034599304],[362.07354736328125,405.02783203125,1.957046389579773],[365.0244140625,408.65399169921875,5.805955410003662],[370.2497863769531,393.02783203125,2.8432364463806152],[373.4071960449219,392.30633544921875,2.6949214935302734],[376.42718505859375,390.62579345703125,2.5169785022735596],[387.6705322265625,383.5346984863281,2.509226083755493],[430.975830078125,352.5643310546875,7.671667098999023],[362.33673095703125,306.27227783203125,-10.674957275390625],[369.27410888671875,282.959716796875,-6.8899664878845215],[375.3443603515625,283.41522216796875,-5.547928810119629],[368.2308349609375,391.7433776855469,3.3069326877593994],[429.79888916015625,370.8660888671875,16.380374908447266],[360.216552734375,284.1373291015625,-11.403491973876953],[370.19171142578125,413.54644775390625,9.367562294006348],[354.33343505859375,314.8792724609375,-16.24195098876953],[367.95965576171875,333.22967529296875,-11.320963859558105],[354.8056640625,419.42999267578125,8.941465377807617],[394.1650390625,397.9410095214844,10.174334526062012],[386.27886962890625,354.5286865234375,-1.6638107299804688],[383.34466552734375,406.4166259765625,10.023663520812988],[408.93756103515625,350.522705078125,-.4140018820762634],[394.07000732421875,363.2153015136719,-.17029017210006714],[415.6781005859375,363.1329345703125,4.210831642150879],[357.8708801269531,427.7336120605469,10.756365776062012],[373.602294921875,336.78094482421875,-7.9504714012146],[402.538330078125,400.6649169921875,14.981179237365723],[388.7276611328125,410.4826965332031,14.569025993347168],[402.673583984375,387.8460693359375,8.856818199157715],[441.69580078125,357.58544921875,18.18902015686035],[415.90966796875,384.5494079589844,12.668798446655273],[448.140625,358.9570617675781,28.132522583007812],[399.534423828125,374.2109680175781,2.99090838432312],[368.04608154296875,322.98687744140625,-9.69819164276123],[365.25445556640625,355.4486083984375,-14.787826538085938],[371.31536865234375,355.68768310546875,-10.122035026550293],[361.15625,350.7537841796875,-17.774524688720703],[378.6302490234375,272.9280700683594,-9.223087310791016],[396.64556884765625,266.4045715332031,-10.38960075378418],[412.140869140625,264.8977355957031,-10.038704872131348],[424.46630859375,266.1622619628906,-8.292969703674316],[432.6207275390625,269.857666015625,-5.837630271911621],[436.8592529296875,284.7066650390625,1.349062204360962],[465.46966552734375,300.35162353515625,20.93846321105957],[426.84515380859375,301.0703125,-.05198252573609352],[415.22412109375,305.3480224609375,-1.9043240547180176],[400.5557861328125,305.7759704589844,-3.1343984603881836],[387.6561279296875,303.6070556640625,-4.057972431182861],[378.49859619140625,300.90484619140625,-4.165782928466797],[372.0899353027344,298.5933532714844,-4.7713847160339355],[466.13446044921875,292.7690734863281,35.2398567199707],[370.875,357.25946044921875,-8.032480239868164],[360.9071960449219,328.91534423828125,-14.934316635131836],[357.85986328125,357.53741455078125,-17.488929748535156],[352.7911376953125,360.99359130859375,-15.21498966217041],[358.0789794921875,358.0654602050781,-15.489232063293457],[368.32891845703125,359.66925048828125,-6.285254001617432],[350.5665283203125,362.3311767578125,-16.098814010620117],[349.84124755859375,362.922607421875,-11.179969787597656],[372.82391357421875,290.2214050292969,-4.020853042602539],[367.08966064453125,293.7569885253906,-5.8502068519592285],[363.7844543457031,296.9742431640625,-7.916255950927734],[424.36444091796875,283.3050537109375,-2.8434669971466064],[430.42962646484375,277.763671875,-2.8994388580322266]],annotations:{silhouette:[[349.1807556152344,209.0174560546875,-19.842634201049805],[383.704833984375,209.08213806152344,-19.359281539916992],[413.09814453125,211.0330810546875,-15.632973670959473],[439.92242431640625,216.3218536376953,-8.177628517150879],[456.60040283203125,226.12193298339844,.7780323028564453],[466.53887939453125,239.51687622070312,10.134809494018555],[470.9981689453125,254.5071563720703,20.368043899536133],[470.13311767578125,273.5577392578125,29.609560012817383],[466.13446044921875,292.7690734863281,35.2398567199707],[462.43603515625,313.177978515625,38.748207092285156],[456.770263671875,335.3797912597656,40.308677673339844],[446.51104736328125,359.6964111328125,39.93059539794922],[433.9317626953125,381.04510498046875,36.094486236572266],[419.9722900390625,397.86724853515625,30.97171401977539],[403.2784423828125,412.0762023925781,26.999357223510742],[389.62322998046875,421.9953308105469,24.24637794494629],[375.482177734375,430.96820068359375,21.34419822692871],[359.59930419921875,437.4459228515625,19.72115135192871],[339.359619140625,439.66424560546875,19.303442001342773],[319.7813415527344,436.9856262207031,20.413311004638672],[305.55743408203125,430.1040344238281,22.65628433227539],[293.66290283203125,420.9043273925781,25.99988555908203],[282.3701477050781,410.80059814453125,29.20186424255371],[268.7952575683594,396.32305908203125,33.61614227294922],[258.391845703125,379.11700439453125,39.21104431152344],[248.96693420410156,357.520263671875,43.36610794067383],[241.4925537109375,333.3435363769531,44.06196212768555],[238.0091552734375,311.23687744140625,42.61039733886719],[235.95053100585938,290.82196044921875,39.218936920166016],[233.19412231445312,271.7872314453125,33.51588439941406],[232.65444946289062,252.9794921875,24.228174209594727],[236.9559326171875,238.30072021484375,13.7774658203125],[246.18536376953125,225.23916625976562,3.998593330383301],[261.619140625,215.71786499023438,-5.522735118865967],[286.90472412109375,210.5862274169922,-13.725871086120605],[315.12847900390625,208.7801055908203,-18.468080520629883]],lipsUpperOuter:[[304.0623474121094,391.3262939453125,7.524161338806152],[306.4148864746094,389.34478759765625,3.878803253173828],[311.4734191894531,388.143310546875,.4265775978565216],[317.86395263671875,386.3134765625,-2.525554895401001],[329.2160339355469,384.7794494628906,-5.188694953918457],[340.8323974609375,386.5469970703125,-5.771723747253418],[352.6107482910156,385.1107177734375,-5.61952018737793],[364.33099365234375,387.132568359375,-3.367276191711426],[371.0953369140625,389.2315979003906,-.6771182417869568],[376.42718505859375,390.62579345703125,2.5169785022735596],[378.90142822265625,392.7913818359375,6.094000816345215]],lipsLowerOuter:[[306.654052734375,394.55609130859375,5.859151840209961],[310.8388671875,398.8521423339844,3.896287441253662],[318.12298583984375,404.373291015625,2.6223807334899902],[327.98876953125,408.43817138671875,2.0838444232940674],[339.68878173828125,409.7881774902344,1.9134308099746704],[351.60980224609375,408.7842712402344,1.7464607954025269],[362.07354736328125,405.02783203125,1.957046389579773],[370.4599914550781,399.85919189453125,2.969301462173462],[375.68768310546875,395.7542724609375,4.658698081970215],[378.90142822265625,392.7913818359375,6.094000816345215]],lipsUpperInner:[[309.79779052734375,390.58154296875,6.151870250701904],[314.946044921875,390.71923828125,4.399217128753662],[319.7705383300781,391.69720458984375,2.4063093662261963],[325.6058349609375,392.8193359375,.8961117267608643],[332.7536315917969,393.8182067871094,-.36642125248908997],[340.728271484375,394.53314208984375,-.8985353112220764],[349.0936279296875,394.14837646484375,-.7451195120811462],[356.6992492675781,393.4400329589844,.18933214247226715],[362.90167236328125,392.61309814453125,1.5852315425872803],[368.2308349609375,391.7433776855469,3.3069326877593994],[373.54046630859375,391.76239013671875,4.832220077514648]],lipsLowerInner:[[309.79779052734375,390.58154296875,6.151870250701904],[314.1611633300781,391.9979248046875,4.789862155914307],[317.6488037109375,393.000732421875,3.34256911277771],[323.78997802734375,394.2787170410156,2.1355702877044678],[331.40216064453125,395.5169677734375,1.2044521570205688],[340.38958740234375,396.1620178222656,.7919079661369324],[349.6767578125,395.8125,.8746253848075867],[357.67431640625,394.83416748046875,1.4957607984542847],[364.321044921875,393.82537841796875,2.467329502105713],[368.56341552734375,393.05975341796875,3.7274839878082275],[373.54046630859375,391.76239013671875,4.832220077514648]],rightEyeUpper0:[[271.39617919921875,283.4222106933594,-.41674062609672546],[274.333984375,282.0985107421875,-1.9615159034729004],[279.5762634277344,280.1316223144531,-3.400237798690796],[289.0861511230469,279.05877685546875,-4.669045448303223],[299.1397705078125,279.6727600097656,-5.022618770599365],[308.75482177734375,282.7154541015625,-4.487869739532471],[314.9249267578125,287.05340576171875,-3.385601282119751]],rightEyeLower0:[[269.3052978515625,284.1684265136719,1.5571523904800415],[273.42633056640625,287.7991027832031,.4377647638320923],[278.02850341796875,290.38739013671875,-.5487459301948547],[284.53924560546875,292.5579528808594,-1.7541943788528442],[294.20318603515625,293.56683349609375,-2.749863862991333],[303.1453552246094,292.73834228515625,-3.1886675357818604],[311.2862548828125,290.9151611328125,-2.9487712383270264],[315.9281005859375,290.0635070800781,-2.427992343902588],[317.7833251953125,289.5350341796875,-2.5646073818206787]],rightEyeUpper1:[[265.9384765625,277.9222412109375,-.34769970178604126],[269.7716064453125,274.5580749511719,-2.932424783706665],[276.37213134765625,271.208740234375,-4.783821105957031],[287.1667785644531,269.97882080078125,-6.553516864776611],[299.40777587890625,271.1799621582031,-6.929609298706055],[309.96417236328125,275.23681640625,-5.749605655670166],[319.0617370605469,283.56549072265625,-4.5142974853515625]],rightEyeLower1:[[266.363037109375,283.1591796875,2.3700873851776123],[270.322998046875,289.6929626464844,1.591227412223816],[275.0693664550781,294.4234619140625,.22258906066417694],[283.77508544921875,297.302001953125,-1.4701876640319824],[294.2421875,298.1295166015625,-2.7120676040649414],[304.83154296875,297.38348388671875,-3.338404417037964],[313.1383056640625,295.2768249511719,-3.1243202686309814],[318.2545166015625,293.0438232421875,-2.9762187004089355],[321.3333740234375,290.2913818359375,-3.031883716583252]],rightEyeUpper2:[[260.74383544921875,276.25726318359375,.46252575516700745],[264.106201171875,270.0748596191406,-3.275754690170288],[271.5699462890625,266.5753173828125,-5.993255615234375],[283.202392578125,265.38037109375,-8.16631031036377],[298.0433349609375,266.78106689453125,-8.936037063598633],[315.54827880859375,273.19500732421875,-8.201863288879395],[324.728515625,283.0706787109375,-6.184993743896484]],rightEyeLower2:[[259.97406005859375,284.3060302734375,4.225242614746094],[262.3685607910156,294.8907470703125,4.2218780517578125],[267.7290954589844,300.33941650390625,2.5095982551574707],[278.2340087890625,304.63153076171875,.3487875759601593],[292.31512451171875,305.28094482421875,-1.2676407098770142],[305.2892761230469,303.3822937011719,-2.6287028789520264],[314.53717041015625,300.78265380859375,-3.0890607833862305],[321.0408630371094,298.5358581542969,-3.829049825668335],[326.2474670410156,293.7449035644531,-5.145124435424805]],rightEyeLower3:[[243.07974243164062,284.1910095214844,11.410715103149414],[251.71701049804688,300.1598205566406,7.154581546783447],[258.19696044921875,309.1534118652344,4.481276512145996],[271.079345703125,315.0118103027344,.9963825345039368],[291.0372314453125,314.6285705566406,-.913032054901123],[305.1451416015625,311.15679931640625,-2.395080327987671],[314.8291015625,307.61669921875,-4.047336578369141],[322.4779052734375,303.8685302734375,-5.391898155212402],[328.7005615234375,296.944580078125,-7.369376182556152]],rightEyebrowUpper:[[245.67010498046875,268.3780517578125,5.735904216766357],[249.7370147705078,256.96484375,-.1450599730014801],[259.1980285644531,250.38096618652344,-6.160211086273193],[273.6416320800781,247.73313903808594,-11.156942367553711],[293.9132385253906,249.87750244140625,-14.815312385559082],[319.271484375,253.851318359375,-16.672733306884766],[322.47174072265625,266.20684814453125,-13.799996376037598],[332.9147033691406,284.2412109375,-11.050355911254883]],rightEyebrowLower:[[251.3238983154297,284.8819885253906,7.398222923278809],[252.73171997070312,272.70587158203125,2.0322983264923096],[255.7642822265625,263.27337646484375,-2.8515512943267822],[264.44329833984375,257.9015197753906,-7.035983562469482],[277.30792236328125,255.85226440429688,-10.730096817016602],[295.72906494140625,257.6122131347656,-13.119375228881836]],leftEyeUpper0:[[424.36444091796875,283.3050537109375,-2.8434669971466064],[421.21954345703125,281.9664306640625,-4.262943267822266],[415.59478759765625,279.8916931152344,-5.543217182159424],[405.80230712890625,278.8263854980469,-6.551760673522949],[395.639892578125,279.46331787109375,-6.673973083496094],[385.80865478515625,282.5535888671875,-5.909609794616699],[379.569580078125,287.020263671875,-4.664144515991211]],leftEyeLower0:[[426.81561279296875,284.1234130859375,-1.0123307704925537],[422.099853515625,287.87432861328125,-2.004124164581299],[416.956787109375,290.4705810546875,-2.9066455364227295],[409.8905029296875,292.63787841796875,-3.918605089187622],[399.97784423828125,293.4935302734375,-4.696448802947998],[390.94818115234375,292.59625244140625,-4.815374851226807],[383.058837890625,290.8570251464844,-4.327030658721924],[378.45623779296875,289.99285888671875,-3.677772283554077],[376.69921875,289.394287109375,-3.765385627746582]],leftEyeUpper1:[[430.42962646484375,277.763671875,-2.8994388580322266],[426.3070068359375,274.3109130859375,-5.313669681549072],[419.29998779296875,270.8801574707031,-6.9901041984558105],[408.01513671875,269.6355285644531,-8.455821990966797],[395.37078857421875,270.9129943847656,-8.416177749633789],[384.573486328125,275.0424499511719,-6.947288513183594],[375.3443603515625,283.41522216796875,-5.547928810119629]],leftEyeLower1:[[430.2877197265625,283.1859130859375,-.26345908641815186],[425.54046630859375,289.8772277832031,-1.0081568956375122],[419.9111328125,294.77874755859375,-2.161745548248291],[410.337646484375,297.671142578125,-3.655602216720581],[399.47509765625,298.22186279296875,-4.606555461883545],[388.82440185546875,297.3912658691406,-4.926597595214844],[380.69281005859375,295.1523132324219,-4.365277290344238],[375.7890625,293.019775390625,-4.063762664794922],[372.82391357421875,290.2214050292969,-4.020853042602539]],leftEyeUpper2:[[436.27392578125,276.37847900390625,-2.3107142448425293],[432.6207275390625,269.857666015625,-5.837630271911621],[424.46630859375,266.1622619628906,-8.292969703674316],[412.140869140625,264.8977355957031,-10.038704872131348],[396.64556884765625,266.4045715332031,-10.38960075378418],[378.6302490234375,272.9280700683594,-9.223087310791016],[369.27410888671875,282.959716796875,-6.8899664878845215]],leftEyeLower2:[[436.8592529296875,284.7066650390625,1.349062204360962],[433.371826171875,295.6092224121094,1.4769021272659302],[426.84515380859375,301.0703125,-.05198252573609352],[415.22412109375,305.3480224609375,-1.9043240547180176],[400.5557861328125,305.7759704589844,-3.1343984603881836],[387.6561279296875,303.6070556640625,-4.057972431182861],[378.49859619140625,300.90484619140625,-4.165782928466797],[372.0899353027344,298.5933532714844,-4.7713847160339355],[367.08966064453125,293.7569885253906,-5.8502068519592285]],leftEyeLower3:[[455.28460693359375,285.4012756347656,7.98612117767334],[444.10369873046875,301.2869567871094,4.057002544403076],[435.8587646484375,310.433837890625,1.5646637678146362],[421.28204345703125,316.126708984375,-1.444227695465088],[400.70745849609375,315.3739013671875,-2.7463700771331787],[386.8515625,311.6008605957031,-3.8161683082580566],[377.18890380859375,307.9072265625,-5.0915327072143555],[369.65777587890625,303.95196533203125,-6.222558498382568],[363.7844543457031,296.9742431640625,-7.916255950927734]],leftEyebrowUpper:[[453.3780517578125,269.0869140625,2.4866178035736084],[449.16925048828125,257.12701416015625,-3.2785239219665527],[438.91448974609375,250.03289794921875,-8.711894989013672],[423.25115966796875,247.256591796875,-13.225061416625977],[401.4315185546875,249.44668579101562,-16.211336135864258],[375.0771789550781,253.53546142578125,-17.435373306274414],[371.3126220703125,265.9526672363281,-14.438712120056152],[360.216552734375,284.1373291015625,-11.403491973876953]],leftEyebrowLower:[[446.30859375,285.75494384765625,4.308371067047119],[445.1763916015625,273.14715576171875,-1.0331487655639648],[442.0211181640625,263.1089782714844,-5.702087879180908],[432.6607666015625,257.37567138671875,-9.42164134979248],[418.69573974609375,255.23684692382812,-12.644633293151855],[399.0858154296875,257.0657958984375,-14.402713775634766]],midwayBetweenEyes:[[346.46759033203125,283.8670654296875,-13.662650108337402]],noseTip:[[341.9098815917969,360.09564208984375,-19.152385711669922]],noseBottom:[[342.26123046875,365.131591796875,-7.952518939971924]],noseRightCorner:[[315.0499267578125,359.3180236816406,-3.172935724258423]],noseLeftCorner:[[371.36090087890625,360.1805419921875,-3.974306344985962]],rightCheek:[[279.26971435546875,349.1729736328125,1.562770128250122]],leftCheek:[[408.93756103515625,350.522705078125,-.4140018820762634]]}}},function(t,e,n){"use strict";(function(t,r){n.d(e,"a",(function(){return nt}));var i,a,o,s,u,c,l,h,p,f,d,m,v,g,y,x,b,w,_,S,M,E,T,C,A,N,I,R,O,k,L,D,P=n(0),F=n(140),B=n.n(F),z=n(141),U=n.n(z);function j(t){var e;Object(P.Wb)({kernelName:t,backendName:"wasm",setupFunc:function(n){e=n.wasm.cwrap(t,null,["number","number"])},kernelFunc:function(t){var n=t.backend,r=t.inputs.x,i=n.dataIdMap.get(r.dataId).id,a=n.makeOutput(r.shape,r.dtype),o=n.dataIdMap.get(a.dataId).id;return 0===P.Nc.sizeFromShape(a.shape)||e(i,o),a}})}function W(t,e,n){var r;Object(P.Wb)({kernelName:t,backendName:"wasm",setupFunc:function(e){r=e.wasm.cwrap(t,null,["number","array","number","number","array","number","number","number"])},kernelFunc:function(a){var o=a.backend,s=a.inputs,u=s.a,c=s.b,l=o.dataIdMap.get(u.dataId).id,h=o.dataIdMap.get(c.dataId).id,p=null!=n?n:u.dtype,f=P.t.assertAndGetBroadcastShape(u.shape,c.shape),d=o.makeOutput(f,p);if(0===P.Nc.sizeFromShape(f))return d;var m=new Uint8Array(new Int32Array(u.shape).buffer),v=new Uint8Array(new Int32Array(c.shape).buffer),g=o.dataIdMap.get(d.dataId).id,y=function(){return r(l,m,u.shape.length,h,v,c.shape.length,i[u.dtype],g)};if(e)return y(),d;var x=P.t.getBroadcastDims(u.shape,f),b=P.t.getBroadcastDims(c.shape,f),w=x.every((function(t,e){return t===e})),_=b.every((function(t,e){return t===e}));if(w&&_)return y(),d;throw new Error("Broadcasting along outer dims is not yet supported for "+t+".")}})}function V(t){var e=t.inputs.x,n=t.attrs.dtype,r=t.backend,i=r.makeOutput(e.shape,n),a=r.typedArrayFromHeap(e);return r.typedArrayFromHeap(i).set(a),i}function H(t,e){var n=new Int32Array(t.wasm.HEAPU8.buffer,e,3),r=n[0],i=n[1],a=n[2];return t.wasm._free(e),{pSelectedIndices:r,selectedSize:i,pSelectedScores:a}}function G(t){var e=t.inputs.x,n=t.attrs,r=n.begin,i=n.size,a=t.backend,o=P.oc.isSliceContinous(e.shape,r,i),s=a.typedArrayFromHeap(e),u=a.makeOutput(i,e.dtype),c=a.typedArrayFromHeap(u),l=P.Nc.computeStrides(e.shape);if(o){var h=P.oc.computeFlatOffset(r,l);return c.set(s.subarray(h,h+P.Nc.sizeFromShape(i))),u}var p=e.shape.length;return 2===p?function(t,e,n,r,i){for(var a=0,o=r[0],s=r[1],u=o+i[0],c=o;c<u;c++){var l=c*e+s;n.set(t.subarray(l,l+i[1]),a),a+=i[1]}}(s,l[0],c,r,i):3===p?function(t,e,n,r,i,a){for(var o=0,s=i[0],u=i[1],c=i[2],l=s+a[0],h=u+a[1],p=s;p<l;p++)for(var f=u;f<h;f++){var d=p*e+f*n+c;r.set(t.subarray(d,d+a[2]),o),o+=a[2]}}(s,l[0],l[1],c,r,i):4===p?function(t,e,n,r,i,a,o){for(var s=0,u=a[0],c=a[1],l=a[2],h=u+o[0],p=c+o[1],f=l+o[2],d=a[3],m=u;m<h;m++)for(var v=c;v<p;v++)for(var g=l;g<f;g++){var y=m*e+v*n+g*r+d;i.set(t.subarray(y,y+o[3]),s),s+=o[3]}}(s,l[0],l[1],l[2],c,r,i):function(t,e,n,r,i){for(var a=Object(P.x)(i,e.dtype,n),o=Object(P.x)(e.shape,e.dtype,t),s=0;s<a.size;++s){var u=a.indexToLoc(s).map((function(t,e){return t+r[e]}));n[s]=o.get.apply(o,u)}}(s,e,c,r,i),u}(s=i||(i={}))[s.float32=0]="float32",s[s.int32=1]="int32",s[s.bool=2]="bool",s[s.string=3]="string",s[s.complex64=4]="complex64",function(t){t[t.linear=0]="linear",t[t.relu=1]="relu",t[t.relu6=2]="relu6",t[t.prelu=3]="prelu"}(a||(a={})),Object(P.Wb)({kernelName:"_FusedMatMul",backendName:"wasm",setupFunc:function(t){o=t.wasm.cwrap("_FusedMatMul",null,["number","array","number","number","array","number","number","number","number","number","number","number"])},kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.a,s=e.b,u=e.bias,c=e.preluActivationWeights;if("float32"!==i.dtype||"float32"!==s.dtype)throw new Error("_FusedMatMul for non non-float32 tensors not yet supported.");var l=r.transposeA,h=r.transposeB,p=r.activation,f=n.dataIdMap.get(i.dataId).id,d=n.dataIdMap.get(s.dataId).id,m=0;if(null!=u){var v=n.dataIdMap.get(u.dataId);if(1!==v.shape.length)throw new Error("_FusedMatMul only supports rank-1 bias but got rank "+v.shape.length+".");m=v.id}var g=null==c?0:n.dataIdMap.get(c.dataId).id,y=a[p];if(null==y)throw new Error(p+" activation not yet supported for FusedConv2D in the wasm backend.");var x=l?i.shape[2]:i.shape[1],b=h?s.shape[1]:s.shape[2],w=i.shape[0],_=n.makeOutput([w,x,b],i.dtype),S=n.dataIdMap.get(_.dataId).id,M=new Uint8Array(new Int32Array(i.shape).buffer),E=new Uint8Array(new Int32Array(s.shape).buffer);return o(f,M,i.shape.length,d,E,s.shape.length,l,h,y,m,g,S),_}}),j("Abs"),W("Add",!0),Object(P.Wb)({kernelName:"AddN",backendName:"wasm",setupFunc:function(t){u=t.wasm.cwrap("AddN",null,["array","number","number","number"])},kernelFunc:function(t){var e=t.inputs,n=t.backend,r=n.makeOutput(e[0].shape,e[0].dtype);if(0===P.Nc.sizeFromShape(r.shape))return r;var a=e.map((function(t){return n.dataIdMap.get(t.dataId).id})),o=new Uint8Array(new Int32Array(a).buffer),s=n.dataIdMap.get(r.dataId).id;return u(o,a.length,i[r.dtype],s),r}}),Object(P.Wb)({kernelName:"ArgMax",backendName:"wasm",kernelFunc:function(t){var e=t.inputs.x,n=t.backend,r=t.attrs.axis,a=e.shape.slice(0,-1),o=n.makeOutput(a,"int32"),s=n.dataIdMap.get(e.dataId).id,u=n.dataIdMap.get(o.dataId).id,l=P.Nc.sizeFromShape(o.shape),h=e.shape[r];return c(s,i[e.dtype],l,h,u),o},setupFunc:function(t){c=t.wasm.cwrap("ArgMax",null,["number","number","number","number","number"])}}),Object(P.Wb)({kernelName:"AvgPool",backendName:"wasm",setupFunc:function(t){l=t.wasm.cwrap("AvgPool",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(t){var e=t.inputs,n=t.attrs,r=t.backend,i=n,a=e.x,o=r.dataIdMap.get(a.dataId).id,s=i.filterHeight,u=i.filterWidth,c=i.padInfo.top,h=i.padInfo.right,p=i.padInfo.bottom,f=i.padInfo.left,d=i.strideHeight,m=i.strideWidth,v=i.inChannels;if("channelsLast"!==i.dataFormat)throw new Error("wasm backend does not support dataFormat:'"+i.dataFormat+"'. Please use 'channelsLast'.");if(1!==i.dilationWidth||1!==i.dilationHeight)throw new Error("was backend only supports average pooling with dilation = [1, 1], got ["+i.dilationHeight+", "+i.dilationWidth+"].");var g=r.makeOutput(i.outShape,"float32"),y=r.dataIdMap.get(g.dataId).id;return l(o,a.shape[0],a.shape[1],a.shape[2],s,u,c,h,p,f,d,m,v,y),g}}),Object(P.Wb)({kernelName:"BatchMatMul",backendName:"wasm",setupFunc:function(t){h=t.wasm.cwrap("BatchMatMul",null,["number","array","number","number","array","number","number","number","number"])},kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.a,a=e.b;if("float32"!==i.dtype||"float32"!==a.dtype)throw new Error("BatchMatMul for non non-float32 tensors not yet supported.");var o=r.transposeA,s=r.transposeB,u=n.dataIdMap.get(i.dataId).id,c=n.dataIdMap.get(a.dataId).id,l=o?i.shape[2]:i.shape[1],p=s?a.shape[1]:a.shape[2],f=i.shape[0],d=n.makeOutput([f,l,p],i.dtype),m=n.dataIdMap.get(d.dataId).id,v=new Uint8Array(new Int32Array(i.shape).buffer),g=new Uint8Array(new Int32Array(a.shape).buffer);return h(u,v,i.shape.length,c,g,a.shape.length,o,s,m),d}}),Object(P.Wb)({kernelName:"Cast",backendName:"wasm",kernelFunc:V}),Object(P.Wb)({kernelName:"ClipByValue",backendName:"wasm",setupFunc:function(t){p=t.wasm.cwrap("ClipByValue",null,["number","number","number","number"])},kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.x,a=r.min,o=r.max,s=n.dataIdMap.get(i.dataId).id,u=n.makeOutput(i.shape,"float32"),c=n.dataIdMap.get(u.dataId).id;return p(s,a,o,c),u}}),Object(P.Wb)({kernelName:"Concat",backendName:"wasm",kernelFunc:function(t){for(var e=t.inputs,n=t.backend,r=t.attrs.axis,i=P.t.computeOutShape(e.map((function(t){return t.shape})),r),a=n.makeOutput(i,e[0].dtype),o=P.Nc.sizeFromShape(e[0].shape.slice(0,r)),s=0,u=e.map((function(t){var e=P.Nc.sizeFromShape(t.shape.slice(r));return s+=e,e})),c=e.map((function(t){return n.typedArrayFromHeap(t)})),l=n.typedArrayFromHeap(a),h=0;h<o;h++)for(var p=h*s,f=0;f<c.length;f++){var d=u[f],m=h*d,v=c[f].subarray(m,m+d);l.set(v,p),p+=d}return a}}),Object(P.Wb)({kernelName:"Conv2D",backendName:"wasm",setupFunc:function(t){f=t.wasm.cwrap("Conv2D",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(t){var e=t.inputs,n=t.attrs,r=t.backend,i=n,a=e.x,o=e.filter,s=r.dataIdMap.get(a.dataId).id,u=r.dataIdMap.get(o.dataId).id,c=i.filterHeight,l=i.filterWidth,h=i.padInfo.top,p=i.padInfo.right,d=i.padInfo.bottom,m=i.padInfo.left,v=i.dilationHeight,g=i.dilationWidth,y=i.strideHeight,x=i.strideWidth,b=i.inChannels,w=i.outChannels,_="SAME"===i.padInfo.type?1:0;if("channelsLast"!==i.dataFormat)throw new Error("wasm backend Conv2D does not support dataFormat:'"+i.dataFormat+"'. Please use 'channelsLast'.");var S=r.makeOutput(i.outShape,"float32"),M=r.dataIdMap.get(S.dataId).id;return f(s,a.shape[0],a.shape[1],a.shape[2],u,c,l,h,p,d,m,_,v,g,y,x,b,w,M),S}}),j("Cos"),function(t){t[t.bilinear=0]="bilinear",t[t.nearest=1]="nearest"}(d||(d={})),Object(P.Wb)({kernelName:"CropAndResize",backendName:"wasm",setupFunc:function(t){m=t.wasm.cwrap("CropAndResize",null,["number","number","number","number","array","number","number","number","number","number"])},kernelFunc:function(t){var e,n=t.backend,r=t.inputs,i=t.attrs,a=i.method,o=i.extrapolationValue,s=i.cropSize,u=r.images,c=r.boxes,l=r.boxInd,h=c.shape[0],p=s,f=p[0],v=p[1],g=[h,f,v,u.shape[3]],y=n.dataIdMap.get(u.dataId);"float32"!==u.dtype&&(e=V({backend:n,inputs:{x:u},attrs:{dtype:"float32"}}),y=n.dataIdMap.get(e.dataId));var x=y.id,b=n.dataIdMap.get(c.dataId).id,w=n.dataIdMap.get(l.dataId).id,_=n.makeOutput(g,"float32"),S=n.dataIdMap.get(_.dataId).id,M=new Uint8Array(new Int32Array(u.shape).buffer);return m(x,b,w,h,M,f,v,d[a],o,S),null!=e&&n.disposeData(e.dataId),_}}),Object(P.Wb)({kernelName:"DepthwiseConv2dNative",backendName:"wasm",setupFunc:function(t){v=t.wasm.cwrap("DepthwiseConv2dNative",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(t){var e=t.inputs,n=t.attrs,r=t.backend,i=n,a=e.x,o=e.filter,s=r.dataIdMap.get(a.dataId).id,u=r.dataIdMap.get(o.dataId).id,c=i.filterHeight,l=i.filterWidth,h=i.padInfo.top,p=i.padInfo.right,f=i.padInfo.bottom,d=i.padInfo.left,m=i.dilationHeight,g=i.dilationWidth,y=i.strideHeight,x=i.strideWidth,b=i.inChannels,w=i.outChannels,_="SAME"===i.padInfo.type?1:0;if("channelsLast"!==i.dataFormat)throw new Error("wasm backend DepthwiseConv2dNative does not support dataFormat:'"+i.dataFormat+"'. Please use 'channelsLast'.");var S=r.makeOutput(i.outShape,"float32"),M=r.dataIdMap.get(S.dataId).id;return v(s,a.shape[0],a.shape[1],a.shape[2],u,c,l,h,p,f,d,_,m,g,y,x,b,w,M),S}}),W("Div",!1),j("Exp"),W("FloorDiv",!1),Object(P.Wb)({kernelName:"FusedBatchNorm",backendName:"wasm",setupFunc:function(t){g=t.wasm.cwrap("FusedBatchNorm",null,["number","number","number","number","number","number","number"])},kernelFunc:function(t){var e=t.backend,n=t.inputs,r=t.attrs.varianceEpsilon,i=n.x,a=n.mean,o=n.variance,s=n.offset,u=n.scale,c=e.dataIdMap.get(i.dataId).id,l=e.dataIdMap.get(a.dataId).id,h=e.dataIdMap.get(o.dataId).id,p=null!=s?e.dataIdMap.get(s.dataId).id:0,f=null!=u?e.dataIdMap.get(u.dataId).id:0,d=e.makeOutput(i.shape,i.dtype);if(0===P.Nc.sizeFromShape(i.shape))return d;var m=e.dataIdMap.get(d.dataId).id;return g(c,l,h,p,f,r,m),d}}),Object(P.Wb)({kernelName:"FusedConv2D",backendName:"wasm",setupFunc:function(t){y=t.wasm.cwrap("FusedConv2D",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(t){var e=t.inputs,n=t.attrs,r=t.backend,i=n.convInfo,o=n.activation,s=a[o];if(null==s)throw new Error(o+" activation not yet supported for FusedConv2D in the wasm backend.");var u=e.x,c=e.filter,l=e.bias,h=e.preluActivationWeights,p=r.dataIdMap.get(u.dataId).id,f=r.dataIdMap.get(c.dataId).id,d=i.outChannels,m=0;if(null!=l){var v=r.dataIdMap.get(l.dataId);if(1!==v.shape.length)throw new Error("FusedConv2D only supports rank-1 bias but got rank "+v.shape.length+".");if(v.shape[0]!==d)throw new Error("FusedConv2D bias shape ("+v.shape+") does not match the number of output channels ("+d+")");m=v.id}var g=i.filterHeight,x=i.filterWidth,b=i.padInfo.top,w=i.padInfo.right,_=i.padInfo.bottom,S=i.padInfo.left,M=i.dilationHeight,E=i.dilationWidth,T=i.strideHeight,C=i.strideWidth,A=i.inChannels,N="SAME"===i.padInfo.type?1:0,I=i.batchSize,R=i.inHeight,O=i.inWidth;if("channelsLast"!==i.dataFormat)throw new Error("wasm backend FusedConv2D does not support dataFormat:'"+i.dataFormat+"'. Please use 'channelsLast'.");var k=r.makeOutput(i.outShape,"float32"),L=r.dataIdMap.get(k.dataId).id,D=null==h?0:r.dataIdMap.get(h.dataId).id;return y(p,I,R,O,f,g,x,m,b,w,_,S,N,M,E,T,C,A,d,s,D,L),k}}),Object(P.Wb)({kernelName:"FusedDepthwiseConv2D",backendName:"wasm",setupFunc:function(t){x=t.wasm.cwrap("FusedDepthwiseConv2D",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(t){var e=t.inputs,n=t.attrs,r=t.backend,i=n.convInfo,o=n.activation,s=a[o];if(null==s)throw new Error(o+" activation not yet supported for FusedDepthwiseConv2D in the wasm backend.");var u=e.x,c=e.filter,l=e.bias,h=e.preluActivationWeights,p=r.dataIdMap.get(u.dataId).id,f=r.dataIdMap.get(c.dataId).id,d=i.outChannels,m=0;if(null!=l){var v=r.dataIdMap.get(l.dataId);if(1!==v.shape.length)throw new Error("FusedDepthwiseConv2D only supports rank-1 bias but got rank "+v.shape.length+".");if(v.shape[0]!==d)throw new Error("FusedDepthwiseConv2D bias shape ("+v.shape+") does not match the number of output channels ("+d+")");m=v.id}var g=i.filterHeight,y=i.filterWidth,b=i.padInfo.top,w=i.padInfo.right,_=i.padInfo.bottom,S=i.padInfo.left,M=i.dilationHeight,E=i.dilationWidth,T=i.strideHeight,C=i.strideWidth,A=i.inChannels,N="SAME"===i.padInfo.type?1:0,I=i.batchSize,R=i.inHeight,O=i.inWidth;if("channelsLast"!==i.dataFormat)throw new Error("wasm backend FusedDepthwiseConv2D does not support dataFormat:'"+i.dataFormat+"'. Please use 'channelsLast'.");var k=r.makeOutput(i.outShape,"float32"),L=r.dataIdMap.get(k.dataId).id,D=null==h?0:r.dataIdMap.get(h.dataId).id;return x(p,I,R,O,f,g,y,m,b,w,_,S,N,M,E,T,C,A,d,s,D,L),k}}),Object(P.Wb)({kernelName:"Gather",backendName:"wasm",setupFunc:function(t){b=t.wasm.cwrap("Gather",null,["number","number","array","number","number","number","array","number"])},kernelFunc:function(t){var e=t.backend,n=t.inputs,r=t.attrs,a=n.x,o=n.indices,s=r.axis,u=a.shape.slice();u[s]=P.Nc.sizeFromShape(o.shape);var c=a.shape.length-1,l=e.makeOutput(u,a.dtype);if(0===P.Nc.sizeFromShape(a.shape))return l;var h=e.dataIdMap.get(a.dataId).id,p=e.dataIdMap.get(o.dataId).id,f=e.dataIdMap.get(l.dataId).id,d=new Uint8Array(new Int32Array(P.Nc.computeStrides(a.shape)).buffer),m=new Uint8Array(new Int32Array(P.Nc.computeStrides(u)).buffer);return b(h,i[a.dtype],d,c,p,s,m,f),l}}),Object(P.Wb)({kernelName:"GatherNd",backendName:"wasm",setupFunc:function(t){w=t.wasm.cwrap("GatherNd",null,["number","number","number","number","number","number","array","number"])},kernelFunc:function(t){var e=t.backend,n=t.inputs,r=n.x,a=n.indices,o=P.db.prepareAndValidate(r,a),s=o[0],u=o[1],c=o[2],l=o[3],h=e.makeOutput(s,r.dtype);if(0===u)return h;var p=a.shape,f=p[p.length-1],d=e.dataIdMap.get(r.dataId).id,m=e.dataIdMap.get(a.dataId).id,v=new Uint8Array(new Int32Array(l).buffer),g=e.dataIdMap.get(h.dataId).id;return w(d,i[r.dtype],m,u,f,c,v,g),h}}),W("Greater",!1,"bool"),W("GreaterEqual",!1,"bool"),W("Less",!1,"bool"),W("LessEqual",!1,"bool"),j("Log"),W("LogicalAnd",!1,"bool"),Object(P.Wb)({kernelName:"Max",backendName:"wasm",setupFunc:function(t){_=t.wasm.cwrap("Max",null,["number, number, number"])},kernelFunc:function(t){var e=t.backend,n=t.inputs,r=t.attrs.axes,i=n.x,a=e.dataIdMap.get(i.dataId).id;P.t.assertAxesAreInnerMostDims("max",r,i.shape.length);var o=P.t.computeOutAndReduceShapes(i.shape,r),s=o[0],u=o[1],c=P.Nc.sizeFromShape(u),l=e.makeOutput(s,i.dtype);if(0===P.Nc.sizeFromShape(i.shape))return l;var h=e.dataIdMap.get(l.dataId).id;return _(a,c,h),l}}),W("Maximum",!1),Object(P.Wb)({kernelName:"MaxPool",backendName:"wasm",setupFunc:function(t){S=t.wasm.cwrap("MaxPool",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(t){var e=t.inputs,n=t.attrs,r=t.backend,i=n,a=e.x,o=r.dataIdMap.get(a.dataId).id,s=i.filterHeight,u=i.filterWidth,c=i.padInfo.top,l=i.padInfo.right,h=i.padInfo.bottom,p=i.padInfo.left,f=i.dilationHeight,d=i.dilationWidth,m=i.strideHeight,v=i.strideWidth,g=i.inChannels,y=i.outChannels;if("channelsLast"!==i.dataFormat)throw new Error("wasm backend does not support dataFormat:'"+i.dataFormat+"'. Please use 'channelsLast'.");var x=r.makeOutput(i.outShape,"float32"),b=r.dataIdMap.get(x.dataId).id;return S(o,a.shape[0],a.shape[1],a.shape[2],s,u,c,l,h,p,f,d,m,v,g,y,b),x}}),Object(P.Wb)({kernelName:"Min",backendName:"wasm",setupFunc:function(t){M=t.wasm.cwrap("Min",null,["number, number, number"])},kernelFunc:function(t){var e=t.backend,n=t.inputs,r=t.attrs.axes,i=n.x,a=e.dataIdMap.get(i.dataId).id;P.t.assertAxesAreInnerMostDims("min",r,i.shape.length);var o=P.t.computeOutAndReduceShapes(i.shape,r),s=o[0],u=o[1],c=P.Nc.sizeFromShape(u),l=e.makeOutput(s,i.dtype);if(0===P.Nc.sizeFromShape(i.shape))return l;var h=e.dataIdMap.get(l.dataId).id;return M(a,c,h),l}}),W("Minimum",!1),W("Mul",!0),j("Neg"),Object(P.Wb)({kernelName:"NonMaxSuppressionV3",backendName:"wasm",setupFunc:function(t){E=t.wasm.cwrap("NonMaxSuppressionV3","number",["number","number","number","number","number"])},kernelFunc:function(t){var e=t.backend,n=t.inputs,r=t.attrs,i=r.iouThreshold,a=r.maxOutputSize,o=r.scoreThreshold,s=n.boxes,u=n.scores,c=e.dataIdMap.get(s.dataId).id,l=e.dataIdMap.get(u.dataId).id,h=H(e,E(c,l,a,i,o)),p=h.pSelectedIndices,f=h.selectedSize,d=h.pSelectedScores;return e.wasm._free(d),e.makeOutput([f],"int32",p)}}),Object(P.Wb)({kernelName:"NonMaxSuppressionV5",backendName:"wasm",setupFunc:function(t){T=t.wasm.cwrap("NonMaxSuppressionV5","number",["number","number","number","number","number","number"])},kernelFunc:function(t){var e=t.backend,n=t.inputs,r=t.attrs,i=r.iouThreshold,a=r.maxOutputSize,o=r.scoreThreshold,s=r.softNmsSigma,u=n.boxes,c=n.scores,l=e.dataIdMap.get(u.dataId).id,h=e.dataIdMap.get(c.dataId).id,p=H(e,T(l,h,a,i,o,s)),f=p.pSelectedIndices,d=p.selectedSize,m=p.pSelectedScores;return[e.makeOutput([d],"int32",f),e.makeOutput([d],"float32",m)]}}),W("NotEqual",!1,"bool"),Object(P.Wb)({kernelName:"OnesLike",backendName:"wasm",kernelFunc:function(t){var e=t.inputs.x,n=t.backend,r=n.makeOutput(e.shape,e.dtype);return n.typedArrayFromHeap(r).fill(1),r}}),Object(P.Wb)({kernelName:"PadV2",backendName:"wasm",kernelFunc:function(t){var e=t.inputs.x,n=t.backend,r=t.attrs,a=r.paddings,o=r.constantValue,s=a.map((function(t,n){return t[0]+e.shape[n]+t[1]})),u=n.dataIdMap.get(e.dataId).id,c=n.makeOutput(s,e.dtype),l=n.dataIdMap.get(c.dataId).id,h=new Uint8Array(new Int32Array(e.shape).buffer),p=[].concat.apply([],a),f=new Uint8Array(new Int32Array(p).buffer);return C(u,h,e.shape.length,i[e.dtype],f,o,l),c},setupFunc:function(t){C=t.wasm.cwrap("PadV2",null,["number","array","number","number","array","number","number"])}}),W("Pow",!1),Object(P.Wb)({kernelName:"Prelu",backendName:"wasm",setupFunc:function(t){A=t.wasm.cwrap("Prelu",null,["number","number","number"])},kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,i=e.alpha,a=n.dataIdMap.get(r.dataId).id,o=n.dataIdMap.get(i.dataId).id,s=n.makeOutput(r.shape,"float32"),u=n.dataIdMap.get(s.dataId).id;return A(a,o,u),s}}),j("Relu"),j("Relu6"),Object(P.Wb)({kernelName:"Reshape",backendName:"wasm",kernelFunc:function(t){var e=t.inputs.x,n=t.attrs.shape;return{dataId:e.dataId,shape:n,dtype:e.dtype}}}),Object(P.Wb)({kernelName:"ResizeBilinear",backendName:"wasm",setupFunc:function(t){N=t.wasm.cwrap("ResizeBilinear",null,["number","number","number","number","number","number","number","number","number"])},kernelFunc:function(t){var e,n=t.backend,r=t.inputs,i=t.attrs,a=r.x,o=i.alignCorners,s=i.newHeight,u=i.newWidth,c=a.shape,l=c[0],h=c[1],p=c[2],f=c[3],d=[l,s,u,f],m=n.dataIdMap.get(a.dataId);"float32"!==m.dtype&&(e=V({backend:n,inputs:{x:a},attrs:{dtype:"float32"}}),m=n.dataIdMap.get(e.dataId));var v=m.id,g=n.makeOutput(d,"float32");if(0===P.Nc.sizeFromShape(a.shape))return g;var y=n.dataIdMap.get(g.dataId).id;return N(v,l,h,p,f,s,u,o?1:0,y),null!=e&&n.disposeData(e.dataId),g}}),j("Rsqrt"),Object(P.Wb)({kernelName:"ScatterNd",backendName:"wasm",setupFunc:function(t){I=t.wasm.cwrap("ScatterNd",null,["number","number","number","number","number","number","array","number","number"])},kernelFunc:function(t){var e=t.backend,n=t.inputs,r=t.attrs,a=n.indices,o=n.updates,s=r.shape,u=e.makeOutput(s,o.dtype);if(0===P.Nc.sizeFromShape(s))return u;var c=P.fc.calculateShapes(o,a,s),l=c.sliceRank,h=c.numUpdates,p=c.sliceSize,f=c.strides,d=c.outputSize,m=e.dataIdMap.get(a.dataId).id,v=e.dataIdMap.get(o.dataId).id,g=new Uint8Array(new Int32Array(f).buffer),y=e.dataIdMap.get(u.dataId).id;return I(m,v,i[o.dtype],l,h,p,g,d,y),u}}),Object(P.Wb)({kernelName:"Sigmoid",backendName:"wasm",setupFunc:function(t){R=t.wasm.cwrap("Sigmoid",null,["number","number"])},kernelFunc:function(t){var e=t.backend,n=t.inputs.x,r=e.dataIdMap.get(n.dataId).id,i=e.makeOutput(n.shape,n.dtype),a=e.dataIdMap.get(i.dataId).id;return 0===P.Nc.sizeFromShape(i.shape)||R(r,a),i}}),j("Sin"),Object(P.Wb)({kernelName:"Slice",backendName:"wasm",kernelFunc:G}),Object(P.Wb)({kernelName:"Softmax",backendName:"wasm",setupFunc:function(t){O=t.wasm.cwrap("Softmax",null,["number","number","number","number"])},kernelFunc:function(t){var e=t.backend,n=t.inputs.logits,r=t.attrs.dim,i=e.dataIdMap.get(n.dataId).id,a=e.makeOutput(n.shape,n.dtype),o=e.dataIdMap.get(a.dataId).id,s=n.shape[r],u=P.Nc.sizeFromShape(n.shape)/s;return 0===P.Nc.sizeFromShape(a.shape)||O(i,o,s,u),a}}),j("Square"),W("Sub",!0),Object(P.Wb)({kernelName:"Sum",backendName:"wasm",setupFunc:function(t){k=t.wasm.cwrap("Sum",null,["number, number, number"])},kernelFunc:function(t){var e=t.backend,n=t.inputs,r=t.attrs.axes,i=n.x,a=e.dataIdMap.get(i.dataId).id;P.t.assertAxesAreInnerMostDims("sum",r,i.shape.length);var o=P.t.computeOutAndReduceShapes(i.shape,r),s=o[0],u=o[1],c=P.Nc.sizeFromShape(u),l=e.makeOutput(s,i.dtype);if(0===P.Nc.sizeFromShape(i.shape))return l;var h=e.dataIdMap.get(l.dataId).id;return k(a,c,h),l}}),j("Tanh"),Object(P.Wb)({kernelName:"Tile",backendName:"wasm",setupFunc:function(t){L=t.wasm.cwrap("Tile",null,["number","array","number","array","number","number"])},kernelFunc:function(t){for(var e=t.inputs,n=t.backend,r=t.attrs,a=e.x,o=n.dataIdMap.get(a.dataId).id,s=r.reps,u=new Array(a.shape.length),c=0;c<u.length;c++)u[c]=a.shape[c]*s[c];var l=new Uint8Array(new Int32Array(a.shape).buffer),h=new Uint8Array(new Int32Array(u).buffer),p=n.makeOutput(u,a.dtype),f=n.dataIdMap.get(p.dataId).id;return L(o,l,a.shape.length,h,u.length,i[p.dtype],f),p}}),Object(P.Wb)({kernelName:"Transpose",backendName:"wasm",kernelFunc:function(t){for(var e=t.inputs,n=t.backend,r=t.attrs,a=function(t,e){for(var n=[],r=[],i=0;i<t.length;++i)1!==t[i]&&n.push(t[i]),1!==t[e[i]]&&r.push(e[i]);for(i=0;i<r.length;++i){for(var a=-1,o=0;o<r.length;++o)r[o]>=i&&(-1===a||r[a]>r[o])&&(a=o);r[a]=i}return[n,r]}(e.x.shape,r.perm),o=a[0],s=a[1],u={dataId:e.x.dataId,shape:o,dtype:e.x.dtype},c=!0,l=0;l<s.length;l++)s[l]!==l&&(c=!1);var h=function(t,e){for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];return n}(e.x.shape,r.perm);if(c)return{dataId:u.dataId,shape:h,dtype:u.dtype};var p=n.makeOutput(h,u.dtype),f=n.dataIdMap.get(u.dataId).id,d=n.dataIdMap.get(p.dataId).id,m=new Uint8Array(new Int32Array(s).buffer),v=new Uint8Array(new Int32Array(u.shape).buffer);return D(f,v,u.shape.length,i[u.dtype],d,m,s.length),p},setupFunc:function(t){D=t.wasm.cwrap("Transpose",null,["number","array","number","number","number","array","number"])}}),Object(P.Wb)({kernelName:"Unpack",backendName:"wasm",kernelFunc:function(t){for(var e=t.inputs.x,n=t.backend,r=t.attrs.axis,i=e.shape[r],a=e.shape.length,o=new Array(a-1),s=0,u=0;u<a;u++)u!==r&&(o[s++]=e.shape[u]);var c=new Array(i),l=new Array(a).fill(0),h=e.shape.slice();for(h[r]=1,u=0;u<c.length;u++)l[r]=u,c[u]=G({inputs:{x:e},attrs:{begin:l,size:h},backend:n});return c.map((function(t){return{dataId:t.dataId,dtype:t.dtype,shape:o}}))}}),Object(P.Wb)({kernelName:"ZerosLike",backendName:"wasm",kernelFunc:function(t){var e=t.inputs.x,n=t.backend,r=n.makeOutput(e.shape,e.dtype);return n.typedArrayFromHeap(r).fill(0),r}});var q=function(t,e){return(q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function X(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}u((r=r.apply(t,e||[])).next())}))}function $(t,e){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}var Y,K=(function(e,n){var i,a=(i="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(e){var n,a,o,s,u,c=void 0!==(e=e||{})?e:{},l={};for(n in c)c.hasOwnProperty(n)&&(l[n]=c[n]);a="object"==typeof window,o="function"==typeof importScripts,s="object"==typeof t&&"object"==typeof t.versions&&"string"==typeof t.versions.node&&!a&&!o,u=!a&&!s&&!o;var h,p,f,d,m="";s?(m=r+"/",h=function(t,e){var n;return f||(f=B.a),d||(d=U.a),t=d.normalize(t),n=f.readFileSync(t),e?n:n.toString()},p=function(t){var e=h(t,!0);return e.buffer||(e=new Uint8Array(e)),_(e.buffer),e},t.argv.length>1&&t.argv[1].replace(/\\/g,"/"),t.argv.slice(2),t.on("uncaughtException",(function(t){if(!(t instanceof ut))throw t})),t.on("unhandledRejection",Y),c.inspect=function(){return"[Emscripten Module object]"}):u?("undefined"!=typeof read&&(h=function(t){return read(t)}),p=function(t){var e;return"function"==typeof readbuffer?new Uint8Array(readbuffer(t)):(_("object"==typeof(e=read(t,"binary"))),e)},"undefined"!=typeof scriptArgs&&scriptArgs,"undefined"!=typeof print&&("undefined"==typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!=typeof printErr?printErr:print)):(a||o)&&(o?m=self.location.href:document.currentScript&&(m=document.currentScript.src),i&&(m=i),m=0!==m.indexOf("blob:")?m.substr(0,m.lastIndexOf("/")+1):"",h=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},o&&(p=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}));var v,g,y=c.print||console.log.bind(console),x=c.printErr||console.warn.bind(console);for(n in l)l.hasOwnProperty(n)&&(c[n]=l[n]);l=null,c.arguments&&c.arguments,c.thisProgram&&c.thisProgram,c.quit&&c.quit,c.wasmBinary&&(v=c.wasmBinary),c.noExitRuntime&&c.noExitRuntime,"object"!=typeof WebAssembly&&x("no native wasm support detected");var b=new WebAssembly.Table({initial:112,maximum:112,element:"anyfunc"}),w=!1;function _(t,e){t||Y("Assertion failed: "+e)}function S(t){var e=c["_"+t];return _(e,"Cannot call unknown function "+t+", make sure it is exported"),e}function M(t,e,n,r,i){var a={string:function(t){var e=0;if(null!=t&&0!==t){var n=1+(t.length<<2);!function(t,e,n){!function(t,e,n,r){if(!(r>0))return 0;for(var i=n+r-1,a=0;a<t.length;++a){var o=t.charCodeAt(a);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&t.charCodeAt(++a)),o<=127){if(n>=i)break;e[n++]=o}else if(o<=2047){if(n+1>=i)break;e[n++]=192|o>>6,e[n++]=128|63&o}else if(o<=65535){if(n+2>=i)break;e[n++]=224|o>>12,e[n++]=128|o>>6&63,e[n++]=128|63&o}else{if(n+3>=i)break;e[n++]=240|o>>18,e[n++]=128|o>>12&63,e[n++]=128|o>>6&63,e[n++]=128|63&o}}e[n]=0}(t,C,e,n)}(t,e=ot(n),n)}return e},array:function(t){var e=ot(t.length);return function(t,e){T.set(t,e)}(t,e),e}},o=S(t),s=[],u=0;if(r)for(var c=0;c<r.length;c++){var l=a[n[c]];l?(0===u&&(u=at()),s[c]=l(r[c])):s[c]=r[c]}var h=o.apply(null,s);return h=function(t){return"string"===e?R(t):"boolean"===e?Boolean(t):t}(h),0!==u&&st(u),h}var E,T,C,A,N="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function I(t,e,n){for(var r=e+n,i=e;t[i]&&!(i>=r);)++i;if(i-e>16&&t.subarray&&N)return N.decode(t.subarray(e,i));for(var a="";e<i;){var o=t[e++];if(128&o){var s=63&t[e++];if(192!=(224&o)){var u=63&t[e++];if((o=224==(240&o)?(15&o)<<12|s<<6|u:(7&o)<<18|s<<12|u<<6|63&t[e++])<65536)a+=String.fromCharCode(o);else{var c=o-65536;a+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else a+=String.fromCharCode((31&o)<<6|s)}else a+=String.fromCharCode(o)}return a}function R(t,e){return t?I(C,t,e):""}function O(t,e){return t%e>0&&(t+=e-t%e),t}function k(t){E=t,c.HEAP8=T=new Int8Array(t),c.HEAP16=new Int16Array(t),c.HEAP32=A=new Int32Array(t),c.HEAPU8=C=new Uint8Array(t),c.HEAPU16=new Uint16Array(t),c.HEAPU32=new Uint32Array(t),c.HEAPF32=new Float32Array(t),c.HEAPF64=new Float64Array(t)}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var L=c.TOTAL_MEMORY||16777216;function D(t){for(;t.length>0;){var e=t.shift();if("function"!=typeof e){var n=e.func;"number"==typeof n?void 0===e.arg?c.dynCall_v(n):c.dynCall_vi(n,e.arg):n(void 0===e.arg?null:e.arg)}else e()}}(g=c.wasmMemory?c.wasmMemory:new WebAssembly.Memory({initial:L/65536}))&&(E=g.buffer),L=E.byteLength,k(E),A[2540]=5253200;var P=[],F=[],z=[],j=[];function W(t){P.unshift(t)}function V(t){j.unshift(t)}var H=Math.ceil,G=Math.floor,q=0,X=null,$=null;function Y(t){throw c.onAbort&&c.onAbort(t),y(t+=""),x(t),w=!0,t="abort("+t+"). Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(t)}c.preloadedImages={},c.preloadedAudios={};var K="data:application/octet-stream;base64,";function J(t){return String.prototype.startsWith?t.startsWith(K):0===t.indexOf(K)}var Z="tfjs-backend-wasm.wasm";function Q(){try{if(v)return new Uint8Array(v);if(p)return p(Z);throw"both async and sync fetching of the wasm failed"}catch(t){Y(t)}}J(Z)||(Z=function(t){return c.locateFile?c.locateFile(t,m):m+t}(Z)),F.push({func:function(){it()}});var tt={buffers:[null,[],[]],printChar:function(t,e){var n=tt.buffers[t];0===e||10===e?((1===t?y:x)(I(n,0)),n.length=0):n.push(e)},varargs:0,get:function(t){return tt.varargs+=4,A[tt.varargs-4>>2]},getStr:function(){return R(tt.get())},get64:function(){var t=tt.get();return tt.get(),t},getZero:function(){tt.get()}},et={a:function(){Y()},d:function(t,e,n){C.set(C.subarray(e,e+n),t)},e:function(t){var e=T.length;if(t>2147418112)return!1;for(var n=Math.max(e,16777216);n<t;)n=n<=536870912?O(2*n,65536):Math.min(O((3*n+2147483648)/4,65536),2147418112);return!!function(t){try{return g.grow(t-E.byteLength+65535>>16),k(g.buffer),1}catch(t){}}(n)},f:function(t){try{return 0}catch(t){return"undefined"!=typeof FS&&t instanceof FS.ErrnoError||Y(t),t.errno}},c:function(t,e,n,r,i){try{return 0}catch(t){return"undefined"!=typeof FS&&t instanceof FS.ErrnoError||Y(t),t.errno}},g:function(t,e,n,r){try{for(var i=0,a=0;a<n;a++){for(var o=A[e+8*a>>2],s=A[e+(8*a+4)>>2],u=0;u<s;u++)tt.printChar(t,C[o+u]);i+=s}return A[r>>2]=i,0}catch(t){return"undefined"!=typeof FS&&t instanceof FS.ErrnoError||Y(t),t.errno}},memory:g,b:function(t){return(t=+t)>=0?+G(t+.5):+H(t-.5)},table:b},nt=function(){var t={env:et,wasi_unstable:et};function e(t,e){var n=t.exports;c.asm=n,function(t){if(q--,c.monitorRunDependencies&&c.monitorRunDependencies(q),0==q&&(null!==X&&(clearInterval(X),X=null),$)){var e=$;$=null,e()}}()}function n(t){e(t.instance)}function r(e){return(v||!a&&!o||"function"!=typeof fetch?new Promise((function(t,e){t(Q())})):fetch(Z,{credentials:"same-origin"}).then((function(t){if(!t.ok)throw"failed to load wasm binary file at '"+Z+"'";return t.arrayBuffer()})).catch((function(){return Q()}))).then((function(e){return WebAssembly.instantiate(e,t)})).then(e,(function(t){x("failed to asynchronously prepare wasm: "+t),Y(t)}))}if(q++,c.monitorRunDependencies&&c.monitorRunDependencies(q),c.instantiateWasm)try{return c.instantiateWasm(t,e)}catch(t){return x("Module.instantiateWasm callback failed with error: "+t),!1}return function(){if(v||"function"!=typeof WebAssembly.instantiateStreaming||J(Z)||"function"!=typeof fetch)return r(n);fetch(Z,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,t).then(n,(function(t){x("wasm streaming compile failed: "+t),x("falling back to ArrayBuffer instantiation"),r(n)}))}))}(),{}}();c.asm=nt;var rt,it=c.___wasm_call_ctors=function(){return c.asm.h.apply(null,arguments)},at=(c._init=function(){return c.asm.i.apply(null,arguments)},c._register_tensor=function(){return c.asm.j.apply(null,arguments)},c._dispose_data=function(){return c.asm.k.apply(null,arguments)},c._dispose=function(){return c.asm.l.apply(null,arguments)},c._Abs=function(){return c.asm.m.apply(null,arguments)},c._Add=function(){return c.asm.n.apply(null,arguments)},c._AddN=function(){return c.asm.o.apply(null,arguments)},c._ArgMax=function(){return c.asm.p.apply(null,arguments)},c._AvgPool=function(){return c.asm.q.apply(null,arguments)},c._BatchMatMul=function(){return c.asm.r.apply(null,arguments)},c._ClipByValue=function(){return c.asm.s.apply(null,arguments)},c._Conv2D=function(){return c.asm.t.apply(null,arguments)},c._Cos=function(){return c.asm.u.apply(null,arguments)},c._CropAndResize=function(){return c.asm.v.apply(null,arguments)},c._DepthwiseConv2dNative=function(){return c.asm.w.apply(null,arguments)},c._Div=function(){return c.asm.x.apply(null,arguments)},c._Exp=function(){return c.asm.y.apply(null,arguments)},c._FloorDiv=function(){return c.asm.z.apply(null,arguments)},c._FusedBatchNorm=function(){return c.asm.A.apply(null,arguments)},c._FusedConv2D=function(){return c.asm.B.apply(null,arguments)},c._FusedDepthwiseConv2D=function(){return c.asm.C.apply(null,arguments)},c._Gather=function(){return c.asm.D.apply(null,arguments)},c._GatherNd=function(){return c.asm.E.apply(null,arguments)},c._Greater=function(){return c.asm.F.apply(null,arguments)},c._GreaterEqual=function(){return c.asm.G.apply(null,arguments)},c._Less=function(){return c.asm.H.apply(null,arguments)},c._LessEqual=function(){return c.asm.I.apply(null,arguments)},c._Log=function(){return c.asm.J.apply(null,arguments)},c._LogicalAnd=function(){return c.asm.K.apply(null,arguments)},c._Max=function(){return c.asm.L.apply(null,arguments)},c._MaxPool=function(){return c.asm.M.apply(null,arguments)},c._Maximum=function(){return c.asm.N.apply(null,arguments)},c._Min=function(){return c.asm.O.apply(null,arguments)},c._Minimum=function(){return c.asm.P.apply(null,arguments)},c._Mul=function(){return c.asm.Q.apply(null,arguments)},c._Neg=function(){return c.asm.R.apply(null,arguments)},c._NonMaxSuppressionV3=function(){return c.asm.S.apply(null,arguments)},c._NonMaxSuppressionV5=function(){return c.asm.T.apply(null,arguments)},c._NotEqual=function(){return c.asm.U.apply(null,arguments)},c._PadV2=function(){return c.asm.V.apply(null,arguments)},c._Pow=function(){return c.asm.W.apply(null,arguments)},c._Prelu=function(){return c.asm.X.apply(null,arguments)},c._Relu=function(){return c.asm.Y.apply(null,arguments)},c._Relu6=function(){return c.asm.Z.apply(null,arguments)},c._ResizeBilinear=function(){return c.asm._.apply(null,arguments)},c._Rsqrt=function(){return c.asm.$.apply(null,arguments)},c._ScatterNd=function(){return c.asm.aa.apply(null,arguments)},c._Sigmoid=function(){return c.asm.ba.apply(null,arguments)},c._Sin=function(){return c.asm.ca.apply(null,arguments)},c._Softmax=function(){return c.asm.da.apply(null,arguments)},c._Square=function(){return c.asm.ea.apply(null,arguments)},c._Sub=function(){return c.asm.fa.apply(null,arguments)},c._Sum=function(){return c.asm.ga.apply(null,arguments)},c._Tanh=function(){return c.asm.ha.apply(null,arguments)},c._Tile=function(){return c.asm.ia.apply(null,arguments)},c._Transpose=function(){return c.asm.ja.apply(null,arguments)},c.__FusedMatMul=function(){return c.asm.ka.apply(null,arguments)},c._malloc=function(){return c.asm.la.apply(null,arguments)},c._free=function(){return c.asm.ma.apply(null,arguments)},c.stackSave=function(){return c.asm.na.apply(null,arguments)}),ot=c.stackAlloc=function(){return c.asm.oa.apply(null,arguments)},st=c.stackRestore=function(){return c.asm.pa.apply(null,arguments)};function ut(t){this.name="ExitStatus",this.message="Program terminated with exit("+t+")",this.status=t}function ct(t){function e(){rt||(rt=!0,w||(D(F),D(z),c.onRuntimeInitialized&&c.onRuntimeInitialized(),function(){if(c.postRun)for("function"==typeof c.postRun&&(c.postRun=[c.postRun]);c.postRun.length;)V(c.postRun.shift());D(j)}()))}q>0||(function(){if(c.preRun)for("function"==typeof c.preRun&&(c.preRun=[c.preRun]);c.preRun.length;)W(c.preRun.shift());D(P)}(),q>0||(c.setStatus?(c.setStatus("Running..."),setTimeout((function(){setTimeout((function(){c.setStatus("")}),1),e()}),1)):e()))}if(c.dynCall_vi=function(){return c.asm.qa.apply(null,arguments)},c.dynCall_v=function(){return c.asm.ra.apply(null,arguments)},c.asm=nt,c.cwrap=function(t,e,n,r){var i=(n=n||[]).every((function(t){return"number"===t}));return"string"!==e&&i&&!r?S(t):function(){return M(t,e,n,arguments)}},c.then=function(t){if(rt)t(c);else{var e=c.onRuntimeInitialized;c.onRuntimeInitialized=function(){e&&e(),t(c)}}return c},$=function t(){rt||ct(),rt||($=t)},c.run=ct,c.preInit)for("function"==typeof c.preInit&&(c.preInit=[c.preInit]);c.preInit.length>0;)c.preInit.pop()();return ct(),e});e.exports=a}(Y={exports:{}}),Y.exports),J=function(t){function e(e){var n=t.call(this)||this;return n.wasm=e,n.dataIdNextNumber=1,n.wasm.tfjs.init(),n.dataIdMap=new P.a(n,Object(P.P)()),n}return function(t,e){function n(){this.constructor=t}q(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.write=function(t,e,n){var r={};return this.move(r,t,e,n),r},e.prototype.numDataIds=function(){return this.dataIdMap.numDataIds()},e.prototype.time=function(t){return X(this,void 0,void 0,(function(){var e;return $(this,(function(n){return e=P.Nc.now(),t(),[2,{kernelMs:P.Nc.now()-e}]}))}))},e.prototype.move=function(t,e,n,r){var i=this.dataIdNextNumber++;if("string"!==r){var a=P.Nc.sizeFromShape(n),o=a*P.Nc.bytesPerElement(r),s=this.wasm._malloc(o);this.dataIdMap.set(t,{id:i,memoryOffset:s,shape:n,dtype:r}),this.wasm.tfjs.registerTensor(i,a,s),null!=e&&this.wasm.HEAPU8.set(new Uint8Array(e.buffer,0,o),s)}else{var u=e;this.dataIdMap.set(t,{id:i,stringBytes:u,shape:n,dtype:r,memoryOffset:null})}},e.prototype.read=function(t){return X(this,void 0,void 0,(function(){return $(this,(function(e){return[2,this.readSync(t)]}))}))},e.prototype.readSync=function(t){var e=this.dataIdMap.get(t),n=e.memoryOffset,r=e.dtype,i=e.shape,a=e.stringBytes;return"string"===r?a:function(t,e){switch(e){case"float32":return new Float32Array(t);case"int32":return new Int32Array(t);case"bool":return new Uint8Array(t);default:throw new Error("Unknown dtype "+e)}}(this.wasm.HEAPU8.slice(n,n+P.Nc.sizeFromShape(i)*P.Nc.bytesPerElement(r)).buffer,r)},e.prototype.disposeData=function(t){var e=this.dataIdMap.get(t);this.wasm._free(e.memoryOffset),this.wasm.tfjs.disposeData(e.id),this.dataIdMap.delete(t)},e.prototype.floatPrecision=function(){return 32},e.prototype.getMemoryOffset=function(t){return this.dataIdMap.get(t).memoryOffset},e.prototype.dispose=function(){this.wasm.tfjs.dispose(),this.wasm=null},e.prototype.memory=function(){return{unreliable:!1}},e.prototype.makeOutput=function(t,e,n){var r;if(null==n)r=this.write(null,t,e);else{r={};var i=this.dataIdNextNumber++;this.dataIdMap.set(r,{id:i,memoryOffset:n,shape:t,dtype:e});var a=P.Nc.sizeFromShape(t);this.wasm.tfjs.registerTensor(i,a,n)}return{dataId:r,shape:t,dtype:e}},e.prototype.typedArrayFromHeap=function(t){var e=t.shape,n=t.dtype,r=t.dataId,i=this.wasm.HEAPU8.buffer,a=this.dataIdMap.get(r).memoryOffset,o=P.Nc.sizeFromShape(e);switch(n){case"float32":return new Float32Array(i,a,o);case"int32":return new Int32Array(i,a,o);case"bool":return new Uint8Array(i,a,o);default:throw new Error("Uknown dtype "+n)}},e}(P.b);function Z(){return X(this,void 0,void 0,(function(){return $(this,(function(t){return[2,new Promise((function(t,e){var n={};null!=Q&&(n.locateFile=function(t,e){return t.endsWith(".wasm")?Q:e+t},et&&(n.instantiateWasm=function(t){return function(e,n){return P.Nc.fetch(t,{credentials:"same-origin"}).then((function(r){r.ok||e.env.a("failed to load wasm binary file at '"+t+"'"),r.arrayBuffer().then((function(t){WebAssembly.instantiate(t,e).then((function(t){n(t.instance)}))}))})),{}}}(Q)));var r=K(n);r.tfjs={init:r.cwrap("init",null,[]),registerTensor:r.cwrap("register_tensor",null,["number","number","number"]),disposeData:r.cwrap("dispose_data",null,["number"]),dispose:r.cwrap("dispose",null,[])};var i=!1;r.onRuntimeInitialized=function(){i=!0,tt=!1,t({wasm:r})},r.onAbort=function(){i||tt||(tt=!0,e({message:"Make sure the server can serve the `.wasm` file relative to the bundled js file. For more details see https://github.com/tensorflow/tfjs/blob/master/tfjs-backend-wasm/README.md#using-bundlers"}))}}))]}))}))}Object(P.Vb)("wasm",(function(){return X(void 0,void 0,void 0,(function(){var t;return $(this,(function(e){switch(e.label){case 0:return[4,Z()];case 1:return t=e.sent().wasm,[2,new J(t)]}}))}))}),2);var Q=null,tt=!1,et=!1;function nt(t,e){if(void 0===e&&(e=!1),tt)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPath()` before you call `tf.setBackend()` or `tf.ready()`");Q=t,et=e}}).call(this,n(94),"/")},function(t,e){},function(t,e){},function(t,e,n){"use strict";
/** @license See the LICENSE file. */Object.defineProperty(e,"__esModule",{value:!0});e.version="1.7.4"},function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var r=n(0),i=n(97);
/**
    * @license
    * Copyright 2020 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */
const a=t=>({startEndTensor:t,startPoint:Object(r.nc)(t,[0,0],[-1,2]),endPoint:Object(r.nc)(t,[0,2],[-1,2])}),o={strides:[8,16],anchors:[2,6]};function s(t,e){let n,i,a;if(t.topLeft instanceof r.c&&t.bottomRight instanceof r.c){const[o,s]=Object(r.Hc)(()=>[Object(r.C)([Object(r.Ac)(e-1,t.topLeft.slice(0,1)),t.topLeft.slice(1,1)]),Object(r.C)([Object(r.Ac)(e-1,t.bottomRight.slice(0,1)),t.bottomRight.slice(1,1)])]);n=o,i=s,null!=t.landmarks&&(a=Object(r.Hc)(()=>{const n=Object(r.Ac)(Object(r.Fc)([e-1,0]),t.landmarks),i=Object(r.Fc)([1,-1]);return Object(r.Gb)(n,i)}))}else{const[r,o]=t.topLeft,[s,u]=t.bottomRight;n=[e-1-r,o],i=[e-1-s,u],null!=t.landmarks&&(a=t.landmarks.map(t=>[e-1-t[0],t[1]]))}const o={topLeft:n,bottomRight:i};return null!=a&&(o.landmarks=a),null!=t.probability&&(o.probability=t.probability instanceof r.c?t.probability.clone():t.probability),o}function u(t,e){return Object(r.Hc)(()=>{let n;return n=t.hasOwnProperty("box")?t.box:t,((t,e)=>{const n=Object(r.Gb)(t.startPoint,e),i=Object(r.Gb)(t.endPoint,e),o=Object(r.D)([n,i],1);return a(o)})(n,e).startEndTensor.squeeze()})}class c{constructor(t,e,n,i,a,s){this.blazeFaceModel=t,this.width=e,this.height=n,this.maxFaces=i,this.anchorsData=function(t,e,n){const r=[];for(let i=0;i<n.strides.length;i++){const a=n.strides[i],o=Math.floor((e+a-1)/a),s=Math.floor((t+a-1)/a),u=n.anchors[i];for(let t=0;t<o;t++){const e=a*(t+.5);for(let t=0;t<s;t++){const n=a*(t+.5);for(let t=0;t<u;t++)r.push([n,e])}}}return r}(e,n,o),this.anchors=Object(r.Gc)(this.anchorsData),this.inputSizeData=[e,n],this.inputSize=Object(r.Fc)([e,n]),this.iouThreshold=a,this.scoreThreshold=s}async getBoundingBoxes(t,e,n=!0){const[i,o,s]=Object(r.Hc)(()=>{const e=t.resizeBilinear([this.width,this.height]),n=Object(r.Gb)(Object(r.Ac)(e.div(255),.5),2),i=this.blazeFaceModel.predict(n).squeeze(),a=function(t,e,n){const i=Object(r.nc)(t,[0,1],[-1,2]),a=Object(r.g)(i,e),o=Object(r.nc)(t,[0,3],[-1,2]),s=Object(r.M)(o,n),u=Object(r.M)(a,n),c=Object(r.M)(s,2),l=Object(r.Ac)(u,c),h=Object(r.g)(u,c),p=Object(r.Gb)(l,n),f=Object(r.Gb)(h,n);return Object(r.D)([p,f],1)}(i,this.anchors,this.inputSize),o=Object(r.nc)(i,[0,0],[-1,1]);return[i,a,Object(r.jc)(o).squeeze()]}),u=console.warn;console.warn=()=>{};const c=r.ib.nonMaxSuppression(o,s,this.maxFaces,this.iouThreshold,this.scoreThreshold);console.warn=u;const l=await c.array();c.dispose();let h=l.map(t=>Object(r.nc)(o,[t,0],[1,-1]));e||(h=await Promise.all(h.map(async t=>{const e=await t.array();return t.dispose(),e})));const p=t.shape[1],f=t.shape[2];let d;d=e?Object(r.M)([f,p],this.inputSize):[f/this.inputSizeData[0],p/this.inputSizeData[1]];const m=[];for(let t=0;t<h.length;t++){const o=h[t],u=Object(r.Hc)(()=>{const u=a(o instanceof r.c?o:Object(r.Gc)(o));if(!n)return u;const c=l[t];let h;return h=e?this.anchors.slice([c,0],[1,2]):this.anchorsData[c],{box:u,landmarks:Object(r.nc)(i,[c,5],[1,-1]).squeeze().reshape([6,-1]),probability:Object(r.nc)(s,[c],[1]),anchor:h}});m.push(u)}return o.dispose(),s.dispose(),i.dispose(),{boxes:m,scaleFactor:d}}async estimateFaces(t,e=!1,n=!1,i=!0){const[,a]=function(t){return t instanceof r.c?[t.shape[0],t.shape[1]]:[t.height,t.width]}(t),o=Object(r.Hc)(()=>(t instanceof r.c||(t=r.w.fromPixels(t)),t.toFloat().expandDims(0))),{boxes:c,scaleFactor:l}=await this.getBoundingBoxes(o,e,i);return o.dispose(),e?c.map(t=>{const e=u(t,l);let r={topLeft:e.slice([0],[2]),bottomRight:e.slice([2],[2])};if(i){const{landmarks:e,probability:n,anchor:i}=t,a=e.add(i).mul(l);r.landmarks=a,r.probability=n}return n&&(r=s(r,a)),r}):Promise.all(c.map(async t=>{const e=u(t,l);let r;if(i){const[n,i,a]=await Promise.all([t.landmarks,e,t.probability].map(async t=>t.array())),o=t.anchor,[s,u]=l,c=n.map(t=>[(t[0]+o[0])*s,(t[1]+o[1])*u]);r={topLeft:i.slice(0,2),bottomRight:i.slice(2),landmarks:c,probability:a},(t=>{t.startEndTensor.dispose(),t.startPoint.dispose(),t.endPoint.dispose()})(t.box),t.landmarks.dispose(),t.probability.dispose()}else{const t=await e.array();r={topLeft:t.slice(0,2),bottomRight:t.slice(2)}}return e.dispose(),n&&(r=s(r,a)),r}))}}const l={silhouette:[10,338,297,332,284,251,389,356,454,323,361,288,397,365,379,378,400,377,152,148,176,149,150,136,172,58,132,93,234,127,162,21,54,103,67,109],lipsUpperOuter:[61,185,40,39,37,0,267,269,270,409,291],lipsLowerOuter:[146,91,181,84,17,314,405,321,375,291],lipsUpperInner:[78,191,80,81,82,13,312,311,310,415,308],lipsLowerInner:[78,95,88,178,87,14,317,402,318,324,308],rightEyeUpper0:[246,161,160,159,158,157,173],rightEyeLower0:[33,7,163,144,145,153,154,155,133],rightEyeUpper1:[247,30,29,27,28,56,190],rightEyeLower1:[130,25,110,24,23,22,26,112,243],rightEyeUpper2:[113,225,224,223,222,221,189],rightEyeLower2:[226,31,228,229,230,231,232,233,244],rightEyeLower3:[143,111,117,118,119,120,121,128,245],rightEyebrowUpper:[156,70,63,105,66,107,55,193],rightEyebrowLower:[35,124,46,53,52,65],leftEyeUpper0:[466,388,387,386,385,384,398],leftEyeLower0:[263,249,390,373,374,380,381,382,362],leftEyeUpper1:[467,260,259,257,258,286,414],leftEyeLower1:[359,255,339,254,253,252,256,341,463],leftEyeUpper2:[342,445,444,443,442,441,413],leftEyeLower2:[446,261,448,449,450,451,452,453,464],leftEyeLower3:[372,340,346,347,348,349,350,357,465],leftEyebrowUpper:[383,300,293,334,296,336,285,417],leftEyebrowLower:[265,353,276,283,282,295],midwayBetweenEyes:[168],noseTip:[1],noseBottom:[2],noseRightCorner:[98],noseLeftCorner:[327],rightCheek:[205],leftCheek:[425]};function h(t){null!=t&&null!=t.startPoint&&(t.startEndTensor.dispose(),t.startPoint.dispose(),t.endPoint.dispose())}function p(t,e,n){return{startEndTensor:t,startPoint:null!=e?e:Object(r.nc)(t,[0,0],[-1,2]),endPoint:null!=n?n:Object(r.nc)(t,[0,2],[-1,2])}}function f(t){return Object(r.Hc)(()=>{const e=Object(r.Ac)(t.endPoint,t.startPoint);return Object(r.d)(e)})}function d(t,e=1.5){return Object(r.Hc)(()=>{const n=function(t){return Object(r.Hc)(()=>{const e=Object(r.M)(Object(r.Ac)(t.endPoint,t.startPoint),2);return Object(r.g)(t.startPoint,e)})}(t),i=f(t),a=Object(r.Gb)(Object(r.M)(i,2),e),o=Object(r.Ac)(n,a),s=Object(r.g)(n,a);return p(Object(r.D)([o,s],1),o,s)})}class m{constructor(t,e,n,r,i,a){this.regionsOfInterest=[],this.runsWithoutFaceDetector=0,this.boundingBoxDetector=t,this.meshDetector=e,this.meshWidth=n,this.meshHeight=r,this.maxContinuousChecks=i,this.maxFaces=a}async predict(t){if(this.shouldUpdateRegionsOfInterest()){const e=!0,n=!1,{boxes:i,scaleFactor:a}=await this.boundingBoxDetector.getBoundingBoxes(t,e,n);if(0===i.length)return a.dispose(),this.clearAllRegionsOfInterest(),null;const o=i.map(t=>d(function(t,e){const n=Object(r.Gb)(t.startPoint,e),i=Object(r.Gb)(t.endPoint,e);return p(Object(r.D)([n,i],1))}(t,a)));i.forEach(h),this.updateRegionsOfInterest(o),this.runsWithoutFaceDetector=0}else this.runsWithoutFaceDetector++;return Object(r.Hc)(()=>this.regionsOfInterest.map((e,n)=>{const i=function(t,e,n){const i=e.shape[1],a=e.shape[2],o=t.startEndTensor;return Object(r.Hc)(()=>{const t=Object(r.D)([o.slice([0,1],[-1,1]),o.slice([0,0],[-1,1]),o.slice([0,3],[-1,1]),o.slice([0,2],[-1,1])],0),s=Object(r.M)(t.transpose(),[i,a,i,a]);return r.ib.cropAndResize(e,s,[0],n)})}(e,t,[this.meshHeight,this.meshWidth]).div(255),[,a,o]=this.meshDetector.predict(i),s=Object(r.Yb)(o,[-1,3]),u=Object(r.M)(f(e),[this.meshWidth,this.meshHeight]),c=Object(r.Gb)(s,u.concat(Object(r.Gc)([1],[1,1]),1)).add(e.startPoint.concat(Object(r.Gc)([0],[1,1]),1)),l=this.calculateLandmarksBoundingBox(c);return h(this.regionsOfInterest[n]),this.regionsOfInterest[n]=l,{coords:s,scaledCoords:c,box:l,flag:a.squeeze()}}))}updateRegionsOfInterest(t){for(let e=0;e<t.length;e++){const n=t[e],r=this.regionsOfInterest[e];let i=0;if(r&&r.startPoint){const[t,e,a,o]=n.startEndTensor.arraySync()[0],[s,u,c,l]=r.startEndTensor.arraySync()[0],h=Math.max(t,s),p=Math.max(e,u),f=(Math.min(a,c)-h)*(Math.min(o,l)-p);i=f/((a-t)*(o-e)+(c-s)*(l-e)-f)}i>.25?h(n):(this.regionsOfInterest[e]=n,h(r))}for(let e=t.length;e<this.regionsOfInterest.length;e++)h(this.regionsOfInterest[e]);this.regionsOfInterest=this.regionsOfInterest.slice(0,t.length)}clearRegionOfInterest(t){null!=this.regionsOfInterest[t]&&(h(this.regionsOfInterest[t]),this.regionsOfInterest=[...this.regionsOfInterest.slice(0,t),...this.regionsOfInterest.slice(t+1)])}clearAllRegionsOfInterest(){for(let t=0;t<this.regionsOfInterest.length;t++)h(this.regionsOfInterest[t]);this.regionsOfInterest=[]}shouldUpdateRegionsOfInterest(){const t=this.regionsOfInterest.length,e=0===t;return 1===this.maxFaces||e?e:t!==this.maxFaces&&this.runsWithoutFaceDetector>=this.maxContinuousChecks}calculateLandmarksBoundingBox(t){const e=t.slice([0,0],[468,1]),n=t.slice([0,1],[468,1]);return d(p(Object(r.yc)([e.min(),n.min(),e.max(),n.max()]).expandDims(0)))}}async function v({maxContinuousChecks:t=5,detectionConfidence:e=.9,maxFaces:n=10,iouThreshold:r=.3,scoreThreshold:i=.75}={}){const[a,o]=await Promise.all([g(n,r,i),y()]);return new b(a,o,t,e,n)}async function g(t,e,n){return async function({maxFaces:t=10,inputWidth:e=128,inputHeight:n=128,iouThreshold:r=.3,scoreThreshold:a=.75}={}){const o=await Object(i.a)("https://tfhub.dev/tensorflow/tfjs-model/blazeface/1/default/1",{fromTFHub:!0});return new c(o,e,n,t,r,a)}({maxFaces:t,iouThreshold:e,scoreThreshold:n})}async function y(){return Object(i.a)("https://tfhub.dev/mediapipe/tfjs-model/facemesh/1/default/1",{fromTFHub:!0})}function x(t,e){if(t.mesh instanceof r.c){const[n,i,a,o]=Object(r.Hc)(()=>{const n=Object(r.Fc)([e-1,0,0]),i=Object(r.Fc)([1,-1,1]);return Object(r.Hc)(()=>[Object(r.C)([Object(r.Ac)(e-1,t.boundingBox.topLeft.slice(0,1)),t.boundingBox.topLeft.slice(1,1)]),Object(r.C)([Object(r.Ac)(e-1,t.boundingBox.bottomRight.slice(0,1)),t.boundingBox.bottomRight.slice(1,1)]),Object(r.Ac)(n,t.mesh).mul(i),Object(r.Ac)(n,t.scaledMesh).mul(i)])});return Object.assign({},t,{boundingBox:{topLeft:n,bottomRight:i},mesh:a,scaledMesh:o})}return Object.assign({},t,{boundingBox:{topLeft:[e-1-t.boundingBox.topLeft[0],t.boundingBox.topLeft[1]],bottomRight:[e-1-t.boundingBox.bottomRight[0],t.boundingBox.bottomRight[1]]},mesh:t.mesh.map(t=>{const n=t.slice(0);return n[0]=e-1-t[0],n}),scaledMesh:t.scaledMesh.map(t=>{const n=t.slice(0);return n[0]=e-1-t[0],n})})}class b{constructor(t,e,n,r,i){this.pipeline=new m(t,e,192,192,n,i),this.detectionConfidence=r}static getAnnotations(){return l}async estimateFaces(t,e=!1,n=!1){const[,i]=function(t){return t instanceof r.c?[t.shape[0],t.shape[1]]:[t.height,t.width]}(t),a=Object(r.Hc)(()=>(t instanceof r.c||(t=r.w.fromPixels(t)),t.toFloat().expandDims(0))),o=Object(r.Q)().get("WEBGL_PACK_DEPTHWISECONV");Object(r.Q)().set("WEBGL_PACK_DEPTHWISECONV",!0);const s=await this.pipeline.predict(a);return Object(r.Q)().set("WEBGL_PACK_DEPTHWISECONV",o),a.dispose(),null!=s&&s.length>0?Promise.all(s.map(async(t,r)=>{const{coords:a,scaledCoords:o,box:s,flag:u}=t;let c=[u];e||(c=c.concat([a,o,s.startPoint,s.endPoint]));const h=await Promise.all(c.map(async t=>t.array())),p=h[0];if(u.dispose(),p<this.detectionConfidence&&this.pipeline.clearRegionOfInterest(r),e){const t={faceInViewConfidence:p,mesh:a,scaledMesh:o,boundingBox:{topLeft:s.startPoint.squeeze(),bottomRight:s.endPoint.squeeze()}};return n?x(t,i):t}const[f,d,m,v]=h.slice(1);o.dispose(),a.dispose();let g={faceInViewConfidence:p,boundingBox:{topLeft:m,bottomRight:v},mesh:f,scaledMesh:d};n&&(g=x(g,i));const y={};for(const t in l)y[t]=l[t].map(t=>g.scaledMesh[t]);return g.annotations=y,g})):[]}}},function(t,e){t.exports=class{constructor(t){return this.destination=t,this.blocks=[{color:"vec3(0., 0., 0.)",st:"vUv"}],this}float(t){return t.toFixed(2)}gradient(){let t=[];for(let e of arguments)t.push(e);return this.blocks.push({color:`vec3(${t.join(", ")})`,st:"st"}),this}repeat(t=1,e=1){return this.blocks.push({color:"color",st:`vec2(fract(${this.float(t)} * st.x), fract(${this.float(e)} * st.y))`}),this}blend(t=[],e=1){return this.blocks.push({color:`mix(color, vec3(${t.join(",")}), ${e})`}),this}out(){let t="";t+="varying vec2 vUv;",t+="\nuniform float u_time;",t+="\nuniform float u_resolution;",t+="\nvoid main(){",t+="\n    vec2 st = vUv;",t+=`\n    vec3 color = vec3(${this.float(0)});`,t+=this.blocks.map(t=>{let e=t.color,n=t.st,r="";return n&&(r+=`\n    st = ${n};`),e&&(r+=`\n    color = ${e};`),r}).join(""),t+=`\n    gl_FragColor = vec4(color, ${this.float(1)});`,t+="\n}",this.destination.material.fragmentShader=t}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(2),i={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = opacity * texel;","}"].join("\n")},a=n(48),o=n(18),s=function(t,e){o.a.call(this),this.scene=t,this.camera=e,this.clear=!0,this.needsSwap=!1,this.inverse=!1};s.prototype=Object.assign(Object.create(o.a.prototype),{constructor:s,render:function(t,e,n){var r,i,a=t.getContext(),o=t.state;o.buffers.color.setMask(!1),o.buffers.depth.setMask(!1),o.buffers.color.setLocked(!0),o.buffers.depth.setLocked(!0),this.inverse?(r=0,i=1):(r=1,i=0),o.buffers.stencil.setTest(!0),o.buffers.stencil.setOp(a.REPLACE,a.REPLACE,a.REPLACE),o.buffers.stencil.setFunc(a.ALWAYS,r,4294967295),o.buffers.stencil.setClear(i),o.buffers.stencil.setLocked(!0),t.setRenderTarget(n),this.clear&&t.clear(),t.render(this.scene,this.camera),t.setRenderTarget(e),this.clear&&t.clear(),t.render(this.scene,this.camera),o.buffers.color.setLocked(!1),o.buffers.depth.setLocked(!1),o.buffers.stencil.setLocked(!1),o.buffers.stencil.setFunc(a.EQUAL,1,4294967295),o.buffers.stencil.setOp(a.KEEP,a.KEEP,a.KEEP),o.buffers.stencil.setLocked(!0)}});var u=function(){o.a.call(this),this.needsSwap=!1};u.prototype=Object.create(o.a.prototype),Object.assign(u.prototype,{render:function(t){t.state.buffers.stencil.setLocked(!1),t.state.buffers.stencil.setTest(!1)}});var c=function(t,e){if(this.renderer=t,void 0===e){var n={minFilter:r.h,magFilter:r.h,format:r.n,stencilBuffer:!1},o=t.getSize(new r.s);this._pixelRatio=t.getPixelRatio(),this._width=o.width,this._height=o.height,(e=new r.u(this._width*this._pixelRatio,this._height*this._pixelRatio,n)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=e.width,this._height=e.height;this.renderTarget1=e,this.renderTarget2=e.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===i&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===a.a&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new a.a(i),this.clock=new r.b};Object.assign(c.prototype,{swapBuffers:function(){var t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t},addPass:function(t){this.passes.push(t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},insertPass:function(t,e){this.passes.splice(e,0,t)},isLastEnabledPass:function(t){for(var e=t+1;e<this.passes.length;e++)if(this.passes[e].enabled)return!1;return!0},render:function(t){void 0===t&&(t=this.clock.getDelta());var e,n,r=this.renderer.getRenderTarget(),i=!1,a=this.passes.length;for(n=0;n<a;n++)if(!1!==(e=this.passes[n]).enabled){if(e.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(n),e.render(this.renderer,this.writeBuffer,this.readBuffer,t,i),e.needsSwap){if(i){var o=this.renderer.getContext(),c=this.renderer.state.buffers.stencil;c.setFunc(o.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,t),c.setFunc(o.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==s&&(e instanceof s?i=!0:e instanceof u&&(i=!1))}this.renderer.setRenderTarget(r)},reset:function(t){if(void 0===t){var e=this.renderer.getSize(new r.s);this._pixelRatio=this.renderer.getPixelRatio(),this._width=e.width,this._height=e.height,(t=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=t,this.renderTarget2=t.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(t,e){this._width=t,this._height=e;var n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(n,r),this.renderTarget2.setSize(n,r);for(var i=0;i<this.passes.length;i++)this.passes[i].setSize(n,r)},setPixelRatio:function(t){this._pixelRatio=t,this.setSize(this._width,this._height)}});var l,h,p,f=function(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1};Object.assign(f.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),f.FullScreenQuad=(l=new r.j(-1,1,1,-1,0,1),h=new r.m(2,2),p=function(t){this._mesh=new r.i(h,t)},Object.defineProperty(p.prototype,"material",{get:function(){return this._mesh.material},set:function(t){this._mesh.material=t}}),Object.assign(p.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(t){t.render(this._mesh,l)}}),p)},function(t,e,n){n(147),t.exports=n(333)},function(t,e,n){"use strict";n(148);var r,i=(r=n(320))&&r.__esModule?r:{default:r};i.default._babelPolyfill&&"undefined"!=typeof console&&console.warn&&console.warn("@babel/polyfill is loaded more than once on this page. This is probably not desirable/intended and may have consequences if different versions of the polyfills are applied sequentially. If you do need to load the polyfill more than once, use @babel/polyfill/noConflict instead to bypass the warning."),i.default._babelPolyfill=!0},function(t,e,n){"use strict";n(149),n(292),n(294),n(297),n(299),n(301),n(303),n(305),n(307),n(309),n(311),n(313),n(315),n(319)},function(t,e,n){n(150),n(153),n(154),n(155),n(156),n(157),n(158),n(159),n(160),n(161),n(162),n(163),n(164),n(165),n(166),n(167),n(168),n(169),n(170),n(171),n(172),n(173),n(174),n(175),n(176),n(177),n(178),n(179),n(180),n(181),n(182),n(183),n(184),n(185),n(186),n(187),n(188),n(189),n(190),n(191),n(192),n(193),n(194),n(196),n(197),n(198),n(199),n(200),n(201),n(202),n(203),n(204),n(205),n(206),n(207),n(208),n(209),n(210),n(211),n(212),n(213),n(214),n(215),n(216),n(217),n(218),n(219),n(220),n(221),n(222),n(223),n(224),n(225),n(226),n(227),n(228),n(229),n(231),n(232),n(234),n(235),n(236),n(237),n(238),n(239),n(240),n(242),n(243),n(244),n(245),n(246),n(247),n(248),n(249),n(250),n(251),n(252),n(253),n(254),n(86),n(255),n(118),n(256),n(119),n(257),n(258),n(259),n(260),n(120),n(263),n(264),n(265),n(266),n(267),n(268),n(269),n(270),n(271),n(272),n(273),n(274),n(275),n(276),n(277),n(278),n(279),n(280),n(281),n(282),n(283),n(284),n(285),n(286),n(287),n(288),n(289),n(290),n(291),t.exports=n(9)},function(t,e,n){"use strict";var r=n(3),i=n(15),a=n(10),o=n(1),s=n(13),u=n(31).KEY,c=n(4),l=n(54),h=n(42),p=n(33),f=n(7),d=n(67),m=n(99),v=n(152),g=n(57),y=n(5),x=n(6),b=n(12),w=n(17),_=n(30),S=n(32),M=n(37),E=n(102),T=n(23),C=n(56),A=n(11),N=n(35),I=T.f,R=A.f,O=E.f,k=r.Symbol,L=r.JSON,D=L&&L.stringify,P=f("_hidden"),F=f("toPrimitive"),B={}.propertyIsEnumerable,z=l("symbol-registry"),U=l("symbols"),j=l("op-symbols"),W=Object.prototype,V="function"==typeof k&&!!C.f,H=r.QObject,G=!H||!H.prototype||!H.prototype.findChild,q=a&&c((function(){return 7!=M(R({},"a",{get:function(){return R(this,"a",{value:7}).a}})).a}))?function(t,e,n){var r=I(W,e);r&&delete W[e],R(t,e,n),r&&t!==W&&R(W,e,r)}:R,X=function(t){var e=U[t]=M(k.prototype);return e._k=t,e},$=V&&"symbol"==typeof k.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof k},Y=function(t,e,n){return t===W&&Y(j,e,n),y(t),e=_(e,!0),y(n),i(U,e)?(n.enumerable?(i(t,P)&&t[P][e]&&(t[P][e]=!1),n=M(n,{enumerable:S(0,!1)})):(i(t,P)||R(t,P,S(1,{})),t[P][e]=!0),q(t,e,n)):R(t,e,n)},K=function(t,e){y(t);for(var n,r=v(e=w(e)),i=0,a=r.length;a>i;)Y(t,n=r[i++],e[n]);return t},J=function(t){var e=B.call(this,t=_(t,!0));return!(this===W&&i(U,t)&&!i(j,t))&&(!(e||!i(this,t)||!i(U,t)||i(this,P)&&this[P][t])||e)},Z=function(t,e){if(t=w(t),e=_(e,!0),t!==W||!i(U,e)||i(j,e)){var n=I(t,e);return!n||!i(U,e)||i(t,P)&&t[P][e]||(n.enumerable=!0),n}},Q=function(t){for(var e,n=O(w(t)),r=[],a=0;n.length>a;)i(U,e=n[a++])||e==P||e==u||r.push(e);return r},tt=function(t){for(var e,n=t===W,r=O(n?j:w(t)),a=[],o=0;r.length>o;)!i(U,e=r[o++])||n&&!i(W,e)||a.push(U[e]);return a};V||(s((k=function(){if(this instanceof k)throw TypeError("Symbol is not a constructor!");var t=p(arguments.length>0?arguments[0]:void 0),e=function(n){this===W&&e.call(j,n),i(this,P)&&i(this[P],t)&&(this[P][t]=!1),q(this,t,S(1,n))};return a&&G&&q(W,t,{configurable:!0,set:e}),X(t)}).prototype,"toString",(function(){return this._k})),T.f=Z,A.f=Y,n(38).f=E.f=Q,n(50).f=J,C.f=tt,a&&!n(34)&&s(W,"propertyIsEnumerable",J,!0),d.f=function(t){return X(f(t))}),o(o.G+o.W+o.F*!V,{Symbol:k});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;et.length>nt;)f(et[nt++]);for(var rt=N(f.store),it=0;rt.length>it;)m(rt[it++]);o(o.S+o.F*!V,"Symbol",{for:function(t){return i(z,t+="")?z[t]:z[t]=k(t)},keyFor:function(t){if(!$(t))throw TypeError(t+" is not a symbol!");for(var e in z)if(z[e]===t)return e},useSetter:function(){G=!0},useSimple:function(){G=!1}}),o(o.S+o.F*!V,"Object",{create:function(t,e){return void 0===e?M(t):K(M(t),e)},defineProperty:Y,defineProperties:K,getOwnPropertyDescriptor:Z,getOwnPropertyNames:Q,getOwnPropertySymbols:tt});var at=c((function(){C.f(1)}));o(o.S+o.F*at,"Object",{getOwnPropertySymbols:function(t){return C.f(b(t))}}),L&&o(o.S+o.F*(!V||c((function(){var t=k();return"[null]"!=D([t])||"{}"!=D({a:t})||"{}"!=D(Object(t))}))),"JSON",{stringify:function(t){for(var e,n,r=[t],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=e=r[1],(x(e)||void 0!==t)&&!$(t))return g(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!$(e))return e}),r[1]=e,D.apply(L,r)}}),k.prototype[F]||n(16)(k.prototype,F,k.prototype.valueOf),h(k,"Symbol"),h(Math,"Math",!0),h(r.JSON,"JSON",!0)},function(t,e,n){t.exports=n(54)("native-function-to-string",Function.toString)},function(t,e,n){var r=n(35),i=n(56),a=n(50);t.exports=function(t){var e=r(t),n=i.f;if(n)for(var o,s=n(t),u=a.f,c=0;s.length>c;)u.call(t,o=s[c++])&&e.push(o);return e}},function(t,e,n){var r=n(1);r(r.S,"Object",{create:n(37)})},function(t,e,n){var r=n(1);r(r.S+r.F*!n(10),"Object",{defineProperty:n(11).f})},function(t,e,n){var r=n(1);r(r.S+r.F*!n(10),"Object",{defineProperties:n(101)})},function(t,e,n){var r=n(17),i=n(23).f;n(24)("getOwnPropertyDescriptor",(function(){return function(t,e){return i(r(t),e)}}))},function(t,e,n){var r=n(12),i=n(39);n(24)("getPrototypeOf",(function(){return function(t){return i(r(t))}}))},function(t,e,n){var r=n(12),i=n(35);n(24)("keys",(function(){return function(t){return i(r(t))}}))},function(t,e,n){n(24)("getOwnPropertyNames",(function(){return n(102).f}))},function(t,e,n){var r=n(6),i=n(31).onFreeze;n(24)("freeze",(function(t){return function(e){return t&&r(e)?t(i(e)):e}}))},function(t,e,n){var r=n(6),i=n(31).onFreeze;n(24)("seal",(function(t){return function(e){return t&&r(e)?t(i(e)):e}}))},function(t,e,n){var r=n(6),i=n(31).onFreeze;n(24)("preventExtensions",(function(t){return function(e){return t&&r(e)?t(i(e)):e}}))},function(t,e,n){var r=n(6);n(24)("isFrozen",(function(t){return function(e){return!r(e)||!!t&&t(e)}}))},function(t,e,n){var r=n(6);n(24)("isSealed",(function(t){return function(e){return!r(e)||!!t&&t(e)}}))},function(t,e,n){var r=n(6);n(24)("isExtensible",(function(t){return function(e){return!!r(e)&&(!t||t(e))}}))},function(t,e,n){var r=n(1);r(r.S+r.F,"Object",{assign:n(103)})},function(t,e,n){var r=n(1);r(r.S,"Object",{is:n(104)})},function(t,e,n){var r=n(1);r(r.S,"Object",{setPrototypeOf:n(71).set})},function(t,e,n){"use strict";var r=n(51),i={};i[n(7)("toStringTag")]="z",i+""!="[object z]"&&n(13)(Object.prototype,"toString",(function(){return"[object "+r(this)+"]"}),!0)},function(t,e,n){var r=n(1);r(r.P,"Function",{bind:n(105)})},function(t,e,n){var r=n(11).f,i=Function.prototype,a=/^\s*function ([^ (]*)/;"name"in i||n(10)&&r(i,"name",{configurable:!0,get:function(){try{return(""+this).match(a)[1]}catch(t){return""}}})},function(t,e,n){"use strict";var r=n(6),i=n(39),a=n(7)("hasInstance"),o=Function.prototype;a in o||n(11).f(o,a,{value:function(t){if("function"!=typeof this||!r(t))return!1;if(!r(this.prototype))return t instanceof this;for(;t=i(t);)if(this.prototype===t)return!0;return!1}})},function(t,e,n){var r=n(1),i=n(107);r(r.G+r.F*(parseInt!=i),{parseInt:i})},function(t,e,n){var r=n(1),i=n(108);r(r.G+r.F*(parseFloat!=i),{parseFloat:i})},function(t,e,n){"use strict";var r=n(3),i=n(15),a=n(27),o=n(73),s=n(30),u=n(4),c=n(38).f,l=n(23).f,h=n(11).f,p=n(43).trim,f=r.Number,d=f,m=f.prototype,v="Number"==a(n(37)(m)),g="trim"in String.prototype,y=function(t){var e=s(t,!1);if("string"==typeof e&&e.length>2){var n,r,i,a=(e=g?e.trim():p(e,3)).charCodeAt(0);if(43===a||45===a){if(88===(n=e.charCodeAt(2))||120===n)return NaN}else if(48===a){switch(e.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+e}for(var o,u=e.slice(2),c=0,l=u.length;c<l;c++)if((o=u.charCodeAt(c))<48||o>i)return NaN;return parseInt(u,r)}}return+e};if(!f(" 0o1")||!f("0b1")||f("+0x1")){f=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof f&&(v?u((function(){m.valueOf.call(n)})):"Number"!=a(n))?o(new d(y(e)),n,f):y(e)};for(var x,b=n(10)?c(d):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),w=0;b.length>w;w++)i(d,x=b[w])&&!i(f,x)&&h(f,x,l(d,x));f.prototype=m,m.constructor=f,n(13)(r,"Number",f)}},function(t,e,n){"use strict";var r=n(1),i=n(22),a=n(109),o=n(74),s=1..toFixed,u=Math.floor,c=[0,0,0,0,0,0],l="Number.toFixed: incorrect invocation!",h=function(t,e){for(var n=-1,r=e;++n<6;)r+=t*c[n],c[n]=r%1e7,r=u(r/1e7)},p=function(t){for(var e=6,n=0;--e>=0;)n+=c[e],c[e]=u(n/t),n=n%t*1e7},f=function(){for(var t=6,e="";--t>=0;)if(""!==e||0===t||0!==c[t]){var n=String(c[t]);e=""===e?n:e+o.call("0",7-n.length)+n}return e},d=function(t,e,n){return 0===e?n:e%2==1?d(t,e-1,n*t):d(t*t,e/2,n)};r(r.P+r.F*(!!s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(4)((function(){s.call({})}))),"Number",{toFixed:function(t){var e,n,r,s,u=a(this,l),c=i(t),m="",v="0";if(c<0||c>20)throw RangeError(l);if(u!=u)return"NaN";if(u<=-1e21||u>=1e21)return String(u);if(u<0&&(m="-",u=-u),u>1e-21)if(n=(e=function(t){for(var e=0,n=t;n>=4096;)e+=12,n/=4096;for(;n>=2;)e+=1,n/=2;return e}(u*d(2,69,1))-69)<0?u*d(2,-e,1):u/d(2,e,1),n*=4503599627370496,(e=52-e)>0){for(h(0,n),r=c;r>=7;)h(1e7,0),r-=7;for(h(d(10,r,1),0),r=e-1;r>=23;)p(1<<23),r-=23;p(1<<r),h(1,1),p(2),v=f()}else h(0,n),h(1<<-e,0),v=f()+o.call("0",c);return v=c>0?m+((s=v.length)<=c?"0."+o.call("0",c-s)+v:v.slice(0,s-c)+"."+v.slice(s-c)):m+v}})},function(t,e,n){"use strict";var r=n(1),i=n(4),a=n(109),o=1..toPrecision;r(r.P+r.F*(i((function(){return"1"!==o.call(1,void 0)}))||!i((function(){o.call({})}))),"Number",{toPrecision:function(t){var e=a(this,"Number#toPrecision: incorrect invocation!");return void 0===t?o.call(e):o.call(e,t)}})},function(t,e,n){var r=n(1);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,e,n){var r=n(1),i=n(3).isFinite;r(r.S,"Number",{isFinite:function(t){return"number"==typeof t&&i(t)}})},function(t,e,n){var r=n(1);r(r.S,"Number",{isInteger:n(110)})},function(t,e,n){var r=n(1);r(r.S,"Number",{isNaN:function(t){return t!=t}})},function(t,e,n){var r=n(1),i=n(110),a=Math.abs;r(r.S,"Number",{isSafeInteger:function(t){return i(t)&&a(t)<=9007199254740991}})},function(t,e,n){var r=n(1);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,e,n){var r=n(1);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,e,n){var r=n(1),i=n(108);r(r.S+r.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(t,e,n){var r=n(1),i=n(107);r(r.S+r.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(t,e,n){var r=n(1),i=n(111),a=Math.sqrt,o=Math.acosh;r(r.S+r.F*!(o&&710==Math.floor(o(Number.MAX_VALUE))&&o(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+a(t-1)*a(t+1))}})},function(t,e,n){var r=n(1),i=Math.asinh;r(r.S+r.F*!(i&&1/i(0)>0),"Math",{asinh:function t(e){return isFinite(e=+e)&&0!=e?e<0?-t(-e):Math.log(e+Math.sqrt(e*e+1)):e}})},function(t,e,n){var r=n(1),i=Math.atanh;r(r.S+r.F*!(i&&1/i(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,e,n){var r=n(1),i=n(75);r(r.S,"Math",{cbrt:function(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,e,n){var r=n(1);r(r.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,e,n){var r=n(1),i=Math.exp;r(r.S,"Math",{cosh:function(t){return(i(t=+t)+i(-t))/2}})},function(t,e,n){var r=n(1),i=n(76);r(r.S+r.F*(i!=Math.expm1),"Math",{expm1:i})},function(t,e,n){var r=n(1);r(r.S,"Math",{fround:n(195)})},function(t,e,n){var r=n(75),i=Math.pow,a=i(2,-52),o=i(2,-23),s=i(2,127)*(2-o),u=i(2,-126);t.exports=Math.fround||function(t){var e,n,i=Math.abs(t),c=r(t);return i<u?c*(i/u/o+1/a-1/a)*u*o:(n=(e=(1+o/a)*i)-(e-i))>s||n!=n?c*(1/0):c*n}},function(t,e,n){var r=n(1),i=Math.abs;r(r.S,"Math",{hypot:function(t,e){for(var n,r,a=0,o=0,s=arguments.length,u=0;o<s;)u<(n=i(arguments[o++]))?(a=a*(r=u/n)*r+1,u=n):a+=n>0?(r=n/u)*r:n;return u===1/0?1/0:u*Math.sqrt(a)}})},function(t,e,n){var r=n(1),i=Math.imul;r(r.S+r.F*n(4)((function(){return-5!=i(4294967295,5)||2!=i.length})),"Math",{imul:function(t,e){var n=+t,r=+e,i=65535&n,a=65535&r;return 0|i*a+((65535&n>>>16)*a+i*(65535&r>>>16)<<16>>>0)}})},function(t,e,n){var r=n(1);r(r.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},function(t,e,n){var r=n(1);r(r.S,"Math",{log1p:n(111)})},function(t,e,n){var r=n(1);r(r.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,e,n){var r=n(1);r(r.S,"Math",{sign:n(75)})},function(t,e,n){var r=n(1),i=n(76),a=Math.exp;r(r.S+r.F*n(4)((function(){return-2e-17!=!Math.sinh(-2e-17)})),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(a(t-1)-a(-t-1))*(Math.E/2)}})},function(t,e,n){var r=n(1),i=n(76),a=Math.exp;r(r.S,"Math",{tanh:function(t){var e=i(t=+t),n=i(-t);return e==1/0?1:n==1/0?-1:(e-n)/(a(t)+a(-t))}})},function(t,e,n){var r=n(1);r(r.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,e,n){var r=n(1),i=n(36),a=String.fromCharCode,o=String.fromCodePoint;r(r.S+r.F*(!!o&&1!=o.length),"String",{fromCodePoint:function(t){for(var e,n=[],r=arguments.length,o=0;r>o;){if(e=+arguments[o++],i(e,1114111)!==e)throw RangeError(e+" is not a valid code point");n.push(e<65536?a(e):a(55296+((e-=65536)>>10),e%1024+56320))}return n.join("")}})},function(t,e,n){var r=n(1),i=n(17),a=n(8);r(r.S,"String",{raw:function(t){for(var e=i(t.raw),n=a(e.length),r=arguments.length,o=[],s=0;n>s;)o.push(String(e[s++])),s<r&&o.push(String(arguments[s]));return o.join("")}})},function(t,e,n){"use strict";n(43)("trim",(function(t){return function(){return t(this,3)}}))},function(t,e,n){"use strict";var r=n(77)(!0);n(78)(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})}))},function(t,e,n){"use strict";var r=n(1),i=n(77)(!1);r(r.P,"String",{codePointAt:function(t){return i(this,t)}})},function(t,e,n){"use strict";var r=n(1),i=n(8),a=n(79),o="".endsWith;r(r.P+r.F*n(81)("endsWith"),"String",{endsWith:function(t){var e=a(this,t,"endsWith"),n=arguments.length>1?arguments[1]:void 0,r=i(e.length),s=void 0===n?r:Math.min(i(n),r),u=String(t);return o?o.call(e,u,s):e.slice(s-u.length,s)===u}})},function(t,e,n){"use strict";var r=n(1),i=n(79);r(r.P+r.F*n(81)("includes"),"String",{includes:function(t){return!!~i(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){var r=n(1);r(r.P,"String",{repeat:n(74)})},function(t,e,n){"use strict";var r=n(1),i=n(8),a=n(79),o="".startsWith;r(r.P+r.F*n(81)("startsWith"),"String",{startsWith:function(t){var e=a(this,t,"startsWith"),n=i(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),r=String(t);return o?o.call(e,r,n):e.slice(n,n+r.length)===r}})},function(t,e,n){"use strict";n(14)("anchor",(function(t){return function(e){return t(this,"a","name",e)}}))},function(t,e,n){"use strict";n(14)("big",(function(t){return function(){return t(this,"big","","")}}))},function(t,e,n){"use strict";n(14)("blink",(function(t){return function(){return t(this,"blink","","")}}))},function(t,e,n){"use strict";n(14)("bold",(function(t){return function(){return t(this,"b","","")}}))},function(t,e,n){"use strict";n(14)("fixed",(function(t){return function(){return t(this,"tt","","")}}))},function(t,e,n){"use strict";n(14)("fontcolor",(function(t){return function(e){return t(this,"font","color",e)}}))},function(t,e,n){"use strict";n(14)("fontsize",(function(t){return function(e){return t(this,"font","size",e)}}))},function(t,e,n){"use strict";n(14)("italics",(function(t){return function(){return t(this,"i","","")}}))},function(t,e,n){"use strict";n(14)("link",(function(t){return function(e){return t(this,"a","href",e)}}))},function(t,e,n){"use strict";n(14)("small",(function(t){return function(){return t(this,"small","","")}}))},function(t,e,n){"use strict";n(14)("strike",(function(t){return function(){return t(this,"strike","","")}}))},function(t,e,n){"use strict";n(14)("sub",(function(t){return function(){return t(this,"sub","","")}}))},function(t,e,n){"use strict";n(14)("sup",(function(t){return function(){return t(this,"sup","","")}}))},function(t,e,n){var r=n(1);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,e,n){"use strict";var r=n(1),i=n(12),a=n(30);r(r.P+r.F*n(4)((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})})),"Date",{toJSON:function(t){var e=i(this),n=a(e);return"number"!=typeof n||isFinite(n)?e.toISOString():null}})},function(t,e,n){var r=n(1),i=n(230);r(r.P+r.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},function(t,e,n){"use strict";var r=n(4),i=Date.prototype.getTime,a=Date.prototype.toISOString,o=function(t){return t>9?t:"0"+t};t.exports=r((function(){return"0385-07-25T07:06:39.999Z"!=a.call(new Date(-50000000000001))}))||!r((function(){a.call(new Date(NaN))}))?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var t=this,e=t.getUTCFullYear(),n=t.getUTCMilliseconds(),r=e<0?"-":e>9999?"+":"";return r+("00000"+Math.abs(e)).slice(r?-6:-4)+"-"+o(t.getUTCMonth()+1)+"-"+o(t.getUTCDate())+"T"+o(t.getUTCHours())+":"+o(t.getUTCMinutes())+":"+o(t.getUTCSeconds())+"."+(n>99?n:"0"+o(n))+"Z"}:a},function(t,e,n){var r=Date.prototype,i=r.toString,a=r.getTime;new Date(NaN)+""!="Invalid Date"&&n(13)(r,"toString",(function(){var t=a.call(this);return t==t?i.call(this):"Invalid Date"}))},function(t,e,n){var r=n(7)("toPrimitive"),i=Date.prototype;r in i||n(16)(i,r,n(233))},function(t,e,n){"use strict";var r=n(5),i=n(30);t.exports=function(t){if("string"!==t&&"number"!==t&&"default"!==t)throw TypeError("Incorrect hint");return i(r(this),"number"!=t)}},function(t,e,n){var r=n(1);r(r.S,"Array",{isArray:n(57)})},function(t,e,n){"use strict";var r=n(20),i=n(1),a=n(12),o=n(113),s=n(82),u=n(8),c=n(83),l=n(84);i(i.S+i.F*!n(58)((function(t){Array.from(t)})),"Array",{from:function(t){var e,n,i,h,p=a(t),f="function"==typeof this?this:Array,d=arguments.length,m=d>1?arguments[1]:void 0,v=void 0!==m,g=0,y=l(p);if(v&&(m=r(m,d>2?arguments[2]:void 0,2)),null==y||f==Array&&s(y))for(n=new f(e=u(p.length));e>g;g++)c(n,g,v?m(p[g],g):p[g]);else for(h=y.call(p),n=new f;!(i=h.next()).done;g++)c(n,g,v?o(h,m,[i.value,g],!0):i.value);return n.length=g,n}})},function(t,e,n){"use strict";var r=n(1),i=n(83);r(r.S+r.F*n(4)((function(){function t(){}return!(Array.of.call(t)instanceof t)})),"Array",{of:function(){for(var t=0,e=arguments.length,n=new("function"==typeof this?this:Array)(e);e>t;)i(n,t,arguments[t++]);return n.length=e,n}})},function(t,e,n){"use strict";var r=n(1),i=n(17),a=[].join;r(r.P+r.F*(n(49)!=Object||!n(19)(a)),"Array",{join:function(t){return a.call(i(this),void 0===t?",":t)}})},function(t,e,n){"use strict";var r=n(1),i=n(70),a=n(27),o=n(36),s=n(8),u=[].slice;r(r.P+r.F*n(4)((function(){i&&u.call(i)})),"Array",{slice:function(t,e){var n=s(this.length),r=a(this);if(e=void 0===e?n:e,"Array"==r)return u.call(this,t,e);for(var i=o(t,n),c=o(e,n),l=s(c-i),h=new Array(l),p=0;p<l;p++)h[p]="String"==r?this.charAt(i+p):this[i+p];return h}})},function(t,e,n){"use strict";var r=n(1),i=n(21),a=n(12),o=n(4),s=[].sort,u=[1,2,3];r(r.P+r.F*(o((function(){u.sort(void 0)}))||!o((function(){u.sort(null)}))||!n(19)(s)),"Array",{sort:function(t){return void 0===t?s.call(a(this)):s.call(a(this),i(t))}})},function(t,e,n){"use strict";var r=n(1),i=n(25)(0),a=n(19)([].forEach,!0);r(r.P+r.F*!a,"Array",{forEach:function(t){return i(this,t,arguments[1])}})},function(t,e,n){var r=n(6),i=n(57),a=n(7)("species");t.exports=function(t){var e;return i(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!i(e.prototype)||(e=void 0),r(e)&&null===(e=e[a])&&(e=void 0)),void 0===e?Array:e}},function(t,e,n){"use strict";var r=n(1),i=n(25)(1);r(r.P+r.F*!n(19)([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(1),i=n(25)(2);r(r.P+r.F*!n(19)([].filter,!0),"Array",{filter:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(1),i=n(25)(3);r(r.P+r.F*!n(19)([].some,!0),"Array",{some:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(1),i=n(25)(4);r(r.P+r.F*!n(19)([].every,!0),"Array",{every:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(1),i=n(115);r(r.P+r.F*!n(19)([].reduce,!0),"Array",{reduce:function(t){return i(this,t,arguments.length,arguments[1],!1)}})},function(t,e,n){"use strict";var r=n(1),i=n(115);r(r.P+r.F*!n(19)([].reduceRight,!0),"Array",{reduceRight:function(t){return i(this,t,arguments.length,arguments[1],!0)}})},function(t,e,n){"use strict";var r=n(1),i=n(55)(!1),a=[].indexOf,o=!!a&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(o||!n(19)(a)),"Array",{indexOf:function(t){return o?a.apply(this,arguments)||0:i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(1),i=n(17),a=n(22),o=n(8),s=[].lastIndexOf,u=!!s&&1/[1].lastIndexOf(1,-0)<0;r(r.P+r.F*(u||!n(19)(s)),"Array",{lastIndexOf:function(t){if(u)return s.apply(this,arguments)||0;var e=i(this),n=o(e.length),r=n-1;for(arguments.length>1&&(r=Math.min(r,a(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in e&&e[r]===t)return r||0;return-1}})},function(t,e,n){var r=n(1);r(r.P,"Array",{copyWithin:n(116)}),n(40)("copyWithin")},function(t,e,n){var r=n(1);r(r.P,"Array",{fill:n(85)}),n(40)("fill")},function(t,e,n){"use strict";var r=n(1),i=n(25)(5),a=!0;"find"in[]&&Array(1).find((function(){a=!1})),r(r.P+r.F*a,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(40)("find")},function(t,e,n){"use strict";var r=n(1),i=n(25)(6),a="findIndex",o=!0;a in[]&&Array(1)[a]((function(){o=!1})),r(r.P+r.F*o,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(40)(a)},function(t,e,n){n(45)("Array")},function(t,e,n){var r=n(3),i=n(73),a=n(11).f,o=n(38).f,s=n(80),u=n(59),c=r.RegExp,l=c,h=c.prototype,p=/a/g,f=/a/g,d=new c(p)!==p;if(n(10)&&(!d||n(4)((function(){return f[n(7)("match")]=!1,c(p)!=p||c(f)==f||"/a/i"!=c(p,"i")})))){c=function(t,e){var n=this instanceof c,r=s(t),a=void 0===e;return!n&&r&&t.constructor===c&&a?t:i(d?new l(r&&!a?t.source:t,e):l((r=t instanceof c)?t.source:t,r&&a?u.call(t):e),n?this:h,c)};for(var m=function(t){t in c||a(c,t,{configurable:!0,get:function(){return l[t]},set:function(e){l[t]=e}})},v=o(l),g=0;v.length>g;)m(v[g++]);h.constructor=c,c.prototype=h,n(13)(r,"RegExp",c)}n(45)("RegExp")},function(t,e,n){"use strict";n(119);var r=n(5),i=n(59),a=n(10),o=/./.toString,s=function(t){n(13)(RegExp.prototype,"toString",t,!0)};n(4)((function(){return"/a/b"!=o.call({source:"a",flags:"b"})}))?s((function(){var t=r(this);return"/".concat(t.source,"/","flags"in t?t.flags:!a&&t instanceof RegExp?i.call(t):void 0)})):"toString"!=o.name&&s((function(){return o.call(this)}))},function(t,e,n){"use strict";var r=n(5),i=n(8),a=n(88),o=n(60);n(61)("match",1,(function(t,e,n,s){return[function(n){var r=t(this),i=null==n?void 0:n[e];return void 0!==i?i.call(n,r):new RegExp(n)[e](String(r))},function(t){var e=s(n,t,this);if(e.done)return e.value;var u=r(t),c=String(this);if(!u.global)return o(u,c);var l=u.unicode;u.lastIndex=0;for(var h,p=[],f=0;null!==(h=o(u,c));){var d=String(h[0]);p[f]=d,""===d&&(u.lastIndex=a(c,i(u.lastIndex),l)),f++}return 0===f?null:p}]}))},function(t,e,n){"use strict";var r=n(5),i=n(12),a=n(8),o=n(22),s=n(88),u=n(60),c=Math.max,l=Math.min,h=Math.floor,p=/\$([$&`']|\d\d?|<[^>]*>)/g,f=/\$([$&`']|\d\d?)/g;n(61)("replace",2,(function(t,e,n,d){return[function(r,i){var a=t(this),o=null==r?void 0:r[e];return void 0!==o?o.call(r,a,i):n.call(String(a),r,i)},function(t,e){var i=d(n,t,this,e);if(i.done)return i.value;var h=r(t),p=String(this),f="function"==typeof e;f||(e=String(e));var v=h.global;if(v){var g=h.unicode;h.lastIndex=0}for(var y=[];;){var x=u(h,p);if(null===x)break;if(y.push(x),!v)break;""===String(x[0])&&(h.lastIndex=s(p,a(h.lastIndex),g))}for(var b,w="",_=0,S=0;S<y.length;S++){x=y[S];for(var M=String(x[0]),E=c(l(o(x.index),p.length),0),T=[],C=1;C<x.length;C++)T.push(void 0===(b=x[C])?b:String(b));var A=x.groups;if(f){var N=[M].concat(T,E,p);void 0!==A&&N.push(A);var I=String(e.apply(void 0,N))}else I=m(M,p,E,T,A,e);E>=_&&(w+=p.slice(_,E)+I,_=E+M.length)}return w+p.slice(_)}];function m(t,e,r,a,o,s){var u=r+t.length,c=a.length,l=f;return void 0!==o&&(o=i(o),l=p),n.call(s,l,(function(n,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,r);case"'":return e.slice(u);case"<":s=o[i.slice(1,-1)];break;default:var l=+i;if(0===l)return n;if(l>c){var p=h(l/10);return 0===p?n:p<=c?void 0===a[p-1]?i.charAt(1):a[p-1]+i.charAt(1):n}s=a[l-1]}return void 0===s?"":s}))}}))},function(t,e,n){"use strict";var r=n(5),i=n(104),a=n(60);n(61)("search",1,(function(t,e,n,o){return[function(n){var r=t(this),i=null==n?void 0:n[e];return void 0!==i?i.call(n,r):new RegExp(n)[e](String(r))},function(t){var e=o(n,t,this);if(e.done)return e.value;var s=r(t),u=String(this),c=s.lastIndex;i(c,0)||(s.lastIndex=0);var l=a(s,u);return i(s.lastIndex,c)||(s.lastIndex=c),null===l?-1:l.index}]}))},function(t,e,n){"use strict";var r=n(80),i=n(5),a=n(52),o=n(88),s=n(8),u=n(60),c=n(87),l=n(4),h=Math.min,p=[].push,f="length",d=!l((function(){RegExp(4294967295,"y")}));n(61)("split",2,(function(t,e,n,l){var m;return m="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[f]||2!="ab".split(/(?:ab)*/)[f]||4!=".".split(/(.?)(.?)/)[f]||".".split(/()()/)[f]>1||"".split(/.?/)[f]?function(t,e){var i=String(this);if(void 0===t&&0===e)return[];if(!r(t))return n.call(i,t,e);for(var a,o,s,u=[],l=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),h=0,d=void 0===e?4294967295:e>>>0,m=new RegExp(t.source,l+"g");(a=c.call(m,i))&&!((o=m.lastIndex)>h&&(u.push(i.slice(h,a.index)),a[f]>1&&a.index<i[f]&&p.apply(u,a.slice(1)),s=a[0][f],h=o,u[f]>=d));)m.lastIndex===a.index&&m.lastIndex++;return h===i[f]?!s&&m.test("")||u.push(""):u.push(i.slice(h)),u[f]>d?u.slice(0,d):u}:"0".split(void 0,0)[f]?function(t,e){return void 0===t&&0===e?[]:n.call(this,t,e)}:n,[function(n,r){var i=t(this),a=null==n?void 0:n[e];return void 0!==a?a.call(n,i,r):m.call(String(i),n,r)},function(t,e){var r=l(m,t,this,e,m!==n);if(r.done)return r.value;var c=i(t),p=String(this),f=a(c,RegExp),v=c.unicode,g=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.unicode?"u":"")+(d?"y":"g"),y=new f(d?c:"^(?:"+c.source+")",g),x=void 0===e?4294967295:e>>>0;if(0===x)return[];if(0===p.length)return null===u(y,p)?[p]:[];for(var b=0,w=0,_=[];w<p.length;){y.lastIndex=d?w:0;var S,M=u(y,d?p:p.slice(w));if(null===M||(S=h(s(y.lastIndex+(d?0:w)),p.length))===b)w=o(p,w,v);else{if(_.push(p.slice(b,w)),_.length===x)return _;for(var E=1;E<=M.length-1;E++)if(_.push(M[E]),_.length===x)return _;w=b=S}}return _.push(p.slice(b)),_}]}))},function(t,e,n){var r=n(3),i=n(89).set,a=r.MutationObserver||r.WebKitMutationObserver,o=r.process,s=r.Promise,u="process"==n(27)(o);t.exports=function(){var t,e,n,c=function(){var r,i;for(u&&(r=o.domain)&&r.exit();t;){i=t.fn,t=t.next;try{i()}catch(r){throw t?n():e=void 0,r}}e=void 0,r&&r.enter()};if(u)n=function(){o.nextTick(c)};else if(!a||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var l=s.resolve(void 0);n=function(){l.then(c)}}else n=function(){i.call(r,c)};else{var h=!0,p=document.createTextNode("");new a(c).observe(p,{characterData:!0}),n=function(){p.data=h=!h}}return function(r){var i={fn:r,next:void 0};e&&(e.next=i),t||(t=i,n()),e=i}}},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,n){"use strict";var r=n(123),i=n(41);t.exports=n(64)("Map",(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(t){var e=r.getEntry(i(this,"Map"),t);return e&&e.v},set:function(t,e){return r.def(i(this,"Map"),0===t?0:t,e)}},r,!0)},function(t,e,n){"use strict";var r=n(123),i=n(41);t.exports=n(64)("Set",(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(t){return r.def(i(this,"Set"),t=0===t?0:t,t)}},r)},function(t,e,n){"use strict";var r,i=n(3),a=n(25)(0),o=n(13),s=n(31),u=n(103),c=n(124),l=n(6),h=n(41),p=n(41),f=!i.ActiveXObject&&"ActiveXObject"in i,d=s.getWeak,m=Object.isExtensible,v=c.ufstore,g=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},y={get:function(t){if(l(t)){var e=d(t);return!0===e?v(h(this,"WeakMap")).get(t):e?e[this._i]:void 0}},set:function(t,e){return c.def(h(this,"WeakMap"),t,e)}},x=t.exports=n(64)("WeakMap",g,y,c,!0,!0);p&&f&&(u((r=c.getConstructor(g,"WeakMap")).prototype,y),s.NEED=!0,a(["delete","has","get","set"],(function(t){var e=x.prototype,n=e[t];o(e,t,(function(e,i){if(l(e)&&!m(e)){this._f||(this._f=new r);var a=this._f[t](e,i);return"set"==t?this:a}return n.call(this,e,i)}))})))},function(t,e,n){"use strict";var r=n(124),i=n(41);n(64)("WeakSet",(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(t){return r.def(i(this,"WeakSet"),t,!0)}},r,!1,!0)},function(t,e,n){"use strict";var r=n(1),i=n(65),a=n(90),o=n(5),s=n(36),u=n(8),c=n(6),l=n(3).ArrayBuffer,h=n(52),p=a.ArrayBuffer,f=a.DataView,d=i.ABV&&l.isView,m=p.prototype.slice,v=i.VIEW;r(r.G+r.W+r.F*(l!==p),{ArrayBuffer:p}),r(r.S+r.F*!i.CONSTR,"ArrayBuffer",{isView:function(t){return d&&d(t)||c(t)&&v in t}}),r(r.P+r.U+r.F*n(4)((function(){return!new p(2).slice(1,void 0).byteLength})),"ArrayBuffer",{slice:function(t,e){if(void 0!==m&&void 0===e)return m.call(o(this),t);for(var n=o(this).byteLength,r=s(t,n),i=s(void 0===e?n:e,n),a=new(h(this,p))(u(i-r)),c=new f(this),l=new f(a),d=0;r<i;)l.setUint8(d++,c.getUint8(r++));return a}}),n(45)("ArrayBuffer")},function(t,e,n){var r=n(1);r(r.G+r.W+r.F*!n(65).ABV,{DataView:n(90).DataView})},function(t,e,n){n(29)("Int8",1,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},function(t,e,n){n(29)("Uint8",1,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},function(t,e,n){n(29)("Uint8",1,(function(t){return function(e,n,r){return t(this,e,n,r)}}),!0)},function(t,e,n){n(29)("Int16",2,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},function(t,e,n){n(29)("Uint16",2,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},function(t,e,n){n(29)("Int32",4,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},function(t,e,n){n(29)("Uint32",4,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},function(t,e,n){n(29)("Float32",4,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},function(t,e,n){n(29)("Float64",8,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},function(t,e,n){var r=n(1),i=n(21),a=n(5),o=(n(3).Reflect||{}).apply,s=Function.apply;r(r.S+r.F*!n(4)((function(){o((function(){}))})),"Reflect",{apply:function(t,e,n){var r=i(t),u=a(n);return o?o(r,e,u):s.call(r,e,u)}})},function(t,e,n){var r=n(1),i=n(37),a=n(21),o=n(5),s=n(6),u=n(4),c=n(105),l=(n(3).Reflect||{}).construct,h=u((function(){function t(){}return!(l((function(){}),[],t)instanceof t)})),p=!u((function(){l((function(){}))}));r(r.S+r.F*(h||p),"Reflect",{construct:function(t,e){a(t),o(e);var n=arguments.length<3?t:a(arguments[2]);if(p&&!h)return l(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var r=[null];return r.push.apply(r,e),new(c.apply(t,r))}var u=n.prototype,f=i(s(u)?u:Object.prototype),d=Function.apply.call(t,f,e);return s(d)?d:f}})},function(t,e,n){var r=n(11),i=n(1),a=n(5),o=n(30);i(i.S+i.F*n(4)((function(){Reflect.defineProperty(r.f({},1,{value:1}),1,{value:2})})),"Reflect",{defineProperty:function(t,e,n){a(t),e=o(e,!0),a(n);try{return r.f(t,e,n),!0}catch(t){return!1}}})},function(t,e,n){var r=n(1),i=n(23).f,a=n(5);r(r.S,"Reflect",{deleteProperty:function(t,e){var n=i(a(t),e);return!(n&&!n.configurable)&&delete t[e]}})},function(t,e,n){"use strict";var r=n(1),i=n(5),a=function(t){this._t=i(t),this._i=0;var e,n=this._k=[];for(e in t)n.push(e)};n(112)(a,"Object",(function(){var t,e=this._k;do{if(this._i>=e.length)return{value:void 0,done:!0}}while(!((t=e[this._i++])in this._t));return{value:t,done:!1}})),r(r.S,"Reflect",{enumerate:function(t){return new a(t)}})},function(t,e,n){var r=n(23),i=n(39),a=n(15),o=n(1),s=n(6),u=n(5);o(o.S,"Reflect",{get:function t(e,n){var o,c,l=arguments.length<3?e:arguments[2];return u(e)===l?e[n]:(o=r.f(e,n))?a(o,"value")?o.value:void 0!==o.get?o.get.call(l):void 0:s(c=i(e))?t(c,n,l):void 0}})},function(t,e,n){var r=n(23),i=n(1),a=n(5);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return r.f(a(t),e)}})},function(t,e,n){var r=n(1),i=n(39),a=n(5);r(r.S,"Reflect",{getPrototypeOf:function(t){return i(a(t))}})},function(t,e,n){var r=n(1);r(r.S,"Reflect",{has:function(t,e){return e in t}})},function(t,e,n){var r=n(1),i=n(5),a=Object.isExtensible;r(r.S,"Reflect",{isExtensible:function(t){return i(t),!a||a(t)}})},function(t,e,n){var r=n(1);r(r.S,"Reflect",{ownKeys:n(126)})},function(t,e,n){var r=n(1),i=n(5),a=Object.preventExtensions;r(r.S,"Reflect",{preventExtensions:function(t){i(t);try{return a&&a(t),!0}catch(t){return!1}}})},function(t,e,n){var r=n(11),i=n(23),a=n(39),o=n(15),s=n(1),u=n(32),c=n(5),l=n(6);s(s.S,"Reflect",{set:function t(e,n,s){var h,p,f=arguments.length<4?e:arguments[3],d=i.f(c(e),n);if(!d){if(l(p=a(e)))return t(p,n,s,f);d=u(0)}if(o(d,"value")){if(!1===d.writable||!l(f))return!1;if(h=i.f(f,n)){if(h.get||h.set||!1===h.writable)return!1;h.value=s,r.f(f,n,h)}else r.f(f,n,u(0,s));return!0}return void 0!==d.set&&(d.set.call(f,s),!0)}})},function(t,e,n){var r=n(1),i=n(71);i&&r(r.S,"Reflect",{setPrototypeOf:function(t,e){i.check(t,e);try{return i.set(t,e),!0}catch(t){return!1}}})},function(t,e,n){n(293),t.exports=n(9).Array.includes},function(t,e,n){"use strict";var r=n(1),i=n(55)(!0);r(r.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(40)("includes")},function(t,e,n){n(295),t.exports=n(9).Array.flatMap},function(t,e,n){"use strict";var r=n(1),i=n(296),a=n(12),o=n(8),s=n(21),u=n(114);r(r.P,"Array",{flatMap:function(t){var e,n,r=a(this);return s(t),e=o(r.length),n=u(r,0),i(n,r,r,e,0,1,t,arguments[1]),n}}),n(40)("flatMap")},function(t,e,n){"use strict";var r=n(57),i=n(6),a=n(8),o=n(20),s=n(7)("isConcatSpreadable");t.exports=function t(e,n,u,c,l,h,p,f){for(var d,m,v=l,g=0,y=!!p&&o(p,f,3);g<c;){if(g in u){if(d=y?y(u[g],g,n):u[g],m=!1,i(d)&&(m=void 0!==(m=d[s])?!!m:r(d)),m&&h>0)v=t(e,n,d,a(d.length),v,h-1)-1;else{if(v>=9007199254740991)throw TypeError();e[v]=d}v++}g++}return v}},function(t,e,n){n(298),t.exports=n(9).String.padStart},function(t,e,n){"use strict";var r=n(1),i=n(127),a=n(63),o=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(a);r(r.P+r.F*o,"String",{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,e,n){n(300),t.exports=n(9).String.padEnd},function(t,e,n){"use strict";var r=n(1),i=n(127),a=n(63),o=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(a);r(r.P+r.F*o,"String",{padEnd:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,e,n){n(302),t.exports=n(9).String.trimLeft},function(t,e,n){"use strict";n(43)("trimLeft",(function(t){return function(){return t(this,1)}}),"trimStart")},function(t,e,n){n(304),t.exports=n(9).String.trimRight},function(t,e,n){"use strict";n(43)("trimRight",(function(t){return function(){return t(this,2)}}),"trimEnd")},function(t,e,n){n(306),t.exports=n(67).f("asyncIterator")},function(t,e,n){n(99)("asyncIterator")},function(t,e,n){n(308),t.exports=n(9).Object.getOwnPropertyDescriptors},function(t,e,n){var r=n(1),i=n(126),a=n(17),o=n(23),s=n(83);r(r.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n,r=a(t),u=o.f,c=i(r),l={},h=0;c.length>h;)void 0!==(n=u(r,e=c[h++]))&&s(l,e,n);return l}})},function(t,e,n){n(310),t.exports=n(9).Object.values},function(t,e,n){var r=n(1),i=n(128)(!1);r(r.S,"Object",{values:function(t){return i(t)}})},function(t,e,n){n(312),t.exports=n(9).Object.entries},function(t,e,n){var r=n(1),i=n(128)(!0);r(r.S,"Object",{entries:function(t){return i(t)}})},function(t,e,n){"use strict";n(120),n(314),t.exports=n(9).Promise.finally},function(t,e,n){"use strict";var r=n(1),i=n(9),a=n(3),o=n(52),s=n(122);r(r.P+r.R,"Promise",{finally:function(t){var e=o(this,i.Promise||a.Promise),n="function"==typeof t;return this.then(n?function(n){return s(e,t()).then((function(){return n}))}:t,n?function(n){return s(e,t()).then((function(){throw n}))}:t)}})},function(t,e,n){n(316),n(317),n(318),t.exports=n(9)},function(t,e,n){var r=n(3),i=n(1),a=n(63),o=[].slice,s=/MSIE .\./.test(a),u=function(t){return function(e,n){var r=arguments.length>2,i=!!r&&o.call(arguments,2);return t(r?function(){("function"==typeof e?e:Function(e)).apply(this,i)}:e,n)}};i(i.G+i.B+i.F*s,{setTimeout:u(r.setTimeout),setInterval:u(r.setInterval)})},function(t,e,n){var r=n(1),i=n(89);r(r.G+r.B,{setImmediate:i.set,clearImmediate:i.clear})},function(t,e,n){for(var r=n(86),i=n(35),a=n(13),o=n(3),s=n(16),u=n(44),c=n(7),l=c("iterator"),h=c("toStringTag"),p=u.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},d=i(f),m=0;m<d.length;m++){var v,g=d[m],y=f[g],x=o[g],b=x&&x.prototype;if(b&&(b[l]||s(b,l,p),b[h]||s(b,h,g),u[g]=p,y))for(v in r)b[v]||a(b,v,r[v],!0)}},function(t,e,n){var r=function(t){"use strict";var e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function s(t,e,n,r){var i=e&&e.prototype instanceof l?e:l,a=Object.create(i.prototype),o=new _(r||[]);return a._invoke=function(t,e,n){var r="suspendedStart";return function(i,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw a;return M()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var s=x(o,n);if(s){if(s===c)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=u(t,e,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===c)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}(t,n,o),a}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=s;var c={};function l(){}function h(){}function p(){}var f={};f[i]=function(){return this};var d=Object.getPrototypeOf,m=d&&d(d(S([])));m&&m!==e&&n.call(m,i)&&(f=m);var v=p.prototype=l.prototype=Object.create(f);function g(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function y(t,e){var r;this._invoke=function(i,a){function o(){return new e((function(r,o){!function r(i,a,o,s){var c=u(t[i],t,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,o,s)}),(function(t){r("throw",t,o,s)})):e.resolve(h).then((function(t){l.value=t,o(l)}),(function(t){return r("throw",t,o,s)}))}s(c.arg)}(i,a,r,o)}))}return r=r?r.then(o,o):o()}}function x(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,x(t,e),"throw"===e.method))return c;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var r=u(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,c;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,c):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,c)}function b(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function w(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(b,this),this.reset(!0)}function S(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,a=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:M}}function M(){return{value:void 0,done:!0}}return h.prototype=v.constructor=p,p.constructor=h,p[o]=h.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,o in t||(t[o]="GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},g(y.prototype),y.prototype[a]=function(){return this},t.AsyncIterator=y,t.async=function(e,n,r,i,a){void 0===a&&(a=Promise);var o=new y(s(e,n,r,i),a);return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},g(v),v[o]="Generator",v[i]=function(){return this},v.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=S,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return o.type="throw",o.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,c):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),c},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),w(n),c}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;w(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}},t}(t.exports);try{regeneratorRuntime=r}catch(t){Function("r","regeneratorRuntime = r")(r)}},function(t,e,n){n(321),t.exports=n(129).global},function(t,e,n){var r=n(322);r(r.G,{global:n(91)})},function(t,e,n){var r=n(91),i=n(129),a=n(323),o=n(325),s=n(332),u=function(t,e,n){var c,l,h,p=t&u.F,f=t&u.G,d=t&u.S,m=t&u.P,v=t&u.B,g=t&u.W,y=f?i:i[e]||(i[e]={}),x=y.prototype,b=f?r:d?r[e]:(r[e]||{}).prototype;for(c in f&&(n=e),n)(l=!p&&b&&void 0!==b[c])&&s(y,c)||(h=l?b[c]:n[c],y[c]=f&&"function"!=typeof b[c]?n[c]:v&&l?a(h,r):g&&b[c]==h?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(h):m&&"function"==typeof h?a(Function.call,h):h,m&&((y.virtual||(y.virtual={}))[c]=h,t&u.R&&x&&!x[c]&&o(x,c,h)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,t.exports=u},function(t,e,n){var r=n(324);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var r=n(326),i=n(331);t.exports=n(93)?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var r=n(327),i=n(328),a=n(330),o=Object.defineProperty;e.f=n(93)?Object.defineProperty:function(t,e,n){if(r(t),e=a(e,!0),r(n),i)try{return o(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var r=n(92);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){t.exports=!n(93)&&!n(130)((function(){return 7!=Object.defineProperty(n(329)("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var r=n(92),i=n(91).document,a=r(i)&&r(i.createElement);t.exports=function(t){return a?i.createElement(t):{}}},function(t,e,n){var r=n(92);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){"use strict";n.r(e);n(334),n(335),n(339),n(343),n(344),n(345),n(352),n(353)},function(t,e,n){},function(t,e,n){"use strict";(function(t){var e=n(95),r=n.n(e);n(336),n(337),n(338);t.codebox=document.getElementById("code-box"),t.editor=r.a.fromTextArea(codebox,{mode:{name:"javascript",globalVars:!0},lineNumbers:!0,smartIndent:!1,value:"",lineWrapping:!0,styleSelectedText:!0,styleActiveSelected:!0,styleActiveLine:{nonEmpty:!0},extraKeys:{"Shift-Ctrl-Enter":t=>{let e=t.getValue("");replEval(e)},"Ctrl-Enter":t=>{let{text:e}=function(t){var e=t.getCursor(),n=e.line,r=e.line;for(;n>0&&""!==t.getLine(n);)n--;for(;r<t.lineCount()&&""!==t.getLine(r);)r++;var i={line:n,ch:0},a={line:r,ch:0},o=t.getRange(i,a);return{start:i,end:a,text:o}}(t);replEval(e)}}}),t.replEval=t=>{let e=t,n=!1;try{e=window.eval(t),e=JSON.stringify(e)}catch(t){e=t,n=!0,console.error(t)}finally{!function(t,e=!1){document.getElementById("repl").innerText=t,document.getElementById("repl").style.color=e?"tomato":"#fff"}(e,n),console.log("replMsg:",e)}}}).call(this,n(26))},function(t,e,n){!function(t){"use strict";t.defineMode("javascript",(function(e,n){var r,i,a=e.indentUnit,o=n.statementIndent,s=n.jsonld,u=n.json||s,c=n.typescript,l=n.wordCharacters||/[\w$\xa1-\uffff]/,h=function(){function t(t){return{type:t,style:"keyword"}}var e=t("keyword a"),n=t("keyword b"),r=t("keyword c"),i=t("keyword d"),a=t("operator"),o={type:"atom",style:"atom"};return{if:t("if"),while:e,with:e,else:n,do:n,try:n,finally:n,return:i,break:i,continue:i,new:t("new"),delete:r,void:r,throw:r,debugger:t("debugger"),var:t("var"),const:t("var"),let:t("var"),function:t("function"),catch:t("catch"),for:t("for"),switch:t("switch"),case:t("case"),default:t("default"),in:a,typeof:a,instanceof:a,true:o,false:o,null:o,undefined:o,NaN:o,Infinity:o,this:t("this"),class:t("class"),super:t("atom"),yield:r,export:t("export"),import:t("import"),extends:r,await:r}}(),p=/[+\-*&%=<>!?|~^@]/,f=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/;function d(t,e,n){return r=t,i=n,e}function m(t,e){var n,r=t.next();if('"'==r||"'"==r)return e.tokenize=(n=r,function(t,e){var r,i=!1;if(s&&"@"==t.peek()&&t.match(f))return e.tokenize=m,d("jsonld-keyword","meta");for(;null!=(r=t.next())&&(r!=n||i);)i=!i&&"\\"==r;return i||(e.tokenize=m),d("string","string")}),e.tokenize(t,e);if("."==r&&t.match(/^\d[\d_]*(?:[eE][+\-]?[\d_]+)?/))return d("number","number");if("."==r&&t.match(".."))return d("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(r))return d(r);if("="==r&&t.eat(">"))return d("=>","operator");if("0"==r&&t.match(/^(?:x[\dA-Fa-f_]+|o[0-7_]+|b[01_]+)n?/))return d("number","number");if(/\d/.test(r))return t.match(/^[\d_]*(?:n|(?:\.[\d_]*)?(?:[eE][+\-]?[\d_]+)?)?/),d("number","number");if("/"==r)return t.eat("*")?(e.tokenize=v,v(t,e)):t.eat("/")?(t.skipToEnd(),d("comment","comment")):Xt(t,e,1)?(function(t){for(var e,n=!1,r=!1;null!=(e=t.next());){if(!n){if("/"==e&&!r)return;"["==e?r=!0:r&&"]"==e&&(r=!1)}n=!n&&"\\"==e}}(t),t.match(/^\b(([gimyus])(?![gimyus]*\2))+\b/),d("regexp","string-2")):(t.eat("="),d("operator","operator",t.current()));if("`"==r)return e.tokenize=g,g(t,e);if("#"==r)return t.skipToEnd(),d("error","error");if("<"==r&&t.match("!--")||"-"==r&&t.match("->"))return t.skipToEnd(),d("comment","comment");if(p.test(r))return">"==r&&e.lexical&&">"==e.lexical.type||(t.eat("=")?"!"!=r&&"="!=r||t.eat("="):/[<>*+\-]/.test(r)&&(t.eat(r),">"==r&&t.eat(r))),d("operator","operator",t.current());if(l.test(r)){t.eatWhile(l);var i=t.current();if("."!=e.lastType){if(h.propertyIsEnumerable(i)){var a=h[i];return d(a.type,a.style,i)}if("async"==i&&t.match(/^(\s|\/\*.*?\*\/)*[\[\(\w]/,!1))return d("async","keyword",i)}return d("variable","variable",i)}}function v(t,e){for(var n,r=!1;n=t.next();){if("/"==n&&r){e.tokenize=m;break}r="*"==n}return d("comment","comment")}function g(t,e){for(var n,r=!1;null!=(n=t.next());){if(!r&&("`"==n||"$"==n&&t.eat("{"))){e.tokenize=m;break}r=!r&&"\\"==n}return d("quasi","string-2",t.current())}function y(t,e){e.fatArrowAt&&(e.fatArrowAt=null);var n=t.string.indexOf("=>",t.start);if(!(n<0)){if(c){var r=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(t.string.slice(t.start,n));r&&(n=r.index)}for(var i=0,a=!1,o=n-1;o>=0;--o){var s=t.string.charAt(o),u="([{}])".indexOf(s);if(u>=0&&u<3){if(!i){++o;break}if(0==--i){"("==s&&(a=!0);break}}else if(u>=3&&u<6)++i;else if(l.test(s))a=!0;else if(/["'\/`]/.test(s))for(;;--o){if(0==o)return;if(t.string.charAt(o-1)==s&&"\\"!=t.string.charAt(o-2)){o--;break}}else if(a&&!i){++o;break}}a&&!i&&(e.fatArrowAt=o)}}var x={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,"jsonld-keyword":!0};function b(t,e,n,r,i,a){this.indented=t,this.column=e,this.type=n,this.prev=i,this.info=a,null!=r&&(this.align=r)}function w(t,e){for(var n=t.localVars;n;n=n.next)if(n.name==e)return!0;for(var r=t.context;r;r=r.prev)for(n=r.vars;n;n=n.next)if(n.name==e)return!0}var _={state:null,column:null,marked:null,cc:null};function S(){for(var t=arguments.length-1;t>=0;t--)_.cc.push(arguments[t])}function M(){return S.apply(null,arguments),!0}function E(t,e){for(var n=e;n;n=n.next)if(n.name==t)return!0;return!1}function T(t){var e=_.state;if(_.marked="def",e.context)if("var"==e.lexical.info&&e.context&&e.context.block){var r=function t(e,n){if(n){if(n.block){var r=t(e,n.prev);return r?r==n.prev?n:new A(r,n.vars,!0):null}return E(e,n.vars)?n:new A(n.prev,new N(e,n.vars),!1)}return null}(t,e.context);if(null!=r)return void(e.context=r)}else if(!E(t,e.localVars))return void(e.localVars=new N(t,e.localVars));n.globalVars&&!E(t,e.globalVars)&&(e.globalVars=new N(t,e.globalVars))}function C(t){return"public"==t||"private"==t||"protected"==t||"abstract"==t||"readonly"==t}function A(t,e,n){this.prev=t,this.vars=e,this.block=n}function N(t,e){this.name=t,this.next=e}var I=new N("this",new N("arguments",null));function R(){_.state.context=new A(_.state.context,_.state.localVars,!1),_.state.localVars=I}function O(){_.state.context=new A(_.state.context,_.state.localVars,!0),_.state.localVars=null}function k(){_.state.localVars=_.state.context.vars,_.state.context=_.state.context.prev}function L(t,e){var n=function(){var n=_.state,r=n.indented;if("stat"==n.lexical.type)r=n.lexical.indented;else for(var i=n.lexical;i&&")"==i.type&&i.align;i=i.prev)r=i.indented;n.lexical=new b(r,_.stream.column(),t,null,n.lexical,e)};return n.lex=!0,n}function D(){var t=_.state;t.lexical.prev&&(")"==t.lexical.type&&(t.indented=t.lexical.indented),t.lexical=t.lexical.prev)}function P(t){return function e(n){return n==t?M():";"==t||"}"==n||")"==n||"]"==n?S():M(e)}}function F(t,e){return"var"==t?M(L("vardef",e),yt,P(";"),D):"keyword a"==t?M(L("form"),j,F,D):"keyword b"==t?M(L("form"),F,D):"keyword d"==t?_.stream.match(/^\s*$/,!1)?M():M(L("stat"),V,P(";"),D):"debugger"==t?M(P(";")):"{"==t?M(L("}"),O,at,D,k):";"==t?M():"if"==t?("else"==_.state.lexical.info&&_.state.cc[_.state.cc.length-1]==D&&_.state.cc.pop()(),M(L("form"),j,F,D,Mt)):"function"==t?M(At):"for"==t?M(L("form"),Et,F,D):"class"==t||c&&"interface"==e?(_.marked="keyword",M(L("form","class"==t?t:e),kt,D)):"variable"==t?c&&"declare"==e?(_.marked="keyword",M(F)):c&&("module"==e||"enum"==e||"type"==e)&&_.stream.match(/^\s*\w/,!1)?(_.marked="keyword","enum"==e?M(Gt):"type"==e?M(It,P("operator"),lt,P(";")):M(L("form"),xt,P("{"),L("}"),at,D,D)):c&&"namespace"==e?(_.marked="keyword",M(L("form"),z,F,D)):c&&"abstract"==e?(_.marked="keyword",M(F)):M(L("stat"),Z):"switch"==t?M(L("form"),j,P("{"),L("}","switch"),O,at,D,D,k):"case"==t?M(z,P(":")):"default"==t?M(P(":")):"catch"==t?M(L("form"),R,B,F,D,k):"export"==t?M(L("stat"),Ft,D):"import"==t?M(L("stat"),zt,D):"async"==t?M(F):"@"==e?M(z,F):S(L("stat"),z,P(";"),D)}function B(t){if("("==t)return M(Rt,P(")"))}function z(t,e){return W(t,e,!1)}function U(t,e){return W(t,e,!0)}function j(t){return"("!=t?S():M(L(")"),V,P(")"),D)}function W(t,e,n){if(_.state.fatArrowAt==_.stream.start){var r=n?Y:$;if("("==t)return M(R,L(")"),rt(Rt,")"),D,P("=>"),r,k);if("variable"==t)return S(R,xt,P("=>"),r,k)}var i=n?G:H;return x.hasOwnProperty(t)?M(i):"function"==t?M(At,i):"class"==t||c&&"interface"==e?(_.marked="keyword",M(L("form"),Ot,D)):"keyword c"==t||"async"==t?M(n?U:z):"("==t?M(L(")"),V,P(")"),D,i):"operator"==t||"spread"==t?M(n?U:z):"["==t?M(L("]"),Ht,D,i):"{"==t?it(tt,"}",null,i):"quasi"==t?S(q,i):"new"==t?M(function(t){return function(e){return"."==e?M(t?J:K):"variable"==e&&c?M(mt,t?G:H):S(t?U:z)}}(n)):"import"==t?M(z):M()}function V(t){return t.match(/[;\}\)\],]/)?S():S(z)}function H(t,e){return","==t?M(V):G(t,e,!1)}function G(t,e,n){var r=0==n?H:G,i=0==n?z:U;return"=>"==t?M(R,n?Y:$,k):"operator"==t?/\+\+|--/.test(e)||c&&"!"==e?M(r):c&&"<"==e&&_.stream.match(/^([^>]|<.*?>)*>\s*\(/,!1)?M(L(">"),rt(lt,">"),D,r):"?"==e?M(z,P(":"),i):M(i):"quasi"==t?S(q,r):";"!=t?"("==t?it(U,")","call",r):"."==t?M(Q,r):"["==t?M(L("]"),V,P("]"),D,r):c&&"as"==e?(_.marked="keyword",M(lt,r)):"regexp"==t?(_.state.lastType=_.marked="operator",_.stream.backUp(_.stream.pos-_.stream.start-1),M(i)):void 0:void 0}function q(t,e){return"quasi"!=t?S():"${"!=e.slice(e.length-2)?M(q):M(z,X)}function X(t){if("}"==t)return _.marked="string-2",_.state.tokenize=g,M(q)}function $(t){return y(_.stream,_.state),S("{"==t?F:z)}function Y(t){return y(_.stream,_.state),S("{"==t?F:U)}function K(t,e){if("target"==e)return _.marked="keyword",M(H)}function J(t,e){if("target"==e)return _.marked="keyword",M(G)}function Z(t){return":"==t?M(D,F):S(H,P(";"),D)}function Q(t){if("variable"==t)return _.marked="property",M()}function tt(t,e){return"async"==t?(_.marked="property",M(tt)):"variable"==t||"keyword"==_.style?(_.marked="property","get"==e||"set"==e?M(et):(c&&_.state.fatArrowAt==_.stream.start&&(n=_.stream.match(/^\s*:\s*/,!1))&&(_.state.fatArrowAt=_.stream.pos+n[0].length),M(nt))):"number"==t||"string"==t?(_.marked=s?"property":_.style+" property",M(nt)):"jsonld-keyword"==t?M(nt):c&&C(e)?(_.marked="keyword",M(tt)):"["==t?M(z,ot,P("]"),nt):"spread"==t?M(U,nt):"*"==e?(_.marked="keyword",M(tt)):":"==t?S(nt):void 0;var n}function et(t){return"variable"!=t?S(nt):(_.marked="property",M(At))}function nt(t){return":"==t?M(U):"("==t?S(At):void 0}function rt(t,e,n){function r(i,a){if(n?n.indexOf(i)>-1:","==i){var o=_.state.lexical;return"call"==o.info&&(o.pos=(o.pos||0)+1),M((function(n,r){return n==e||r==e?S():S(t)}),r)}return i==e||a==e?M():n&&n.indexOf(";")>-1?S(t):M(P(e))}return function(n,i){return n==e||i==e?M():S(t,r)}}function it(t,e,n){for(var r=3;r<arguments.length;r++)_.cc.push(arguments[r]);return M(L(e,n),rt(t,e),D)}function at(t){return"}"==t?M():S(F,at)}function ot(t,e){if(c){if(":"==t)return M(lt);if("?"==e)return M(ot)}}function st(t,e){if(c&&(":"==t||"in"==e))return M(lt)}function ut(t){if(c&&":"==t)return _.stream.match(/^\s*\w+\s+is\b/,!1)?M(z,ct,lt):M(lt)}function ct(t,e){if("is"==e)return _.marked="keyword",M()}function lt(t,e){return"keyof"==e||"typeof"==e||"infer"==e?(_.marked="keyword",M("typeof"==e?U:lt)):"variable"==t||"void"==e?(_.marked="type",M(dt)):"|"==e||"&"==e?M(lt):"string"==t||"number"==t||"atom"==t?M(dt):"["==t?M(L("]"),rt(lt,"]",","),D,dt):"{"==t?M(L("}"),rt(pt,"}",",;"),D,dt):"("==t?M(rt(ft,")"),ht,dt):"<"==t?M(rt(lt,">"),lt):void 0}function ht(t){if("=>"==t)return M(lt)}function pt(t,e){return"variable"==t||"keyword"==_.style?(_.marked="property",M(pt)):"?"==e||"number"==t||"string"==t?M(pt):":"==t?M(lt):"["==t?M(P("variable"),st,P("]"),pt):"("==t?S(Nt,pt):void 0}function ft(t,e){return"variable"==t&&_.stream.match(/^\s*[?:]/,!1)||"?"==e?M(ft):":"==t?M(lt):"spread"==t?M(ft):S(lt)}function dt(t,e){return"<"==e?M(L(">"),rt(lt,">"),D,dt):"|"==e||"."==t||"&"==e?M(lt):"["==t?M(lt,P("]"),dt):"extends"==e||"implements"==e?(_.marked="keyword",M(lt)):"?"==e?M(lt,P(":"),lt):void 0}function mt(t,e){if("<"==e)return M(L(">"),rt(lt,">"),D,dt)}function vt(){return S(lt,gt)}function gt(t,e){if("="==e)return M(lt)}function yt(t,e){return"enum"==e?(_.marked="keyword",M(Gt)):S(xt,ot,_t,St)}function xt(t,e){return c&&C(e)?(_.marked="keyword",M(xt)):"variable"==t?(T(e),M()):"spread"==t?M(xt):"["==t?it(wt,"]"):"{"==t?it(bt,"}"):void 0}function bt(t,e){return"variable"!=t||_.stream.match(/^\s*:/,!1)?("variable"==t&&(_.marked="property"),"spread"==t?M(xt):"}"==t?S():"["==t?M(z,P("]"),P(":"),bt):M(P(":"),xt,_t)):(T(e),M(_t))}function wt(){return S(xt,_t)}function _t(t,e){if("="==e)return M(U)}function St(t){if(","==t)return M(yt)}function Mt(t,e){if("keyword b"==t&&"else"==e)return M(L("form","else"),F,D)}function Et(t,e){return"await"==e?M(Et):"("==t?M(L(")"),Tt,D):void 0}function Tt(t){return"var"==t?M(yt,Ct):"variable"==t?M(Ct):S(Ct)}function Ct(t,e){return")"==t?M():";"==t?M(Ct):"in"==e||"of"==e?(_.marked="keyword",M(z,Ct)):S(z,Ct)}function At(t,e){return"*"==e?(_.marked="keyword",M(At)):"variable"==t?(T(e),M(At)):"("==t?M(R,L(")"),rt(Rt,")"),D,ut,F,k):c&&"<"==e?M(L(">"),rt(vt,">"),D,At):void 0}function Nt(t,e){return"*"==e?(_.marked="keyword",M(Nt)):"variable"==t?(T(e),M(Nt)):"("==t?M(R,L(")"),rt(Rt,")"),D,ut,k):c&&"<"==e?M(L(">"),rt(vt,">"),D,Nt):void 0}function It(t,e){return"keyword"==t||"variable"==t?(_.marked="type",M(It)):"<"==e?M(L(">"),rt(vt,">"),D):void 0}function Rt(t,e){return"@"==e&&M(z,Rt),"spread"==t?M(Rt):c&&C(e)?(_.marked="keyword",M(Rt)):c&&"this"==t?M(ot,_t):S(xt,ot,_t)}function Ot(t,e){return"variable"==t?kt(t,e):Lt(t,e)}function kt(t,e){if("variable"==t)return T(e),M(Lt)}function Lt(t,e){return"<"==e?M(L(">"),rt(vt,">"),D,Lt):"extends"==e||"implements"==e||c&&","==t?("implements"==e&&(_.marked="keyword"),M(c?lt:z,Lt)):"{"==t?M(L("}"),Dt,D):void 0}function Dt(t,e){return"async"==t||"variable"==t&&("static"==e||"get"==e||"set"==e||c&&C(e))&&_.stream.match(/^\s+[\w$\xa1-\uffff]/,!1)?(_.marked="keyword",M(Dt)):"variable"==t||"keyword"==_.style?(_.marked="property",M(c?Pt:At,Dt)):"number"==t||"string"==t?M(c?Pt:At,Dt):"["==t?M(z,ot,P("]"),c?Pt:At,Dt):"*"==e?(_.marked="keyword",M(Dt)):c&&"("==t?S(Nt,Dt):";"==t||","==t?M(Dt):"}"==t?M():"@"==e?M(z,Dt):void 0}function Pt(t,e){if("?"==e)return M(Pt);if(":"==t)return M(lt,_t);if("="==e)return M(U);var n=_.state.lexical.prev;return S(n&&"interface"==n.info?Nt:At)}function Ft(t,e){return"*"==e?(_.marked="keyword",M(Vt,P(";"))):"default"==e?(_.marked="keyword",M(z,P(";"))):"{"==t?M(rt(Bt,"}"),Vt,P(";")):S(F)}function Bt(t,e){return"as"==e?(_.marked="keyword",M(P("variable"))):"variable"==t?S(U,Bt):void 0}function zt(t){return"string"==t?M():"("==t?S(z):S(Ut,jt,Vt)}function Ut(t,e){return"{"==t?it(Ut,"}"):("variable"==t&&T(e),"*"==e&&(_.marked="keyword"),M(Wt))}function jt(t){if(","==t)return M(Ut,jt)}function Wt(t,e){if("as"==e)return _.marked="keyword",M(Ut)}function Vt(t,e){if("from"==e)return _.marked="keyword",M(z)}function Ht(t){return"]"==t?M():S(rt(U,"]"))}function Gt(){return S(L("form"),xt,P("{"),L("}"),rt(qt,"}"),D,D)}function qt(){return S(xt,_t)}function Xt(t,e,n){return e.tokenize==m&&/^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\[{}\(,;:]|=>)$/.test(e.lastType)||"quasi"==e.lastType&&/\{\s*$/.test(t.string.slice(0,t.pos-(n||0)))}return k.lex=!0,D.lex=!0,{startState:function(t){var e={tokenize:m,lastType:"sof",cc:[],lexical:new b((t||0)-a,0,"block",!1),localVars:n.localVars,context:n.localVars&&new A(null,null,!1),indented:t||0};return n.globalVars&&"object"==typeof n.globalVars&&(e.globalVars=n.globalVars),e},token:function(t,e){if(t.sol()&&(e.lexical.hasOwnProperty("align")||(e.lexical.align=!1),e.indented=t.indentation(),y(t,e)),e.tokenize!=v&&t.eatSpace())return null;var n=e.tokenize(t,e);return"comment"==r?n:(e.lastType="operator"!=r||"++"!=i&&"--"!=i?r:"incdec",function(t,e,n,r,i){var a=t.cc;for(_.state=t,_.stream=i,_.marked=null,_.cc=a,_.style=e,t.lexical.hasOwnProperty("align")||(t.lexical.align=!0);;)if((a.length?a.pop():u?z:F)(n,r)){for(;a.length&&a[a.length-1].lex;)a.pop()();return _.marked?_.marked:"variable"==n&&w(t,r)?"variable-2":e}}(e,n,r,i,t))},indent:function(e,r){if(e.tokenize==v)return t.Pass;if(e.tokenize!=m)return 0;var i,s=r&&r.charAt(0),u=e.lexical;if(!/^\s*else\b/.test(r))for(var c=e.cc.length-1;c>=0;--c){var l=e.cc[c];if(l==D)u=u.prev;else if(l!=Mt)break}for(;("stat"==u.type||"form"==u.type)&&("}"==s||(i=e.cc[e.cc.length-1])&&(i==H||i==G)&&!/^[,\.=+\-*:?[\(]/.test(r));)u=u.prev;o&&")"==u.type&&"stat"==u.prev.type&&(u=u.prev);var h=u.type,f=s==h;return"vardef"==h?u.indented+("operator"==e.lastType||","==e.lastType?u.info.length+1:0):"form"==h&&"{"==s?u.indented:"form"==h?u.indented+a:"stat"==h?u.indented+(function(t,e){return"operator"==t.lastType||","==t.lastType||p.test(e.charAt(0))||/[,.]/.test(e.charAt(0))}(e,r)?o||a:0):"switch"!=u.info||f||0==n.doubleIndentSwitch?u.align?u.column+(f?0:1):u.indented+(f?0:a):u.indented+(/^(?:case|default)\b/.test(r)?a:2*a)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:u?null:"/*",blockCommentEnd:u?null:"*/",blockCommentContinue:u?null:" * ",lineComment:u?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:u?"json":"javascript",jsonldMode:s,jsonMode:u,expressionAllowed:Xt,skipExpression:function(t){var e=t.cc[t.cc.length-1];e!=z&&e!=U||t.cc.pop()}}})),t.registerHelper("wordChars","javascript",/[\w$]/),t.defineMIME("text/javascript","javascript"),t.defineMIME("text/ecmascript","javascript"),t.defineMIME("application/javascript","javascript"),t.defineMIME("application/x-javascript","javascript"),t.defineMIME("application/ecmascript","javascript"),t.defineMIME("application/json",{name:"javascript",json:!0}),t.defineMIME("application/x-json",{name:"javascript",json:!0}),t.defineMIME("application/ld+json",{name:"javascript",jsonld:!0}),t.defineMIME("text/typescript",{name:"javascript",typescript:!0}),t.defineMIME("application/typescript",{name:"javascript",typescript:!0})}(n(95))},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";(function(t){n(340);var e=n(134),r=n.n(e);t.toolbar=new r.a({el:"#toolbar",data:{camera:{class:"red",text:"Camera Disabled"},model:{class:"red",text:"Loading Face Model..."},faceVisible:!1},methods:{replEval(){window.replEval()}}})}).call(this,n(26))},function(t,e,n){},function(t,e,n){"use strict";(function(e,n){
/*!
 * Vue.js v2.6.11
 * (c) 2014-2019 Evan You
 * Released under the MIT License.
 */
var r=Object.freeze({});function i(t){return null==t}function a(t){return null!=t}function o(t){return!0===t}function s(t){return"string"==typeof t||"number"==typeof t||"symbol"==typeof t||"boolean"==typeof t}function u(t){return null!==t&&"object"==typeof t}var c=Object.prototype.toString;function l(t){return"[object Object]"===c.call(t)}function h(t){var e=parseFloat(String(t));return e>=0&&Math.floor(e)===e&&isFinite(t)}function p(t){return a(t)&&"function"==typeof t.then&&"function"==typeof t.catch}function f(t){return null==t?"":Array.isArray(t)||l(t)&&t.toString===c?JSON.stringify(t,null,2):String(t)}function d(t){var e=parseFloat(t);return isNaN(e)?t:e}function m(t,e){for(var n=Object.create(null),r=t.split(","),i=0;i<r.length;i++)n[r[i]]=!0;return e?function(t){return n[t.toLowerCase()]}:function(t){return n[t]}}var v=m("slot,component",!0),g=m("key,ref,slot,slot-scope,is");function y(t,e){if(t.length){var n=t.indexOf(e);if(n>-1)return t.splice(n,1)}}var x=Object.prototype.hasOwnProperty;function b(t,e){return x.call(t,e)}function w(t){var e=Object.create(null);return function(n){return e[n]||(e[n]=t(n))}}var _=/-(\w)/g,S=w((function(t){return t.replace(_,(function(t,e){return e?e.toUpperCase():""}))})),M=w((function(t){return t.charAt(0).toUpperCase()+t.slice(1)})),E=/\B([A-Z])/g,T=w((function(t){return t.replace(E,"-$1").toLowerCase()})),C=Function.prototype.bind?function(t,e){return t.bind(e)}:function(t,e){function n(n){var r=arguments.length;return r?r>1?t.apply(e,arguments):t.call(e,n):t.call(e)}return n._length=t.length,n};function A(t,e){e=e||0;for(var n=t.length-e,r=new Array(n);n--;)r[n]=t[n+e];return r}function N(t,e){for(var n in e)t[n]=e[n];return t}function I(t){for(var e={},n=0;n<t.length;n++)t[n]&&N(e,t[n]);return e}function R(t,e,n){}var O=function(t,e,n){return!1},k=function(t){return t};function L(t,e){if(t===e)return!0;var n=u(t),r=u(e);if(!n||!r)return!n&&!r&&String(t)===String(e);try{var i=Array.isArray(t),a=Array.isArray(e);if(i&&a)return t.length===e.length&&t.every((function(t,n){return L(t,e[n])}));if(t instanceof Date&&e instanceof Date)return t.getTime()===e.getTime();if(i||a)return!1;var o=Object.keys(t),s=Object.keys(e);return o.length===s.length&&o.every((function(n){return L(t[n],e[n])}))}catch(t){return!1}}function D(t,e){for(var n=0;n<t.length;n++)if(L(t[n],e))return n;return-1}function P(t){var e=!1;return function(){e||(e=!0,t.apply(this,arguments))}}var F="data-server-rendered",B=["component","directive","filter"],z=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch"],U={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:O,isReservedAttr:O,isUnknownElement:O,getTagNamespace:R,parsePlatformTagName:k,mustUseProp:O,async:!0,_lifecycleHooks:z},j=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function W(t,e,n,r){Object.defineProperty(t,e,{value:n,enumerable:!!r,writable:!0,configurable:!0})}var V,H=new RegExp("[^"+j.source+".$_\\d]"),G="__proto__"in{},q="undefined"!=typeof window,X="undefined"!=typeof WXEnvironment&&!!WXEnvironment.platform,$=X&&WXEnvironment.platform.toLowerCase(),Y=q&&window.navigator.userAgent.toLowerCase(),K=Y&&/msie|trident/.test(Y),J=Y&&Y.indexOf("msie 9.0")>0,Z=Y&&Y.indexOf("edge/")>0,Q=(Y&&Y.indexOf("android"),Y&&/iphone|ipad|ipod|ios/.test(Y)||"ios"===$),tt=(Y&&/chrome\/\d+/.test(Y),Y&&/phantomjs/.test(Y),Y&&Y.match(/firefox\/(\d+)/)),et={}.watch,nt=!1;if(q)try{var rt={};Object.defineProperty(rt,"passive",{get:function(){nt=!0}}),window.addEventListener("test-passive",null,rt)}catch(r){}var it=function(){return void 0===V&&(V=!q&&!X&&void 0!==e&&e.process&&"server"===e.process.env.VUE_ENV),V},at=q&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function ot(t){return"function"==typeof t&&/native code/.test(t.toString())}var st,ut="undefined"!=typeof Symbol&&ot(Symbol)&&"undefined"!=typeof Reflect&&ot(Reflect.ownKeys);st="undefined"!=typeof Set&&ot(Set)?Set:function(){function t(){this.set=Object.create(null)}return t.prototype.has=function(t){return!0===this.set[t]},t.prototype.add=function(t){this.set[t]=!0},t.prototype.clear=function(){this.set=Object.create(null)},t}();var ct=R,lt=0,ht=function(){this.id=lt++,this.subs=[]};ht.prototype.addSub=function(t){this.subs.push(t)},ht.prototype.removeSub=function(t){y(this.subs,t)},ht.prototype.depend=function(){ht.target&&ht.target.addDep(this)},ht.prototype.notify=function(){for(var t=this.subs.slice(),e=0,n=t.length;e<n;e++)t[e].update()},ht.target=null;var pt=[];function ft(t){pt.push(t),ht.target=t}function dt(){pt.pop(),ht.target=pt[pt.length-1]}var mt=function(t,e,n,r,i,a,o,s){this.tag=t,this.data=e,this.children=n,this.text=r,this.elm=i,this.ns=void 0,this.context=a,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=e&&e.key,this.componentOptions=o,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=s,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1},vt={child:{configurable:!0}};vt.child.get=function(){return this.componentInstance},Object.defineProperties(mt.prototype,vt);var gt=function(t){void 0===t&&(t="");var e=new mt;return e.text=t,e.isComment=!0,e};function yt(t){return new mt(void 0,void 0,void 0,String(t))}function xt(t){var e=new mt(t.tag,t.data,t.children&&t.children.slice(),t.text,t.elm,t.context,t.componentOptions,t.asyncFactory);return e.ns=t.ns,e.isStatic=t.isStatic,e.key=t.key,e.isComment=t.isComment,e.fnContext=t.fnContext,e.fnOptions=t.fnOptions,e.fnScopeId=t.fnScopeId,e.asyncMeta=t.asyncMeta,e.isCloned=!0,e}var bt=Array.prototype,wt=Object.create(bt);["push","pop","shift","unshift","splice","sort","reverse"].forEach((function(t){var e=bt[t];W(wt,t,(function(){for(var n=[],r=arguments.length;r--;)n[r]=arguments[r];var i,a=e.apply(this,n),o=this.__ob__;switch(t){case"push":case"unshift":i=n;break;case"splice":i=n.slice(2)}return i&&o.observeArray(i),o.dep.notify(),a}))}));var _t=Object.getOwnPropertyNames(wt),St=!0;function Mt(t){St=t}var Et=function(t){var e;this.value=t,this.dep=new ht,this.vmCount=0,W(t,"__ob__",this),Array.isArray(t)?(G?(e=wt,t.__proto__=e):function(t,e,n){for(var r=0,i=n.length;r<i;r++){var a=n[r];W(t,a,e[a])}}(t,wt,_t),this.observeArray(t)):this.walk(t)};function Tt(t,e){var n;if(u(t)&&!(t instanceof mt))return b(t,"__ob__")&&t.__ob__ instanceof Et?n=t.__ob__:St&&!it()&&(Array.isArray(t)||l(t))&&Object.isExtensible(t)&&!t._isVue&&(n=new Et(t)),e&&n&&n.vmCount++,n}function Ct(t,e,n,r,i){var a=new ht,o=Object.getOwnPropertyDescriptor(t,e);if(!o||!1!==o.configurable){var s=o&&o.get,u=o&&o.set;s&&!u||2!==arguments.length||(n=t[e]);var c=!i&&Tt(n);Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:function(){var e=s?s.call(t):n;return ht.target&&(a.depend(),c&&(c.dep.depend(),Array.isArray(e)&&function t(e){for(var n=void 0,r=0,i=e.length;r<i;r++)(n=e[r])&&n.__ob__&&n.__ob__.dep.depend(),Array.isArray(n)&&t(n)}(e))),e},set:function(e){var r=s?s.call(t):n;e===r||e!=e&&r!=r||s&&!u||(u?u.call(t,e):n=e,c=!i&&Tt(e),a.notify())}})}}function At(t,e,n){if(Array.isArray(t)&&h(e))return t.length=Math.max(t.length,e),t.splice(e,1,n),n;if(e in t&&!(e in Object.prototype))return t[e]=n,n;var r=t.__ob__;return t._isVue||r&&r.vmCount?n:r?(Ct(r.value,e,n),r.dep.notify(),n):(t[e]=n,n)}function Nt(t,e){if(Array.isArray(t)&&h(e))t.splice(e,1);else{var n=t.__ob__;t._isVue||n&&n.vmCount||b(t,e)&&(delete t[e],n&&n.dep.notify())}}Et.prototype.walk=function(t){for(var e=Object.keys(t),n=0;n<e.length;n++)Ct(t,e[n])},Et.prototype.observeArray=function(t){for(var e=0,n=t.length;e<n;e++)Tt(t[e])};var It=U.optionMergeStrategies;function Rt(t,e){if(!e)return t;for(var n,r,i,a=ut?Reflect.ownKeys(e):Object.keys(e),o=0;o<a.length;o++)"__ob__"!==(n=a[o])&&(r=t[n],i=e[n],b(t,n)?r!==i&&l(r)&&l(i)&&Rt(r,i):At(t,n,i));return t}function Ot(t,e,n){return n?function(){var r="function"==typeof e?e.call(n,n):e,i="function"==typeof t?t.call(n,n):t;return r?Rt(r,i):i}:e?t?function(){return Rt("function"==typeof e?e.call(this,this):e,"function"==typeof t?t.call(this,this):t)}:e:t}function kt(t,e){var n=e?t?t.concat(e):Array.isArray(e)?e:[e]:t;return n?function(t){for(var e=[],n=0;n<t.length;n++)-1===e.indexOf(t[n])&&e.push(t[n]);return e}(n):n}function Lt(t,e,n,r){var i=Object.create(t||null);return e?N(i,e):i}It.data=function(t,e,n){return n?Ot(t,e,n):e&&"function"!=typeof e?t:Ot(t,e)},z.forEach((function(t){It[t]=kt})),B.forEach((function(t){It[t+"s"]=Lt})),It.watch=function(t,e,n,r){if(t===et&&(t=void 0),e===et&&(e=void 0),!e)return Object.create(t||null);if(!t)return e;var i={};for(var a in N(i,t),e){var o=i[a],s=e[a];o&&!Array.isArray(o)&&(o=[o]),i[a]=o?o.concat(s):Array.isArray(s)?s:[s]}return i},It.props=It.methods=It.inject=It.computed=function(t,e,n,r){if(!t)return e;var i=Object.create(null);return N(i,t),e&&N(i,e),i},It.provide=Ot;var Dt=function(t,e){return void 0===e?t:e};function Pt(t,e,n){if("function"==typeof e&&(e=e.options),function(t,e){var n=t.props;if(n){var r,i,a={};if(Array.isArray(n))for(r=n.length;r--;)"string"==typeof(i=n[r])&&(a[S(i)]={type:null});else if(l(n))for(var o in n)i=n[o],a[S(o)]=l(i)?i:{type:i};t.props=a}}(e),function(t,e){var n=t.inject;if(n){var r=t.inject={};if(Array.isArray(n))for(var i=0;i<n.length;i++)r[n[i]]={from:n[i]};else if(l(n))for(var a in n){var o=n[a];r[a]=l(o)?N({from:a},o):{from:o}}}}(e),function(t){var e=t.directives;if(e)for(var n in e){var r=e[n];"function"==typeof r&&(e[n]={bind:r,update:r})}}(e),!e._base&&(e.extends&&(t=Pt(t,e.extends,n)),e.mixins))for(var r=0,i=e.mixins.length;r<i;r++)t=Pt(t,e.mixins[r],n);var a,o={};for(a in t)s(a);for(a in e)b(t,a)||s(a);function s(r){var i=It[r]||Dt;o[r]=i(t[r],e[r],n,r)}return o}function Ft(t,e,n,r){if("string"==typeof n){var i=t[e];if(b(i,n))return i[n];var a=S(n);if(b(i,a))return i[a];var o=M(a);return b(i,o)?i[o]:i[n]||i[a]||i[o]}}function Bt(t,e,n,r){var i=e[t],a=!b(n,t),o=n[t],s=jt(Boolean,i.type);if(s>-1)if(a&&!b(i,"default"))o=!1;else if(""===o||o===T(t)){var u=jt(String,i.type);(u<0||s<u)&&(o=!0)}if(void 0===o){o=function(t,e,n){if(b(e,"default")){var r=e.default;return t&&t.$options.propsData&&void 0===t.$options.propsData[n]&&void 0!==t._props[n]?t._props[n]:"function"==typeof r&&"Function"!==zt(e.type)?r.call(t):r}}(r,i,t);var c=St;Mt(!0),Tt(o),Mt(c)}return o}function zt(t){var e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:""}function Ut(t,e){return zt(t)===zt(e)}function jt(t,e){if(!Array.isArray(e))return Ut(e,t)?0:-1;for(var n=0,r=e.length;n<r;n++)if(Ut(e[n],t))return n;return-1}function Wt(t,e,n){ft();try{if(e)for(var r=e;r=r.$parent;){var i=r.$options.errorCaptured;if(i)for(var a=0;a<i.length;a++)try{if(!1===i[a].call(r,t,e,n))return}catch(t){Ht(t,r,"errorCaptured hook")}}Ht(t,e,n)}finally{dt()}}function Vt(t,e,n,r,i){var a;try{(a=n?t.apply(e,n):t.call(e))&&!a._isVue&&p(a)&&!a._handled&&(a.catch((function(t){return Wt(t,r,i+" (Promise/async)")})),a._handled=!0)}catch(t){Wt(t,r,i)}return a}function Ht(t,e,n){if(U.errorHandler)try{return U.errorHandler.call(null,t,e,n)}catch(e){e!==t&&Gt(e,null,"config.errorHandler")}Gt(t,e,n)}function Gt(t,e,n){if(!q&&!X||"undefined"==typeof console)throw t;console.error(t)}var qt,Xt=!1,$t=[],Yt=!1;function Kt(){Yt=!1;var t=$t.slice(0);$t.length=0;for(var e=0;e<t.length;e++)t[e]()}if("undefined"!=typeof Promise&&ot(Promise)){var Jt=Promise.resolve();qt=function(){Jt.then(Kt),Q&&setTimeout(R)},Xt=!0}else if(K||"undefined"==typeof MutationObserver||!ot(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())qt=void 0!==n&&ot(n)?function(){n(Kt)}:function(){setTimeout(Kt,0)};else{var Zt=1,Qt=new MutationObserver(Kt),te=document.createTextNode(String(Zt));Qt.observe(te,{characterData:!0}),qt=function(){Zt=(Zt+1)%2,te.data=String(Zt)},Xt=!0}function ee(t,e){var n;if($t.push((function(){if(t)try{t.call(e)}catch(t){Wt(t,e,"nextTick")}else n&&n(e)})),Yt||(Yt=!0,qt()),!t&&"undefined"!=typeof Promise)return new Promise((function(t){n=t}))}var ne=new st;function re(t){!function t(e,n){var r,i,a=Array.isArray(e);if(!(!a&&!u(e)||Object.isFrozen(e)||e instanceof mt)){if(e.__ob__){var o=e.__ob__.dep.id;if(n.has(o))return;n.add(o)}if(a)for(r=e.length;r--;)t(e[r],n);else for(r=(i=Object.keys(e)).length;r--;)t(e[i[r]],n)}}(t,ne),ne.clear()}var ie=w((function(t){var e="&"===t.charAt(0),n="~"===(t=e?t.slice(1):t).charAt(0),r="!"===(t=n?t.slice(1):t).charAt(0);return{name:t=r?t.slice(1):t,once:n,capture:r,passive:e}}));function ae(t,e){function n(){var t=arguments,r=n.fns;if(!Array.isArray(r))return Vt(r,null,arguments,e,"v-on handler");for(var i=r.slice(),a=0;a<i.length;a++)Vt(i[a],null,t,e,"v-on handler")}return n.fns=t,n}function oe(t,e,n,r,a,s){var u,c,l,h;for(u in t)c=t[u],l=e[u],h=ie(u),i(c)||(i(l)?(i(c.fns)&&(c=t[u]=ae(c,s)),o(h.once)&&(c=t[u]=a(h.name,c,h.capture)),n(h.name,c,h.capture,h.passive,h.params)):c!==l&&(l.fns=c,t[u]=l));for(u in e)i(t[u])&&r((h=ie(u)).name,e[u],h.capture)}function se(t,e,n){var r;t instanceof mt&&(t=t.data.hook||(t.data.hook={}));var s=t[e];function u(){n.apply(this,arguments),y(r.fns,u)}i(s)?r=ae([u]):a(s.fns)&&o(s.merged)?(r=s).fns.push(u):r=ae([s,u]),r.merged=!0,t[e]=r}function ue(t,e,n,r,i){if(a(e)){if(b(e,n))return t[n]=e[n],i||delete e[n],!0;if(b(e,r))return t[n]=e[r],i||delete e[r],!0}return!1}function ce(t){return s(t)?[yt(t)]:Array.isArray(t)?function t(e,n){var r,u,c,l,h=[];for(r=0;r<e.length;r++)i(u=e[r])||"boolean"==typeof u||(l=h[c=h.length-1],Array.isArray(u)?u.length>0&&(le((u=t(u,(n||"")+"_"+r))[0])&&le(l)&&(h[c]=yt(l.text+u[0].text),u.shift()),h.push.apply(h,u)):s(u)?le(l)?h[c]=yt(l.text+u):""!==u&&h.push(yt(u)):le(u)&&le(l)?h[c]=yt(l.text+u.text):(o(e._isVList)&&a(u.tag)&&i(u.key)&&a(n)&&(u.key="__vlist"+n+"_"+r+"__"),h.push(u)));return h}(t):void 0}function le(t){return a(t)&&a(t.text)&&!1===t.isComment}function he(t,e){if(t){for(var n=Object.create(null),r=ut?Reflect.ownKeys(t):Object.keys(t),i=0;i<r.length;i++){var a=r[i];if("__ob__"!==a){for(var o=t[a].from,s=e;s;){if(s._provided&&b(s._provided,o)){n[a]=s._provided[o];break}s=s.$parent}if(!s&&"default"in t[a]){var u=t[a].default;n[a]="function"==typeof u?u.call(e):u}}}return n}}function pe(t,e){if(!t||!t.length)return{};for(var n={},r=0,i=t.length;r<i;r++){var a=t[r],o=a.data;if(o&&o.attrs&&o.attrs.slot&&delete o.attrs.slot,a.context!==e&&a.fnContext!==e||!o||null==o.slot)(n.default||(n.default=[])).push(a);else{var s=o.slot,u=n[s]||(n[s]=[]);"template"===a.tag?u.push.apply(u,a.children||[]):u.push(a)}}for(var c in n)n[c].every(fe)&&delete n[c];return n}function fe(t){return t.isComment&&!t.asyncFactory||" "===t.text}function de(t,e,n){var i,a=Object.keys(e).length>0,o=t?!!t.$stable:!a,s=t&&t.$key;if(t){if(t._normalized)return t._normalized;if(o&&n&&n!==r&&s===n.$key&&!a&&!n.$hasNormal)return n;for(var u in i={},t)t[u]&&"$"!==u[0]&&(i[u]=me(e,u,t[u]))}else i={};for(var c in e)c in i||(i[c]=ve(e,c));return t&&Object.isExtensible(t)&&(t._normalized=i),W(i,"$stable",o),W(i,"$key",s),W(i,"$hasNormal",a),i}function me(t,e,n){var r=function(){var t=arguments.length?n.apply(null,arguments):n({});return(t=t&&"object"==typeof t&&!Array.isArray(t)?[t]:ce(t))&&(0===t.length||1===t.length&&t[0].isComment)?void 0:t};return n.proxy&&Object.defineProperty(t,e,{get:r,enumerable:!0,configurable:!0}),r}function ve(t,e){return function(){return t[e]}}function ge(t,e){var n,r,i,o,s;if(Array.isArray(t)||"string"==typeof t)for(n=new Array(t.length),r=0,i=t.length;r<i;r++)n[r]=e(t[r],r);else if("number"==typeof t)for(n=new Array(t),r=0;r<t;r++)n[r]=e(r+1,r);else if(u(t))if(ut&&t[Symbol.iterator]){n=[];for(var c=t[Symbol.iterator](),l=c.next();!l.done;)n.push(e(l.value,n.length)),l=c.next()}else for(o=Object.keys(t),n=new Array(o.length),r=0,i=o.length;r<i;r++)s=o[r],n[r]=e(t[s],s,r);return a(n)||(n=[]),n._isVList=!0,n}function ye(t,e,n,r){var i,a=this.$scopedSlots[t];a?(n=n||{},r&&(n=N(N({},r),n)),i=a(n)||e):i=this.$slots[t]||e;var o=n&&n.slot;return o?this.$createElement("template",{slot:o},i):i}function xe(t){return Ft(this.$options,"filters",t)||k}function be(t,e){return Array.isArray(t)?-1===t.indexOf(e):t!==e}function we(t,e,n,r,i){var a=U.keyCodes[e]||n;return i&&r&&!U.keyCodes[e]?be(i,r):a?be(a,t):r?T(r)!==e:void 0}function _e(t,e,n,r,i){if(n&&u(n)){var a;Array.isArray(n)&&(n=I(n));var o=function(o){if("class"===o||"style"===o||g(o))a=t;else{var s=t.attrs&&t.attrs.type;a=r||U.mustUseProp(e,s,o)?t.domProps||(t.domProps={}):t.attrs||(t.attrs={})}var u=S(o),c=T(o);u in a||c in a||(a[o]=n[o],i&&((t.on||(t.on={}))["update:"+o]=function(t){n[o]=t}))};for(var s in n)o(s)}return t}function Se(t,e){var n=this._staticTrees||(this._staticTrees=[]),r=n[t];return r&&!e||Ee(r=n[t]=this.$options.staticRenderFns[t].call(this._renderProxy,null,this),"__static__"+t,!1),r}function Me(t,e,n){return Ee(t,"__once__"+e+(n?"_"+n:""),!0),t}function Ee(t,e,n){if(Array.isArray(t))for(var r=0;r<t.length;r++)t[r]&&"string"!=typeof t[r]&&Te(t[r],e+"_"+r,n);else Te(t,e,n)}function Te(t,e,n){t.isStatic=!0,t.key=e,t.isOnce=n}function Ce(t,e){if(e&&l(e)){var n=t.on=t.on?N({},t.on):{};for(var r in e){var i=n[r],a=e[r];n[r]=i?[].concat(i,a):a}}return t}function Ae(t,e,n,r){e=e||{$stable:!n};for(var i=0;i<t.length;i++){var a=t[i];Array.isArray(a)?Ae(a,e,n):a&&(a.proxy&&(a.fn.proxy=!0),e[a.key]=a.fn)}return r&&(e.$key=r),e}function Ne(t,e){for(var n=0;n<e.length;n+=2){var r=e[n];"string"==typeof r&&r&&(t[e[n]]=e[n+1])}return t}function Ie(t,e){return"string"==typeof t?e+t:t}function Re(t){t._o=Me,t._n=d,t._s=f,t._l=ge,t._t=ye,t._q=L,t._i=D,t._m=Se,t._f=xe,t._k=we,t._b=_e,t._v=yt,t._e=gt,t._u=Ae,t._g=Ce,t._d=Ne,t._p=Ie}function Oe(t,e,n,i,a){var s,u=this,c=a.options;b(i,"_uid")?(s=Object.create(i))._original=i:(s=i,i=i._original);var l=o(c._compiled),h=!l;this.data=t,this.props=e,this.children=n,this.parent=i,this.listeners=t.on||r,this.injections=he(c.inject,i),this.slots=function(){return u.$slots||de(t.scopedSlots,u.$slots=pe(n,i)),u.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return de(t.scopedSlots,this.slots())}}),l&&(this.$options=c,this.$slots=this.slots(),this.$scopedSlots=de(t.scopedSlots,this.$slots)),c._scopeId?this._c=function(t,e,n,r){var a=ze(s,t,e,n,r,h);return a&&!Array.isArray(a)&&(a.fnScopeId=c._scopeId,a.fnContext=i),a}:this._c=function(t,e,n,r){return ze(s,t,e,n,r,h)}}function ke(t,e,n,r,i){var a=xt(t);return a.fnContext=n,a.fnOptions=r,e.slot&&((a.data||(a.data={})).slot=e.slot),a}function Le(t,e){for(var n in e)t[S(n)]=e[n]}Re(Oe.prototype);var De={init:function(t,e){if(t.componentInstance&&!t.componentInstance._isDestroyed&&t.data.keepAlive){var n=t;De.prepatch(n,n)}else(t.componentInstance=function(t,e){var n={_isComponent:!0,_parentVnode:t,parent:e},r=t.data.inlineTemplate;return a(r)&&(n.render=r.render,n.staticRenderFns=r.staticRenderFns),new t.componentOptions.Ctor(n)}(t,Ye)).$mount(e?t.elm:void 0,e)},prepatch:function(t,e){var n=e.componentOptions;!function(t,e,n,i,a){var o=i.data.scopedSlots,s=t.$scopedSlots,u=!!(o&&!o.$stable||s!==r&&!s.$stable||o&&t.$scopedSlots.$key!==o.$key),c=!!(a||t.$options._renderChildren||u);if(t.$options._parentVnode=i,t.$vnode=i,t._vnode&&(t._vnode.parent=i),t.$options._renderChildren=a,t.$attrs=i.data.attrs||r,t.$listeners=n||r,e&&t.$options.props){Mt(!1);for(var l=t._props,h=t.$options._propKeys||[],p=0;p<h.length;p++){var f=h[p],d=t.$options.props;l[f]=Bt(f,d,e,t)}Mt(!0),t.$options.propsData=e}n=n||r;var m=t.$options._parentListeners;t.$options._parentListeners=n,$e(t,n,m),c&&(t.$slots=pe(a,i.context),t.$forceUpdate())}(e.componentInstance=t.componentInstance,n.propsData,n.listeners,e,n.children)},insert:function(t){var e,n=t.context,r=t.componentInstance;r._isMounted||(r._isMounted=!0,Qe(r,"mounted")),t.data.keepAlive&&(n._isMounted?((e=r)._inactive=!1,en.push(e)):Ze(r,!0))},destroy:function(t){var e=t.componentInstance;e._isDestroyed||(t.data.keepAlive?function t(e,n){if(!(n&&(e._directInactive=!0,Je(e))||e._inactive)){e._inactive=!0;for(var r=0;r<e.$children.length;r++)t(e.$children[r]);Qe(e,"deactivated")}}(e,!0):e.$destroy())}},Pe=Object.keys(De);function Fe(t,e,n,s,c){if(!i(t)){var l=n.$options._base;if(u(t)&&(t=l.extend(t)),"function"==typeof t){var h;if(i(t.cid)&&void 0===(t=function(t,e){if(o(t.error)&&a(t.errorComp))return t.errorComp;if(a(t.resolved))return t.resolved;var n=je;if(n&&a(t.owners)&&-1===t.owners.indexOf(n)&&t.owners.push(n),o(t.loading)&&a(t.loadingComp))return t.loadingComp;if(n&&!a(t.owners)){var r=t.owners=[n],s=!0,c=null,l=null;n.$on("hook:destroyed",(function(){return y(r,n)}));var h=function(t){for(var e=0,n=r.length;e<n;e++)r[e].$forceUpdate();t&&(r.length=0,null!==c&&(clearTimeout(c),c=null),null!==l&&(clearTimeout(l),l=null))},f=P((function(n){t.resolved=We(n,e),s?r.length=0:h(!0)})),d=P((function(e){a(t.errorComp)&&(t.error=!0,h(!0))})),m=t(f,d);return u(m)&&(p(m)?i(t.resolved)&&m.then(f,d):p(m.component)&&(m.component.then(f,d),a(m.error)&&(t.errorComp=We(m.error,e)),a(m.loading)&&(t.loadingComp=We(m.loading,e),0===m.delay?t.loading=!0:c=setTimeout((function(){c=null,i(t.resolved)&&i(t.error)&&(t.loading=!0,h(!1))}),m.delay||200)),a(m.timeout)&&(l=setTimeout((function(){l=null,i(t.resolved)&&d(null)}),m.timeout)))),s=!1,t.loading?t.loadingComp:t.resolved}}(h=t,l)))return function(t,e,n,r,i){var a=gt();return a.asyncFactory=t,a.asyncMeta={data:e,context:n,children:r,tag:i},a}(h,e,n,s,c);e=e||{},wn(t),a(e.model)&&function(t,e){var n=t.model&&t.model.prop||"value",r=t.model&&t.model.event||"input";(e.attrs||(e.attrs={}))[n]=e.model.value;var i=e.on||(e.on={}),o=i[r],s=e.model.callback;a(o)?(Array.isArray(o)?-1===o.indexOf(s):o!==s)&&(i[r]=[s].concat(o)):i[r]=s}(t.options,e);var f=function(t,e,n){var r=e.options.props;if(!i(r)){var o={},s=t.attrs,u=t.props;if(a(s)||a(u))for(var c in r){var l=T(c);ue(o,u,c,l,!0)||ue(o,s,c,l,!1)}return o}}(e,t);if(o(t.options.functional))return function(t,e,n,i,o){var s=t.options,u={},c=s.props;if(a(c))for(var l in c)u[l]=Bt(l,c,e||r);else a(n.attrs)&&Le(u,n.attrs),a(n.props)&&Le(u,n.props);var h=new Oe(n,u,o,i,t),p=s.render.call(null,h._c,h);if(p instanceof mt)return ke(p,n,h.parent,s);if(Array.isArray(p)){for(var f=ce(p)||[],d=new Array(f.length),m=0;m<f.length;m++)d[m]=ke(f[m],n,h.parent,s);return d}}(t,f,e,n,s);var d=e.on;if(e.on=e.nativeOn,o(t.options.abstract)){var m=e.slot;e={},m&&(e.slot=m)}!function(t){for(var e=t.hook||(t.hook={}),n=0;n<Pe.length;n++){var r=Pe[n],i=e[r],a=De[r];i===a||i&&i._merged||(e[r]=i?Be(a,i):a)}}(e);var v=t.options.name||c;return new mt("vue-component-"+t.cid+(v?"-"+v:""),e,void 0,void 0,void 0,n,{Ctor:t,propsData:f,listeners:d,tag:c,children:s},h)}}}function Be(t,e){var n=function(n,r){t(n,r),e(n,r)};return n._merged=!0,n}function ze(t,e,n,r,c,l){return(Array.isArray(n)||s(n))&&(c=r,r=n,n=void 0),o(l)&&(c=2),function(t,e,n,r,s){if(a(n)&&a(n.__ob__))return gt();if(a(n)&&a(n.is)&&(e=n.is),!e)return gt();var c,l,h;(Array.isArray(r)&&"function"==typeof r[0]&&((n=n||{}).scopedSlots={default:r[0]},r.length=0),2===s?r=ce(r):1===s&&(r=function(t){for(var e=0;e<t.length;e++)if(Array.isArray(t[e]))return Array.prototype.concat.apply([],t);return t}(r)),"string"==typeof e)?(l=t.$vnode&&t.$vnode.ns||U.getTagNamespace(e),c=U.isReservedTag(e)?new mt(U.parsePlatformTagName(e),n,r,void 0,void 0,t):n&&n.pre||!a(h=Ft(t.$options,"components",e))?new mt(e,n,r,void 0,void 0,t):Fe(h,n,t,r,e)):c=Fe(e,n,t,r);return Array.isArray(c)?c:a(c)?(a(l)&&function t(e,n,r){if(e.ns=n,"foreignObject"===e.tag&&(n=void 0,r=!0),a(e.children))for(var s=0,u=e.children.length;s<u;s++){var c=e.children[s];a(c.tag)&&(i(c.ns)||o(r)&&"svg"!==c.tag)&&t(c,n,r)}}(c,l),a(n)&&function(t){u(t.style)&&re(t.style),u(t.class)&&re(t.class)}(n),c):gt()}(t,e,n,r,c)}var Ue,je=null;function We(t,e){return(t.__esModule||ut&&"Module"===t[Symbol.toStringTag])&&(t=t.default),u(t)?e.extend(t):t}function Ve(t){return t.isComment&&t.asyncFactory}function He(t){if(Array.isArray(t))for(var e=0;e<t.length;e++){var n=t[e];if(a(n)&&(a(n.componentOptions)||Ve(n)))return n}}function Ge(t,e){Ue.$on(t,e)}function qe(t,e){Ue.$off(t,e)}function Xe(t,e){var n=Ue;return function r(){null!==e.apply(null,arguments)&&n.$off(t,r)}}function $e(t,e,n){Ue=t,oe(e,n||{},Ge,qe,Xe,t),Ue=void 0}var Ye=null;function Ke(t){var e=Ye;return Ye=t,function(){Ye=e}}function Je(t){for(;t&&(t=t.$parent);)if(t._inactive)return!0;return!1}function Ze(t,e){if(e){if(t._directInactive=!1,Je(t))return}else if(t._directInactive)return;if(t._inactive||null===t._inactive){t._inactive=!1;for(var n=0;n<t.$children.length;n++)Ze(t.$children[n]);Qe(t,"activated")}}function Qe(t,e){ft();var n=t.$options[e],r=e+" hook";if(n)for(var i=0,a=n.length;i<a;i++)Vt(n[i],t,null,t,r);t._hasHookEvent&&t.$emit("hook:"+e),dt()}var tn=[],en=[],nn={},rn=!1,an=!1,on=0,sn=0,un=Date.now;if(q&&!K){var cn=window.performance;cn&&"function"==typeof cn.now&&un()>document.createEvent("Event").timeStamp&&(un=function(){return cn.now()})}function ln(){var t,e;for(sn=un(),an=!0,tn.sort((function(t,e){return t.id-e.id})),on=0;on<tn.length;on++)(t=tn[on]).before&&t.before(),e=t.id,nn[e]=null,t.run();var n=en.slice(),r=tn.slice();on=tn.length=en.length=0,nn={},rn=an=!1,function(t){for(var e=0;e<t.length;e++)t[e]._inactive=!0,Ze(t[e],!0)}(n),function(t){for(var e=t.length;e--;){var n=t[e],r=n.vm;r._watcher===n&&r._isMounted&&!r._isDestroyed&&Qe(r,"updated")}}(r),at&&U.devtools&&at.emit("flush")}var hn=0,pn=function(t,e,n,r,i){this.vm=t,i&&(t._watcher=this),t._watchers.push(this),r?(this.deep=!!r.deep,this.user=!!r.user,this.lazy=!!r.lazy,this.sync=!!r.sync,this.before=r.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=n,this.id=++hn,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new st,this.newDepIds=new st,this.expression="","function"==typeof e?this.getter=e:(this.getter=function(t){if(!H.test(t)){var e=t.split(".");return function(t){for(var n=0;n<e.length;n++){if(!t)return;t=t[e[n]]}return t}}}(e),this.getter||(this.getter=R)),this.value=this.lazy?void 0:this.get()};pn.prototype.get=function(){var t;ft(this);var e=this.vm;try{t=this.getter.call(e,e)}catch(t){if(!this.user)throw t;Wt(t,e,'getter for watcher "'+this.expression+'"')}finally{this.deep&&re(t),dt(),this.cleanupDeps()}return t},pn.prototype.addDep=function(t){var e=t.id;this.newDepIds.has(e)||(this.newDepIds.add(e),this.newDeps.push(t),this.depIds.has(e)||t.addSub(this))},pn.prototype.cleanupDeps=function(){for(var t=this.deps.length;t--;){var e=this.deps[t];this.newDepIds.has(e.id)||e.removeSub(this)}var n=this.depIds;this.depIds=this.newDepIds,this.newDepIds=n,this.newDepIds.clear(),n=this.deps,this.deps=this.newDeps,this.newDeps=n,this.newDeps.length=0},pn.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():function(t){var e=t.id;if(null==nn[e]){if(nn[e]=!0,an){for(var n=tn.length-1;n>on&&tn[n].id>t.id;)n--;tn.splice(n+1,0,t)}else tn.push(t);rn||(rn=!0,ee(ln))}}(this)},pn.prototype.run=function(){if(this.active){var t=this.get();if(t!==this.value||u(t)||this.deep){var e=this.value;if(this.value=t,this.user)try{this.cb.call(this.vm,t,e)}catch(t){Wt(t,this.vm,'callback for watcher "'+this.expression+'"')}else this.cb.call(this.vm,t,e)}}},pn.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},pn.prototype.depend=function(){for(var t=this.deps.length;t--;)this.deps[t].depend()},pn.prototype.teardown=function(){if(this.active){this.vm._isBeingDestroyed||y(this.vm._watchers,this);for(var t=this.deps.length;t--;)this.deps[t].removeSub(this);this.active=!1}};var fn={enumerable:!0,configurable:!0,get:R,set:R};function dn(t,e,n){fn.get=function(){return this[e][n]},fn.set=function(t){this[e][n]=t},Object.defineProperty(t,n,fn)}var mn={lazy:!0};function vn(t,e,n){var r=!it();"function"==typeof n?(fn.get=r?gn(e):yn(n),fn.set=R):(fn.get=n.get?r&&!1!==n.cache?gn(e):yn(n.get):R,fn.set=n.set||R),Object.defineProperty(t,e,fn)}function gn(t){return function(){var e=this._computedWatchers&&this._computedWatchers[t];if(e)return e.dirty&&e.evaluate(),ht.target&&e.depend(),e.value}}function yn(t){return function(){return t.call(this,this)}}function xn(t,e,n,r){return l(n)&&(r=n,n=n.handler),"string"==typeof n&&(n=t[n]),t.$watch(e,n,r)}var bn=0;function wn(t){var e=t.options;if(t.super){var n=wn(t.super);if(n!==t.superOptions){t.superOptions=n;var r=function(t){var e,n=t.options,r=t.sealedOptions;for(var i in n)n[i]!==r[i]&&(e||(e={}),e[i]=n[i]);return e}(t);r&&N(t.extendOptions,r),(e=t.options=Pt(n,t.extendOptions)).name&&(e.components[e.name]=t)}}return e}function _n(t){this._init(t)}function Sn(t){return t&&(t.Ctor.options.name||t.tag)}function Mn(t,e){return Array.isArray(t)?t.indexOf(e)>-1:"string"==typeof t?t.split(",").indexOf(e)>-1:(n=t,"[object RegExp]"===c.call(n)&&t.test(e));var n}function En(t,e){var n=t.cache,r=t.keys,i=t._vnode;for(var a in n){var o=n[a];if(o){var s=Sn(o.componentOptions);s&&!e(s)&&Tn(n,a,r,i)}}}function Tn(t,e,n,r){var i=t[e];!i||r&&i.tag===r.tag||i.componentInstance.$destroy(),t[e]=null,y(n,e)}!function(t){t.prototype._init=function(t){var e=this;e._uid=bn++,e._isVue=!0,t&&t._isComponent?function(t,e){var n=t.$options=Object.create(t.constructor.options),r=e._parentVnode;n.parent=e.parent,n._parentVnode=r;var i=r.componentOptions;n.propsData=i.propsData,n._parentListeners=i.listeners,n._renderChildren=i.children,n._componentTag=i.tag,e.render&&(n.render=e.render,n.staticRenderFns=e.staticRenderFns)}(e,t):e.$options=Pt(wn(e.constructor),t||{},e),e._renderProxy=e,e._self=e,function(t){var e=t.$options,n=e.parent;if(n&&!e.abstract){for(;n.$options.abstract&&n.$parent;)n=n.$parent;n.$children.push(t)}t.$parent=n,t.$root=n?n.$root:t,t.$children=[],t.$refs={},t._watcher=null,t._inactive=null,t._directInactive=!1,t._isMounted=!1,t._isDestroyed=!1,t._isBeingDestroyed=!1}(e),function(t){t._events=Object.create(null),t._hasHookEvent=!1;var e=t.$options._parentListeners;e&&$e(t,e)}(e),function(t){t._vnode=null,t._staticTrees=null;var e=t.$options,n=t.$vnode=e._parentVnode,i=n&&n.context;t.$slots=pe(e._renderChildren,i),t.$scopedSlots=r,t._c=function(e,n,r,i){return ze(t,e,n,r,i,!1)},t.$createElement=function(e,n,r,i){return ze(t,e,n,r,i,!0)};var a=n&&n.data;Ct(t,"$attrs",a&&a.attrs||r,null,!0),Ct(t,"$listeners",e._parentListeners||r,null,!0)}(e),Qe(e,"beforeCreate"),function(t){var e=he(t.$options.inject,t);e&&(Mt(!1),Object.keys(e).forEach((function(n){Ct(t,n,e[n])})),Mt(!0))}(e),function(t){t._watchers=[];var e=t.$options;e.props&&function(t,e){var n=t.$options.propsData||{},r=t._props={},i=t.$options._propKeys=[];t.$parent&&Mt(!1);var a=function(a){i.push(a);var o=Bt(a,e,n,t);Ct(r,a,o),a in t||dn(t,"_props",a)};for(var o in e)a(o);Mt(!0)}(t,e.props),e.methods&&function(t,e){for(var n in t.$options.props,e)t[n]="function"!=typeof e[n]?R:C(e[n],t)}(t,e.methods),e.data?function(t){var e=t.$options.data;l(e=t._data="function"==typeof e?function(t,e){ft();try{return t.call(e,e)}catch(t){return Wt(t,e,"data()"),{}}finally{dt()}}(e,t):e||{})||(e={});for(var n,r=Object.keys(e),i=t.$options.props,a=(t.$options.methods,r.length);a--;){var o=r[a];i&&b(i,o)||(void 0,36!==(n=(o+"").charCodeAt(0))&&95!==n&&dn(t,"_data",o))}Tt(e,!0)}(t):Tt(t._data={},!0),e.computed&&function(t,e){var n=t._computedWatchers=Object.create(null),r=it();for(var i in e){var a=e[i],o="function"==typeof a?a:a.get;r||(n[i]=new pn(t,o||R,R,mn)),i in t||vn(t,i,a)}}(t,e.computed),e.watch&&e.watch!==et&&function(t,e){for(var n in e){var r=e[n];if(Array.isArray(r))for(var i=0;i<r.length;i++)xn(t,n,r[i]);else xn(t,n,r)}}(t,e.watch)}(e),function(t){var e=t.$options.provide;e&&(t._provided="function"==typeof e?e.call(t):e)}(e),Qe(e,"created"),e.$options.el&&e.$mount(e.$options.el)}}(_n),function(t){Object.defineProperty(t.prototype,"$data",{get:function(){return this._data}}),Object.defineProperty(t.prototype,"$props",{get:function(){return this._props}}),t.prototype.$set=At,t.prototype.$delete=Nt,t.prototype.$watch=function(t,e,n){if(l(e))return xn(this,t,e,n);(n=n||{}).user=!0;var r=new pn(this,t,e,n);if(n.immediate)try{e.call(this,r.value)}catch(t){Wt(t,this,'callback for immediate watcher "'+r.expression+'"')}return function(){r.teardown()}}}(_n),function(t){var e=/^hook:/;t.prototype.$on=function(t,n){var r=this;if(Array.isArray(t))for(var i=0,a=t.length;i<a;i++)r.$on(t[i],n);else(r._events[t]||(r._events[t]=[])).push(n),e.test(t)&&(r._hasHookEvent=!0);return r},t.prototype.$once=function(t,e){var n=this;function r(){n.$off(t,r),e.apply(n,arguments)}return r.fn=e,n.$on(t,r),n},t.prototype.$off=function(t,e){var n=this;if(!arguments.length)return n._events=Object.create(null),n;if(Array.isArray(t)){for(var r=0,i=t.length;r<i;r++)n.$off(t[r],e);return n}var a,o=n._events[t];if(!o)return n;if(!e)return n._events[t]=null,n;for(var s=o.length;s--;)if((a=o[s])===e||a.fn===e){o.splice(s,1);break}return n},t.prototype.$emit=function(t){var e=this._events[t];if(e){e=e.length>1?A(e):e;for(var n=A(arguments,1),r='event handler for "'+t+'"',i=0,a=e.length;i<a;i++)Vt(e[i],this,n,this,r)}return this}}(_n),function(t){t.prototype._update=function(t,e){var n=this,r=n.$el,i=n._vnode,a=Ke(n);n._vnode=t,n.$el=i?n.__patch__(i,t):n.__patch__(n.$el,t,e,!1),a(),r&&(r.__vue__=null),n.$el&&(n.$el.__vue__=n),n.$vnode&&n.$parent&&n.$vnode===n.$parent._vnode&&(n.$parent.$el=n.$el)},t.prototype.$forceUpdate=function(){this._watcher&&this._watcher.update()},t.prototype.$destroy=function(){var t=this;if(!t._isBeingDestroyed){Qe(t,"beforeDestroy"),t._isBeingDestroyed=!0;var e=t.$parent;!e||e._isBeingDestroyed||t.$options.abstract||y(e.$children,t),t._watcher&&t._watcher.teardown();for(var n=t._watchers.length;n--;)t._watchers[n].teardown();t._data.__ob__&&t._data.__ob__.vmCount--,t._isDestroyed=!0,t.__patch__(t._vnode,null),Qe(t,"destroyed"),t.$off(),t.$el&&(t.$el.__vue__=null),t.$vnode&&(t.$vnode.parent=null)}}}(_n),function(t){Re(t.prototype),t.prototype.$nextTick=function(t){return ee(t,this)},t.prototype._render=function(){var t,e=this,n=e.$options,r=n.render,i=n._parentVnode;i&&(e.$scopedSlots=de(i.data.scopedSlots,e.$slots,e.$scopedSlots)),e.$vnode=i;try{je=e,t=r.call(e._renderProxy,e.$createElement)}catch(n){Wt(n,e,"render"),t=e._vnode}finally{je=null}return Array.isArray(t)&&1===t.length&&(t=t[0]),t instanceof mt||(t=gt()),t.parent=i,t}}(_n);var Cn=[String,RegExp,Array],An={KeepAlive:{name:"keep-alive",abstract:!0,props:{include:Cn,exclude:Cn,max:[String,Number]},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var t in this.cache)Tn(this.cache,t,this.keys)},mounted:function(){var t=this;this.$watch("include",(function(e){En(t,(function(t){return Mn(e,t)}))})),this.$watch("exclude",(function(e){En(t,(function(t){return!Mn(e,t)}))}))},render:function(){var t=this.$slots.default,e=He(t),n=e&&e.componentOptions;if(n){var r=Sn(n),i=this.include,a=this.exclude;if(i&&(!r||!Mn(i,r))||a&&r&&Mn(a,r))return e;var o=this.cache,s=this.keys,u=null==e.key?n.Ctor.cid+(n.tag?"::"+n.tag:""):e.key;o[u]?(e.componentInstance=o[u].componentInstance,y(s,u),s.push(u)):(o[u]=e,s.push(u),this.max&&s.length>parseInt(this.max)&&Tn(o,s[0],s,this._vnode)),e.data.keepAlive=!0}return e||t&&t[0]}}};!function(t){var e={get:function(){return U}};Object.defineProperty(t,"config",e),t.util={warn:ct,extend:N,mergeOptions:Pt,defineReactive:Ct},t.set=At,t.delete=Nt,t.nextTick=ee,t.observable=function(t){return Tt(t),t},t.options=Object.create(null),B.forEach((function(e){t.options[e+"s"]=Object.create(null)})),t.options._base=t,N(t.options.components,An),function(t){t.use=function(t){var e=this._installedPlugins||(this._installedPlugins=[]);if(e.indexOf(t)>-1)return this;var n=A(arguments,1);return n.unshift(this),"function"==typeof t.install?t.install.apply(t,n):"function"==typeof t&&t.apply(null,n),e.push(t),this}}(t),function(t){t.mixin=function(t){return this.options=Pt(this.options,t),this}}(t),function(t){t.cid=0;var e=1;t.extend=function(t){t=t||{};var n=this,r=n.cid,i=t._Ctor||(t._Ctor={});if(i[r])return i[r];var a=t.name||n.options.name,o=function(t){this._init(t)};return(o.prototype=Object.create(n.prototype)).constructor=o,o.cid=e++,o.options=Pt(n.options,t),o.super=n,o.options.props&&function(t){var e=t.options.props;for(var n in e)dn(t.prototype,"_props",n)}(o),o.options.computed&&function(t){var e=t.options.computed;for(var n in e)vn(t.prototype,n,e[n])}(o),o.extend=n.extend,o.mixin=n.mixin,o.use=n.use,B.forEach((function(t){o[t]=n[t]})),a&&(o.options.components[a]=o),o.superOptions=n.options,o.extendOptions=t,o.sealedOptions=N({},o.options),i[r]=o,o}}(t),function(t){B.forEach((function(e){t[e]=function(t,n){return n?("component"===e&&l(n)&&(n.name=n.name||t,n=this.options._base.extend(n)),"directive"===e&&"function"==typeof n&&(n={bind:n,update:n}),this.options[e+"s"][t]=n,n):this.options[e+"s"][t]}}))}(t)}(_n),Object.defineProperty(_n.prototype,"$isServer",{get:it}),Object.defineProperty(_n.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(_n,"FunctionalRenderContext",{value:Oe}),_n.version="2.6.11";var Nn=m("style,class"),In=m("input,textarea,option,select,progress"),Rn=function(t,e,n){return"value"===n&&In(t)&&"button"!==e||"selected"===n&&"option"===t||"checked"===n&&"input"===t||"muted"===n&&"video"===t},On=m("contenteditable,draggable,spellcheck"),kn=m("events,caret,typing,plaintext-only"),Ln=m("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,translate,truespeed,typemustmatch,visible"),Dn="http://www.w3.org/1999/xlink",Pn=function(t){return":"===t.charAt(5)&&"xlink"===t.slice(0,5)},Fn=function(t){return Pn(t)?t.slice(6,t.length):""},Bn=function(t){return null==t||!1===t};function zn(t,e){return{staticClass:Un(t.staticClass,e.staticClass),class:a(t.class)?[t.class,e.class]:e.class}}function Un(t,e){return t?e?t+" "+e:t:e||""}function jn(t){return Array.isArray(t)?function(t){for(var e,n="",r=0,i=t.length;r<i;r++)a(e=jn(t[r]))&&""!==e&&(n&&(n+=" "),n+=e);return n}(t):u(t)?function(t){var e="";for(var n in t)t[n]&&(e&&(e+=" "),e+=n);return e}(t):"string"==typeof t?t:""}var Wn={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},Vn=m("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),Hn=m("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignObject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),Gn=function(t){return Vn(t)||Hn(t)};function qn(t){return Hn(t)?"svg":"math"===t?"math":void 0}var Xn=Object.create(null),$n=m("text,number,password,search,email,tel,url");function Yn(t){return"string"==typeof t?document.querySelector(t)||document.createElement("div"):t}var Kn=Object.freeze({createElement:function(t,e){var n=document.createElement(t);return"select"!==t||e.data&&e.data.attrs&&void 0!==e.data.attrs.multiple&&n.setAttribute("multiple","multiple"),n},createElementNS:function(t,e){return document.createElementNS(Wn[t],e)},createTextNode:function(t){return document.createTextNode(t)},createComment:function(t){return document.createComment(t)},insertBefore:function(t,e,n){t.insertBefore(e,n)},removeChild:function(t,e){t.removeChild(e)},appendChild:function(t,e){t.appendChild(e)},parentNode:function(t){return t.parentNode},nextSibling:function(t){return t.nextSibling},tagName:function(t){return t.tagName},setTextContent:function(t,e){t.textContent=e},setStyleScope:function(t,e){t.setAttribute(e,"")}}),Jn={create:function(t,e){Zn(e)},update:function(t,e){t.data.ref!==e.data.ref&&(Zn(t,!0),Zn(e))},destroy:function(t){Zn(t,!0)}};function Zn(t,e){var n=t.data.ref;if(a(n)){var r=t.context,i=t.componentInstance||t.elm,o=r.$refs;e?Array.isArray(o[n])?y(o[n],i):o[n]===i&&(o[n]=void 0):t.data.refInFor?Array.isArray(o[n])?o[n].indexOf(i)<0&&o[n].push(i):o[n]=[i]:o[n]=i}}var Qn=new mt("",{},[]),tr=["create","activate","update","remove","destroy"];function er(t,e){return t.key===e.key&&(t.tag===e.tag&&t.isComment===e.isComment&&a(t.data)===a(e.data)&&function(t,e){if("input"!==t.tag)return!0;var n,r=a(n=t.data)&&a(n=n.attrs)&&n.type,i=a(n=e.data)&&a(n=n.attrs)&&n.type;return r===i||$n(r)&&$n(i)}(t,e)||o(t.isAsyncPlaceholder)&&t.asyncFactory===e.asyncFactory&&i(e.asyncFactory.error))}function nr(t,e,n){var r,i,o={};for(r=e;r<=n;++r)a(i=t[r].key)&&(o[i]=r);return o}var rr={create:ir,update:ir,destroy:function(t){ir(t,Qn)}};function ir(t,e){(t.data.directives||e.data.directives)&&function(t,e){var n,r,i,a=t===Qn,o=e===Qn,s=or(t.data.directives,t.context),u=or(e.data.directives,e.context),c=[],l=[];for(n in u)r=s[n],i=u[n],r?(i.oldValue=r.value,i.oldArg=r.arg,ur(i,"update",e,t),i.def&&i.def.componentUpdated&&l.push(i)):(ur(i,"bind",e,t),i.def&&i.def.inserted&&c.push(i));if(c.length){var h=function(){for(var n=0;n<c.length;n++)ur(c[n],"inserted",e,t)};a?se(e,"insert",h):h()}if(l.length&&se(e,"postpatch",(function(){for(var n=0;n<l.length;n++)ur(l[n],"componentUpdated",e,t)})),!a)for(n in s)u[n]||ur(s[n],"unbind",t,t,o)}(t,e)}var ar=Object.create(null);function or(t,e){var n,r,i=Object.create(null);if(!t)return i;for(n=0;n<t.length;n++)(r=t[n]).modifiers||(r.modifiers=ar),i[sr(r)]=r,r.def=Ft(e.$options,"directives",r.name);return i}function sr(t){return t.rawName||t.name+"."+Object.keys(t.modifiers||{}).join(".")}function ur(t,e,n,r,i){var a=t.def&&t.def[e];if(a)try{a(n.elm,t,n,r,i)}catch(r){Wt(r,n.context,"directive "+t.name+" "+e+" hook")}}var cr=[Jn,rr];function lr(t,e){var n=e.componentOptions;if(!(a(n)&&!1===n.Ctor.options.inheritAttrs||i(t.data.attrs)&&i(e.data.attrs))){var r,o,s=e.elm,u=t.data.attrs||{},c=e.data.attrs||{};for(r in a(c.__ob__)&&(c=e.data.attrs=N({},c)),c)o=c[r],u[r]!==o&&hr(s,r,o);for(r in(K||Z)&&c.value!==u.value&&hr(s,"value",c.value),u)i(c[r])&&(Pn(r)?s.removeAttributeNS(Dn,Fn(r)):On(r)||s.removeAttribute(r))}}function hr(t,e,n){t.tagName.indexOf("-")>-1?pr(t,e,n):Ln(e)?Bn(n)?t.removeAttribute(e):(n="allowfullscreen"===e&&"EMBED"===t.tagName?"true":e,t.setAttribute(e,n)):On(e)?t.setAttribute(e,function(t,e){return Bn(e)||"false"===e?"false":"contenteditable"===t&&kn(e)?e:"true"}(e,n)):Pn(e)?Bn(n)?t.removeAttributeNS(Dn,Fn(e)):t.setAttributeNS(Dn,e,n):pr(t,e,n)}function pr(t,e,n){if(Bn(n))t.removeAttribute(e);else{if(K&&!J&&"TEXTAREA"===t.tagName&&"placeholder"===e&&""!==n&&!t.__ieph){var r=function(e){e.stopImmediatePropagation(),t.removeEventListener("input",r)};t.addEventListener("input",r),t.__ieph=!0}t.setAttribute(e,n)}}var fr={create:lr,update:lr};function dr(t,e){var n=e.elm,r=e.data,o=t.data;if(!(i(r.staticClass)&&i(r.class)&&(i(o)||i(o.staticClass)&&i(o.class)))){var s=function(t){for(var e=t.data,n=t,r=t;a(r.componentInstance);)(r=r.componentInstance._vnode)&&r.data&&(e=zn(r.data,e));for(;a(n=n.parent);)n&&n.data&&(e=zn(e,n.data));return function(t,e){return a(t)||a(e)?Un(t,jn(e)):""}(e.staticClass,e.class)}(e),u=n._transitionClasses;a(u)&&(s=Un(s,jn(u))),s!==n._prevClass&&(n.setAttribute("class",s),n._prevClass=s)}}var mr,vr,gr,yr,xr,br,wr={create:dr,update:dr},_r=/[\w).+\-_$\]]/;function Sr(t){var e,n,r,i,a,o=!1,s=!1,u=!1,c=!1,l=0,h=0,p=0,f=0;for(r=0;r<t.length;r++)if(n=e,e=t.charCodeAt(r),o)39===e&&92!==n&&(o=!1);else if(s)34===e&&92!==n&&(s=!1);else if(u)96===e&&92!==n&&(u=!1);else if(c)47===e&&92!==n&&(c=!1);else if(124!==e||124===t.charCodeAt(r+1)||124===t.charCodeAt(r-1)||l||h||p){switch(e){case 34:s=!0;break;case 39:o=!0;break;case 96:u=!0;break;case 40:p++;break;case 41:p--;break;case 91:h++;break;case 93:h--;break;case 123:l++;break;case 125:l--}if(47===e){for(var d=r-1,m=void 0;d>=0&&" "===(m=t.charAt(d));d--);m&&_r.test(m)||(c=!0)}}else void 0===i?(f=r+1,i=t.slice(0,r).trim()):v();function v(){(a||(a=[])).push(t.slice(f,r).trim()),f=r+1}if(void 0===i?i=t.slice(0,r).trim():0!==f&&v(),a)for(r=0;r<a.length;r++)i=Mr(i,a[r]);return i}function Mr(t,e){var n=e.indexOf("(");if(n<0)return'_f("'+e+'")('+t+")";var r=e.slice(0,n),i=e.slice(n+1);return'_f("'+r+'")('+t+(")"!==i?","+i:i)}function Er(t,e){console.error("[Vue compiler]: "+t)}function Tr(t,e){return t?t.map((function(t){return t[e]})).filter((function(t){return t})):[]}function Cr(t,e,n,r,i){(t.props||(t.props=[])).push(Pr({name:e,value:n,dynamic:i},r)),t.plain=!1}function Ar(t,e,n,r,i){(i?t.dynamicAttrs||(t.dynamicAttrs=[]):t.attrs||(t.attrs=[])).push(Pr({name:e,value:n,dynamic:i},r)),t.plain=!1}function Nr(t,e,n,r){t.attrsMap[e]=n,t.attrsList.push(Pr({name:e,value:n},r))}function Ir(t,e,n,r,i,a,o,s){(t.directives||(t.directives=[])).push(Pr({name:e,rawName:n,value:r,arg:i,isDynamicArg:a,modifiers:o},s)),t.plain=!1}function Rr(t,e,n){return n?"_p("+e+',"'+t+'")':t+e}function Or(t,e,n,i,a,o,s,u){var c;(i=i||r).right?u?e="("+e+")==='click'?'contextmenu':("+e+")":"click"===e&&(e="contextmenu",delete i.right):i.middle&&(u?e="("+e+")==='click'?'mouseup':("+e+")":"click"===e&&(e="mouseup")),i.capture&&(delete i.capture,e=Rr("!",e,u)),i.once&&(delete i.once,e=Rr("~",e,u)),i.passive&&(delete i.passive,e=Rr("&",e,u)),i.native?(delete i.native,c=t.nativeEvents||(t.nativeEvents={})):c=t.events||(t.events={});var l=Pr({value:n.trim(),dynamic:u},s);i!==r&&(l.modifiers=i);var h=c[e];Array.isArray(h)?a?h.unshift(l):h.push(l):c[e]=h?a?[l,h]:[h,l]:l,t.plain=!1}function kr(t,e,n){var r=Lr(t,":"+e)||Lr(t,"v-bind:"+e);if(null!=r)return Sr(r);if(!1!==n){var i=Lr(t,e);if(null!=i)return JSON.stringify(i)}}function Lr(t,e,n){var r;if(null!=(r=t.attrsMap[e]))for(var i=t.attrsList,a=0,o=i.length;a<o;a++)if(i[a].name===e){i.splice(a,1);break}return n&&delete t.attrsMap[e],r}function Dr(t,e){for(var n=t.attrsList,r=0,i=n.length;r<i;r++){var a=n[r];if(e.test(a.name))return n.splice(r,1),a}}function Pr(t,e){return e&&(null!=e.start&&(t.start=e.start),null!=e.end&&(t.end=e.end)),t}function Fr(t,e,n){var r=n||{},i=r.number,a="$$v";r.trim&&(a="(typeof $$v === 'string'? $$v.trim(): $$v)"),i&&(a="_n("+a+")");var o=Br(e,a);t.model={value:"("+e+")",expression:JSON.stringify(e),callback:"function ($$v) {"+o+"}"}}function Br(t,e){var n=function(t){if(t=t.trim(),mr=t.length,t.indexOf("[")<0||t.lastIndexOf("]")<mr-1)return(yr=t.lastIndexOf("."))>-1?{exp:t.slice(0,yr),key:'"'+t.slice(yr+1)+'"'}:{exp:t,key:null};for(vr=t,yr=xr=br=0;!Ur();)jr(gr=zr())?Vr(gr):91===gr&&Wr(gr);return{exp:t.slice(0,xr),key:t.slice(xr+1,br)}}(t);return null===n.key?t+"="+e:"$set("+n.exp+", "+n.key+", "+e+")"}function zr(){return vr.charCodeAt(++yr)}function Ur(){return yr>=mr}function jr(t){return 34===t||39===t}function Wr(t){var e=1;for(xr=yr;!Ur();)if(jr(t=zr()))Vr(t);else if(91===t&&e++,93===t&&e--,0===e){br=yr;break}}function Vr(t){for(var e=t;!Ur()&&(t=zr())!==e;);}var Hr,Gr="__r";function qr(t,e,n){var r=Hr;return function i(){null!==e.apply(null,arguments)&&Yr(t,i,n,r)}}var Xr=Xt&&!(tt&&Number(tt[1])<=53);function $r(t,e,n,r){if(Xr){var i=sn,a=e;e=a._wrapper=function(t){if(t.target===t.currentTarget||t.timeStamp>=i||t.timeStamp<=0||t.target.ownerDocument!==document)return a.apply(this,arguments)}}Hr.addEventListener(t,e,nt?{capture:n,passive:r}:n)}function Yr(t,e,n,r){(r||Hr).removeEventListener(t,e._wrapper||e,n)}function Kr(t,e){if(!i(t.data.on)||!i(e.data.on)){var n=e.data.on||{},r=t.data.on||{};Hr=e.elm,function(t){if(a(t.__r)){var e=K?"change":"input";t[e]=[].concat(t.__r,t[e]||[]),delete t.__r}a(t.__c)&&(t.change=[].concat(t.__c,t.change||[]),delete t.__c)}(n),oe(n,r,$r,Yr,qr,e.context),Hr=void 0}}var Jr,Zr={create:Kr,update:Kr};function Qr(t,e){if(!i(t.data.domProps)||!i(e.data.domProps)){var n,r,o=e.elm,s=t.data.domProps||{},u=e.data.domProps||{};for(n in a(u.__ob__)&&(u=e.data.domProps=N({},u)),s)n in u||(o[n]="");for(n in u){if(r=u[n],"textContent"===n||"innerHTML"===n){if(e.children&&(e.children.length=0),r===s[n])continue;1===o.childNodes.length&&o.removeChild(o.childNodes[0])}if("value"===n&&"PROGRESS"!==o.tagName){o._value=r;var c=i(r)?"":String(r);ti(o,c)&&(o.value=c)}else if("innerHTML"===n&&Hn(o.tagName)&&i(o.innerHTML)){(Jr=Jr||document.createElement("div")).innerHTML="<svg>"+r+"</svg>";for(var l=Jr.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;l.firstChild;)o.appendChild(l.firstChild)}else if(r!==s[n])try{o[n]=r}catch(t){}}}}function ti(t,e){return!t.composing&&("OPTION"===t.tagName||function(t,e){var n=!0;try{n=document.activeElement!==t}catch(t){}return n&&t.value!==e}(t,e)||function(t,e){var n=t.value,r=t._vModifiers;if(a(r)){if(r.number)return d(n)!==d(e);if(r.trim)return n.trim()!==e.trim()}return n!==e}(t,e))}var ei={create:Qr,update:Qr},ni=w((function(t){var e={},n=/:(.+)/;return t.split(/;(?![^(]*\))/g).forEach((function(t){if(t){var r=t.split(n);r.length>1&&(e[r[0].trim()]=r[1].trim())}})),e}));function ri(t){var e=ii(t.style);return t.staticStyle?N(t.staticStyle,e):e}function ii(t){return Array.isArray(t)?I(t):"string"==typeof t?ni(t):t}var ai,oi=/^--/,si=/\s*!important$/,ui=function(t,e,n){if(oi.test(e))t.style.setProperty(e,n);else if(si.test(n))t.style.setProperty(T(e),n.replace(si,""),"important");else{var r=li(e);if(Array.isArray(n))for(var i=0,a=n.length;i<a;i++)t.style[r]=n[i];else t.style[r]=n}},ci=["Webkit","Moz","ms"],li=w((function(t){if(ai=ai||document.createElement("div").style,"filter"!==(t=S(t))&&t in ai)return t;for(var e=t.charAt(0).toUpperCase()+t.slice(1),n=0;n<ci.length;n++){var r=ci[n]+e;if(r in ai)return r}}));function hi(t,e){var n=e.data,r=t.data;if(!(i(n.staticStyle)&&i(n.style)&&i(r.staticStyle)&&i(r.style))){var o,s,u=e.elm,c=r.staticStyle,l=r.normalizedStyle||r.style||{},h=c||l,p=ii(e.data.style)||{};e.data.normalizedStyle=a(p.__ob__)?N({},p):p;var f=function(t,e){for(var n,r={},i=t;i.componentInstance;)(i=i.componentInstance._vnode)&&i.data&&(n=ri(i.data))&&N(r,n);(n=ri(t.data))&&N(r,n);for(var a=t;a=a.parent;)a.data&&(n=ri(a.data))&&N(r,n);return r}(e);for(s in h)i(f[s])&&ui(u,s,"");for(s in f)(o=f[s])!==h[s]&&ui(u,s,null==o?"":o)}}var pi={create:hi,update:hi},fi=/\s+/;function di(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(fi).forEach((function(e){return t.classList.add(e)})):t.classList.add(e);else{var n=" "+(t.getAttribute("class")||"")+" ";n.indexOf(" "+e+" ")<0&&t.setAttribute("class",(n+e).trim())}}function mi(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(fi).forEach((function(e){return t.classList.remove(e)})):t.classList.remove(e),t.classList.length||t.removeAttribute("class");else{for(var n=" "+(t.getAttribute("class")||"")+" ",r=" "+e+" ";n.indexOf(r)>=0;)n=n.replace(r," ");(n=n.trim())?t.setAttribute("class",n):t.removeAttribute("class")}}function vi(t){if(t){if("object"==typeof t){var e={};return!1!==t.css&&N(e,gi(t.name||"v")),N(e,t),e}return"string"==typeof t?gi(t):void 0}}var gi=w((function(t){return{enterClass:t+"-enter",enterToClass:t+"-enter-to",enterActiveClass:t+"-enter-active",leaveClass:t+"-leave",leaveToClass:t+"-leave-to",leaveActiveClass:t+"-leave-active"}})),yi=q&&!J,xi="transition",bi="animation",wi="transition",_i="transitionend",Si="animation",Mi="animationend";yi&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(wi="WebkitTransition",_i="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(Si="WebkitAnimation",Mi="webkitAnimationEnd"));var Ei=q?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(t){return t()};function Ti(t){Ei((function(){Ei(t)}))}function Ci(t,e){var n=t._transitionClasses||(t._transitionClasses=[]);n.indexOf(e)<0&&(n.push(e),di(t,e))}function Ai(t,e){t._transitionClasses&&y(t._transitionClasses,e),mi(t,e)}function Ni(t,e,n){var r=Ri(t,e),i=r.type,a=r.timeout,o=r.propCount;if(!i)return n();var s=i===xi?_i:Mi,u=0,c=function(){t.removeEventListener(s,l),n()},l=function(e){e.target===t&&++u>=o&&c()};setTimeout((function(){u<o&&c()}),a+1),t.addEventListener(s,l)}var Ii=/\b(transform|all)(,|$)/;function Ri(t,e){var n,r=window.getComputedStyle(t),i=(r[wi+"Delay"]||"").split(", "),a=(r[wi+"Duration"]||"").split(", "),o=Oi(i,a),s=(r[Si+"Delay"]||"").split(", "),u=(r[Si+"Duration"]||"").split(", "),c=Oi(s,u),l=0,h=0;return e===xi?o>0&&(n=xi,l=o,h=a.length):e===bi?c>0&&(n=bi,l=c,h=u.length):h=(n=(l=Math.max(o,c))>0?o>c?xi:bi:null)?n===xi?a.length:u.length:0,{type:n,timeout:l,propCount:h,hasTransform:n===xi&&Ii.test(r[wi+"Property"])}}function Oi(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max.apply(null,e.map((function(e,n){return ki(e)+ki(t[n])})))}function ki(t){return 1e3*Number(t.slice(0,-1).replace(",","."))}function Li(t,e){var n=t.elm;a(n._leaveCb)&&(n._leaveCb.cancelled=!0,n._leaveCb());var r=vi(t.data.transition);if(!i(r)&&!a(n._enterCb)&&1===n.nodeType){for(var o=r.css,s=r.type,c=r.enterClass,l=r.enterToClass,h=r.enterActiveClass,p=r.appearClass,f=r.appearToClass,m=r.appearActiveClass,v=r.beforeEnter,g=r.enter,y=r.afterEnter,x=r.enterCancelled,b=r.beforeAppear,w=r.appear,_=r.afterAppear,S=r.appearCancelled,M=r.duration,E=Ye,T=Ye.$vnode;T&&T.parent;)E=T.context,T=T.parent;var C=!E._isMounted||!t.isRootInsert;if(!C||w||""===w){var A=C&&p?p:c,N=C&&m?m:h,I=C&&f?f:l,R=C&&b||v,O=C&&"function"==typeof w?w:g,k=C&&_||y,L=C&&S||x,D=d(u(M)?M.enter:M),F=!1!==o&&!J,B=Fi(O),z=n._enterCb=P((function(){F&&(Ai(n,I),Ai(n,N)),z.cancelled?(F&&Ai(n,A),L&&L(n)):k&&k(n),n._enterCb=null}));t.data.show||se(t,"insert",(function(){var e=n.parentNode,r=e&&e._pending&&e._pending[t.key];r&&r.tag===t.tag&&r.elm._leaveCb&&r.elm._leaveCb(),O&&O(n,z)})),R&&R(n),F&&(Ci(n,A),Ci(n,N),Ti((function(){Ai(n,A),z.cancelled||(Ci(n,I),B||(Pi(D)?setTimeout(z,D):Ni(n,s,z)))}))),t.data.show&&(e&&e(),O&&O(n,z)),F||B||z()}}}function Di(t,e){var n=t.elm;a(n._enterCb)&&(n._enterCb.cancelled=!0,n._enterCb());var r=vi(t.data.transition);if(i(r)||1!==n.nodeType)return e();if(!a(n._leaveCb)){var o=r.css,s=r.type,c=r.leaveClass,l=r.leaveToClass,h=r.leaveActiveClass,p=r.beforeLeave,f=r.leave,m=r.afterLeave,v=r.leaveCancelled,g=r.delayLeave,y=r.duration,x=!1!==o&&!J,b=Fi(f),w=d(u(y)?y.leave:y),_=n._leaveCb=P((function(){n.parentNode&&n.parentNode._pending&&(n.parentNode._pending[t.key]=null),x&&(Ai(n,l),Ai(n,h)),_.cancelled?(x&&Ai(n,c),v&&v(n)):(e(),m&&m(n)),n._leaveCb=null}));g?g(S):S()}function S(){_.cancelled||(!t.data.show&&n.parentNode&&((n.parentNode._pending||(n.parentNode._pending={}))[t.key]=t),p&&p(n),x&&(Ci(n,c),Ci(n,h),Ti((function(){Ai(n,c),_.cancelled||(Ci(n,l),b||(Pi(w)?setTimeout(_,w):Ni(n,s,_)))}))),f&&f(n,_),x||b||_())}}function Pi(t){return"number"==typeof t&&!isNaN(t)}function Fi(t){if(i(t))return!1;var e=t.fns;return a(e)?Fi(Array.isArray(e)?e[0]:e):(t._length||t.length)>1}function Bi(t,e){!0!==e.data.show&&Li(e)}var zi=function(t){var e,n,r={},u=t.modules,c=t.nodeOps;for(e=0;e<tr.length;++e)for(r[tr[e]]=[],n=0;n<u.length;++n)a(u[n][tr[e]])&&r[tr[e]].push(u[n][tr[e]]);function l(t){var e=c.parentNode(t);a(e)&&c.removeChild(e,t)}function h(t,e,n,i,s,u,l){if(a(t.elm)&&a(u)&&(t=u[l]=xt(t)),t.isRootInsert=!s,!function(t,e,n,i){var s=t.data;if(a(s)){var u=a(t.componentInstance)&&s.keepAlive;if(a(s=s.hook)&&a(s=s.init)&&s(t,!1),a(t.componentInstance))return p(t,e),f(n,t.elm,i),o(u)&&function(t,e,n,i){for(var o,s=t;s.componentInstance;)if(a(o=(s=s.componentInstance._vnode).data)&&a(o=o.transition)){for(o=0;o<r.activate.length;++o)r.activate[o](Qn,s);e.push(s);break}f(n,t.elm,i)}(t,e,n,i),!0}}(t,e,n,i)){var h=t.data,m=t.children,v=t.tag;a(v)?(t.elm=t.ns?c.createElementNS(t.ns,v):c.createElement(v,t),y(t),d(t,m,e),a(h)&&g(t,e),f(n,t.elm,i)):o(t.isComment)?(t.elm=c.createComment(t.text),f(n,t.elm,i)):(t.elm=c.createTextNode(t.text),f(n,t.elm,i))}}function p(t,e){a(t.data.pendingInsert)&&(e.push.apply(e,t.data.pendingInsert),t.data.pendingInsert=null),t.elm=t.componentInstance.$el,v(t)?(g(t,e),y(t)):(Zn(t),e.push(t))}function f(t,e,n){a(t)&&(a(n)?c.parentNode(n)===t&&c.insertBefore(t,e,n):c.appendChild(t,e))}function d(t,e,n){if(Array.isArray(e))for(var r=0;r<e.length;++r)h(e[r],n,t.elm,null,!0,e,r);else s(t.text)&&c.appendChild(t.elm,c.createTextNode(String(t.text)))}function v(t){for(;t.componentInstance;)t=t.componentInstance._vnode;return a(t.tag)}function g(t,n){for(var i=0;i<r.create.length;++i)r.create[i](Qn,t);a(e=t.data.hook)&&(a(e.create)&&e.create(Qn,t),a(e.insert)&&n.push(t))}function y(t){var e;if(a(e=t.fnScopeId))c.setStyleScope(t.elm,e);else for(var n=t;n;)a(e=n.context)&&a(e=e.$options._scopeId)&&c.setStyleScope(t.elm,e),n=n.parent;a(e=Ye)&&e!==t.context&&e!==t.fnContext&&a(e=e.$options._scopeId)&&c.setStyleScope(t.elm,e)}function x(t,e,n,r,i,a){for(;r<=i;++r)h(n[r],a,t,e,!1,n,r)}function b(t){var e,n,i=t.data;if(a(i))for(a(e=i.hook)&&a(e=e.destroy)&&e(t),e=0;e<r.destroy.length;++e)r.destroy[e](t);if(a(e=t.children))for(n=0;n<t.children.length;++n)b(t.children[n])}function w(t,e,n){for(;e<=n;++e){var r=t[e];a(r)&&(a(r.tag)?(_(r),b(r)):l(r.elm))}}function _(t,e){if(a(e)||a(t.data)){var n,i=r.remove.length+1;for(a(e)?e.listeners+=i:e=function(t,e){function n(){0==--n.listeners&&l(t)}return n.listeners=e,n}(t.elm,i),a(n=t.componentInstance)&&a(n=n._vnode)&&a(n.data)&&_(n,e),n=0;n<r.remove.length;++n)r.remove[n](t,e);a(n=t.data.hook)&&a(n=n.remove)?n(t,e):e()}else l(t.elm)}function S(t,e,n,r){for(var i=n;i<r;i++){var o=e[i];if(a(o)&&er(t,o))return i}}function M(t,e,n,s,u,l){if(t!==e){a(e.elm)&&a(s)&&(e=s[u]=xt(e));var p=e.elm=t.elm;if(o(t.isAsyncPlaceholder))a(e.asyncFactory.resolved)?C(t.elm,e,n):e.isAsyncPlaceholder=!0;else if(o(e.isStatic)&&o(t.isStatic)&&e.key===t.key&&(o(e.isCloned)||o(e.isOnce)))e.componentInstance=t.componentInstance;else{var f,d=e.data;a(d)&&a(f=d.hook)&&a(f=f.prepatch)&&f(t,e);var m=t.children,g=e.children;if(a(d)&&v(e)){for(f=0;f<r.update.length;++f)r.update[f](t,e);a(f=d.hook)&&a(f=f.update)&&f(t,e)}i(e.text)?a(m)&&a(g)?m!==g&&function(t,e,n,r,o){for(var s,u,l,p=0,f=0,d=e.length-1,m=e[0],v=e[d],g=n.length-1,y=n[0],b=n[g],_=!o;p<=d&&f<=g;)i(m)?m=e[++p]:i(v)?v=e[--d]:er(m,y)?(M(m,y,r,n,f),m=e[++p],y=n[++f]):er(v,b)?(M(v,b,r,n,g),v=e[--d],b=n[--g]):er(m,b)?(M(m,b,r,n,g),_&&c.insertBefore(t,m.elm,c.nextSibling(v.elm)),m=e[++p],b=n[--g]):er(v,y)?(M(v,y,r,n,f),_&&c.insertBefore(t,v.elm,m.elm),v=e[--d],y=n[++f]):(i(s)&&(s=nr(e,p,d)),i(u=a(y.key)?s[y.key]:S(y,e,p,d))?h(y,r,t,m.elm,!1,n,f):er(l=e[u],y)?(M(l,y,r,n,f),e[u]=void 0,_&&c.insertBefore(t,l.elm,m.elm)):h(y,r,t,m.elm,!1,n,f),y=n[++f]);p>d?x(t,i(n[g+1])?null:n[g+1].elm,n,f,g,r):f>g&&w(e,p,d)}(p,m,g,n,l):a(g)?(a(t.text)&&c.setTextContent(p,""),x(p,null,g,0,g.length-1,n)):a(m)?w(m,0,m.length-1):a(t.text)&&c.setTextContent(p,""):t.text!==e.text&&c.setTextContent(p,e.text),a(d)&&a(f=d.hook)&&a(f=f.postpatch)&&f(t,e)}}}function E(t,e,n){if(o(n)&&a(t.parent))t.parent.data.pendingInsert=e;else for(var r=0;r<e.length;++r)e[r].data.hook.insert(e[r])}var T=m("attrs,class,staticClass,staticStyle,key");function C(t,e,n,r){var i,s=e.tag,u=e.data,c=e.children;if(r=r||u&&u.pre,e.elm=t,o(e.isComment)&&a(e.asyncFactory))return e.isAsyncPlaceholder=!0,!0;if(a(u)&&(a(i=u.hook)&&a(i=i.init)&&i(e,!0),a(i=e.componentInstance)))return p(e,n),!0;if(a(s)){if(a(c))if(t.hasChildNodes())if(a(i=u)&&a(i=i.domProps)&&a(i=i.innerHTML)){if(i!==t.innerHTML)return!1}else{for(var l=!0,h=t.firstChild,f=0;f<c.length;f++){if(!h||!C(h,c[f],n,r)){l=!1;break}h=h.nextSibling}if(!l||h)return!1}else d(e,c,n);if(a(u)){var m=!1;for(var v in u)if(!T(v)){m=!0,g(e,n);break}!m&&u.class&&re(u.class)}}else t.data!==e.text&&(t.data=e.text);return!0}return function(t,e,n,s){if(!i(e)){var u,l=!1,p=[];if(i(t))l=!0,h(e,p);else{var f=a(t.nodeType);if(!f&&er(t,e))M(t,e,p,null,null,s);else{if(f){if(1===t.nodeType&&t.hasAttribute(F)&&(t.removeAttribute(F),n=!0),o(n)&&C(t,e,p))return E(e,p,!0),t;u=t,t=new mt(c.tagName(u).toLowerCase(),{},[],void 0,u)}var d=t.elm,m=c.parentNode(d);if(h(e,p,d._leaveCb?null:m,c.nextSibling(d)),a(e.parent))for(var g=e.parent,y=v(e);g;){for(var x=0;x<r.destroy.length;++x)r.destroy[x](g);if(g.elm=e.elm,y){for(var _=0;_<r.create.length;++_)r.create[_](Qn,g);var S=g.data.hook.insert;if(S.merged)for(var T=1;T<S.fns.length;T++)S.fns[T]()}else Zn(g);g=g.parent}a(m)?w([t],0,0):a(t.tag)&&b(t)}}return E(e,p,l),e.elm}a(t)&&b(t)}}({nodeOps:Kn,modules:[fr,wr,Zr,ei,pi,q?{create:Bi,activate:Bi,remove:function(t,e){!0!==t.data.show?Di(t,e):e()}}:{}].concat(cr)});J&&document.addEventListener("selectionchange",(function(){var t=document.activeElement;t&&t.vmodel&&Xi(t,"input")}));var Ui={inserted:function(t,e,n,r){"select"===n.tag?(r.elm&&!r.elm._vOptions?se(n,"postpatch",(function(){Ui.componentUpdated(t,e,n)})):ji(t,e,n.context),t._vOptions=[].map.call(t.options,Hi)):("textarea"===n.tag||$n(t.type))&&(t._vModifiers=e.modifiers,e.modifiers.lazy||(t.addEventListener("compositionstart",Gi),t.addEventListener("compositionend",qi),t.addEventListener("change",qi),J&&(t.vmodel=!0)))},componentUpdated:function(t,e,n){if("select"===n.tag){ji(t,e,n.context);var r=t._vOptions,i=t._vOptions=[].map.call(t.options,Hi);i.some((function(t,e){return!L(t,r[e])}))&&(t.multiple?e.value.some((function(t){return Vi(t,i)})):e.value!==e.oldValue&&Vi(e.value,i))&&Xi(t,"change")}}};function ji(t,e,n){Wi(t,e,n),(K||Z)&&setTimeout((function(){Wi(t,e,n)}),0)}function Wi(t,e,n){var r=e.value,i=t.multiple;if(!i||Array.isArray(r)){for(var a,o,s=0,u=t.options.length;s<u;s++)if(o=t.options[s],i)a=D(r,Hi(o))>-1,o.selected!==a&&(o.selected=a);else if(L(Hi(o),r))return void(t.selectedIndex!==s&&(t.selectedIndex=s));i||(t.selectedIndex=-1)}}function Vi(t,e){return e.every((function(e){return!L(e,t)}))}function Hi(t){return"_value"in t?t._value:t.value}function Gi(t){t.target.composing=!0}function qi(t){t.target.composing&&(t.target.composing=!1,Xi(t.target,"input"))}function Xi(t,e){var n=document.createEvent("HTMLEvents");n.initEvent(e,!0,!0),t.dispatchEvent(n)}function $i(t){return!t.componentInstance||t.data&&t.data.transition?t:$i(t.componentInstance._vnode)}var Yi={model:Ui,show:{bind:function(t,e,n){var r=e.value,i=(n=$i(n)).data&&n.data.transition,a=t.__vOriginalDisplay="none"===t.style.display?"":t.style.display;r&&i?(n.data.show=!0,Li(n,(function(){t.style.display=a}))):t.style.display=r?a:"none"},update:function(t,e,n){var r=e.value;!r!=!e.oldValue&&((n=$i(n)).data&&n.data.transition?(n.data.show=!0,r?Li(n,(function(){t.style.display=t.__vOriginalDisplay})):Di(n,(function(){t.style.display="none"}))):t.style.display=r?t.__vOriginalDisplay:"none")},unbind:function(t,e,n,r,i){i||(t.style.display=t.__vOriginalDisplay)}}},Ki={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function Ji(t){var e=t&&t.componentOptions;return e&&e.Ctor.options.abstract?Ji(He(e.children)):t}function Zi(t){var e={},n=t.$options;for(var r in n.propsData)e[r]=t[r];var i=n._parentListeners;for(var a in i)e[S(a)]=i[a];return e}function Qi(t,e){if(/\d-keep-alive$/.test(e.tag))return t("keep-alive",{props:e.componentOptions.propsData})}var ta=function(t){return t.tag||Ve(t)},ea=function(t){return"show"===t.name},na={name:"transition",props:Ki,abstract:!0,render:function(t){var e=this,n=this.$slots.default;if(n&&(n=n.filter(ta)).length){var r=this.mode,i=n[0];if(function(t){for(;t=t.parent;)if(t.data.transition)return!0}(this.$vnode))return i;var a=Ji(i);if(!a)return i;if(this._leaving)return Qi(t,i);var o="__transition-"+this._uid+"-";a.key=null==a.key?a.isComment?o+"comment":o+a.tag:s(a.key)?0===String(a.key).indexOf(o)?a.key:o+a.key:a.key;var u=(a.data||(a.data={})).transition=Zi(this),c=this._vnode,l=Ji(c);if(a.data.directives&&a.data.directives.some(ea)&&(a.data.show=!0),l&&l.data&&!function(t,e){return e.key===t.key&&e.tag===t.tag}(a,l)&&!Ve(l)&&(!l.componentInstance||!l.componentInstance._vnode.isComment)){var h=l.data.transition=N({},u);if("out-in"===r)return this._leaving=!0,se(h,"afterLeave",(function(){e._leaving=!1,e.$forceUpdate()})),Qi(t,i);if("in-out"===r){if(Ve(a))return c;var p,f=function(){p()};se(u,"afterEnter",f),se(u,"enterCancelled",f),se(h,"delayLeave",(function(t){p=t}))}}return i}}},ra=N({tag:String,moveClass:String},Ki);function ia(t){t.elm._moveCb&&t.elm._moveCb(),t.elm._enterCb&&t.elm._enterCb()}function aa(t){t.data.newPos=t.elm.getBoundingClientRect()}function oa(t){var e=t.data.pos,n=t.data.newPos,r=e.left-n.left,i=e.top-n.top;if(r||i){t.data.moved=!0;var a=t.elm.style;a.transform=a.WebkitTransform="translate("+r+"px,"+i+"px)",a.transitionDuration="0s"}}delete ra.mode;var sa={Transition:na,TransitionGroup:{props:ra,beforeMount:function(){var t=this,e=this._update;this._update=function(n,r){var i=Ke(t);t.__patch__(t._vnode,t.kept,!1,!0),t._vnode=t.kept,i(),e.call(t,n,r)}},render:function(t){for(var e=this.tag||this.$vnode.data.tag||"span",n=Object.create(null),r=this.prevChildren=this.children,i=this.$slots.default||[],a=this.children=[],o=Zi(this),s=0;s<i.length;s++){var u=i[s];u.tag&&null!=u.key&&0!==String(u.key).indexOf("__vlist")&&(a.push(u),n[u.key]=u,(u.data||(u.data={})).transition=o)}if(r){for(var c=[],l=[],h=0;h<r.length;h++){var p=r[h];p.data.transition=o,p.data.pos=p.elm.getBoundingClientRect(),n[p.key]?c.push(p):l.push(p)}this.kept=t(e,null,c),this.removed=l}return t(e,null,a)},updated:function(){var t=this.prevChildren,e=this.moveClass||(this.name||"v")+"-move";t.length&&this.hasMove(t[0].elm,e)&&(t.forEach(ia),t.forEach(aa),t.forEach(oa),this._reflow=document.body.offsetHeight,t.forEach((function(t){if(t.data.moved){var n=t.elm,r=n.style;Ci(n,e),r.transform=r.WebkitTransform=r.transitionDuration="",n.addEventListener(_i,n._moveCb=function t(r){r&&r.target!==n||r&&!/transform$/.test(r.propertyName)||(n.removeEventListener(_i,t),n._moveCb=null,Ai(n,e))})}})))},methods:{hasMove:function(t,e){if(!yi)return!1;if(this._hasMove)return this._hasMove;var n=t.cloneNode();t._transitionClasses&&t._transitionClasses.forEach((function(t){mi(n,t)})),di(n,e),n.style.display="none",this.$el.appendChild(n);var r=Ri(n);return this.$el.removeChild(n),this._hasMove=r.hasTransform}}}};_n.config.mustUseProp=Rn,_n.config.isReservedTag=Gn,_n.config.isReservedAttr=Nn,_n.config.getTagNamespace=qn,_n.config.isUnknownElement=function(t){if(!q)return!0;if(Gn(t))return!1;if(t=t.toLowerCase(),null!=Xn[t])return Xn[t];var e=document.createElement(t);return t.indexOf("-")>-1?Xn[t]=e.constructor===window.HTMLUnknownElement||e.constructor===window.HTMLElement:Xn[t]=/HTMLUnknownElement/.test(e.toString())},N(_n.options.directives,Yi),N(_n.options.components,sa),_n.prototype.__patch__=q?zi:R,_n.prototype.$mount=function(t,e){return function(t,e,n){var r;return t.$el=e,t.$options.render||(t.$options.render=gt),Qe(t,"beforeMount"),r=function(){t._update(t._render(),n)},new pn(t,r,R,{before:function(){t._isMounted&&!t._isDestroyed&&Qe(t,"beforeUpdate")}},!0),n=!1,null==t.$vnode&&(t._isMounted=!0,Qe(t,"mounted")),t}(this,t=t&&q?Yn(t):void 0,e)},q&&setTimeout((function(){U.devtools&&at&&at.emit("init",_n)}),0);var ua,ca=/\{\{((?:.|\r?\n)+?)\}\}/g,la=/[-.*+?^${}()|[\]\/\\]/g,ha=w((function(t){var e=t[0].replace(la,"\\$&"),n=t[1].replace(la,"\\$&");return new RegExp(e+"((?:.|\\n)+?)"+n,"g")})),pa={staticKeys:["staticClass"],transformNode:function(t,e){e.warn;var n=Lr(t,"class");n&&(t.staticClass=JSON.stringify(n));var r=kr(t,"class",!1);r&&(t.classBinding=r)},genData:function(t){var e="";return t.staticClass&&(e+="staticClass:"+t.staticClass+","),t.classBinding&&(e+="class:"+t.classBinding+","),e}},fa={staticKeys:["staticStyle"],transformNode:function(t,e){e.warn;var n=Lr(t,"style");n&&(t.staticStyle=JSON.stringify(ni(n)));var r=kr(t,"style",!1);r&&(t.styleBinding=r)},genData:function(t){var e="";return t.staticStyle&&(e+="staticStyle:"+t.staticStyle+","),t.styleBinding&&(e+="style:("+t.styleBinding+"),"),e}},da=m("area,base,br,col,embed,frame,hr,img,input,isindex,keygen,link,meta,param,source,track,wbr"),ma=m("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr,source"),va=m("address,article,aside,base,blockquote,body,caption,col,colgroup,dd,details,dialog,div,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,head,header,hgroup,hr,html,legend,li,menuitem,meta,optgroup,option,param,rp,rt,source,style,summary,tbody,td,tfoot,th,thead,title,tr,track"),ga=/^\s*([^\s"'<>\/=]+)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,ya=/^\s*((?:v-[\w-]+:|@|:|#)\[[^=]+\][^\s"'<>\/=]*)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,xa="[a-zA-Z_][\\-\\.0-9_a-zA-Z"+j.source+"]*",ba="((?:"+xa+"\\:)?"+xa+")",wa=new RegExp("^<"+ba),_a=/^\s*(\/?)>/,Sa=new RegExp("^<\\/"+ba+"[^>]*>"),Ma=/^<!DOCTYPE [^>]+>/i,Ea=/^<!\--/,Ta=/^<!\[/,Ca=m("script,style,textarea",!0),Aa={},Na={"&lt;":"<","&gt;":">","&quot;":'"',"&amp;":"&","&#10;":"\n","&#9;":"\t","&#39;":"'"},Ia=/&(?:lt|gt|quot|amp|#39);/g,Ra=/&(?:lt|gt|quot|amp|#39|#10|#9);/g,Oa=m("pre,textarea",!0),ka=function(t,e){return t&&Oa(t)&&"\n"===e[0]};function La(t,e){var n=e?Ra:Ia;return t.replace(n,(function(t){return Na[t]}))}var Da,Pa,Fa,Ba,za,Ua,ja,Wa,Va=/^@|^v-on:/,Ha=/^v-|^@|^:|^#/,Ga=/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/,qa=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,Xa=/^\(|\)$/g,$a=/^\[.*\]$/,Ya=/:(.*)$/,Ka=/^:|^\.|^v-bind:/,Ja=/\.[^.\]]+(?=[^\]]*$)/g,Za=/^v-slot(:|$)|^#/,Qa=/[\r\n]/,to=/\s+/g,eo=w((function(t){return(ua=ua||document.createElement("div")).innerHTML=t,ua.textContent})),no="_empty_";function ro(t,e,n){return{type:1,tag:t,attrsList:e,attrsMap:co(e),rawAttrsMap:{},parent:n,children:[]}}function io(t,e){var n,r;(r=kr(n=t,"key"))&&(n.key=r),t.plain=!t.key&&!t.scopedSlots&&!t.attrsList.length,function(t){var e=kr(t,"ref");e&&(t.ref=e,t.refInFor=function(t){for(var e=t;e;){if(void 0!==e.for)return!0;e=e.parent}return!1}(t))}(t),function(t){var e;"template"===t.tag?(e=Lr(t,"scope"),t.slotScope=e||Lr(t,"slot-scope")):(e=Lr(t,"slot-scope"))&&(t.slotScope=e);var n=kr(t,"slot");if(n&&(t.slotTarget='""'===n?'"default"':n,t.slotTargetDynamic=!(!t.attrsMap[":slot"]&&!t.attrsMap["v-bind:slot"]),"template"===t.tag||t.slotScope||Ar(t,"slot",n,function(t,e){return t.rawAttrsMap[":"+e]||t.rawAttrsMap["v-bind:"+e]||t.rawAttrsMap[e]}(t,"slot"))),"template"===t.tag){var r=Dr(t,Za);if(r){var i=so(r),a=i.name,o=i.dynamic;t.slotTarget=a,t.slotTargetDynamic=o,t.slotScope=r.value||no}}else{var s=Dr(t,Za);if(s){var u=t.scopedSlots||(t.scopedSlots={}),c=so(s),l=c.name,h=c.dynamic,p=u[l]=ro("template",[],t);p.slotTarget=l,p.slotTargetDynamic=h,p.children=t.children.filter((function(t){if(!t.slotScope)return t.parent=p,!0})),p.slotScope=s.value||no,t.children=[],t.plain=!1}}}(t),function(t){"slot"===t.tag&&(t.slotName=kr(t,"name"))}(t),function(t){var e;(e=kr(t,"is"))&&(t.component=e),null!=Lr(t,"inline-template")&&(t.inlineTemplate=!0)}(t);for(var i=0;i<Fa.length;i++)t=Fa[i](t,e)||t;return function(t){var e,n,r,i,a,o,s,u,c=t.attrsList;for(e=0,n=c.length;e<n;e++)if(r=i=c[e].name,a=c[e].value,Ha.test(r))if(t.hasBindings=!0,(o=uo(r.replace(Ha,"")))&&(r=r.replace(Ja,"")),Ka.test(r))r=r.replace(Ka,""),a=Sr(a),(u=$a.test(r))&&(r=r.slice(1,-1)),o&&(o.prop&&!u&&"innerHtml"===(r=S(r))&&(r="innerHTML"),o.camel&&!u&&(r=S(r)),o.sync&&(s=Br(a,"$event"),u?Or(t,'"update:"+('+r+")",s,null,!1,0,c[e],!0):(Or(t,"update:"+S(r),s,null,!1,0,c[e]),T(r)!==S(r)&&Or(t,"update:"+T(r),s,null,!1,0,c[e])))),o&&o.prop||!t.component&&ja(t.tag,t.attrsMap.type,r)?Cr(t,r,a,c[e],u):Ar(t,r,a,c[e],u);else if(Va.test(r))r=r.replace(Va,""),(u=$a.test(r))&&(r=r.slice(1,-1)),Or(t,r,a,o,!1,0,c[e],u);else{var l=(r=r.replace(Ha,"")).match(Ya),h=l&&l[1];u=!1,h&&(r=r.slice(0,-(h.length+1)),$a.test(h)&&(h=h.slice(1,-1),u=!0)),Ir(t,r,i,a,h,u,o,c[e])}else Ar(t,r,JSON.stringify(a),c[e]),!t.component&&"muted"===r&&ja(t.tag,t.attrsMap.type,r)&&Cr(t,r,"true",c[e])}(t),t}function ao(t){var e;if(e=Lr(t,"v-for")){var n=function(t){var e=t.match(Ga);if(e){var n={};n.for=e[2].trim();var r=e[1].trim().replace(Xa,""),i=r.match(qa);return i?(n.alias=r.replace(qa,"").trim(),n.iterator1=i[1].trim(),i[2]&&(n.iterator2=i[2].trim())):n.alias=r,n}}(e);n&&N(t,n)}}function oo(t,e){t.ifConditions||(t.ifConditions=[]),t.ifConditions.push(e)}function so(t){var e=t.name.replace(Za,"");return e||"#"!==t.name[0]&&(e="default"),$a.test(e)?{name:e.slice(1,-1),dynamic:!0}:{name:'"'+e+'"',dynamic:!1}}function uo(t){var e=t.match(Ja);if(e){var n={};return e.forEach((function(t){n[t.slice(1)]=!0})),n}}function co(t){for(var e={},n=0,r=t.length;n<r;n++)e[t[n].name]=t[n].value;return e}var lo=/^xmlns:NS\d+/,ho=/^NS\d+:/;function po(t){return ro(t.tag,t.attrsList.slice(),t.parent)}var fo,mo,vo=[pa,fa,{preTransformNode:function(t,e){if("input"===t.tag){var n,r=t.attrsMap;if(!r["v-model"])return;if((r[":type"]||r["v-bind:type"])&&(n=kr(t,"type")),r.type||n||!r["v-bind"]||(n="("+r["v-bind"]+").type"),n){var i=Lr(t,"v-if",!0),a=i?"&&("+i+")":"",o=null!=Lr(t,"v-else",!0),s=Lr(t,"v-else-if",!0),u=po(t);ao(u),Nr(u,"type","checkbox"),io(u,e),u.processed=!0,u.if="("+n+")==='checkbox'"+a,oo(u,{exp:u.if,block:u});var c=po(t);Lr(c,"v-for",!0),Nr(c,"type","radio"),io(c,e),oo(u,{exp:"("+n+")==='radio'"+a,block:c});var l=po(t);return Lr(l,"v-for",!0),Nr(l,":type",n),io(l,e),oo(u,{exp:i,block:l}),o?u.else=!0:s&&(u.elseif=s),u}}}}],go={expectHTML:!0,modules:vo,directives:{model:function(t,e,n){var r=e.value,i=e.modifiers,a=t.tag,o=t.attrsMap.type;if(t.component)return Fr(t,r,i),!1;if("select"===a)!function(t,e,n){var r='var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = "_value" in o ? o._value : o.value;return '+(n&&n.number?"_n(val)":"val")+"});";Or(t,"change",r=r+" "+Br(e,"$event.target.multiple ? $$selectedVal : $$selectedVal[0]"),null,!0)}(t,r,i);else if("input"===a&&"checkbox"===o)!function(t,e,n){var r=n&&n.number,i=kr(t,"value")||"null",a=kr(t,"true-value")||"true",o=kr(t,"false-value")||"false";Cr(t,"checked","Array.isArray("+e+")?_i("+e+","+i+")>-1"+("true"===a?":("+e+")":":_q("+e+","+a+")")),Or(t,"change","var $$a="+e+",$$el=$event.target,$$c=$$el.checked?("+a+"):("+o+");if(Array.isArray($$a)){var $$v="+(r?"_n("+i+")":i)+",$$i=_i($$a,$$v);if($$el.checked){$$i<0&&("+Br(e,"$$a.concat([$$v])")+")}else{$$i>-1&&("+Br(e,"$$a.slice(0,$$i).concat($$a.slice($$i+1))")+")}}else{"+Br(e,"$$c")+"}",null,!0)}(t,r,i);else if("input"===a&&"radio"===o)!function(t,e,n){var r=n&&n.number,i=kr(t,"value")||"null";Cr(t,"checked","_q("+e+","+(i=r?"_n("+i+")":i)+")"),Or(t,"change",Br(e,i),null,!0)}(t,r,i);else if("input"===a||"textarea"===a)!function(t,e,n){var r=t.attrsMap.type,i=n||{},a=i.lazy,o=i.number,s=i.trim,u=!a&&"range"!==r,c=a?"change":"range"===r?Gr:"input",l="$event.target.value";s&&(l="$event.target.value.trim()"),o&&(l="_n("+l+")");var h=Br(e,l);u&&(h="if($event.target.composing)return;"+h),Cr(t,"value","("+e+")"),Or(t,c,h,null,!0),(s||o)&&Or(t,"blur","$forceUpdate()")}(t,r,i);else if(!U.isReservedTag(a))return Fr(t,r,i),!1;return!0},text:function(t,e){e.value&&Cr(t,"textContent","_s("+e.value+")",e)},html:function(t,e){e.value&&Cr(t,"innerHTML","_s("+e.value+")",e)}},isPreTag:function(t){return"pre"===t},isUnaryTag:da,mustUseProp:Rn,canBeLeftOpenTag:ma,isReservedTag:Gn,getTagNamespace:qn,staticKeys:function(t){return t.reduce((function(t,e){return t.concat(e.staticKeys||[])}),[]).join(",")}(vo)},yo=w((function(t){return m("type,tag,attrsList,attrsMap,plain,parent,children,attrs,start,end,rawAttrsMap"+(t?","+t:""))}));var xo=/^([\w$_]+|\([^)]*?\))\s*=>|^function(?:\s+[\w$]+)?\s*\(/,bo=/\([^)]*?\);*$/,wo=/^[A-Za-z_$][\w$]*(?:\.[A-Za-z_$][\w$]*|\['[^']*?']|\["[^"]*?"]|\[\d+]|\[[A-Za-z_$][\w$]*])*$/,_o={esc:27,tab:9,enter:13,space:32,up:38,left:37,right:39,down:40,delete:[8,46]},So={esc:["Esc","Escape"],tab:"Tab",enter:"Enter",space:[" ","Spacebar"],up:["Up","ArrowUp"],left:["Left","ArrowLeft"],right:["Right","ArrowRight"],down:["Down","ArrowDown"],delete:["Backspace","Delete","Del"]},Mo=function(t){return"if("+t+")return null;"},Eo={stop:"$event.stopPropagation();",prevent:"$event.preventDefault();",self:Mo("$event.target !== $event.currentTarget"),ctrl:Mo("!$event.ctrlKey"),shift:Mo("!$event.shiftKey"),alt:Mo("!$event.altKey"),meta:Mo("!$event.metaKey"),left:Mo("'button' in $event && $event.button !== 0"),middle:Mo("'button' in $event && $event.button !== 1"),right:Mo("'button' in $event && $event.button !== 2")};function To(t,e){var n=e?"nativeOn:":"on:",r="",i="";for(var a in t){var o=Co(t[a]);t[a]&&t[a].dynamic?i+=a+","+o+",":r+='"'+a+'":'+o+","}return r="{"+r.slice(0,-1)+"}",i?n+"_d("+r+",["+i.slice(0,-1)+"])":n+r}function Co(t){if(!t)return"function(){}";if(Array.isArray(t))return"["+t.map((function(t){return Co(t)})).join(",")+"]";var e=wo.test(t.value),n=xo.test(t.value),r=wo.test(t.value.replace(bo,""));if(t.modifiers){var i="",a="",o=[];for(var s in t.modifiers)if(Eo[s])a+=Eo[s],_o[s]&&o.push(s);else if("exact"===s){var u=t.modifiers;a+=Mo(["ctrl","shift","alt","meta"].filter((function(t){return!u[t]})).map((function(t){return"$event."+t+"Key"})).join("||"))}else o.push(s);return o.length&&(i+=function(t){return"if(!$event.type.indexOf('key')&&"+t.map(Ao).join("&&")+")return null;"}(o)),a&&(i+=a),"function($event){"+i+(e?"return "+t.value+"($event)":n?"return ("+t.value+")($event)":r?"return "+t.value:t.value)+"}"}return e||n?t.value:"function($event){"+(r?"return "+t.value:t.value)+"}"}function Ao(t){var e=parseInt(t,10);if(e)return"$event.keyCode!=="+e;var n=_o[t],r=So[t];return"_k($event.keyCode,"+JSON.stringify(t)+","+JSON.stringify(n)+",$event.key,"+JSON.stringify(r)+")"}var No={on:function(t,e){t.wrapListeners=function(t){return"_g("+t+","+e.value+")"}},bind:function(t,e){t.wrapData=function(n){return"_b("+n+",'"+t.tag+"',"+e.value+","+(e.modifiers&&e.modifiers.prop?"true":"false")+(e.modifiers&&e.modifiers.sync?",true":"")+")"}},cloak:R},Io=function(t){this.options=t,this.warn=t.warn||Er,this.transforms=Tr(t.modules,"transformCode"),this.dataGenFns=Tr(t.modules,"genData"),this.directives=N(N({},No),t.directives);var e=t.isReservedTag||O;this.maybeComponent=function(t){return!!t.component||!e(t.tag)},this.onceId=0,this.staticRenderFns=[],this.pre=!1};function Ro(t,e){var n=new Io(e);return{render:"with(this){return "+(t?Oo(t,n):'_c("div")')+"}",staticRenderFns:n.staticRenderFns}}function Oo(t,e){if(t.parent&&(t.pre=t.pre||t.parent.pre),t.staticRoot&&!t.staticProcessed)return ko(t,e);if(t.once&&!t.onceProcessed)return Lo(t,e);if(t.for&&!t.forProcessed)return Po(t,e);if(t.if&&!t.ifProcessed)return Do(t,e);if("template"!==t.tag||t.slotTarget||e.pre){if("slot"===t.tag)return function(t,e){var n=t.slotName||'"default"',r=Uo(t,e),i="_t("+n+(r?","+r:""),a=t.attrs||t.dynamicAttrs?Vo((t.attrs||[]).concat(t.dynamicAttrs||[]).map((function(t){return{name:S(t.name),value:t.value,dynamic:t.dynamic}}))):null,o=t.attrsMap["v-bind"];return!a&&!o||r||(i+=",null"),a&&(i+=","+a),o&&(i+=(a?"":",null")+","+o),i+")"}(t,e);var n;if(t.component)n=function(t,e,n){var r=e.inlineTemplate?null:Uo(e,n,!0);return"_c("+t+","+Fo(e,n)+(r?","+r:"")+")"}(t.component,t,e);else{var r;(!t.plain||t.pre&&e.maybeComponent(t))&&(r=Fo(t,e));var i=t.inlineTemplate?null:Uo(t,e,!0);n="_c('"+t.tag+"'"+(r?","+r:"")+(i?","+i:"")+")"}for(var a=0;a<e.transforms.length;a++)n=e.transforms[a](t,n);return n}return Uo(t,e)||"void 0"}function ko(t,e){t.staticProcessed=!0;var n=e.pre;return t.pre&&(e.pre=t.pre),e.staticRenderFns.push("with(this){return "+Oo(t,e)+"}"),e.pre=n,"_m("+(e.staticRenderFns.length-1)+(t.staticInFor?",true":"")+")"}function Lo(t,e){if(t.onceProcessed=!0,t.if&&!t.ifProcessed)return Do(t,e);if(t.staticInFor){for(var n="",r=t.parent;r;){if(r.for){n=r.key;break}r=r.parent}return n?"_o("+Oo(t,e)+","+e.onceId+++","+n+")":Oo(t,e)}return ko(t,e)}function Do(t,e,n,r){return t.ifProcessed=!0,function t(e,n,r,i){if(!e.length)return i||"_e()";var a=e.shift();return a.exp?"("+a.exp+")?"+o(a.block)+":"+t(e,n,r,i):""+o(a.block);function o(t){return r?r(t,n):t.once?Lo(t,n):Oo(t,n)}}(t.ifConditions.slice(),e,n,r)}function Po(t,e,n,r){var i=t.for,a=t.alias,o=t.iterator1?","+t.iterator1:"",s=t.iterator2?","+t.iterator2:"";return t.forProcessed=!0,(r||"_l")+"(("+i+"),function("+a+o+s+"){return "+(n||Oo)(t,e)+"})"}function Fo(t,e){var n="{",r=function(t,e){var n=t.directives;if(n){var r,i,a,o,s="directives:[",u=!1;for(r=0,i=n.length;r<i;r++){a=n[r],o=!0;var c=e.directives[a.name];c&&(o=!!c(t,a,e.warn)),o&&(u=!0,s+='{name:"'+a.name+'",rawName:"'+a.rawName+'"'+(a.value?",value:("+a.value+"),expression:"+JSON.stringify(a.value):"")+(a.arg?",arg:"+(a.isDynamicArg?a.arg:'"'+a.arg+'"'):"")+(a.modifiers?",modifiers:"+JSON.stringify(a.modifiers):"")+"},")}return u?s.slice(0,-1)+"]":void 0}}(t,e);r&&(n+=r+","),t.key&&(n+="key:"+t.key+","),t.ref&&(n+="ref:"+t.ref+","),t.refInFor&&(n+="refInFor:true,"),t.pre&&(n+="pre:true,"),t.component&&(n+='tag:"'+t.tag+'",');for(var i=0;i<e.dataGenFns.length;i++)n+=e.dataGenFns[i](t);if(t.attrs&&(n+="attrs:"+Vo(t.attrs)+","),t.props&&(n+="domProps:"+Vo(t.props)+","),t.events&&(n+=To(t.events,!1)+","),t.nativeEvents&&(n+=To(t.nativeEvents,!0)+","),t.slotTarget&&!t.slotScope&&(n+="slot:"+t.slotTarget+","),t.scopedSlots&&(n+=function(t,e,n){var r=t.for||Object.keys(e).some((function(t){var n=e[t];return n.slotTargetDynamic||n.if||n.for||Bo(n)})),i=!!t.if;if(!r)for(var a=t.parent;a;){if(a.slotScope&&a.slotScope!==no||a.for){r=!0;break}a.if&&(i=!0),a=a.parent}var o=Object.keys(e).map((function(t){return zo(e[t],n)})).join(",");return"scopedSlots:_u(["+o+"]"+(r?",null,true":"")+(!r&&i?",null,false,"+function(t){for(var e=5381,n=t.length;n;)e=33*e^t.charCodeAt(--n);return e>>>0}(o):"")+")"}(t,t.scopedSlots,e)+","),t.model&&(n+="model:{value:"+t.model.value+",callback:"+t.model.callback+",expression:"+t.model.expression+"},"),t.inlineTemplate){var a=function(t,e){var n=t.children[0];if(n&&1===n.type){var r=Ro(n,e.options);return"inlineTemplate:{render:function(){"+r.render+"},staticRenderFns:["+r.staticRenderFns.map((function(t){return"function(){"+t+"}"})).join(",")+"]}"}}(t,e);a&&(n+=a+",")}return n=n.replace(/,$/,"")+"}",t.dynamicAttrs&&(n="_b("+n+',"'+t.tag+'",'+Vo(t.dynamicAttrs)+")"),t.wrapData&&(n=t.wrapData(n)),t.wrapListeners&&(n=t.wrapListeners(n)),n}function Bo(t){return 1===t.type&&("slot"===t.tag||t.children.some(Bo))}function zo(t,e){var n=t.attrsMap["slot-scope"];if(t.if&&!t.ifProcessed&&!n)return Do(t,e,zo,"null");if(t.for&&!t.forProcessed)return Po(t,e,zo);var r=t.slotScope===no?"":String(t.slotScope),i="function("+r+"){return "+("template"===t.tag?t.if&&n?"("+t.if+")?"+(Uo(t,e)||"undefined")+":undefined":Uo(t,e)||"undefined":Oo(t,e))+"}",a=r?"":",proxy:true";return"{key:"+(t.slotTarget||'"default"')+",fn:"+i+a+"}"}function Uo(t,e,n,r,i){var a=t.children;if(a.length){var o=a[0];if(1===a.length&&o.for&&"template"!==o.tag&&"slot"!==o.tag){var s=n?e.maybeComponent(o)?",1":",0":"";return""+(r||Oo)(o,e)+s}var u=n?function(t,e){for(var n=0,r=0;r<t.length;r++){var i=t[r];if(1===i.type){if(jo(i)||i.ifConditions&&i.ifConditions.some((function(t){return jo(t.block)}))){n=2;break}(e(i)||i.ifConditions&&i.ifConditions.some((function(t){return e(t.block)})))&&(n=1)}}return n}(a,e.maybeComponent):0,c=i||Wo;return"["+a.map((function(t){return c(t,e)})).join(",")+"]"+(u?","+u:"")}}function jo(t){return void 0!==t.for||"template"===t.tag||"slot"===t.tag}function Wo(t,e){return 1===t.type?Oo(t,e):3===t.type&&t.isComment?(r=t,"_e("+JSON.stringify(r.text)+")"):"_v("+(2===(n=t).type?n.expression:Ho(JSON.stringify(n.text)))+")";var n,r}function Vo(t){for(var e="",n="",r=0;r<t.length;r++){var i=t[r],a=Ho(i.value);i.dynamic?n+=i.name+","+a+",":e+='"'+i.name+'":'+a+","}return e="{"+e.slice(0,-1)+"}",n?"_d("+e+",["+n.slice(0,-1)+"])":e}function Ho(t){return t.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}function Go(t,e){try{return new Function(t)}catch(n){return e.push({err:n,code:t}),R}}function qo(t){var e=Object.create(null);return function(n,r,i){(r=N({},r)).warn,delete r.warn;var a=r.delimiters?String(r.delimiters)+n:n;if(e[a])return e[a];var o=t(n,r),s={},u=[];return s.render=Go(o.render,u),s.staticRenderFns=o.staticRenderFns.map((function(t){return Go(t,u)})),e[a]=s}}new RegExp("\\b"+"do,if,for,let,new,try,var,case,else,with,await,break,catch,class,const,super,throw,while,yield,delete,export,import,return,switch,default,extends,finally,continue,debugger,function,arguments".split(",").join("\\b|\\b")+"\\b");var Xo,$o,Yo=(Xo=function(t,e){var n=function(t,e){Da=e.warn||Er,Ua=e.isPreTag||O,ja=e.mustUseProp||O,Wa=e.getTagNamespace||O,e.isReservedTag,Fa=Tr(e.modules,"transformNode"),Ba=Tr(e.modules,"preTransformNode"),za=Tr(e.modules,"postTransformNode"),Pa=e.delimiters;var n,r,i=[],a=!1!==e.preserveWhitespace,o=e.whitespace,s=!1,u=!1;function c(t){if(l(t),s||t.processed||(t=io(t,e)),i.length||t===n||n.if&&(t.elseif||t.else)&&oo(n,{exp:t.elseif,block:t}),r&&!t.forbidden)if(t.elseif||t.else)o=t,(c=function(t){for(var e=t.length;e--;){if(1===t[e].type)return t[e];t.pop()}}(r.children))&&c.if&&oo(c,{exp:o.elseif,block:o});else{if(t.slotScope){var a=t.slotTarget||'"default"';(r.scopedSlots||(r.scopedSlots={}))[a]=t}r.children.push(t),t.parent=r}var o,c;t.children=t.children.filter((function(t){return!t.slotScope})),l(t),t.pre&&(s=!1),Ua(t.tag)&&(u=!1);for(var h=0;h<za.length;h++)za[h](t,e)}function l(t){if(!u)for(var e;(e=t.children[t.children.length-1])&&3===e.type&&" "===e.text;)t.children.pop()}return function(t,e){for(var n,r,i=[],a=e.expectHTML,o=e.isUnaryTag||O,s=e.canBeLeftOpenTag||O,u=0;t;){if(n=t,r&&Ca(r)){var c=0,l=r.toLowerCase(),h=Aa[l]||(Aa[l]=new RegExp("([\\s\\S]*?)(</"+l+"[^>]*>)","i")),p=t.replace(h,(function(t,n,r){return c=r.length,Ca(l)||"noscript"===l||(n=n.replace(/<!\--([\s\S]*?)-->/g,"$1").replace(/<!\[CDATA\[([\s\S]*?)]]>/g,"$1")),ka(l,n)&&(n=n.slice(1)),e.chars&&e.chars(n),""}));u+=t.length-p.length,t=p,T(l,u-c,u)}else{var f=t.indexOf("<");if(0===f){if(Ea.test(t)){var d=t.indexOf("--\x3e");if(d>=0){e.shouldKeepComment&&e.comment(t.substring(4,d),u,u+d+3),S(d+3);continue}}if(Ta.test(t)){var m=t.indexOf("]>");if(m>=0){S(m+2);continue}}var v=t.match(Ma);if(v){S(v[0].length);continue}var g=t.match(Sa);if(g){var y=u;S(g[0].length),T(g[1],y,u);continue}var x=M();if(x){E(x),ka(x.tagName,t)&&S(1);continue}}var b=void 0,w=void 0,_=void 0;if(f>=0){for(w=t.slice(f);!(Sa.test(w)||wa.test(w)||Ea.test(w)||Ta.test(w)||(_=w.indexOf("<",1))<0);)f+=_,w=t.slice(f);b=t.substring(0,f)}f<0&&(b=t),b&&S(b.length),e.chars&&b&&e.chars(b,u-b.length,u)}if(t===n){e.chars&&e.chars(t);break}}function S(e){u+=e,t=t.substring(e)}function M(){var e=t.match(wa);if(e){var n,r,i={tagName:e[1],attrs:[],start:u};for(S(e[0].length);!(n=t.match(_a))&&(r=t.match(ya)||t.match(ga));)r.start=u,S(r[0].length),r.end=u,i.attrs.push(r);if(n)return i.unarySlash=n[1],S(n[0].length),i.end=u,i}}function E(t){var n=t.tagName,u=t.unarySlash;a&&("p"===r&&va(n)&&T(r),s(n)&&r===n&&T(n));for(var c=o(n)||!!u,l=t.attrs.length,h=new Array(l),p=0;p<l;p++){var f=t.attrs[p],d=f[3]||f[4]||f[5]||"",m="a"===n&&"href"===f[1]?e.shouldDecodeNewlinesForHref:e.shouldDecodeNewlines;h[p]={name:f[1],value:La(d,m)}}c||(i.push({tag:n,lowerCasedTag:n.toLowerCase(),attrs:h,start:t.start,end:t.end}),r=n),e.start&&e.start(n,h,c,t.start,t.end)}function T(t,n,a){var o,s;if(null==n&&(n=u),null==a&&(a=u),t)for(s=t.toLowerCase(),o=i.length-1;o>=0&&i[o].lowerCasedTag!==s;o--);else o=0;if(o>=0){for(var c=i.length-1;c>=o;c--)e.end&&e.end(i[c].tag,n,a);i.length=o,r=o&&i[o-1].tag}else"br"===s?e.start&&e.start(t,[],!0,n,a):"p"===s&&(e.start&&e.start(t,[],!1,n,a),e.end&&e.end(t,n,a))}T()}(t,{warn:Da,expectHTML:e.expectHTML,isUnaryTag:e.isUnaryTag,canBeLeftOpenTag:e.canBeLeftOpenTag,shouldDecodeNewlines:e.shouldDecodeNewlines,shouldDecodeNewlinesForHref:e.shouldDecodeNewlinesForHref,shouldKeepComment:e.comments,outputSourceRange:e.outputSourceRange,start:function(t,a,o,l,h){var p=r&&r.ns||Wa(t);K&&"svg"===p&&(a=function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];lo.test(r.name)||(r.name=r.name.replace(ho,""),e.push(r))}return e}(a));var f,d=ro(t,a,r);p&&(d.ns=p),"style"!==(f=d).tag&&("script"!==f.tag||f.attrsMap.type&&"text/javascript"!==f.attrsMap.type)||it()||(d.forbidden=!0);for(var m=0;m<Ba.length;m++)d=Ba[m](d,e)||d;s||(function(t){null!=Lr(t,"v-pre")&&(t.pre=!0)}(d),d.pre&&(s=!0)),Ua(d.tag)&&(u=!0),s?function(t){var e=t.attrsList,n=e.length;if(n)for(var r=t.attrs=new Array(n),i=0;i<n;i++)r[i]={name:e[i].name,value:JSON.stringify(e[i].value)},null!=e[i].start&&(r[i].start=e[i].start,r[i].end=e[i].end);else t.pre||(t.plain=!0)}(d):d.processed||(ao(d),function(t){var e=Lr(t,"v-if");if(e)t.if=e,oo(t,{exp:e,block:t});else{null!=Lr(t,"v-else")&&(t.else=!0);var n=Lr(t,"v-else-if");n&&(t.elseif=n)}}(d),function(t){null!=Lr(t,"v-once")&&(t.once=!0)}(d)),n||(n=d),o?c(d):(r=d,i.push(d))},end:function(t,e,n){var a=i[i.length-1];i.length-=1,r=i[i.length-1],c(a)},chars:function(t,e,n){if(r&&(!K||"textarea"!==r.tag||r.attrsMap.placeholder!==t)){var i,c,l,h=r.children;(t=u||t.trim()?"script"===(i=r).tag||"style"===i.tag?t:eo(t):h.length?o?"condense"===o&&Qa.test(t)?"":" ":a?" ":"":"")&&(u||"condense"!==o||(t=t.replace(to," ")),!s&&" "!==t&&(c=function(t,e){var n=e?ha(e):ca;if(n.test(t)){for(var r,i,a,o=[],s=[],u=n.lastIndex=0;r=n.exec(t);){(i=r.index)>u&&(s.push(a=t.slice(u,i)),o.push(JSON.stringify(a)));var c=Sr(r[1].trim());o.push("_s("+c+")"),s.push({"@binding":c}),u=i+r[0].length}return u<t.length&&(s.push(a=t.slice(u)),o.push(JSON.stringify(a))),{expression:o.join("+"),tokens:s}}}(t,Pa))?l={type:2,expression:c.expression,tokens:c.tokens,text:t}:" "===t&&h.length&&" "===h[h.length-1].text||(l={type:3,text:t}),l&&h.push(l))}},comment:function(t,e,n){if(r){var i={type:3,text:t,isComment:!0};r.children.push(i)}}}),n}(t.trim(),e);!1!==e.optimize&&function(t,e){t&&(fo=yo(e.staticKeys||""),mo=e.isReservedTag||O,function t(e){if(e.static=function(t){return 2!==t.type&&(3===t.type||!(!t.pre&&(t.hasBindings||t.if||t.for||v(t.tag)||!mo(t.tag)||function(t){for(;t.parent;){if("template"!==(t=t.parent).tag)return!1;if(t.for)return!0}return!1}(t)||!Object.keys(t).every(fo))))}(e),1===e.type){if(!mo(e.tag)&&"slot"!==e.tag&&null==e.attrsMap["inline-template"])return;for(var n=0,r=e.children.length;n<r;n++){var i=e.children[n];t(i),i.static||(e.static=!1)}if(e.ifConditions)for(var a=1,o=e.ifConditions.length;a<o;a++){var s=e.ifConditions[a].block;t(s),s.static||(e.static=!1)}}}(t),function t(e,n){if(1===e.type){if((e.static||e.once)&&(e.staticInFor=n),e.static&&e.children.length&&(1!==e.children.length||3!==e.children[0].type))return void(e.staticRoot=!0);if(e.staticRoot=!1,e.children)for(var r=0,i=e.children.length;r<i;r++)t(e.children[r],n||!!e.for);if(e.ifConditions)for(var a=1,o=e.ifConditions.length;a<o;a++)t(e.ifConditions[a].block,n)}}(t,!1))}(n,e);var r=Ro(n,e);return{ast:n,render:r.render,staticRenderFns:r.staticRenderFns}},function(t){function e(e,n){var r=Object.create(t),i=[],a=[];if(n)for(var o in n.modules&&(r.modules=(t.modules||[]).concat(n.modules)),n.directives&&(r.directives=N(Object.create(t.directives||null),n.directives)),n)"modules"!==o&&"directives"!==o&&(r[o]=n[o]);r.warn=function(t,e,n){(n?a:i).push(t)};var s=Xo(e.trim(),r);return s.errors=i,s.tips=a,s}return{compile:e,compileToFunctions:qo(e)}})(go),Ko=(Yo.compile,Yo.compileToFunctions);function Jo(t){return($o=$o||document.createElement("div")).innerHTML=t?'<a href="\n"/>':'<div a="\n"/>',$o.innerHTML.indexOf("&#10;")>0}var Zo=!!q&&Jo(!1),Qo=!!q&&Jo(!0),ts=w((function(t){var e=Yn(t);return e&&e.innerHTML})),es=_n.prototype.$mount;_n.prototype.$mount=function(t,e){if((t=t&&Yn(t))===document.body||t===document.documentElement)return this;var n=this.$options;if(!n.render){var r=n.template;if(r)if("string"==typeof r)"#"===r.charAt(0)&&(r=ts(r));else{if(!r.nodeType)return this;r=r.innerHTML}else t&&(r=function(t){if(t.outerHTML)return t.outerHTML;var e=document.createElement("div");return e.appendChild(t.cloneNode(!0)),e.innerHTML}(t));if(r){var i=Ko(r,{outputSourceRange:!1,shouldDecodeNewlines:Zo,shouldDecodeNewlinesForHref:Qo,delimiters:n.delimiters,comments:n.comments},this),a=i.render,o=i.staticRenderFns;n.render=a,n.staticRenderFns=o}}return es.call(this,t,e)},_n.compile=Ko,t.exports=_n}).call(this,n(26),n(131).setImmediate)},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,i,a,o,s,u=1,c={},l=!1,h=t.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(t);p=p&&p.setTimeout?p:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick((function(){d(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((a=new MessageChannel).port1.onmessage=function(t){d(t.data)},r=function(t){a.port2.postMessage(t)}):h&&"onreadystatechange"in h.createElement("script")?(i=h.documentElement,r=function(t){var e=h.createElement("script");e.onreadystatechange=function(){d(t),e.onreadystatechange=null,i.removeChild(e),e=null},i.appendChild(e)}):r=function(t){setTimeout(d,0,t)}:(o="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(o)&&d(+e.data.slice(o.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),r=function(e){t.postMessage(o+e,"*")}),p.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return c[u]=i,r(u),u++},p.clearImmediate=f}function f(t){delete c[t]}function d(t){if(l)setTimeout(d,0,t);else{var e=c[t];if(e){l=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{f(t),l=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(26),n(94))},function(t,e,n){(function(t){t.webcam=document.createElement("video");navigator.mediaDevices.getUserMedia({audio:!1,video:!0}).then(t=>{webcam.width="133",webcam.height="100",webcam.setAttribute("muted",""),webcam.setAttribute("playsinline",""),webcam.setAttribute("loop",""),webcam.setAttribute("preload","metadata"),Object.assign(webcam.style,{position:"fixed",top:"1rem",right:"1rem",objectFit:"cover",borderRadius:"0.25em",zIndex:"9999"}),webcam.srcObject=t,webcam.addEventListener("loadedmetadata",()=>{toolbar.camera.class="green",toolbar.camera.text="Camera Enabled",webcam.play(),document.body.appendChild(webcam),startFace()})})}).call(this,n(26))},function(t,e,n){"use strict";(function(t){var e=n(2),r=(n(133),n(145)),i=n(135),a=n(48),o=n(136),s=(n(96),n(137));t.backgroundShader=o.a,t.postShader=s.a,t.width=window.innerWidth,t.height=window.innerHeight,t.time=0,t.canvas=document.createElement("canvas"),canvas.width=window.innerWidth,canvas.height=window.innerHeight,Object.assign(canvas.style,{position:"fixed",top:"0px",left:"0px",zIndex:"1"}),document.body.appendChild(canvas),t.scene=new e.o,t.cam=new e.k(60,canvas.width/canvas.height,.1,1200),t.renderer=new e.v({antialias:!0,alpha:!0,canvas:canvas,preserveDrawingBuffer:!0}),renderer.setSize(canvas.width,canvas.height),cam.position.set(0,100,-400),cam.lookAt(0,0,0),t.composer=new r.a(renderer),t.background=new a.a(backgroundShader),t.stage=new i.a(scene,cam),t.postprocess=new a.a(postShader),background.material.uniforms.u_resolution.value=new e.s(width,height),postprocess.material.uniforms.u_resolution.value=new e.s(width,height),composer.addPass(stage),composer.addPass(background),composer.addPass(postprocess)}).call(this,n(26))},function(t,e,n){"use strict";(function(t){var e=n(138),r=n(0),i=n(139),a=n(142),o=n(143),s=n(53),u=n(2),c=(n(133),n(96)),l=n(144),h=n.n(l);function p(t,e,n,r,i,a,o){try{var s=t[a](o),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function f(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){p(a,r,i,o,s,"next",t)}function s(t){p(a,r,i,o,s,"throw",t)}o(void 0)}))}}t.faceMaterial=c.a,faceMaterial.uniforms.u_time.value=time,faceMaterial.uniforms.u_resolution.value=new u.s(width,height),t.faceObject=new u.i(new u.f,faceMaterial),t.startFace=f((function*(){i.a(`https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-backend-wasm@${a.version}/dist/tfjs-backend-wasm.wasm`),yield r.hc("wasm");const n=yield o.a({maxFaces:1}).then(t=>(toolbar.model.class="green",toolbar.model.text="Model Ready",t));t.faces=[e.a];let c=new u.f;faces[0].scaledMesh.forEach(t=>{let e=new u.t(t[0],t[1],t[2]);c.vertices.push(e)});for(let t=0;t<s.a.length/3;t++){const e=[s.a[3*t],s.a[3*t+1],s.a[3*t+2]];c.faces.push(new u.d(...e))}function l(){return p.apply(this,arguments)}function p(){return(p=f((function*(){faces=yield n.estimateFaces(window.webcam,!1,!1),1===faces.length?(d(faces[0].scaledMesh),toolbar.faceVisible=!(faces[0].faceInViewConfidence<1)):toolbar.faceVisible=!1,requestAnimationFrame(l)}))).apply(this,arguments)}function d(t){t.forEach((t,e,n)=>{let r=t[0],i=t[1],a=t[2];faceObject.geometry.vertices[e].x=r,faceObject.geometry.vertices[e].y=i,faceObject.geometry.vertices[e].z=a}),faceObject.geometry.verticesNeedUpdate=!0}faceObject=new u.i(c,faceMaterial),faceObject.geometry.dynamic=!0,faceObject.geometry.verticesNeedUpdate=!0,function(t){t.computeBoundingBox();var e=t.boundingBox.max,n=t.boundingBox.min,r=new u.s(0-n.x,0-n.y),i=new u.s(e.x-n.x,e.y-n.y),a=t.faces;t.faceVertexUvs[0]=[];for(var o=0;o<a.length;o++){var s=t.vertices[a[o].a],c=t.vertices[a[o].b],l=t.vertices[a[o].c];t.faceVertexUvs[0].push([new u.s((s.x+r.x)/i.x,(s.y+r.y)/i.y),new u.s((c.x+r.x)/i.x,(c.y+r.y)/i.y),new u.s((l.x+r.x)/i.x,(l.y+r.y)/i.y)])}t.uvsNeedUpdate=!0}(faceObject.geometry),faceObject.rotation.z=Math.PI,scene.add(faceObject),t.faceFrag=new h.a(faceObject),faceFrag.gradient("st.x","st.y",1).out(),cam.position.set(0-faceObject.geometry.vertices[6].x,0-faceObject.geometry.vertices[6].y+20,0-faceObject.geometry.vertices[6].z-300),cam.lookAt(0-faceObject.geometry.vertices[6].x,0-faceObject.geometry.vertices[6].y,0-faceObject.geometry.vertices[6].z),l(),d(faces[0].scaledMesh),window.addEventListener("resize",()=>{cam.position.set(0-faceObject.geometry.vertices[5].x,0-faceObject.geometry.vertices[5].y+20,0-faceObject.geometry.vertices[5].z-300),cam.lookAt(0-faceObject.geometry.vertices[5].x,0-faceObject.geometry.vertices[5].y,0-faceObject.geometry.vertices[5].z)})}))}).call(this,n(26))},function(t,e,n){"use strict";e.byteLength=function(t){var e=c(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){var e,n,r=c(t),o=r[0],s=r[1],u=new a(function(t,e,n){return 3*(e+n)/4-n}(0,o,s)),l=0,h=s>0?o-4:o;for(n=0;n<h;n+=4)e=i[t.charCodeAt(n)]<<18|i[t.charCodeAt(n+1)]<<12|i[t.charCodeAt(n+2)]<<6|i[t.charCodeAt(n+3)],u[l++]=e>>16&255,u[l++]=e>>8&255,u[l++]=255&e;2===s&&(e=i[t.charCodeAt(n)]<<2|i[t.charCodeAt(n+1)]>>4,u[l++]=255&e);1===s&&(e=i[t.charCodeAt(n)]<<10|i[t.charCodeAt(n+1)]<<4|i[t.charCodeAt(n+2)]>>2,u[l++]=e>>8&255,u[l++]=255&e);return u},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,a=[],o=0,s=n-i;o<s;o+=16383)a.push(l(t,o,o+16383>s?s:o+16383));1===i?(e=t[n-1],a.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],a.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return a.join("")};for(var r=[],i=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=o.length;s<u;++s)r[s]=o[s],i[o.charCodeAt(s)]=s;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function l(t,e,n){for(var i,a,o=[],s=e;s<n;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),o.push(r[(a=i)>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var a,o,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,h=n?i-1:0,p=n?-1:1,f=t[e+h];for(h+=p,a=f&(1<<-l)-1,f>>=-l,l+=s;l>0;a=256*a+t[e+h],h+=p,l-=8);for(o=a&(1<<-l)-1,a>>=-l,l+=r;l>0;o=256*o+t[e+h],h+=p,l-=8);if(0===a)a=1-c;else{if(a===u)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,r),a-=c}return(f?-1:1)*o*Math.pow(2,a-r)},e.write=function(t,e,n,r,i,a){var o,s,u,c=8*a-i-1,l=(1<<c)-1,h=l>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:a-1,d=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,o=l):(o=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-o))<1&&(o--,u*=2),(e+=o+h>=1?p/u:p*Math.pow(2,1-h))*u>=2&&(o++,u/=2),o+h>=l?(s=0,o=l):o+h>=1?(s=(e*u-1)*Math.pow(2,i),o+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;t[n+f]=255&s,f+=d,s/=256,i-=8);for(o=o<<i|s,c+=i;c>0;t[n+f]=255&o,f+=d,o/=256,c-=8);t[n+f-d]|=128*m}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e){},function(t,e){},function(t,e){},function(t,e){!function t(){time+=.01,faceObject.material.needsUpdate=!0,background.material.needsUpdate=!0,postprocess.material.needsUpdate=!0,faceObject.material.uniforms.u_time.value=time,background.material.uniforms.u_time.value=time,postprocess.material.uniforms.u_time.value=time,composer.render(renderer),window.requestAnimationFrame(t)}()},function(t,e){window.addEventListener("resize",()=>{width=window.innerWidth,height=window.innerHeight,faceObject.material.uniforms.u_resolution.value=new THREE.Vector2(width,height),background.material.uniforms.u_resolution.value=new THREE.Vector2(width,height),postprocess.material.uniforms.u_resolution.value=new THREE.Vector2(width,height)})}]);